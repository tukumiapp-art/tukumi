(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();function tE(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yv={exports:{}},vu={},xv={exports:{}},Ee={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Qo=Symbol.for("react.element"),nE=Symbol.for("react.portal"),rE=Symbol.for("react.fragment"),sE=Symbol.for("react.strict_mode"),iE=Symbol.for("react.profiler"),aE=Symbol.for("react.provider"),oE=Symbol.for("react.context"),lE=Symbol.for("react.forward_ref"),cE=Symbol.for("react.suspense"),uE=Symbol.for("react.memo"),dE=Symbol.for("react.lazy"),Tg=Symbol.iterator;function hE(t){return t===null||typeof t!="object"?null:(t=Tg&&t[Tg]||t["@@iterator"],typeof t=="function"?t:null)}var vv={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},wv=Object.assign,_v={};function pa(t,e,n){this.props=t,this.context=e,this.refs=_v,this.updater=n||vv}pa.prototype.isReactComponent={};pa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};pa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bv(){}bv.prototype=pa.prototype;function Df(t,e,n){this.props=t,this.context=e,this.refs=_v,this.updater=n||vv}var Lf=Df.prototype=new bv;Lf.constructor=Df;wv(Lf,pa.prototype);Lf.isPureReactComponent=!0;var Sg=Array.isArray,Nv=Object.prototype.hasOwnProperty,Of={current:null},Ev={key:!0,ref:!0,__self:!0,__source:!0};function kv(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)Nv.call(e,r)&&!Ev.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var u=Array(l),d=0;d<l;d++)u[d]=arguments[d+2];s.children=u}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:Qo,type:t,key:i,ref:o,props:s,_owner:Of.current}}function fE(t,e){return{$$typeof:Qo,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Mf(t){return typeof t=="object"&&t!==null&&t.$$typeof===Qo}function mE(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ig=/\/+/g;function Nd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?mE(""+t.key):e.toString(36)}function lc(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case Qo:case nE:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+Nd(o,0):r,Sg(s)?(n="",t!=null&&(n=t.replace(Ig,"$&/")+"/"),lc(s,e,n,"",function(d){return d})):s!=null&&(Mf(s)&&(s=fE(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Ig,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Sg(t))for(var l=0;l<t.length;l++){i=t[l];var u=r+Nd(i,l);o+=lc(i,e,n,u,s)}else if(u=hE(t),typeof u=="function")for(t=u.call(t),l=0;!(i=t.next()).done;)i=i.value,u=r+Nd(i,l++),o+=lc(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Ml(t,e,n){if(t==null)return t;var r=[],s=0;return lc(t,r,"","",function(i){return e.call(n,i,s++)}),r}function pE(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var on={current:null},cc={transition:null},gE={ReactCurrentDispatcher:on,ReactCurrentBatchConfig:cc,ReactCurrentOwner:Of};function Tv(){throw Error("act(...) is not supported in production builds of React.")}Ee.Children={map:Ml,forEach:function(t,e,n){Ml(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ml(t,function(){e++}),e},toArray:function(t){return Ml(t,function(e){return e})||[]},only:function(t){if(!Mf(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ee.Component=pa;Ee.Fragment=rE;Ee.Profiler=iE;Ee.PureComponent=Df;Ee.StrictMode=sE;Ee.Suspense=cE;Ee.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gE;Ee.act=Tv;Ee.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=wv({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Of.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(u in e)Nv.call(e,u)&&!Ev.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&l!==void 0?l[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){l=Array(u);for(var d=0;d<u;d++)l[d]=arguments[d+2];r.children=l}return{$$typeof:Qo,type:t.type,key:s,ref:i,props:r,_owner:o}};Ee.createContext=function(t){return t={$$typeof:oE,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:aE,_context:t},t.Consumer=t};Ee.createElement=kv;Ee.createFactory=function(t){var e=kv.bind(null,t);return e.type=t,e};Ee.createRef=function(){return{current:null}};Ee.forwardRef=function(t){return{$$typeof:lE,render:t}};Ee.isValidElement=Mf;Ee.lazy=function(t){return{$$typeof:dE,_payload:{_status:-1,_result:t},_init:pE}};Ee.memo=function(t,e){return{$$typeof:uE,type:t,compare:e===void 0?null:e}};Ee.startTransition=function(t){var e=cc.transition;cc.transition={};try{t()}finally{cc.transition=e}};Ee.unstable_act=Tv;Ee.useCallback=function(t,e){return on.current.useCallback(t,e)};Ee.useContext=function(t){return on.current.useContext(t)};Ee.useDebugValue=function(){};Ee.useDeferredValue=function(t){return on.current.useDeferredValue(t)};Ee.useEffect=function(t,e){return on.current.useEffect(t,e)};Ee.useId=function(){return on.current.useId()};Ee.useImperativeHandle=function(t,e,n){return on.current.useImperativeHandle(t,e,n)};Ee.useInsertionEffect=function(t,e){return on.current.useInsertionEffect(t,e)};Ee.useLayoutEffect=function(t,e){return on.current.useLayoutEffect(t,e)};Ee.useMemo=function(t,e){return on.current.useMemo(t,e)};Ee.useReducer=function(t,e,n){return on.current.useReducer(t,e,n)};Ee.useRef=function(t){return on.current.useRef(t)};Ee.useState=function(t){return on.current.useState(t)};Ee.useSyncExternalStore=function(t,e,n){return on.current.useSyncExternalStore(t,e,n)};Ee.useTransition=function(){return on.current.useTransition()};Ee.version="18.3.1";xv.exports=Ee;var w=xv.exports;const Sv=tE(w);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yE=w,xE=Symbol.for("react.element"),vE=Symbol.for("react.fragment"),wE=Object.prototype.hasOwnProperty,_E=yE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bE={key:!0,ref:!0,__self:!0,__source:!0};function Iv(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)wE.call(e,r)&&!bE.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:xE,type:t,key:i,ref:o,props:s,_owner:_E.current}}vu.Fragment=vE;vu.jsx=Iv;vu.jsxs=Iv;yv.exports=vu;var a=yv.exports,dh={},jv={exports:{}},jn={},Cv={exports:{}},Rv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(G,ee){var X=G.length;G.push(ee);e:for(;0<X;){var fe=X-1>>>1,ae=G[fe];if(0<s(ae,ee))G[fe]=ee,G[X]=ae,X=fe;else break e}}function n(G){return G.length===0?null:G[0]}function r(G){if(G.length===0)return null;var ee=G[0],X=G.pop();if(X!==ee){G[0]=X;e:for(var fe=0,ae=G.length,q=ae>>>1;fe<q;){var oe=2*(fe+1)-1,pe=G[oe],O=oe+1,re=G[O];if(0>s(pe,X))O<ae&&0>s(re,pe)?(G[fe]=re,G[O]=X,fe=O):(G[fe]=pe,G[oe]=X,fe=oe);else if(O<ae&&0>s(re,X))G[fe]=re,G[O]=X,fe=O;else break e}}return ee}function s(G,ee){var X=G.sortIndex-ee.sortIndex;return X!==0?X:G.id-ee.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var u=[],d=[],h=1,p=null,m=3,v=!1,T=!1,j=!1,I=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(G){for(var ee=n(d);ee!==null;){if(ee.callback===null)r(d);else if(ee.startTime<=G)r(d),ee.sortIndex=ee.expirationTime,e(u,ee);else break;ee=n(d)}}function A(G){if(j=!1,b(G),!T)if(n(u)!==null)T=!0,Be(V);else{var ee=n(d);ee!==null&&Ve(A,ee.startTime-G)}}function V(G,ee){T=!1,j&&(j=!1,y(x),x=-1),v=!0;var X=m;try{for(b(ee),p=n(u);p!==null&&(!(p.expirationTime>ee)||G&&!R());){var fe=p.callback;if(typeof fe=="function"){p.callback=null,m=p.priorityLevel;var ae=fe(p.expirationTime<=ee);ee=t.unstable_now(),typeof ae=="function"?p.callback=ae:p===n(u)&&r(u),b(ee)}else r(u);p=n(u)}if(p!==null)var q=!0;else{var oe=n(d);oe!==null&&Ve(A,oe.startTime-ee),q=!1}return q}finally{p=null,m=X,v=!1}}var M=!1,N=null,x=-1,E=5,S=-1;function R(){return!(t.unstable_now()-S<E)}function P(){if(N!==null){var G=t.unstable_now();S=G;var ee=!0;try{ee=N(!0,G)}finally{ee?C():(M=!1,N=null)}}else M=!1}var C;if(typeof _=="function")C=function(){_(P)};else if(typeof MessageChannel<"u"){var he=new MessageChannel,Ie=he.port2;he.port1.onmessage=P,C=function(){Ie.postMessage(null)}}else C=function(){I(P,0)};function Be(G){N=G,M||(M=!0,C())}function Ve(G,ee){x=I(function(){G(t.unstable_now())},ee)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(G){G.callback=null},t.unstable_continueExecution=function(){T||v||(T=!0,Be(V))},t.unstable_forceFrameRate=function(G){0>G||125<G?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<G?Math.floor(1e3/G):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(G){switch(m){case 1:case 2:case 3:var ee=3;break;default:ee=m}var X=m;m=ee;try{return G()}finally{m=X}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(G,ee){switch(G){case 1:case 2:case 3:case 4:case 5:break;default:G=3}var X=m;m=G;try{return ee()}finally{m=X}},t.unstable_scheduleCallback=function(G,ee,X){var fe=t.unstable_now();switch(typeof X=="object"&&X!==null?(X=X.delay,X=typeof X=="number"&&0<X?fe+X:fe):X=fe,G){case 1:var ae=-1;break;case 2:ae=250;break;case 5:ae=1073741823;break;case 4:ae=1e4;break;default:ae=5e3}return ae=X+ae,G={id:h++,callback:ee,priorityLevel:G,startTime:X,expirationTime:ae,sortIndex:-1},X>fe?(G.sortIndex=X,e(d,G),n(u)===null&&G===n(d)&&(j?(y(x),x=-1):j=!0,Ve(A,X-fe))):(G.sortIndex=ae,e(u,G),T||v||(T=!0,Be(V))),G},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(G){var ee=m;return function(){var X=m;m=ee;try{return G.apply(this,arguments)}finally{m=X}}}})(Rv);Cv.exports=Rv;var NE=Cv.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var EE=w,In=NE;function K(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var Av=new Set,bo={};function ui(t,e){Xi(t,e),Xi(t+"Capture",e)}function Xi(t,e){for(bo[t]=e,t=0;t<e.length;t++)Av.add(e[t])}var Dr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hh=Object.prototype.hasOwnProperty,kE=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,jg={},Cg={};function TE(t){return hh.call(Cg,t)?!0:hh.call(jg,t)?!1:kE.test(t)?Cg[t]=!0:(jg[t]=!0,!1)}function SE(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function IE(t,e,n,r){if(e===null||typeof e>"u"||SE(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ln(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Ft={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Ft[t]=new ln(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Ft[e]=new ln(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Ft[t]=new ln(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Ft[t]=new ln(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Ft[t]=new ln(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Ft[t]=new ln(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Ft[t]=new ln(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Ft[t]=new ln(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Ft[t]=new ln(t,5,!1,t.toLowerCase(),null,!1,!1)});var Vf=/[\-:]([a-z])/g;function Ff(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Vf,Ff);Ft[e]=new ln(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Vf,Ff);Ft[e]=new ln(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Vf,Ff);Ft[e]=new ln(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Ft[t]=new ln(t,1,!1,t.toLowerCase(),null,!1,!1)});Ft.xlinkHref=new ln("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Ft[t]=new ln(t,1,!1,t.toLowerCase(),null,!0,!0)});function Uf(t,e,n,r){var s=Ft.hasOwnProperty(e)?Ft[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(IE(e,n,s,r)&&(n=null),r||s===null?TE(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var zr=EE.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Vl=Symbol.for("react.element"),ji=Symbol.for("react.portal"),Ci=Symbol.for("react.fragment"),Bf=Symbol.for("react.strict_mode"),fh=Symbol.for("react.profiler"),Pv=Symbol.for("react.provider"),Dv=Symbol.for("react.context"),$f=Symbol.for("react.forward_ref"),mh=Symbol.for("react.suspense"),ph=Symbol.for("react.suspense_list"),zf=Symbol.for("react.memo"),es=Symbol.for("react.lazy"),Lv=Symbol.for("react.offscreen"),Rg=Symbol.iterator;function Ma(t){return t===null||typeof t!="object"?null:(t=Rg&&t[Rg]||t["@@iterator"],typeof t=="function"?t:null)}var st=Object.assign,Ed;function Qa(t){if(Ed===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Ed=e&&e[1]||""}return`
`+Ed+t}var kd=!1;function Td(t,e){if(!t||kd)return"";kd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var r=d}Reflect.construct(t,[],e)}else{try{e.call()}catch(d){r=d}t.call(e.prototype)}else{try{throw Error()}catch(d){r=d}t()}}catch(d){if(d&&r&&typeof d.stack=="string"){for(var s=d.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var u=`
`+s[o].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=o&&0<=l);break}}}finally{kd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Qa(t):""}function jE(t){switch(t.tag){case 5:return Qa(t.type);case 16:return Qa("Lazy");case 13:return Qa("Suspense");case 19:return Qa("SuspenseList");case 0:case 2:case 15:return t=Td(t.type,!1),t;case 11:return t=Td(t.type.render,!1),t;case 1:return t=Td(t.type,!0),t;default:return""}}function gh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Ci:return"Fragment";case ji:return"Portal";case fh:return"Profiler";case Bf:return"StrictMode";case mh:return"Suspense";case ph:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Dv:return(t.displayName||"Context")+".Consumer";case Pv:return(t._context.displayName||"Context")+".Provider";case $f:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case zf:return e=t.displayName||null,e!==null?e:gh(t.type)||"Memo";case es:e=t._payload,t=t._init;try{return gh(t(e))}catch{}}return null}function CE(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return gh(e);case 8:return e===Bf?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ns(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Ov(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function RE(t){var e=Ov(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Fl(t){t._valueTracker||(t._valueTracker=RE(t))}function Mv(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=Ov(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Rc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function yh(t,e){var n=e.checked;return st({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Ag(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ns(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function Vv(t,e){e=e.checked,e!=null&&Uf(t,"checked",e,!1)}function xh(t,e){Vv(t,e);var n=Ns(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?vh(t,e.type,n):e.hasOwnProperty("defaultValue")&&vh(t,e.type,Ns(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Pg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function vh(t,e,n){(e!=="number"||Rc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ya=Array.isArray;function $i(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ns(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function wh(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(K(91));return st({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Dg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(K(92));if(Ya(n)){if(1<n.length)throw Error(K(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ns(n)}}function Fv(t,e){var n=Ns(e.value),r=Ns(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Lg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function Uv(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function _h(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?Uv(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ul,Bv=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Ul=Ul||document.createElement("div"),Ul.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Ul.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function No(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var io={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AE=["Webkit","ms","Moz","O"];Object.keys(io).forEach(function(t){AE.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),io[e]=io[t]})});function $v(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||io.hasOwnProperty(t)&&io[t]?(""+e).trim():e+"px"}function zv(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=$v(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var PE=st({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function bh(t,e){if(e){if(PE[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(K(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(K(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(K(61))}if(e.style!=null&&typeof e.style!="object")throw Error(K(62))}}function Nh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Eh=null;function Wf(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var kh=null,zi=null,Wi=null;function Og(t){if(t=Xo(t)){if(typeof kh!="function")throw Error(K(280));var e=t.stateNode;e&&(e=Eu(e),kh(t.stateNode,t.type,e))}}function Wv(t){zi?Wi?Wi.push(t):Wi=[t]:zi=t}function qv(){if(zi){var t=zi,e=Wi;if(Wi=zi=null,Og(t),e)for(t=0;t<e.length;t++)Og(e[t])}}function Hv(t,e){return t(e)}function Gv(){}var Sd=!1;function Kv(t,e,n){if(Sd)return t(e,n);Sd=!0;try{return Hv(t,e,n)}finally{Sd=!1,(zi!==null||Wi!==null)&&(Gv(),qv())}}function Eo(t,e){var n=t.stateNode;if(n===null)return null;var r=Eu(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(K(231,e,typeof n));return n}var Th=!1;if(Dr)try{var Va={};Object.defineProperty(Va,"passive",{get:function(){Th=!0}}),window.addEventListener("test",Va,Va),window.removeEventListener("test",Va,Va)}catch{Th=!1}function DE(t,e,n,r,s,i,o,l,u){var d=Array.prototype.slice.call(arguments,3);try{e.apply(n,d)}catch(h){this.onError(h)}}var ao=!1,Ac=null,Pc=!1,Sh=null,LE={onError:function(t){ao=!0,Ac=t}};function OE(t,e,n,r,s,i,o,l,u){ao=!1,Ac=null,DE.apply(LE,arguments)}function ME(t,e,n,r,s,i,o,l,u){if(OE.apply(this,arguments),ao){if(ao){var d=Ac;ao=!1,Ac=null}else throw Error(K(198));Pc||(Pc=!0,Sh=d)}}function di(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function Qv(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Mg(t){if(di(t)!==t)throw Error(K(188))}function VE(t){var e=t.alternate;if(!e){if(e=di(t),e===null)throw Error(K(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Mg(s),t;if(i===r)return Mg(s),e;i=i.sibling}throw Error(K(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(K(189))}}if(n.alternate!==r)throw Error(K(190))}if(n.tag!==3)throw Error(K(188));return n.stateNode.current===n?t:e}function Yv(t){return t=VE(t),t!==null?Jv(t):null}function Jv(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=Jv(t);if(e!==null)return e;t=t.sibling}return null}var Xv=In.unstable_scheduleCallback,Vg=In.unstable_cancelCallback,FE=In.unstable_shouldYield,UE=In.unstable_requestPaint,mt=In.unstable_now,BE=In.unstable_getCurrentPriorityLevel,qf=In.unstable_ImmediatePriority,Zv=In.unstable_UserBlockingPriority,Dc=In.unstable_NormalPriority,$E=In.unstable_LowPriority,e0=In.unstable_IdlePriority,wu=null,cr=null;function zE(t){if(cr&&typeof cr.onCommitFiberRoot=="function")try{cr.onCommitFiberRoot(wu,t,void 0,(t.current.flags&128)===128)}catch{}}var Kn=Math.clz32?Math.clz32:HE,WE=Math.log,qE=Math.LN2;function HE(t){return t>>>=0,t===0?32:31-(WE(t)/qE|0)|0}var Bl=64,$l=4194304;function Ja(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Lc(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Ja(l):(i&=o,i!==0&&(r=Ja(i)))}else o=n&~s,o!==0?r=Ja(o):i!==0&&(r=Ja(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Kn(e),s=1<<n,r|=t[n],e&=~s;return r}function GE(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function KE(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Kn(i),l=1<<o,u=s[o];u===-1?(!(l&n)||l&r)&&(s[o]=GE(l,e)):u<=e&&(t.expiredLanes|=l),i&=~l}}function Ih(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function t0(){var t=Bl;return Bl<<=1,!(Bl&4194240)&&(Bl=64),t}function Id(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Yo(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Kn(e),t[e]=n}function QE(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Kn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Hf(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Kn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Fe=0;function n0(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var r0,Gf,s0,i0,a0,jh=!1,zl=[],hs=null,fs=null,ms=null,ko=new Map,To=new Map,ns=[],YE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Fg(t,e){switch(t){case"focusin":case"focusout":hs=null;break;case"dragenter":case"dragleave":fs=null;break;case"mouseover":case"mouseout":ms=null;break;case"pointerover":case"pointerout":ko.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":To.delete(e.pointerId)}}function Fa(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Xo(e),e!==null&&Gf(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function JE(t,e,n,r,s){switch(e){case"focusin":return hs=Fa(hs,t,e,n,r,s),!0;case"dragenter":return fs=Fa(fs,t,e,n,r,s),!0;case"mouseover":return ms=Fa(ms,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return ko.set(i,Fa(ko.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,To.set(i,Fa(To.get(i)||null,t,e,n,r,s)),!0}return!1}function o0(t){var e=Ws(t.target);if(e!==null){var n=di(e);if(n!==null){if(e=n.tag,e===13){if(e=Qv(n),e!==null){t.blockedOn=e,a0(t.priority,function(){s0(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function uc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Ch(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Eh=r,n.target.dispatchEvent(r),Eh=null}else return e=Xo(n),e!==null&&Gf(e),t.blockedOn=n,!1;e.shift()}return!0}function Ug(t,e,n){uc(t)&&n.delete(e)}function XE(){jh=!1,hs!==null&&uc(hs)&&(hs=null),fs!==null&&uc(fs)&&(fs=null),ms!==null&&uc(ms)&&(ms=null),ko.forEach(Ug),To.forEach(Ug)}function Ua(t,e){t.blockedOn===e&&(t.blockedOn=null,jh||(jh=!0,In.unstable_scheduleCallback(In.unstable_NormalPriority,XE)))}function So(t){function e(s){return Ua(s,t)}if(0<zl.length){Ua(zl[0],t);for(var n=1;n<zl.length;n++){var r=zl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(hs!==null&&Ua(hs,t),fs!==null&&Ua(fs,t),ms!==null&&Ua(ms,t),ko.forEach(e),To.forEach(e),n=0;n<ns.length;n++)r=ns[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ns.length&&(n=ns[0],n.blockedOn===null);)o0(n),n.blockedOn===null&&ns.shift()}var qi=zr.ReactCurrentBatchConfig,Oc=!0;function ZE(t,e,n,r){var s=Fe,i=qi.transition;qi.transition=null;try{Fe=1,Kf(t,e,n,r)}finally{Fe=s,qi.transition=i}}function ek(t,e,n,r){var s=Fe,i=qi.transition;qi.transition=null;try{Fe=4,Kf(t,e,n,r)}finally{Fe=s,qi.transition=i}}function Kf(t,e,n,r){if(Oc){var s=Ch(t,e,n,r);if(s===null)Vd(t,e,r,Mc,n),Fg(t,r);else if(JE(s,t,e,n,r))r.stopPropagation();else if(Fg(t,r),e&4&&-1<YE.indexOf(t)){for(;s!==null;){var i=Xo(s);if(i!==null&&r0(i),i=Ch(t,e,n,r),i===null&&Vd(t,e,r,Mc,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Vd(t,e,r,null,n)}}var Mc=null;function Ch(t,e,n,r){if(Mc=null,t=Wf(r),t=Ws(t),t!==null)if(e=di(t),e===null)t=null;else if(n=e.tag,n===13){if(t=Qv(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Mc=t,null}function l0(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(BE()){case qf:return 1;case Zv:return 4;case Dc:case $E:return 16;case e0:return 536870912;default:return 16}default:return 16}}var cs=null,Qf=null,dc=null;function c0(){if(dc)return dc;var t,e=Qf,n=e.length,r,s="value"in cs?cs.value:cs.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return dc=s.slice(t,1<r?1-r:void 0)}function hc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Wl(){return!0}function Bg(){return!1}function Cn(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Wl:Bg,this.isPropagationStopped=Bg,this}return st(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Wl)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Wl)},persist:function(){},isPersistent:Wl}),e}var ga={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Yf=Cn(ga),Jo=st({},ga,{view:0,detail:0}),tk=Cn(Jo),jd,Cd,Ba,_u=st({},Jo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jf,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ba&&(Ba&&t.type==="mousemove"?(jd=t.screenX-Ba.screenX,Cd=t.screenY-Ba.screenY):Cd=jd=0,Ba=t),jd)},movementY:function(t){return"movementY"in t?t.movementY:Cd}}),$g=Cn(_u),nk=st({},_u,{dataTransfer:0}),rk=Cn(nk),sk=st({},Jo,{relatedTarget:0}),Rd=Cn(sk),ik=st({},ga,{animationName:0,elapsedTime:0,pseudoElement:0}),ak=Cn(ik),ok=st({},ga,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),lk=Cn(ok),ck=st({},ga,{data:0}),zg=Cn(ck),uk={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},dk={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hk={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function fk(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=hk[t])?!!e[t]:!1}function Jf(){return fk}var mk=st({},Jo,{key:function(t){if(t.key){var e=uk[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?dk[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jf,charCode:function(t){return t.type==="keypress"?hc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),pk=Cn(mk),gk=st({},_u,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Wg=Cn(gk),yk=st({},Jo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jf}),xk=Cn(yk),vk=st({},ga,{propertyName:0,elapsedTime:0,pseudoElement:0}),wk=Cn(vk),_k=st({},_u,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bk=Cn(_k),Nk=[9,13,27,32],Xf=Dr&&"CompositionEvent"in window,oo=null;Dr&&"documentMode"in document&&(oo=document.documentMode);var Ek=Dr&&"TextEvent"in window&&!oo,u0=Dr&&(!Xf||oo&&8<oo&&11>=oo),qg=" ",Hg=!1;function d0(t,e){switch(t){case"keyup":return Nk.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function h0(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ri=!1;function kk(t,e){switch(t){case"compositionend":return h0(e);case"keypress":return e.which!==32?null:(Hg=!0,qg);case"textInput":return t=e.data,t===qg&&Hg?null:t;default:return null}}function Tk(t,e){if(Ri)return t==="compositionend"||!Xf&&d0(t,e)?(t=c0(),dc=Qf=cs=null,Ri=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return u0&&e.locale!=="ko"?null:e.data;default:return null}}var Sk={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Gg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!Sk[t.type]:e==="textarea"}function f0(t,e,n,r){Wv(r),e=Vc(e,"onChange"),0<e.length&&(n=new Yf("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var lo=null,Io=null;function Ik(t){E0(t,0)}function bu(t){var e=Di(t);if(Mv(e))return t}function jk(t,e){if(t==="change")return e}var m0=!1;if(Dr){var Ad;if(Dr){var Pd="oninput"in document;if(!Pd){var Kg=document.createElement("div");Kg.setAttribute("oninput","return;"),Pd=typeof Kg.oninput=="function"}Ad=Pd}else Ad=!1;m0=Ad&&(!document.documentMode||9<document.documentMode)}function Qg(){lo&&(lo.detachEvent("onpropertychange",p0),Io=lo=null)}function p0(t){if(t.propertyName==="value"&&bu(Io)){var e=[];f0(e,Io,t,Wf(t)),Kv(Ik,e)}}function Ck(t,e,n){t==="focusin"?(Qg(),lo=e,Io=n,lo.attachEvent("onpropertychange",p0)):t==="focusout"&&Qg()}function Rk(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return bu(Io)}function Ak(t,e){if(t==="click")return bu(e)}function Pk(t,e){if(t==="input"||t==="change")return bu(e)}function Dk(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Yn=typeof Object.is=="function"?Object.is:Dk;function jo(t,e){if(Yn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!hh.call(e,s)||!Yn(t[s],e[s]))return!1}return!0}function Yg(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jg(t,e){var n=Yg(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Yg(n)}}function g0(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?g0(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function y0(){for(var t=window,e=Rc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Rc(t.document)}return e}function Zf(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function Lk(t){var e=y0(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&g0(n.ownerDocument.documentElement,n)){if(r!==null&&Zf(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Jg(n,i);var o=Jg(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Ok=Dr&&"documentMode"in document&&11>=document.documentMode,Ai=null,Rh=null,co=null,Ah=!1;function Xg(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Ah||Ai==null||Ai!==Rc(r)||(r=Ai,"selectionStart"in r&&Zf(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),co&&jo(co,r)||(co=r,r=Vc(Rh,"onSelect"),0<r.length&&(e=new Yf("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ai)))}function ql(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pi={animationend:ql("Animation","AnimationEnd"),animationiteration:ql("Animation","AnimationIteration"),animationstart:ql("Animation","AnimationStart"),transitionend:ql("Transition","TransitionEnd")},Dd={},x0={};Dr&&(x0=document.createElement("div").style,"AnimationEvent"in window||(delete Pi.animationend.animation,delete Pi.animationiteration.animation,delete Pi.animationstart.animation),"TransitionEvent"in window||delete Pi.transitionend.transition);function Nu(t){if(Dd[t])return Dd[t];if(!Pi[t])return t;var e=Pi[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in x0)return Dd[t]=e[n];return t}var v0=Nu("animationend"),w0=Nu("animationiteration"),_0=Nu("animationstart"),b0=Nu("transitionend"),N0=new Map,Zg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Cs(t,e){N0.set(t,e),ui(e,[t])}for(var Ld=0;Ld<Zg.length;Ld++){var Od=Zg[Ld],Mk=Od.toLowerCase(),Vk=Od[0].toUpperCase()+Od.slice(1);Cs(Mk,"on"+Vk)}Cs(v0,"onAnimationEnd");Cs(w0,"onAnimationIteration");Cs(_0,"onAnimationStart");Cs("dblclick","onDoubleClick");Cs("focusin","onFocus");Cs("focusout","onBlur");Cs(b0,"onTransitionEnd");Xi("onMouseEnter",["mouseout","mouseover"]);Xi("onMouseLeave",["mouseout","mouseover"]);Xi("onPointerEnter",["pointerout","pointerover"]);Xi("onPointerLeave",["pointerout","pointerover"]);ui("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));ui("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));ui("onBeforeInput",["compositionend","keypress","textInput","paste"]);ui("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));ui("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xa="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fk=new Set("cancel close invalid load scroll toggle".split(" ").concat(Xa));function ey(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,ME(r,e,void 0,t),t.currentTarget=null}function E0(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],u=l.instance,d=l.currentTarget;if(l=l.listener,u!==i&&s.isPropagationStopped())break e;ey(s,l,d),i=u}else for(o=0;o<r.length;o++){if(l=r[o],u=l.instance,d=l.currentTarget,l=l.listener,u!==i&&s.isPropagationStopped())break e;ey(s,l,d),i=u}}}if(Pc)throw t=Sh,Pc=!1,Sh=null,t}function Ye(t,e){var n=e[Mh];n===void 0&&(n=e[Mh]=new Set);var r=t+"__bubble";n.has(r)||(k0(e,t,2,!1),n.add(r))}function Md(t,e,n){var r=0;e&&(r|=4),k0(n,t,r,e)}var Hl="_reactListening"+Math.random().toString(36).slice(2);function Co(t){if(!t[Hl]){t[Hl]=!0,Av.forEach(function(n){n!=="selectionchange"&&(Fk.has(n)||Md(n,!1,t),Md(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Hl]||(e[Hl]=!0,Md("selectionchange",!1,e))}}function k0(t,e,n,r){switch(l0(e)){case 1:var s=ZE;break;case 4:s=ek;break;default:s=Kf}n=s.bind(null,e,n,t),s=void 0,!Th||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Vd(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var u=o.tag;if((u===3||u===4)&&(u=o.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Ws(l),o===null)return;if(u=o.tag,u===5||u===6){r=i=o;continue e}l=l.parentNode}}r=r.return}Kv(function(){var d=i,h=Wf(n),p=[];e:{var m=N0.get(t);if(m!==void 0){var v=Yf,T=t;switch(t){case"keypress":if(hc(n)===0)break e;case"keydown":case"keyup":v=pk;break;case"focusin":T="focus",v=Rd;break;case"focusout":T="blur",v=Rd;break;case"beforeblur":case"afterblur":v=Rd;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=$g;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=rk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=xk;break;case v0:case w0:case _0:v=ak;break;case b0:v=wk;break;case"scroll":v=tk;break;case"wheel":v=bk;break;case"copy":case"cut":case"paste":v=lk;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Wg}var j=(e&4)!==0,I=!j&&t==="scroll",y=j?m!==null?m+"Capture":null:m;j=[];for(var _=d,b;_!==null;){b=_;var A=b.stateNode;if(b.tag===5&&A!==null&&(b=A,y!==null&&(A=Eo(_,y),A!=null&&j.push(Ro(_,A,b)))),I)break;_=_.return}0<j.length&&(m=new v(m,T,null,n,h),p.push({event:m,listeners:j}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==Eh&&(T=n.relatedTarget||n.fromElement)&&(Ws(T)||T[Lr]))break e;if((v||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,v?(T=n.relatedTarget||n.toElement,v=d,T=T?Ws(T):null,T!==null&&(I=di(T),T!==I||T.tag!==5&&T.tag!==6)&&(T=null)):(v=null,T=d),v!==T)){if(j=$g,A="onMouseLeave",y="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(j=Wg,A="onPointerLeave",y="onPointerEnter",_="pointer"),I=v==null?m:Di(v),b=T==null?m:Di(T),m=new j(A,_+"leave",v,n,h),m.target=I,m.relatedTarget=b,A=null,Ws(h)===d&&(j=new j(y,_+"enter",T,n,h),j.target=b,j.relatedTarget=I,A=j),I=A,v&&T)t:{for(j=v,y=T,_=0,b=j;b;b=ki(b))_++;for(b=0,A=y;A;A=ki(A))b++;for(;0<_-b;)j=ki(j),_--;for(;0<b-_;)y=ki(y),b--;for(;_--;){if(j===y||y!==null&&j===y.alternate)break t;j=ki(j),y=ki(y)}j=null}else j=null;v!==null&&ty(p,m,v,j,!1),T!==null&&I!==null&&ty(p,I,T,j,!0)}}e:{if(m=d?Di(d):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var V=jk;else if(Gg(m))if(m0)V=Pk;else{V=Rk;var M=Ck}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(V=Ak);if(V&&(V=V(t,d))){f0(p,V,n,h);break e}M&&M(t,m,d),t==="focusout"&&(M=m._wrapperState)&&M.controlled&&m.type==="number"&&vh(m,"number",m.value)}switch(M=d?Di(d):window,t){case"focusin":(Gg(M)||M.contentEditable==="true")&&(Ai=M,Rh=d,co=null);break;case"focusout":co=Rh=Ai=null;break;case"mousedown":Ah=!0;break;case"contextmenu":case"mouseup":case"dragend":Ah=!1,Xg(p,n,h);break;case"selectionchange":if(Ok)break;case"keydown":case"keyup":Xg(p,n,h)}var N;if(Xf)e:{switch(t){case"compositionstart":var x="onCompositionStart";break e;case"compositionend":x="onCompositionEnd";break e;case"compositionupdate":x="onCompositionUpdate";break e}x=void 0}else Ri?d0(t,n)&&(x="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(x="onCompositionStart");x&&(u0&&n.locale!=="ko"&&(Ri||x!=="onCompositionStart"?x==="onCompositionEnd"&&Ri&&(N=c0()):(cs=h,Qf="value"in cs?cs.value:cs.textContent,Ri=!0)),M=Vc(d,x),0<M.length&&(x=new zg(x,t,null,n,h),p.push({event:x,listeners:M}),N?x.data=N:(N=h0(n),N!==null&&(x.data=N)))),(N=Ek?kk(t,n):Tk(t,n))&&(d=Vc(d,"onBeforeInput"),0<d.length&&(h=new zg("onBeforeInput","beforeinput",null,n,h),p.push({event:h,listeners:d}),h.data=N))}E0(p,e)})}function Ro(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Vc(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Eo(t,n),i!=null&&r.unshift(Ro(t,i,s)),i=Eo(t,e),i!=null&&r.push(Ro(t,i,s))),t=t.return}return r}function ki(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ty(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,u=l.alternate,d=l.stateNode;if(u!==null&&u===r)break;l.tag===5&&d!==null&&(l=d,s?(u=Eo(n,i),u!=null&&o.unshift(Ro(n,u,l))):s||(u=Eo(n,i),u!=null&&o.push(Ro(n,u,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var Uk=/\r\n?/g,Bk=/\u0000|\uFFFD/g;function ny(t){return(typeof t=="string"?t:""+t).replace(Uk,`
`).replace(Bk,"")}function Gl(t,e,n){if(e=ny(e),ny(t)!==e&&n)throw Error(K(425))}function Fc(){}var Ph=null,Dh=null;function Lh(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Oh=typeof setTimeout=="function"?setTimeout:void 0,$k=typeof clearTimeout=="function"?clearTimeout:void 0,ry=typeof Promise=="function"?Promise:void 0,zk=typeof queueMicrotask=="function"?queueMicrotask:typeof ry<"u"?function(t){return ry.resolve(null).then(t).catch(Wk)}:Oh;function Wk(t){setTimeout(function(){throw t})}function Fd(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),So(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);So(e)}function ps(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function sy(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var ya=Math.random().toString(36).slice(2),ar="__reactFiber$"+ya,Ao="__reactProps$"+ya,Lr="__reactContainer$"+ya,Mh="__reactEvents$"+ya,qk="__reactListeners$"+ya,Hk="__reactHandles$"+ya;function Ws(t){var e=t[ar];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Lr]||n[ar]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=sy(t);t!==null;){if(n=t[ar])return n;t=sy(t)}return e}t=n,n=t.parentNode}return null}function Xo(t){return t=t[ar]||t[Lr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Di(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(K(33))}function Eu(t){return t[Ao]||null}var Vh=[],Li=-1;function Rs(t){return{current:t}}function Ze(t){0>Li||(t.current=Vh[Li],Vh[Li]=null,Li--)}function He(t,e){Li++,Vh[Li]=t.current,t.current=e}var Es={},Jt=Rs(Es),mn=Rs(!1),Xs=Es;function Zi(t,e){var n=t.type.contextTypes;if(!n)return Es;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function pn(t){return t=t.childContextTypes,t!=null}function Uc(){Ze(mn),Ze(Jt)}function iy(t,e,n){if(Jt.current!==Es)throw Error(K(168));He(Jt,e),He(mn,n)}function T0(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(K(108,CE(t)||"Unknown",s));return st({},n,r)}function Bc(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Es,Xs=Jt.current,He(Jt,t),He(mn,mn.current),!0}function ay(t,e,n){var r=t.stateNode;if(!r)throw Error(K(169));n?(t=T0(t,e,Xs),r.__reactInternalMemoizedMergedChildContext=t,Ze(mn),Ze(Jt),He(Jt,t)):Ze(mn),He(mn,n)}var Er=null,ku=!1,Ud=!1;function S0(t){Er===null?Er=[t]:Er.push(t)}function Gk(t){ku=!0,S0(t)}function As(){if(!Ud&&Er!==null){Ud=!0;var t=0,e=Fe;try{var n=Er;for(Fe=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Er=null,ku=!1}catch(s){throw Er!==null&&(Er=Er.slice(t+1)),Xv(qf,As),s}finally{Fe=e,Ud=!1}}return null}var Oi=[],Mi=0,$c=null,zc=0,An=[],Pn=0,Zs=null,kr=1,Tr="";function Bs(t,e){Oi[Mi++]=zc,Oi[Mi++]=$c,$c=t,zc=e}function I0(t,e,n){An[Pn++]=kr,An[Pn++]=Tr,An[Pn++]=Zs,Zs=t;var r=kr;t=Tr;var s=32-Kn(r)-1;r&=~(1<<s),n+=1;var i=32-Kn(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,kr=1<<32-Kn(e)+s|n<<s|r,Tr=i+t}else kr=1<<i|n<<s|r,Tr=t}function em(t){t.return!==null&&(Bs(t,1),I0(t,1,0))}function tm(t){for(;t===$c;)$c=Oi[--Mi],Oi[Mi]=null,zc=Oi[--Mi],Oi[Mi]=null;for(;t===Zs;)Zs=An[--Pn],An[Pn]=null,Tr=An[--Pn],An[Pn]=null,kr=An[--Pn],An[Pn]=null}var Nn=null,vn=null,et=!1,Gn=null;function j0(t,e){var n=Ln(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function oy(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Nn=t,vn=ps(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Nn=t,vn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Zs!==null?{id:kr,overflow:Tr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ln(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Nn=t,vn=null,!0):!1;default:return!1}}function Fh(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Uh(t){if(et){var e=vn;if(e){var n=e;if(!oy(t,e)){if(Fh(t))throw Error(K(418));e=ps(n.nextSibling);var r=Nn;e&&oy(t,e)?j0(r,n):(t.flags=t.flags&-4097|2,et=!1,Nn=t)}}else{if(Fh(t))throw Error(K(418));t.flags=t.flags&-4097|2,et=!1,Nn=t}}}function ly(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Nn=t}function Kl(t){if(t!==Nn)return!1;if(!et)return ly(t),et=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Lh(t.type,t.memoizedProps)),e&&(e=vn)){if(Fh(t))throw C0(),Error(K(418));for(;e;)j0(t,e),e=ps(e.nextSibling)}if(ly(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(K(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){vn=ps(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}vn=null}}else vn=Nn?ps(t.stateNode.nextSibling):null;return!0}function C0(){for(var t=vn;t;)t=ps(t.nextSibling)}function ea(){vn=Nn=null,et=!1}function nm(t){Gn===null?Gn=[t]:Gn.push(t)}var Kk=zr.ReactCurrentBatchConfig;function $a(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(K(309));var r=n.stateNode}if(!r)throw Error(K(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(K(284));if(!n._owner)throw Error(K(290,t))}return t}function Ql(t,e){throw t=Object.prototype.toString.call(e),Error(K(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function cy(t){var e=t._init;return e(t._payload)}function R0(t){function e(y,_){if(t){var b=y.deletions;b===null?(y.deletions=[_],y.flags|=16):b.push(_)}}function n(y,_){if(!t)return null;for(;_!==null;)e(y,_),_=_.sibling;return null}function r(y,_){for(y=new Map;_!==null;)_.key!==null?y.set(_.key,_):y.set(_.index,_),_=_.sibling;return y}function s(y,_){return y=vs(y,_),y.index=0,y.sibling=null,y}function i(y,_,b){return y.index=b,t?(b=y.alternate,b!==null?(b=b.index,b<_?(y.flags|=2,_):b):(y.flags|=2,_)):(y.flags|=1048576,_)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function l(y,_,b,A){return _===null||_.tag!==6?(_=Gd(b,y.mode,A),_.return=y,_):(_=s(_,b),_.return=y,_)}function u(y,_,b,A){var V=b.type;return V===Ci?h(y,_,b.props.children,A,b.key):_!==null&&(_.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===es&&cy(V)===_.type)?(A=s(_,b.props),A.ref=$a(y,_,b),A.return=y,A):(A=vc(b.type,b.key,b.props,null,y.mode,A),A.ref=$a(y,_,b),A.return=y,A)}function d(y,_,b,A){return _===null||_.tag!==4||_.stateNode.containerInfo!==b.containerInfo||_.stateNode.implementation!==b.implementation?(_=Kd(b,y.mode,A),_.return=y,_):(_=s(_,b.children||[]),_.return=y,_)}function h(y,_,b,A,V){return _===null||_.tag!==7?(_=Qs(b,y.mode,A,V),_.return=y,_):(_=s(_,b),_.return=y,_)}function p(y,_,b){if(typeof _=="string"&&_!==""||typeof _=="number")return _=Gd(""+_,y.mode,b),_.return=y,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Vl:return b=vc(_.type,_.key,_.props,null,y.mode,b),b.ref=$a(y,null,_),b.return=y,b;case ji:return _=Kd(_,y.mode,b),_.return=y,_;case es:var A=_._init;return p(y,A(_._payload),b)}if(Ya(_)||Ma(_))return _=Qs(_,y.mode,b,null),_.return=y,_;Ql(y,_)}return null}function m(y,_,b,A){var V=_!==null?_.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return V!==null?null:l(y,_,""+b,A);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Vl:return b.key===V?u(y,_,b,A):null;case ji:return b.key===V?d(y,_,b,A):null;case es:return V=b._init,m(y,_,V(b._payload),A)}if(Ya(b)||Ma(b))return V!==null?null:h(y,_,b,A,null);Ql(y,b)}return null}function v(y,_,b,A,V){if(typeof A=="string"&&A!==""||typeof A=="number")return y=y.get(b)||null,l(_,y,""+A,V);if(typeof A=="object"&&A!==null){switch(A.$$typeof){case Vl:return y=y.get(A.key===null?b:A.key)||null,u(_,y,A,V);case ji:return y=y.get(A.key===null?b:A.key)||null,d(_,y,A,V);case es:var M=A._init;return v(y,_,b,M(A._payload),V)}if(Ya(A)||Ma(A))return y=y.get(b)||null,h(_,y,A,V,null);Ql(_,A)}return null}function T(y,_,b,A){for(var V=null,M=null,N=_,x=_=0,E=null;N!==null&&x<b.length;x++){N.index>x?(E=N,N=null):E=N.sibling;var S=m(y,N,b[x],A);if(S===null){N===null&&(N=E);break}t&&N&&S.alternate===null&&e(y,N),_=i(S,_,x),M===null?V=S:M.sibling=S,M=S,N=E}if(x===b.length)return n(y,N),et&&Bs(y,x),V;if(N===null){for(;x<b.length;x++)N=p(y,b[x],A),N!==null&&(_=i(N,_,x),M===null?V=N:M.sibling=N,M=N);return et&&Bs(y,x),V}for(N=r(y,N);x<b.length;x++)E=v(N,y,x,b[x],A),E!==null&&(t&&E.alternate!==null&&N.delete(E.key===null?x:E.key),_=i(E,_,x),M===null?V=E:M.sibling=E,M=E);return t&&N.forEach(function(R){return e(y,R)}),et&&Bs(y,x),V}function j(y,_,b,A){var V=Ma(b);if(typeof V!="function")throw Error(K(150));if(b=V.call(b),b==null)throw Error(K(151));for(var M=V=null,N=_,x=_=0,E=null,S=b.next();N!==null&&!S.done;x++,S=b.next()){N.index>x?(E=N,N=null):E=N.sibling;var R=m(y,N,S.value,A);if(R===null){N===null&&(N=E);break}t&&N&&R.alternate===null&&e(y,N),_=i(R,_,x),M===null?V=R:M.sibling=R,M=R,N=E}if(S.done)return n(y,N),et&&Bs(y,x),V;if(N===null){for(;!S.done;x++,S=b.next())S=p(y,S.value,A),S!==null&&(_=i(S,_,x),M===null?V=S:M.sibling=S,M=S);return et&&Bs(y,x),V}for(N=r(y,N);!S.done;x++,S=b.next())S=v(N,y,x,S.value,A),S!==null&&(t&&S.alternate!==null&&N.delete(S.key===null?x:S.key),_=i(S,_,x),M===null?V=S:M.sibling=S,M=S);return t&&N.forEach(function(P){return e(y,P)}),et&&Bs(y,x),V}function I(y,_,b,A){if(typeof b=="object"&&b!==null&&b.type===Ci&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case Vl:e:{for(var V=b.key,M=_;M!==null;){if(M.key===V){if(V=b.type,V===Ci){if(M.tag===7){n(y,M.sibling),_=s(M,b.props.children),_.return=y,y=_;break e}}else if(M.elementType===V||typeof V=="object"&&V!==null&&V.$$typeof===es&&cy(V)===M.type){n(y,M.sibling),_=s(M,b.props),_.ref=$a(y,M,b),_.return=y,y=_;break e}n(y,M);break}else e(y,M);M=M.sibling}b.type===Ci?(_=Qs(b.props.children,y.mode,A,b.key),_.return=y,y=_):(A=vc(b.type,b.key,b.props,null,y.mode,A),A.ref=$a(y,_,b),A.return=y,y=A)}return o(y);case ji:e:{for(M=b.key;_!==null;){if(_.key===M)if(_.tag===4&&_.stateNode.containerInfo===b.containerInfo&&_.stateNode.implementation===b.implementation){n(y,_.sibling),_=s(_,b.children||[]),_.return=y,y=_;break e}else{n(y,_);break}else e(y,_);_=_.sibling}_=Kd(b,y.mode,A),_.return=y,y=_}return o(y);case es:return M=b._init,I(y,_,M(b._payload),A)}if(Ya(b))return T(y,_,b,A);if(Ma(b))return j(y,_,b,A);Ql(y,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,_!==null&&_.tag===6?(n(y,_.sibling),_=s(_,b),_.return=y,y=_):(n(y,_),_=Gd(b,y.mode,A),_.return=y,y=_),o(y)):n(y,_)}return I}var ta=R0(!0),A0=R0(!1),Wc=Rs(null),qc=null,Vi=null,rm=null;function sm(){rm=Vi=qc=null}function im(t){var e=Wc.current;Ze(Wc),t._currentValue=e}function Bh(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Hi(t,e){qc=t,rm=Vi=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(fn=!0),t.firstContext=null)}function Mn(t){var e=t._currentValue;if(rm!==t)if(t={context:t,memoizedValue:e,next:null},Vi===null){if(qc===null)throw Error(K(308));Vi=t,qc.dependencies={lanes:0,firstContext:t}}else Vi=Vi.next=t;return e}var qs=null;function am(t){qs===null?qs=[t]:qs.push(t)}function P0(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,am(e)):(n.next=s.next,s.next=n),e.interleaved=n,Or(t,r)}function Or(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ts=!1;function om(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function D0(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Cr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function gs(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Re&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Or(t,n)}return s=r.interleaved,s===null?(e.next=e,am(r)):(e.next=s.next,s.next=e),r.interleaved=e,Or(t,n)}function fc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hf(t,n)}}function uy(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Hc(t,e,n,r){var s=t.updateQueue;ts=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var u=l,d=u.next;u.next=null,o===null?i=d:o.next=d,o=u;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=u))}if(i!==null){var p=s.baseState;o=0,h=d=u=null,l=i;do{var m=l.lane,v=l.eventTime;if((r&m)===m){h!==null&&(h=h.next={eventTime:v,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var T=t,j=l;switch(m=e,v=n,j.tag){case 1:if(T=j.payload,typeof T=="function"){p=T.call(v,p,m);break e}p=T;break e;case 3:T.flags=T.flags&-65537|128;case 0:if(T=j.payload,m=typeof T=="function"?T.call(v,p,m):T,m==null)break e;p=st({},p,m);break e;case 2:ts=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=s.effects,m===null?s.effects=[l]:m.push(l))}else v={eventTime:v,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=v,u=p):h=h.next=v,o|=m;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;m=l,l=m.next,m.next=null,s.lastBaseUpdate=m,s.shared.pending=null}}while(!0);if(h===null&&(u=p),s.baseState=u,s.firstBaseUpdate=d,s.lastBaseUpdate=h,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);ti|=o,t.lanes=o,t.memoizedState=p}}function dy(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(K(191,s));s.call(r)}}}var Zo={},ur=Rs(Zo),Po=Rs(Zo),Do=Rs(Zo);function Hs(t){if(t===Zo)throw Error(K(174));return t}function lm(t,e){switch(He(Do,e),He(Po,t),He(ur,Zo),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:_h(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=_h(e,t)}Ze(ur),He(ur,e)}function na(){Ze(ur),Ze(Po),Ze(Do)}function L0(t){Hs(Do.current);var e=Hs(ur.current),n=_h(e,t.type);e!==n&&(He(Po,t),He(ur,n))}function cm(t){Po.current===t&&(Ze(ur),Ze(Po))}var nt=Rs(0);function Gc(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Bd=[];function um(){for(var t=0;t<Bd.length;t++)Bd[t]._workInProgressVersionPrimary=null;Bd.length=0}var mc=zr.ReactCurrentDispatcher,$d=zr.ReactCurrentBatchConfig,ei=0,rt=null,bt=null,jt=null,Kc=!1,uo=!1,Lo=0,Qk=0;function Wt(){throw Error(K(321))}function dm(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Yn(t[n],e[n]))return!1;return!0}function hm(t,e,n,r,s,i){if(ei=i,rt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mc.current=t===null||t.memoizedState===null?Zk:eT,t=n(r,s),uo){i=0;do{if(uo=!1,Lo=0,25<=i)throw Error(K(301));i+=1,jt=bt=null,e.updateQueue=null,mc.current=tT,t=n(r,s)}while(uo)}if(mc.current=Qc,e=bt!==null&&bt.next!==null,ei=0,jt=bt=rt=null,Kc=!1,e)throw Error(K(300));return t}function fm(){var t=Lo!==0;return Lo=0,t}function ir(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return jt===null?rt.memoizedState=jt=t:jt=jt.next=t,jt}function Vn(){if(bt===null){var t=rt.alternate;t=t!==null?t.memoizedState:null}else t=bt.next;var e=jt===null?rt.memoizedState:jt.next;if(e!==null)jt=e,bt=t;else{if(t===null)throw Error(K(310));bt=t,t={memoizedState:bt.memoizedState,baseState:bt.baseState,baseQueue:bt.baseQueue,queue:bt.queue,next:null},jt===null?rt.memoizedState=jt=t:jt=jt.next=t}return jt}function Oo(t,e){return typeof e=="function"?e(t):e}function zd(t){var e=Vn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=bt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,u=null,d=i;do{var h=d.lane;if((ei&h)===h)u!==null&&(u=u.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),r=d.hasEagerState?d.eagerState:t(r,d.action);else{var p={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};u===null?(l=u=p,o=r):u=u.next=p,rt.lanes|=h,ti|=h}d=d.next}while(d!==null&&d!==i);u===null?o=r:u.next=l,Yn(r,e.memoizedState)||(fn=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,rt.lanes|=i,ti|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Wd(t){var e=Vn(),n=e.queue;if(n===null)throw Error(K(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Yn(i,e.memoizedState)||(fn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function O0(){}function M0(t,e){var n=rt,r=Vn(),s=e(),i=!Yn(r.memoizedState,s);if(i&&(r.memoizedState=s,fn=!0),r=r.queue,mm(U0.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||jt!==null&&jt.memoizedState.tag&1){if(n.flags|=2048,Mo(9,F0.bind(null,n,r,s,e),void 0,null),Ct===null)throw Error(K(349));ei&30||V0(n,e,s)}return s}function V0(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function F0(t,e,n,r){e.value=n,e.getSnapshot=r,B0(e)&&$0(t)}function U0(t,e,n){return n(function(){B0(e)&&$0(t)})}function B0(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Yn(t,n)}catch{return!0}}function $0(t){var e=Or(t,1);e!==null&&Qn(e,t,1,-1)}function hy(t){var e=ir();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oo,lastRenderedState:t},e.queue=t,t=t.dispatch=Xk.bind(null,rt,t),[e.memoizedState,t]}function Mo(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=rt.updateQueue,e===null?(e={lastEffect:null,stores:null},rt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function z0(){return Vn().memoizedState}function pc(t,e,n,r){var s=ir();rt.flags|=t,s.memoizedState=Mo(1|e,n,void 0,r===void 0?null:r)}function Tu(t,e,n,r){var s=Vn();r=r===void 0?null:r;var i=void 0;if(bt!==null){var o=bt.memoizedState;if(i=o.destroy,r!==null&&dm(r,o.deps)){s.memoizedState=Mo(e,n,i,r);return}}rt.flags|=t,s.memoizedState=Mo(1|e,n,i,r)}function fy(t,e){return pc(8390656,8,t,e)}function mm(t,e){return Tu(2048,8,t,e)}function W0(t,e){return Tu(4,2,t,e)}function q0(t,e){return Tu(4,4,t,e)}function H0(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function G0(t,e,n){return n=n!=null?n.concat([t]):null,Tu(4,4,H0.bind(null,e,t),n)}function pm(){}function K0(t,e){var n=Vn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dm(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Q0(t,e){var n=Vn();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&dm(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function Y0(t,e,n){return ei&21?(Yn(n,e)||(n=t0(),rt.lanes|=n,ti|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,fn=!0),t.memoizedState=n)}function Yk(t,e){var n=Fe;Fe=n!==0&&4>n?n:4,t(!0);var r=$d.transition;$d.transition={};try{t(!1),e()}finally{Fe=n,$d.transition=r}}function J0(){return Vn().memoizedState}function Jk(t,e,n){var r=xs(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},X0(t))Z0(e,n);else if(n=P0(t,e,n,r),n!==null){var s=tn();Qn(n,t,r,s),ew(n,e,r)}}function Xk(t,e,n){var r=xs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(X0(t))Z0(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Yn(l,o)){var u=e.interleaved;u===null?(s.next=s,am(e)):(s.next=u.next,u.next=s),e.interleaved=s;return}}catch{}finally{}n=P0(t,e,s,r),n!==null&&(s=tn(),Qn(n,t,r,s),ew(n,e,r))}}function X0(t){var e=t.alternate;return t===rt||e!==null&&e===rt}function Z0(t,e){uo=Kc=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function ew(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Hf(t,n)}}var Qc={readContext:Mn,useCallback:Wt,useContext:Wt,useEffect:Wt,useImperativeHandle:Wt,useInsertionEffect:Wt,useLayoutEffect:Wt,useMemo:Wt,useReducer:Wt,useRef:Wt,useState:Wt,useDebugValue:Wt,useDeferredValue:Wt,useTransition:Wt,useMutableSource:Wt,useSyncExternalStore:Wt,useId:Wt,unstable_isNewReconciler:!1},Zk={readContext:Mn,useCallback:function(t,e){return ir().memoizedState=[t,e===void 0?null:e],t},useContext:Mn,useEffect:fy,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,pc(4194308,4,H0.bind(null,e,t),n)},useLayoutEffect:function(t,e){return pc(4194308,4,t,e)},useInsertionEffect:function(t,e){return pc(4,2,t,e)},useMemo:function(t,e){var n=ir();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=ir();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=Jk.bind(null,rt,t),[r.memoizedState,t]},useRef:function(t){var e=ir();return t={current:t},e.memoizedState=t},useState:hy,useDebugValue:pm,useDeferredValue:function(t){return ir().memoizedState=t},useTransition:function(){var t=hy(!1),e=t[0];return t=Yk.bind(null,t[1]),ir().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=rt,s=ir();if(et){if(n===void 0)throw Error(K(407));n=n()}else{if(n=e(),Ct===null)throw Error(K(349));ei&30||V0(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,fy(U0.bind(null,r,i,t),[t]),r.flags|=2048,Mo(9,F0.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=ir(),e=Ct.identifierPrefix;if(et){var n=Tr,r=kr;n=(r&~(1<<32-Kn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Lo++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=Qk++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},eT={readContext:Mn,useCallback:K0,useContext:Mn,useEffect:mm,useImperativeHandle:G0,useInsertionEffect:W0,useLayoutEffect:q0,useMemo:Q0,useReducer:zd,useRef:z0,useState:function(){return zd(Oo)},useDebugValue:pm,useDeferredValue:function(t){var e=Vn();return Y0(e,bt.memoizedState,t)},useTransition:function(){var t=zd(Oo)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:O0,useSyncExternalStore:M0,useId:J0,unstable_isNewReconciler:!1},tT={readContext:Mn,useCallback:K0,useContext:Mn,useEffect:mm,useImperativeHandle:G0,useInsertionEffect:W0,useLayoutEffect:q0,useMemo:Q0,useReducer:Wd,useRef:z0,useState:function(){return Wd(Oo)},useDebugValue:pm,useDeferredValue:function(t){var e=Vn();return bt===null?e.memoizedState=t:Y0(e,bt.memoizedState,t)},useTransition:function(){var t=Wd(Oo)[0],e=Vn().memoizedState;return[t,e]},useMutableSource:O0,useSyncExternalStore:M0,useId:J0,unstable_isNewReconciler:!1};function qn(t,e){if(t&&t.defaultProps){e=st({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function $h(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:st({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Su={isMounted:function(t){return(t=t._reactInternals)?di(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=tn(),s=xs(t),i=Cr(r,s);i.payload=e,n!=null&&(i.callback=n),e=gs(t,i,s),e!==null&&(Qn(e,t,s,r),fc(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=tn(),s=xs(t),i=Cr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=gs(t,i,s),e!==null&&(Qn(e,t,s,r),fc(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=tn(),r=xs(t),s=Cr(n,r);s.tag=2,e!=null&&(s.callback=e),e=gs(t,s,r),e!==null&&(Qn(e,t,r,n),fc(e,t,r))}};function my(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!jo(n,r)||!jo(s,i):!0}function tw(t,e,n){var r=!1,s=Es,i=e.contextType;return typeof i=="object"&&i!==null?i=Mn(i):(s=pn(e)?Xs:Jt.current,r=e.contextTypes,i=(r=r!=null)?Zi(t,s):Es),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Su,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function py(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&Su.enqueueReplaceState(e,e.state,null)}function zh(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},om(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Mn(i):(i=pn(e)?Xs:Jt.current,s.context=Zi(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&($h(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&Su.enqueueReplaceState(s,s.state,null),Hc(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function ra(t,e){try{var n="",r=e;do n+=jE(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function qd(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function Wh(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var nT=typeof WeakMap=="function"?WeakMap:Map;function nw(t,e,n){n=Cr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Jc||(Jc=!0,ef=r),Wh(t,e)},n}function rw(t,e,n){n=Cr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){Wh(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){Wh(t,e),typeof r!="function"&&(ys===null?ys=new Set([this]):ys.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function gy(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new nT;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=gT.bind(null,t,e,n),e.then(t,t))}function yy(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function xy(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Cr(-1,1),e.tag=2,gs(n,e,1))),n.lanes|=1),t)}var rT=zr.ReactCurrentOwner,fn=!1;function en(t,e,n,r){e.child=t===null?A0(e,null,n,r):ta(e,t.child,n,r)}function vy(t,e,n,r,s){n=n.render;var i=e.ref;return Hi(e,s),r=hm(t,e,n,r,i,s),n=fm(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Mr(t,e,s)):(et&&n&&em(e),e.flags|=1,en(t,e,r,s),e.child)}function wy(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Nm(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,sw(t,e,i,r,s)):(t=vc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:jo,n(o,r)&&t.ref===e.ref)return Mr(t,e,s)}return e.flags|=1,t=vs(i,r),t.ref=e.ref,t.return=e,e.child=t}function sw(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(jo(i,r)&&t.ref===e.ref)if(fn=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(fn=!0);else return e.lanes=t.lanes,Mr(t,e,s)}return qh(t,e,n,r,s)}function iw(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},He(Ui,xn),xn|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,He(Ui,xn),xn|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,He(Ui,xn),xn|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,He(Ui,xn),xn|=r;return en(t,e,s,n),e.child}function aw(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function qh(t,e,n,r,s){var i=pn(n)?Xs:Jt.current;return i=Zi(e,i),Hi(e,s),n=hm(t,e,n,r,i,s),r=fm(),t!==null&&!fn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Mr(t,e,s)):(et&&r&&em(e),e.flags|=1,en(t,e,n,s),e.child)}function _y(t,e,n,r,s){if(pn(n)){var i=!0;Bc(e)}else i=!1;if(Hi(e,s),e.stateNode===null)gc(t,e),tw(e,n,r),zh(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var u=o.context,d=n.contextType;typeof d=="object"&&d!==null?d=Mn(d):(d=pn(n)?Xs:Jt.current,d=Zi(e,d));var h=n.getDerivedStateFromProps,p=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";p||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||u!==d)&&py(e,o,r,d),ts=!1;var m=e.memoizedState;o.state=m,Hc(e,r,o,s),u=e.memoizedState,l!==r||m!==u||mn.current||ts?(typeof h=="function"&&($h(e,n,h,r),u=e.memoizedState),(l=ts||my(e,n,l,r,m,u,d))?(p||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),o.props=r,o.state=u,o.context=d,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,D0(t,e),l=e.memoizedProps,d=e.type===e.elementType?l:qn(e.type,l),o.props=d,p=e.pendingProps,m=o.context,u=n.contextType,typeof u=="object"&&u!==null?u=Mn(u):(u=pn(n)?Xs:Jt.current,u=Zi(e,u));var v=n.getDerivedStateFromProps;(h=typeof v=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==p||m!==u)&&py(e,o,r,u),ts=!1,m=e.memoizedState,o.state=m,Hc(e,r,o,s);var T=e.memoizedState;l!==p||m!==T||mn.current||ts?(typeof v=="function"&&($h(e,n,v,r),T=e.memoizedState),(d=ts||my(e,n,d,r,m,T,u)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,T,u),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,T,u)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=T),o.props=r,o.state=T,o.context=u,r=d):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),r=!1)}return Hh(t,e,n,r,i,s)}function Hh(t,e,n,r,s,i){aw(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&ay(e,n,!1),Mr(t,e,i);r=e.stateNode,rT.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=ta(e,t.child,null,i),e.child=ta(e,null,l,i)):en(t,e,l,i),e.memoizedState=r.state,s&&ay(e,n,!0),e.child}function ow(t){var e=t.stateNode;e.pendingContext?iy(t,e.pendingContext,e.pendingContext!==e.context):e.context&&iy(t,e.context,!1),lm(t,e.containerInfo)}function by(t,e,n,r,s){return ea(),nm(s),e.flags|=256,en(t,e,n,r),e.child}var Gh={dehydrated:null,treeContext:null,retryLane:0};function Kh(t){return{baseLanes:t,cachePool:null,transitions:null}}function lw(t,e,n){var r=e.pendingProps,s=nt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),He(nt,s&1),t===null)return Uh(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Cu(o,r,0,null),t=Qs(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Kh(n),e.memoizedState=Gh,t):gm(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return sT(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var u={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=u,e.deletions=null):(r=vs(s,u),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=vs(l,i):(i=Qs(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?Kh(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=Gh,r}return i=t.child,t=i.sibling,r=vs(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function gm(t,e){return e=Cu({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Yl(t,e,n,r){return r!==null&&nm(r),ta(e,t.child,null,n),t=gm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function sT(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=qd(Error(K(422))),Yl(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Cu({mode:"visible",children:r.children},s,0,null),i=Qs(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&ta(e,t.child,null,o),e.child.memoizedState=Kh(o),e.memoizedState=Gh,i);if(!(e.mode&1))return Yl(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(K(419)),r=qd(i,r,void 0),Yl(t,e,o,r)}if(l=(o&t.childLanes)!==0,fn||l){if(r=Ct,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Or(t,s),Qn(r,t,s,-1))}return bm(),r=qd(Error(K(421))),Yl(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=yT.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,vn=ps(s.nextSibling),Nn=e,et=!0,Gn=null,t!==null&&(An[Pn++]=kr,An[Pn++]=Tr,An[Pn++]=Zs,kr=t.id,Tr=t.overflow,Zs=e),e=gm(e,r.children),e.flags|=4096,e)}function Ny(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),Bh(t.return,e,n)}function Hd(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function cw(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(en(t,e,r.children,n),r=nt.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Ny(t,n,e);else if(t.tag===19)Ny(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(He(nt,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Gc(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Hd(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Gc(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Hd(e,!0,n,null,i);break;case"together":Hd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Mr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),ti|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(K(153));if(e.child!==null){for(t=e.child,n=vs(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=vs(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function iT(t,e,n){switch(e.tag){case 3:ow(e),ea();break;case 5:L0(e);break;case 1:pn(e.type)&&Bc(e);break;case 4:lm(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;He(Wc,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(He(nt,nt.current&1),e.flags|=128,null):n&e.child.childLanes?lw(t,e,n):(He(nt,nt.current&1),t=Mr(t,e,n),t!==null?t.sibling:null);He(nt,nt.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return cw(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),He(nt,nt.current),r)break;return null;case 22:case 23:return e.lanes=0,iw(t,e,n)}return Mr(t,e,n)}var uw,Qh,dw,hw;uw=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Qh=function(){};dw=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Hs(ur.current);var i=null;switch(n){case"input":s=yh(t,s),r=yh(t,r),i=[];break;case"select":s=st({},s,{value:void 0}),r=st({},r,{value:void 0}),i=[];break;case"textarea":s=wh(t,s),r=wh(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Fc)}bh(n,r);var o;n=null;for(d in s)if(!r.hasOwnProperty(d)&&s.hasOwnProperty(d)&&s[d]!=null)if(d==="style"){var l=s[d];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(bo.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in r){var u=r[d];if(l=s!=null?s[d]:void 0,r.hasOwnProperty(d)&&u!==l&&(u!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||u&&u.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in u)u.hasOwnProperty(o)&&l[o]!==u[o]&&(n||(n={}),n[o]=u[o])}else n||(i||(i=[]),i.push(d,n)),n=u;else d==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,l=l?l.__html:void 0,u!=null&&l!==u&&(i=i||[]).push(d,u)):d==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(d,""+u):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(bo.hasOwnProperty(d)?(u!=null&&d==="onScroll"&&Ye("scroll",t),i||l===u||(i=[])):(i=i||[]).push(d,u))}n&&(i=i||[]).push("style",n);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};hw=function(t,e,n,r){n!==r&&(e.flags|=4)};function za(t,e){if(!et)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function qt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function aT(t,e,n){var r=e.pendingProps;switch(tm(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qt(e),null;case 1:return pn(e.type)&&Uc(),qt(e),null;case 3:return r=e.stateNode,na(),Ze(mn),Ze(Jt),um(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Kl(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Gn!==null&&(rf(Gn),Gn=null))),Qh(t,e),qt(e),null;case 5:cm(e);var s=Hs(Do.current);if(n=e.type,t!==null&&e.stateNode!=null)dw(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(K(166));return qt(e),null}if(t=Hs(ur.current),Kl(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ar]=e,r[Ao]=i,t=(e.mode&1)!==0,n){case"dialog":Ye("cancel",r),Ye("close",r);break;case"iframe":case"object":case"embed":Ye("load",r);break;case"video":case"audio":for(s=0;s<Xa.length;s++)Ye(Xa[s],r);break;case"source":Ye("error",r);break;case"img":case"image":case"link":Ye("error",r),Ye("load",r);break;case"details":Ye("toggle",r);break;case"input":Ag(r,i),Ye("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ye("invalid",r);break;case"textarea":Dg(r,i),Ye("invalid",r)}bh(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Gl(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Gl(r.textContent,l,t),s=["children",""+l]):bo.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Ye("scroll",r)}switch(n){case"input":Fl(r),Pg(r,i,!0);break;case"textarea":Fl(r),Lg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Fc)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=Uv(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ar]=e,t[Ao]=r,uw(t,e,!1,!1),e.stateNode=t;e:{switch(o=Nh(n,r),n){case"dialog":Ye("cancel",t),Ye("close",t),s=r;break;case"iframe":case"object":case"embed":Ye("load",t),s=r;break;case"video":case"audio":for(s=0;s<Xa.length;s++)Ye(Xa[s],t);s=r;break;case"source":Ye("error",t),s=r;break;case"img":case"image":case"link":Ye("error",t),Ye("load",t),s=r;break;case"details":Ye("toggle",t),s=r;break;case"input":Ag(t,r),s=yh(t,r),Ye("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=st({},r,{value:void 0}),Ye("invalid",t);break;case"textarea":Dg(t,r),s=wh(t,r),Ye("invalid",t);break;default:s=r}bh(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var u=l[i];i==="style"?zv(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&Bv(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&No(t,u):typeof u=="number"&&No(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(bo.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Ye("scroll",t):u!=null&&Uf(t,i,u,o))}switch(n){case"input":Fl(t),Pg(t,r,!1);break;case"textarea":Fl(t),Lg(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ns(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?$i(t,!!r.multiple,i,!1):r.defaultValue!=null&&$i(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Fc)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return qt(e),null;case 6:if(t&&e.stateNode!=null)hw(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(K(166));if(n=Hs(Do.current),Hs(ur.current),Kl(e)){if(r=e.stateNode,n=e.memoizedProps,r[ar]=e,(i=r.nodeValue!==n)&&(t=Nn,t!==null))switch(t.tag){case 3:Gl(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Gl(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ar]=e,e.stateNode=r}return qt(e),null;case 13:if(Ze(nt),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(et&&vn!==null&&e.mode&1&&!(e.flags&128))C0(),ea(),e.flags|=98560,i=!1;else if(i=Kl(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(K(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(K(317));i[ar]=e}else ea(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;qt(e),i=!1}else Gn!==null&&(rf(Gn),Gn=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||nt.current&1?Nt===0&&(Nt=3):bm())),e.updateQueue!==null&&(e.flags|=4),qt(e),null);case 4:return na(),Qh(t,e),t===null&&Co(e.stateNode.containerInfo),qt(e),null;case 10:return im(e.type._context),qt(e),null;case 17:return pn(e.type)&&Uc(),qt(e),null;case 19:if(Ze(nt),i=e.memoizedState,i===null)return qt(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)za(i,!1);else{if(Nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Gc(t),o!==null){for(e.flags|=128,za(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return He(nt,nt.current&1|2),e.child}t=t.sibling}i.tail!==null&&mt()>sa&&(e.flags|=128,r=!0,za(i,!1),e.lanes=4194304)}else{if(!r)if(t=Gc(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),za(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!et)return qt(e),null}else 2*mt()-i.renderingStartTime>sa&&n!==1073741824&&(e.flags|=128,r=!0,za(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=mt(),e.sibling=null,n=nt.current,He(nt,r?n&1|2:n&1),e):(qt(e),null);case 22:case 23:return _m(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?xn&1073741824&&(qt(e),e.subtreeFlags&6&&(e.flags|=8192)):qt(e),null;case 24:return null;case 25:return null}throw Error(K(156,e.tag))}function oT(t,e){switch(tm(e),e.tag){case 1:return pn(e.type)&&Uc(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return na(),Ze(mn),Ze(Jt),um(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return cm(e),null;case 13:if(Ze(nt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(K(340));ea()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ze(nt),null;case 4:return na(),null;case 10:return im(e.type._context),null;case 22:case 23:return _m(),null;case 24:return null;default:return null}}var Jl=!1,Kt=!1,lT=typeof WeakSet=="function"?WeakSet:Set,Z=null;function Fi(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){lt(t,e,r)}else n.current=null}function Yh(t,e,n){try{n()}catch(r){lt(t,e,r)}}var Ey=!1;function cT(t,e){if(Ph=Oc,t=y0(),Zf(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,u=-1,d=0,h=0,p=t,m=null;t:for(;;){for(var v;p!==n||s!==0&&p.nodeType!==3||(l=o+s),p!==i||r!==0&&p.nodeType!==3||(u=o+r),p.nodeType===3&&(o+=p.nodeValue.length),(v=p.firstChild)!==null;)m=p,p=v;for(;;){if(p===t)break t;if(m===n&&++d===s&&(l=o),m===i&&++h===r&&(u=o),(v=p.nextSibling)!==null)break;p=m,m=p.parentNode}p=v}n=l===-1||u===-1?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(Dh={focusedElem:t,selectionRange:n},Oc=!1,Z=e;Z!==null;)if(e=Z,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,Z=t;else for(;Z!==null;){e=Z;try{var T=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(T!==null){var j=T.memoizedProps,I=T.memoizedState,y=e.stateNode,_=y.getSnapshotBeforeUpdate(e.elementType===e.type?j:qn(e.type,j),I);y.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(K(163))}}catch(A){lt(e,e.return,A)}if(t=e.sibling,t!==null){t.return=e.return,Z=t;break}Z=e.return}return T=Ey,Ey=!1,T}function ho(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&Yh(e,n,i)}s=s.next}while(s!==r)}}function Iu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Jh(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function fw(t){var e=t.alternate;e!==null&&(t.alternate=null,fw(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ar],delete e[Ao],delete e[Mh],delete e[qk],delete e[Hk])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function mw(t){return t.tag===5||t.tag===3||t.tag===4}function ky(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||mw(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Xh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Fc));else if(r!==4&&(t=t.child,t!==null))for(Xh(t,e,n),t=t.sibling;t!==null;)Xh(t,e,n),t=t.sibling}function Zh(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Zh(t,e,n),t=t.sibling;t!==null;)Zh(t,e,n),t=t.sibling}var Dt=null,Hn=!1;function Xr(t,e,n){for(n=n.child;n!==null;)pw(t,e,n),n=n.sibling}function pw(t,e,n){if(cr&&typeof cr.onCommitFiberUnmount=="function")try{cr.onCommitFiberUnmount(wu,n)}catch{}switch(n.tag){case 5:Kt||Fi(n,e);case 6:var r=Dt,s=Hn;Dt=null,Xr(t,e,n),Dt=r,Hn=s,Dt!==null&&(Hn?(t=Dt,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Dt.removeChild(n.stateNode));break;case 18:Dt!==null&&(Hn?(t=Dt,n=n.stateNode,t.nodeType===8?Fd(t.parentNode,n):t.nodeType===1&&Fd(t,n),So(t)):Fd(Dt,n.stateNode));break;case 4:r=Dt,s=Hn,Dt=n.stateNode.containerInfo,Hn=!0,Xr(t,e,n),Dt=r,Hn=s;break;case 0:case 11:case 14:case 15:if(!Kt&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Yh(n,e,o),s=s.next}while(s!==r)}Xr(t,e,n);break;case 1:if(!Kt&&(Fi(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){lt(n,e,l)}Xr(t,e,n);break;case 21:Xr(t,e,n);break;case 22:n.mode&1?(Kt=(r=Kt)||n.memoizedState!==null,Xr(t,e,n),Kt=r):Xr(t,e,n);break;default:Xr(t,e,n)}}function Ty(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new lT),e.forEach(function(r){var s=xT.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Wn(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Dt=l.stateNode,Hn=!1;break e;case 3:Dt=l.stateNode.containerInfo,Hn=!0;break e;case 4:Dt=l.stateNode.containerInfo,Hn=!0;break e}l=l.return}if(Dt===null)throw Error(K(160));pw(i,o,s),Dt=null,Hn=!1;var u=s.alternate;u!==null&&(u.return=null),s.return=null}catch(d){lt(s,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)gw(e,t),e=e.sibling}function gw(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Wn(e,t),sr(t),r&4){try{ho(3,t,t.return),Iu(3,t)}catch(j){lt(t,t.return,j)}try{ho(5,t,t.return)}catch(j){lt(t,t.return,j)}}break;case 1:Wn(e,t),sr(t),r&512&&n!==null&&Fi(n,n.return);break;case 5:if(Wn(e,t),sr(t),r&512&&n!==null&&Fi(n,n.return),t.flags&32){var s=t.stateNode;try{No(s,"")}catch(j){lt(t,t.return,j)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&Vv(s,i),Nh(l,o);var d=Nh(l,i);for(o=0;o<u.length;o+=2){var h=u[o],p=u[o+1];h==="style"?zv(s,p):h==="dangerouslySetInnerHTML"?Bv(s,p):h==="children"?No(s,p):Uf(s,h,p,d)}switch(l){case"input":xh(s,i);break;case"textarea":Fv(s,i);break;case"select":var m=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var v=i.value;v!=null?$i(s,!!i.multiple,v,!1):m!==!!i.multiple&&(i.defaultValue!=null?$i(s,!!i.multiple,i.defaultValue,!0):$i(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ao]=i}catch(j){lt(t,t.return,j)}}break;case 6:if(Wn(e,t),sr(t),r&4){if(t.stateNode===null)throw Error(K(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(j){lt(t,t.return,j)}}break;case 3:if(Wn(e,t),sr(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{So(e.containerInfo)}catch(j){lt(t,t.return,j)}break;case 4:Wn(e,t),sr(t);break;case 13:Wn(e,t),sr(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(vm=mt())),r&4&&Ty(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(Kt=(d=Kt)||h,Wn(e,t),Kt=d):Wn(e,t),sr(t),r&8192){if(d=t.memoizedState!==null,(t.stateNode.isHidden=d)&&!h&&t.mode&1)for(Z=t,h=t.child;h!==null;){for(p=Z=h;Z!==null;){switch(m=Z,v=m.child,m.tag){case 0:case 11:case 14:case 15:ho(4,m,m.return);break;case 1:Fi(m,m.return);var T=m.stateNode;if(typeof T.componentWillUnmount=="function"){r=m,n=m.return;try{e=r,T.props=e.memoizedProps,T.state=e.memoizedState,T.componentWillUnmount()}catch(j){lt(r,n,j)}}break;case 5:Fi(m,m.return);break;case 22:if(m.memoizedState!==null){Iy(p);continue}}v!==null?(v.return=m,Z=v):Iy(p)}h=h.sibling}e:for(h=null,p=t;;){if(p.tag===5){if(h===null){h=p;try{s=p.stateNode,d?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=p.stateNode,u=p.memoizedProps.style,o=u!=null&&u.hasOwnProperty("display")?u.display:null,l.style.display=$v("display",o))}catch(j){lt(t,t.return,j)}}}else if(p.tag===6){if(h===null)try{p.stateNode.nodeValue=d?"":p.memoizedProps}catch(j){lt(t,t.return,j)}}else if((p.tag!==22&&p.tag!==23||p.memoizedState===null||p===t)&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===t)break e;for(;p.sibling===null;){if(p.return===null||p.return===t)break e;h===p&&(h=null),p=p.return}h===p&&(h=null),p.sibling.return=p.return,p=p.sibling}}break;case 19:Wn(e,t),sr(t),r&4&&Ty(t);break;case 21:break;default:Wn(e,t),sr(t)}}function sr(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(mw(n)){var r=n;break e}n=n.return}throw Error(K(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(No(s,""),r.flags&=-33);var i=ky(t);Zh(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=ky(t);Xh(t,l,o);break;default:throw Error(K(161))}}catch(u){lt(t,t.return,u)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function uT(t,e,n){Z=t,yw(t)}function yw(t,e,n){for(var r=(t.mode&1)!==0;Z!==null;){var s=Z,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Jl;if(!o){var l=s.alternate,u=l!==null&&l.memoizedState!==null||Kt;l=Jl;var d=Kt;if(Jl=o,(Kt=u)&&!d)for(Z=s;Z!==null;)o=Z,u=o.child,o.tag===22&&o.memoizedState!==null?jy(s):u!==null?(u.return=o,Z=u):jy(s);for(;i!==null;)Z=i,yw(i),i=i.sibling;Z=s,Jl=l,Kt=d}Sy(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,Z=i):Sy(t)}}function Sy(t){for(;Z!==null;){var e=Z;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Kt||Iu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Kt)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:qn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&dy(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}dy(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var p=h.dehydrated;p!==null&&So(p)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(K(163))}Kt||e.flags&512&&Jh(e)}catch(m){lt(e,e.return,m)}}if(e===t){Z=null;break}if(n=e.sibling,n!==null){n.return=e.return,Z=n;break}Z=e.return}}function Iy(t){for(;Z!==null;){var e=Z;if(e===t){Z=null;break}var n=e.sibling;if(n!==null){n.return=e.return,Z=n;break}Z=e.return}}function jy(t){for(;Z!==null;){var e=Z;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Iu(4,e)}catch(u){lt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){lt(e,s,u)}}var i=e.return;try{Jh(e)}catch(u){lt(e,i,u)}break;case 5:var o=e.return;try{Jh(e)}catch(u){lt(e,o,u)}}}catch(u){lt(e,e.return,u)}if(e===t){Z=null;break}var l=e.sibling;if(l!==null){l.return=e.return,Z=l;break}Z=e.return}}var dT=Math.ceil,Yc=zr.ReactCurrentDispatcher,ym=zr.ReactCurrentOwner,On=zr.ReactCurrentBatchConfig,Re=0,Ct=null,vt=null,Mt=0,xn=0,Ui=Rs(0),Nt=0,Vo=null,ti=0,ju=0,xm=0,fo=null,un=null,vm=0,sa=1/0,Nr=null,Jc=!1,ef=null,ys=null,Xl=!1,us=null,Xc=0,mo=0,tf=null,yc=-1,xc=0;function tn(){return Re&6?mt():yc!==-1?yc:yc=mt()}function xs(t){return t.mode&1?Re&2&&Mt!==0?Mt&-Mt:Kk.transition!==null?(xc===0&&(xc=t0()),xc):(t=Fe,t!==0||(t=window.event,t=t===void 0?16:l0(t.type)),t):1}function Qn(t,e,n,r){if(50<mo)throw mo=0,tf=null,Error(K(185));Yo(t,n,r),(!(Re&2)||t!==Ct)&&(t===Ct&&(!(Re&2)&&(ju|=n),Nt===4&&rs(t,Mt)),gn(t,r),n===1&&Re===0&&!(e.mode&1)&&(sa=mt()+500,ku&&As()))}function gn(t,e){var n=t.callbackNode;KE(t,e);var r=Lc(t,t===Ct?Mt:0);if(r===0)n!==null&&Vg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Vg(n),e===1)t.tag===0?Gk(Cy.bind(null,t)):S0(Cy.bind(null,t)),zk(function(){!(Re&6)&&As()}),n=null;else{switch(n0(r)){case 1:n=qf;break;case 4:n=Zv;break;case 16:n=Dc;break;case 536870912:n=e0;break;default:n=Dc}n=kw(n,xw.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function xw(t,e){if(yc=-1,xc=0,Re&6)throw Error(K(327));var n=t.callbackNode;if(Gi()&&t.callbackNode!==n)return null;var r=Lc(t,t===Ct?Mt:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Zc(t,r);else{e=r;var s=Re;Re|=2;var i=ww();(Ct!==t||Mt!==e)&&(Nr=null,sa=mt()+500,Ks(t,e));do try{mT();break}catch(l){vw(t,l)}while(!0);sm(),Yc.current=i,Re=s,vt!==null?e=0:(Ct=null,Mt=0,e=Nt)}if(e!==0){if(e===2&&(s=Ih(t),s!==0&&(r=s,e=nf(t,s))),e===1)throw n=Vo,Ks(t,0),rs(t,r),gn(t,mt()),n;if(e===6)rs(t,r);else{if(s=t.current.alternate,!(r&30)&&!hT(s)&&(e=Zc(t,r),e===2&&(i=Ih(t),i!==0&&(r=i,e=nf(t,i))),e===1))throw n=Vo,Ks(t,0),rs(t,r),gn(t,mt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(K(345));case 2:$s(t,un,Nr);break;case 3:if(rs(t,r),(r&130023424)===r&&(e=vm+500-mt(),10<e)){if(Lc(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){tn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Oh($s.bind(null,t,un,Nr),e);break}$s(t,un,Nr);break;case 4:if(rs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Kn(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=mt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*dT(r/1960))-r,10<r){t.timeoutHandle=Oh($s.bind(null,t,un,Nr),r);break}$s(t,un,Nr);break;case 5:$s(t,un,Nr);break;default:throw Error(K(329))}}}return gn(t,mt()),t.callbackNode===n?xw.bind(null,t):null}function nf(t,e){var n=fo;return t.current.memoizedState.isDehydrated&&(Ks(t,e).flags|=256),t=Zc(t,e),t!==2&&(e=un,un=n,e!==null&&rf(e)),t}function rf(t){un===null?un=t:un.push.apply(un,t)}function hT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Yn(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function rs(t,e){for(e&=~xm,e&=~ju,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Kn(e),r=1<<n;t[n]=-1,e&=~r}}function Cy(t){if(Re&6)throw Error(K(327));Gi();var e=Lc(t,0);if(!(e&1))return gn(t,mt()),null;var n=Zc(t,e);if(t.tag!==0&&n===2){var r=Ih(t);r!==0&&(e=r,n=nf(t,r))}if(n===1)throw n=Vo,Ks(t,0),rs(t,e),gn(t,mt()),n;if(n===6)throw Error(K(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$s(t,un,Nr),gn(t,mt()),null}function wm(t,e){var n=Re;Re|=1;try{return t(e)}finally{Re=n,Re===0&&(sa=mt()+500,ku&&As())}}function ni(t){us!==null&&us.tag===0&&!(Re&6)&&Gi();var e=Re;Re|=1;var n=On.transition,r=Fe;try{if(On.transition=null,Fe=1,t)return t()}finally{Fe=r,On.transition=n,Re=e,!(Re&6)&&As()}}function _m(){xn=Ui.current,Ze(Ui)}function Ks(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,$k(n)),vt!==null)for(n=vt.return;n!==null;){var r=n;switch(tm(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Uc();break;case 3:na(),Ze(mn),Ze(Jt),um();break;case 5:cm(r);break;case 4:na();break;case 13:Ze(nt);break;case 19:Ze(nt);break;case 10:im(r.type._context);break;case 22:case 23:_m()}n=n.return}if(Ct=t,vt=t=vs(t.current,null),Mt=xn=e,Nt=0,Vo=null,xm=ju=ti=0,un=fo=null,qs!==null){for(e=0;e<qs.length;e++)if(n=qs[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}qs=null}return t}function vw(t,e){do{var n=vt;try{if(sm(),mc.current=Qc,Kc){for(var r=rt.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Kc=!1}if(ei=0,jt=bt=rt=null,uo=!1,Lo=0,ym.current=null,n===null||n.return===null){Nt=1,Vo=e,vt=null;break}e:{var i=t,o=n.return,l=n,u=e;if(e=Mt,l.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var d=u,h=l,p=h.tag;if(!(h.mode&1)&&(p===0||p===11||p===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var v=yy(o);if(v!==null){v.flags&=-257,xy(v,o,l,i,e),v.mode&1&&gy(i,d,e),e=v,u=d;var T=e.updateQueue;if(T===null){var j=new Set;j.add(u),e.updateQueue=j}else T.add(u);break e}else{if(!(e&1)){gy(i,d,e),bm();break e}u=Error(K(426))}}else if(et&&l.mode&1){var I=yy(o);if(I!==null){!(I.flags&65536)&&(I.flags|=256),xy(I,o,l,i,e),nm(ra(u,l));break e}}i=u=ra(u,l),Nt!==4&&(Nt=2),fo===null?fo=[i]:fo.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=nw(i,u,e);uy(i,y);break e;case 1:l=u;var _=i.type,b=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ys===null||!ys.has(b)))){i.flags|=65536,e&=-e,i.lanes|=e;var A=rw(i,l,e);uy(i,A);break e}}i=i.return}while(i!==null)}bw(n)}catch(V){e=V,vt===n&&n!==null&&(vt=n=n.return);continue}break}while(!0)}function ww(){var t=Yc.current;return Yc.current=Qc,t===null?Qc:t}function bm(){(Nt===0||Nt===3||Nt===2)&&(Nt=4),Ct===null||!(ti&268435455)&&!(ju&268435455)||rs(Ct,Mt)}function Zc(t,e){var n=Re;Re|=2;var r=ww();(Ct!==t||Mt!==e)&&(Nr=null,Ks(t,e));do try{fT();break}catch(s){vw(t,s)}while(!0);if(sm(),Re=n,Yc.current=r,vt!==null)throw Error(K(261));return Ct=null,Mt=0,Nt}function fT(){for(;vt!==null;)_w(vt)}function mT(){for(;vt!==null&&!FE();)_w(vt)}function _w(t){var e=Ew(t.alternate,t,xn);t.memoizedProps=t.pendingProps,e===null?bw(t):vt=e,ym.current=null}function bw(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=oT(n,e),n!==null){n.flags&=32767,vt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nt=6,vt=null;return}}else if(n=aT(n,e,xn),n!==null){vt=n;return}if(e=e.sibling,e!==null){vt=e;return}vt=e=t}while(e!==null);Nt===0&&(Nt=5)}function $s(t,e,n){var r=Fe,s=On.transition;try{On.transition=null,Fe=1,pT(t,e,n,r)}finally{On.transition=s,Fe=r}return null}function pT(t,e,n,r){do Gi();while(us!==null);if(Re&6)throw Error(K(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(K(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(QE(t,i),t===Ct&&(vt=Ct=null,Mt=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Xl||(Xl=!0,kw(Dc,function(){return Gi(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=On.transition,On.transition=null;var o=Fe;Fe=1;var l=Re;Re|=4,ym.current=null,cT(t,n),gw(n,t),Lk(Dh),Oc=!!Ph,Dh=Ph=null,t.current=n,uT(n),UE(),Re=l,Fe=o,On.transition=i}else t.current=n;if(Xl&&(Xl=!1,us=t,Xc=s),i=t.pendingLanes,i===0&&(ys=null),zE(n.stateNode),gn(t,mt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Jc)throw Jc=!1,t=ef,ef=null,t;return Xc&1&&t.tag!==0&&Gi(),i=t.pendingLanes,i&1?t===tf?mo++:(mo=0,tf=t):mo=0,As(),null}function Gi(){if(us!==null){var t=n0(Xc),e=On.transition,n=Fe;try{if(On.transition=null,Fe=16>t?16:t,us===null)var r=!1;else{if(t=us,us=null,Xc=0,Re&6)throw Error(K(331));var s=Re;for(Re|=4,Z=t.current;Z!==null;){var i=Z,o=i.child;if(Z.flags&16){var l=i.deletions;if(l!==null){for(var u=0;u<l.length;u++){var d=l[u];for(Z=d;Z!==null;){var h=Z;switch(h.tag){case 0:case 11:case 15:ho(8,h,i)}var p=h.child;if(p!==null)p.return=h,Z=p;else for(;Z!==null;){h=Z;var m=h.sibling,v=h.return;if(fw(h),h===d){Z=null;break}if(m!==null){m.return=v,Z=m;break}Z=v}}}var T=i.alternate;if(T!==null){var j=T.child;if(j!==null){T.child=null;do{var I=j.sibling;j.sibling=null,j=I}while(j!==null)}}Z=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,Z=o;else e:for(;Z!==null;){if(i=Z,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ho(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,Z=y;break e}Z=i.return}}var _=t.current;for(Z=_;Z!==null;){o=Z;var b=o.child;if(o.subtreeFlags&2064&&b!==null)b.return=o,Z=b;else e:for(o=_;Z!==null;){if(l=Z,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Iu(9,l)}}catch(V){lt(l,l.return,V)}if(l===o){Z=null;break e}var A=l.sibling;if(A!==null){A.return=l.return,Z=A;break e}Z=l.return}}if(Re=s,As(),cr&&typeof cr.onPostCommitFiberRoot=="function")try{cr.onPostCommitFiberRoot(wu,t)}catch{}r=!0}return r}finally{Fe=n,On.transition=e}}return!1}function Ry(t,e,n){e=ra(n,e),e=nw(t,e,1),t=gs(t,e,1),e=tn(),t!==null&&(Yo(t,1,e),gn(t,e))}function lt(t,e,n){if(t.tag===3)Ry(t,t,n);else for(;e!==null;){if(e.tag===3){Ry(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ys===null||!ys.has(r))){t=ra(n,t),t=rw(e,t,1),e=gs(e,t,1),t=tn(),e!==null&&(Yo(e,1,t),gn(e,t));break}}e=e.return}}function gT(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=tn(),t.pingedLanes|=t.suspendedLanes&n,Ct===t&&(Mt&n)===n&&(Nt===4||Nt===3&&(Mt&130023424)===Mt&&500>mt()-vm?Ks(t,0):xm|=n),gn(t,e)}function Nw(t,e){e===0&&(t.mode&1?(e=$l,$l<<=1,!($l&130023424)&&($l=4194304)):e=1);var n=tn();t=Or(t,e),t!==null&&(Yo(t,e,n),gn(t,n))}function yT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),Nw(t,n)}function xT(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(K(314))}r!==null&&r.delete(e),Nw(t,n)}var Ew;Ew=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mn.current)fn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return fn=!1,iT(t,e,n);fn=!!(t.flags&131072)}else fn=!1,et&&e.flags&1048576&&I0(e,zc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;gc(t,e),t=e.pendingProps;var s=Zi(e,Jt.current);Hi(e,n),s=hm(null,e,r,t,s,n);var i=fm();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,pn(r)?(i=!0,Bc(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,om(e),s.updater=Su,e.stateNode=s,s._reactInternals=e,zh(e,r,t,n),e=Hh(null,e,r,!0,i,n)):(e.tag=0,et&&i&&em(e),en(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(gc(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=wT(r),t=qn(r,t),s){case 0:e=qh(null,e,r,t,n);break e;case 1:e=_y(null,e,r,t,n);break e;case 11:e=vy(null,e,r,t,n);break e;case 14:e=wy(null,e,r,qn(r.type,t),n);break e}throw Error(K(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),qh(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),_y(t,e,r,s,n);case 3:e:{if(ow(e),t===null)throw Error(K(387));r=e.pendingProps,i=e.memoizedState,s=i.element,D0(t,e),Hc(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=ra(Error(K(423)),e),e=by(t,e,r,n,s);break e}else if(r!==s){s=ra(Error(K(424)),e),e=by(t,e,r,n,s);break e}else for(vn=ps(e.stateNode.containerInfo.firstChild),Nn=e,et=!0,Gn=null,n=A0(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ea(),r===s){e=Mr(t,e,n);break e}en(t,e,r,n)}e=e.child}return e;case 5:return L0(e),t===null&&Uh(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Lh(r,s)?o=null:i!==null&&Lh(r,i)&&(e.flags|=32),aw(t,e),en(t,e,o,n),e.child;case 6:return t===null&&Uh(e),null;case 13:return lw(t,e,n);case 4:return lm(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=ta(e,null,r,n):en(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),vy(t,e,r,s,n);case 7:return en(t,e,e.pendingProps,n),e.child;case 8:return en(t,e,e.pendingProps.children,n),e.child;case 12:return en(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,He(Wc,r._currentValue),r._currentValue=o,i!==null)if(Yn(i.value,o)){if(i.children===s.children&&!mn.current){e=Mr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var u=l.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Cr(-1,n&-n),u.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?u.next=u:(u.next=h.next,h.next=u),d.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),Bh(i.return,n,e),l.lanes|=n;break}u=u.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(K(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),Bh(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}en(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Hi(e,n),s=Mn(s),r=r(s),e.flags|=1,en(t,e,r,n),e.child;case 14:return r=e.type,s=qn(r,e.pendingProps),s=qn(r.type,s),wy(t,e,r,s,n);case 15:return sw(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:qn(r,s),gc(t,e),e.tag=1,pn(r)?(t=!0,Bc(e)):t=!1,Hi(e,n),tw(e,r,s),zh(e,r,s,n),Hh(null,e,r,!0,t,n);case 19:return cw(t,e,n);case 22:return iw(t,e,n)}throw Error(K(156,e.tag))};function kw(t,e){return Xv(t,e)}function vT(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ln(t,e,n,r){return new vT(t,e,n,r)}function Nm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function wT(t){if(typeof t=="function")return Nm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===$f)return 11;if(t===zf)return 14}return 2}function vs(t,e){var n=t.alternate;return n===null?(n=Ln(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function vc(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Nm(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Ci:return Qs(n.children,s,i,e);case Bf:o=8,s|=8;break;case fh:return t=Ln(12,n,e,s|2),t.elementType=fh,t.lanes=i,t;case mh:return t=Ln(13,n,e,s),t.elementType=mh,t.lanes=i,t;case ph:return t=Ln(19,n,e,s),t.elementType=ph,t.lanes=i,t;case Lv:return Cu(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case Pv:o=10;break e;case Dv:o=9;break e;case $f:o=11;break e;case zf:o=14;break e;case es:o=16,r=null;break e}throw Error(K(130,t==null?t:typeof t,""))}return e=Ln(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Qs(t,e,n,r){return t=Ln(7,t,r,e),t.lanes=n,t}function Cu(t,e,n,r){return t=Ln(22,t,r,e),t.elementType=Lv,t.lanes=n,t.stateNode={isHidden:!1},t}function Gd(t,e,n){return t=Ln(6,t,null,e),t.lanes=n,t}function Kd(t,e,n){return e=Ln(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function _T(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Id(0),this.expirationTimes=Id(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Id(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function Em(t,e,n,r,s,i,o,l,u){return t=new _T(t,e,n,l,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ln(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},om(i),t}function bT(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ji,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function Tw(t){if(!t)return Es;t=t._reactInternals;e:{if(di(t)!==t||t.tag!==1)throw Error(K(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(pn(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(K(171))}if(t.tag===1){var n=t.type;if(pn(n))return T0(t,n,e)}return e}function Sw(t,e,n,r,s,i,o,l,u){return t=Em(n,r,!0,t,s,i,o,l,u),t.context=Tw(null),n=t.current,r=tn(),s=xs(n),i=Cr(r,s),i.callback=e??null,gs(n,i,s),t.current.lanes=s,Yo(t,s,r),gn(t,r),t}function Ru(t,e,n,r){var s=e.current,i=tn(),o=xs(s);return n=Tw(n),e.context===null?e.context=n:e.pendingContext=n,e=Cr(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=gs(s,e,o),t!==null&&(Qn(t,s,o,i),fc(t,s,o)),o}function eu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Ay(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function km(t,e){Ay(t,e),(t=t.alternate)&&Ay(t,e)}function NT(){return null}var Iw=typeof reportError=="function"?reportError:function(t){console.error(t)};function Tm(t){this._internalRoot=t}Au.prototype.render=Tm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(K(409));Ru(t,e,null,null)};Au.prototype.unmount=Tm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ni(function(){Ru(null,t,null,null)}),e[Lr]=null}};function Au(t){this._internalRoot=t}Au.prototype.unstable_scheduleHydration=function(t){if(t){var e=i0();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ns.length&&e!==0&&e<ns[n].priority;n++);ns.splice(n,0,t),n===0&&o0(t)}};function Sm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pu(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function Py(){}function ET(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var d=eu(o);i.call(d)}}var o=Sw(e,r,t,0,null,!1,!1,"",Py);return t._reactRootContainer=o,t[Lr]=o.current,Co(t.nodeType===8?t.parentNode:t),ni(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var d=eu(u);l.call(d)}}var u=Em(t,0,!1,null,null,!1,!1,"",Py);return t._reactRootContainer=u,t[Lr]=u.current,Co(t.nodeType===8?t.parentNode:t),ni(function(){Ru(e,u,n,r)}),u}function Du(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var u=eu(o);l.call(u)}}Ru(e,o,t,s)}else o=ET(n,e,t,s,r);return eu(o)}r0=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Ja(e.pendingLanes);n!==0&&(Hf(e,n|1),gn(e,mt()),!(Re&6)&&(sa=mt()+500,As()))}break;case 13:ni(function(){var r=Or(t,1);if(r!==null){var s=tn();Qn(r,t,1,s)}}),km(t,1)}};Gf=function(t){if(t.tag===13){var e=Or(t,134217728);if(e!==null){var n=tn();Qn(e,t,134217728,n)}km(t,134217728)}};s0=function(t){if(t.tag===13){var e=xs(t),n=Or(t,e);if(n!==null){var r=tn();Qn(n,t,e,r)}km(t,e)}};i0=function(){return Fe};a0=function(t,e){var n=Fe;try{return Fe=t,e()}finally{Fe=n}};kh=function(t,e,n){switch(e){case"input":if(xh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Eu(r);if(!s)throw Error(K(90));Mv(r),xh(r,s)}}}break;case"textarea":Fv(t,n);break;case"select":e=n.value,e!=null&&$i(t,!!n.multiple,e,!1)}};Hv=wm;Gv=ni;var kT={usingClientEntryPoint:!1,Events:[Xo,Di,Eu,Wv,qv,wm]},Wa={findFiberByHostInstance:Ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},TT={bundleType:Wa.bundleType,version:Wa.version,rendererPackageName:Wa.rendererPackageName,rendererConfig:Wa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:zr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Yv(t),t===null?null:t.stateNode},findFiberByHostInstance:Wa.findFiberByHostInstance||NT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Zl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Zl.isDisabled&&Zl.supportsFiber)try{wu=Zl.inject(TT),cr=Zl}catch{}}jn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=kT;jn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sm(e))throw Error(K(200));return bT(t,e,null,n)};jn.createRoot=function(t,e){if(!Sm(t))throw Error(K(299));var n=!1,r="",s=Iw;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=Em(t,1,!1,null,null,n,!1,r,s),t[Lr]=e.current,Co(t.nodeType===8?t.parentNode:t),new Tm(e)};jn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(K(188)):(t=Object.keys(t).join(","),Error(K(268,t)));return t=Yv(e),t=t===null?null:t.stateNode,t};jn.flushSync=function(t){return ni(t)};jn.hydrate=function(t,e,n){if(!Pu(e))throw Error(K(200));return Du(null,t,e,!0,n)};jn.hydrateRoot=function(t,e,n){if(!Sm(t))throw Error(K(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=Iw;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=Sw(e,null,t,1,n??null,s,!1,i,o),t[Lr]=e.current,Co(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Au(e)};jn.render=function(t,e,n){if(!Pu(e))throw Error(K(200));return Du(null,t,e,!1,n)};jn.unmountComponentAtNode=function(t){if(!Pu(t))throw Error(K(40));return t._reactRootContainer?(ni(function(){Du(null,null,t,!1,function(){t._reactRootContainer=null,t[Lr]=null})}),!0):!1};jn.unstable_batchedUpdates=wm;jn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Pu(n))throw Error(K(200));if(t==null||t._reactInternals===void 0)throw Error(K(38));return Du(t,e,n,!1,r)};jn.version="18.3.1-next-f1338f8080-20240426";function jw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(jw)}catch(t){console.error(t)}}jw(),jv.exports=jn;var ST=jv.exports,Dy=ST;dh.createRoot=Dy.createRoot,dh.hydrateRoot=Dy.hydrateRoot;/**
 * react-router v7.9.6
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ly="popstate";function IT(t={}){function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return sf("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Fo(s)}return CT(e,n,null,t)}function tt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Fn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function jT(){return Math.random().toString(36).substring(2,10)}function Oy(t,e){return{usr:t.state,key:t.key,idx:e}}function sf(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?xa(e):e,state:n,key:e&&e.key||r||jT()}}function Fo({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function xa(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function CT(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l="POP",u=null,d=h();d==null&&(d=0,o.replaceState({...o.state,idx:d},""));function h(){return(o.state||{idx:null}).idx}function p(){l="POP";let I=h(),y=I==null?null:I-d;d=I,u&&u({action:l,location:j.location,delta:y})}function m(I,y){l="PUSH";let _=sf(j.location,I,y);d=h()+1;let b=Oy(_,d),A=j.createHref(_);try{o.pushState(b,"",A)}catch(V){if(V instanceof DOMException&&V.name==="DataCloneError")throw V;s.location.assign(A)}i&&u&&u({action:l,location:j.location,delta:1})}function v(I,y){l="REPLACE";let _=sf(j.location,I,y);d=h();let b=Oy(_,d),A=j.createHref(_);o.replaceState(b,"",A),i&&u&&u({action:l,location:j.location,delta:0})}function T(I){return RT(I)}let j={get action(){return l},get location(){return t(s,o)},listen(I){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Ly,p),u=I,()=>{s.removeEventListener(Ly,p),u=null}},createHref(I){return e(s,I)},createURL:T,encodeLocation(I){let y=T(I);return{pathname:y.pathname,search:y.search,hash:y.hash}},push:m,replace:v,go(I){return o.go(I)}};return j}function RT(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),tt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Fo(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function Cw(t,e,n="/"){return AT(t,e,n,!1)}function AT(t,e,n,r){let s=typeof e=="string"?xa(e):e,i=Vr(s.pathname||"/",n);if(i==null)return null;let o=Rw(t);PT(o);let l=null;for(let u=0;l==null&&u<o.length;++u){let d=WT(i);l=$T(o[u],d,r)}return l}function Rw(t,e=[],n=[],r="",s=!1){let i=(o,l,u=s,d)=>{let h={relativePath:d===void 0?o.path||"":d,caseSensitive:o.caseSensitive===!0,childrenIndex:l,route:o};if(h.relativePath.startsWith("/")){if(!h.relativePath.startsWith(r)&&u)return;tt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length)}let p=Rr([r,h.relativePath]),m=n.concat(h);o.children&&o.children.length>0&&(tt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${p}".`),Rw(o.children,e,m,p,u)),!(o.path==null&&!o.index)&&e.push({path:p,score:UT(p,o.index),routesMeta:m})};return t.forEach((o,l)=>{var u;if(o.path===""||!((u=o.path)!=null&&u.includes("?")))i(o,l);else for(let d of Aw(o.path))i(o,l,!0,d)}),e}function Aw(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=Aw(r.join("/")),l=[];return l.push(...o.map(u=>u===""?i:[i,u].join("/"))),s&&l.push(...o),l.map(u=>t.startsWith("/")&&u===""?"/":u)}function PT(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:BT(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var DT=/^:[\w-]+$/,LT=3,OT=2,MT=1,VT=10,FT=-2,My=t=>t==="*";function UT(t,e){let n=t.split("/"),r=n.length;return n.some(My)&&(r+=FT),e&&(r+=OT),n.filter(s=>!My(s)).reduce((s,i)=>s+(DT.test(i)?LT:i===""?MT:VT),r)}function BT(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function $T(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let u=r[l],d=l===r.length-1,h=i==="/"?e:e.slice(i.length)||"/",p=tu({path:u.relativePath,caseSensitive:u.caseSensitive,end:d},h),m=u.route;if(!p&&d&&n&&!r[r.length-1].route.index&&(p=tu({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},h)),!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:Rr([i,p.pathname]),pathnameBase:QT(Rr([i,p.pathnameBase])),route:m}),p.pathnameBase!=="/"&&(i=Rr([i,p.pathnameBase]))}return o}function tu(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=zT(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,{paramName:h,isOptional:p},m)=>{if(h==="*"){let T=l[m]||"";o=i.slice(0,i.length-T.length).replace(/(.)\/+$/,"$1")}const v=l[m];return p&&!v?d[h]=void 0:d[h]=(v||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:t}}function zT(t,e=!1,n=!0){Fn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,u)=>(r.push({paramName:l,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function WT(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Vr(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}var qT=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HT=t=>qT.test(t);function GT(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?xa(t):t,i;if(n)if(HT(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Fn(!1,`Pathnames cannot have embedded double slashes - normalizing ${o} -> ${n}`)}n.startsWith("/")?i=Vy(n.substring(1),"/"):i=Vy(n,e)}else i=e;return{pathname:i,search:YT(r),hash:JT(s)}}function Vy(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Qd(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function KT(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Im(t){let e=KT(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function jm(t,e,n,r=!1){let s;typeof t=="string"?s=xa(t):(s={...t},tt(!s.pathname||!s.pathname.includes("?"),Qd("?","pathname","search",s)),tt(!s.pathname||!s.pathname.includes("#"),Qd("#","pathname","hash",s)),tt(!s.search||!s.search.includes("#"),Qd("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let p=e.length-1;if(!r&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),p-=1;s.pathname=m.join("/")}l=p>=0?e[p]:"/"}let u=GT(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(d||h)&&(u.pathname+="/"),u}var Rr=t=>t.join("/").replace(/\/\/+/g,"/"),QT=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),YT=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,JT=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function XT(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var Pw=["POST","PUT","PATCH","DELETE"];new Set(Pw);var ZT=["GET",...Pw];new Set(ZT);var va=w.createContext(null);va.displayName="DataRouter";var Lu=w.createContext(null);Lu.displayName="DataRouterState";w.createContext(!1);var Dw=w.createContext({isTransitioning:!1});Dw.displayName="ViewTransition";var eS=w.createContext(new Map);eS.displayName="Fetchers";var tS=w.createContext(null);tS.displayName="Await";var Zn=w.createContext(null);Zn.displayName="Navigation";var el=w.createContext(null);el.displayName="Location";var er=w.createContext({outlet:null,matches:[],isDataRoute:!1});er.displayName="Route";var Cm=w.createContext(null);Cm.displayName="RouteError";function nS(t,{relative:e}={}){tt(wa(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=w.useContext(Zn),{hash:s,pathname:i,search:o}=nl(t,{relative:e}),l=i;return n!=="/"&&(l=i==="/"?n:Rr([n,i])),r.createHref({pathname:l,search:o,hash:s})}function wa(){return w.useContext(el)!=null}function tr(){return tt(wa(),"useLocation() may be used only in the context of a <Router> component."),w.useContext(el).location}var Lw="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function Ow(t){w.useContext(Zn).static||w.useLayoutEffect(t)}function at(){let{isDataRoute:t}=w.useContext(er);return t?pS():rS()}function rS(){tt(wa(),"useNavigate() may be used only in the context of a <Router> component.");let t=w.useContext(va),{basename:e,navigator:n}=w.useContext(Zn),{matches:r}=w.useContext(er),{pathname:s}=tr(),i=JSON.stringify(Im(r)),o=w.useRef(!1);return Ow(()=>{o.current=!0}),w.useCallback((u,d={})=>{if(Fn(o.current,Lw),!o.current)return;if(typeof u=="number"){n.go(u);return}let h=jm(u,JSON.parse(i),s,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Rr([e,h.pathname])),(d.replace?n.replace:n.push)(h,d.state,d)},[e,n,i,s,t])}w.createContext(null);function tl(){let{matches:t}=w.useContext(er),e=t[t.length-1];return e?e.params:{}}function nl(t,{relative:e}={}){let{matches:n}=w.useContext(er),{pathname:r}=tr(),s=JSON.stringify(Im(n));return w.useMemo(()=>jm(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function sS(t,e){return Mw(t,e)}function Mw(t,e,n,r,s){var _;tt(wa(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=w.useContext(Zn),{matches:o}=w.useContext(er),l=o[o.length-1],u=l?l.params:{},d=l?l.pathname:"/",h=l?l.pathnameBase:"/",p=l&&l.route;{let b=p&&p.path||"";Vw(d,!p||b.endsWith("*")||b.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${b}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${b}"> to <Route path="${b==="/"?"*":`${b}/*`}">.`)}let m=tr(),v;if(e){let b=typeof e=="string"?xa(e):e;tt(h==="/"||((_=b.pathname)==null?void 0:_.startsWith(h)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${b.pathname}" was given in the \`location\` prop.`),v=b}else v=m;let T=v.pathname||"/",j=T;if(h!=="/"){let b=h.replace(/^\//,"").split("/");j="/"+T.replace(/^\//,"").split("/").slice(b.length).join("/")}let I=Cw(t,{pathname:j});Fn(p||I!=null,`No routes matched location "${v.pathname}${v.search}${v.hash}" `),Fn(I==null||I[I.length-1].route.element!==void 0||I[I.length-1].route.Component!==void 0||I[I.length-1].route.lazy!==void 0,`Matched leaf route at location "${v.pathname}${v.search}${v.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let y=cS(I&&I.map(b=>Object.assign({},b,{params:Object.assign({},u,b.params),pathname:Rr([h,i.encodeLocation?i.encodeLocation(b.pathname.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathname]),pathnameBase:b.pathnameBase==="/"?h:Rr([h,i.encodeLocation?i.encodeLocation(b.pathnameBase.replace(/\?/g,"%3F").replace(/#/g,"%23")).pathname:b.pathnameBase])})),o,n,r,s);return e&&y?w.createElement(el.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...v},navigationType:"POP"}},y):y}function iS(){let t=mS(),e=XT(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},o=null;return console.error("Error handled by React Router default ErrorBoundary:",t),o=w.createElement(w.Fragment,null,w.createElement("p",null," Hey developer "),w.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",w.createElement("code",{style:i},"ErrorBoundary")," or"," ",w.createElement("code",{style:i},"errorElement")," prop on your route.")),w.createElement(w.Fragment,null,w.createElement("h2",null,"Unexpected Application Error!"),w.createElement("h3",{style:{fontStyle:"italic"}},e),n?w.createElement("pre",{style:s},n):null,o)}var aS=w.createElement(iS,null),oS=class extends w.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){this.props.onError?this.props.onError(t,e):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?w.createElement(er.Provider,{value:this.props.routeContext},w.createElement(Cm.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function lS({routeContext:t,match:e,children:n}){let r=w.useContext(va);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),w.createElement(er.Provider,{value:t},n)}function cS(t,e=[],n=null,r=null,s=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let i=t,o=n==null?void 0:n.errors;if(o!=null){let h=i.findIndex(p=>p.route.id&&(o==null?void 0:o[p.route.id])!==void 0);tt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),i=i.slice(0,Math.min(i.length,h+1))}let l=!1,u=-1;if(n)for(let h=0;h<i.length;h++){let p=i[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(u=h),p.route.id){let{loaderData:m,errors:v}=n,T=p.route.loader&&!m.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||T){l=!0,u>=0?i=i.slice(0,u+1):i=[i[0]];break}}}let d=n&&r?(h,p)=>{var m,v;r(h,{location:n.location,params:((v=(m=n.matches)==null?void 0:m[0])==null?void 0:v.params)??{},errorInfo:p})}:void 0;return i.reduceRight((h,p,m)=>{let v,T=!1,j=null,I=null;n&&(v=o&&p.route.id?o[p.route.id]:void 0,j=p.route.errorElement||aS,l&&(u<0&&m===0?(Vw("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),T=!0,I=null):u===m&&(T=!0,I=p.route.hydrateFallbackElement||null)));let y=e.concat(i.slice(0,m+1)),_=()=>{let b;return v?b=j:T?b=I:p.route.Component?b=w.createElement(p.route.Component,null):p.route.element?b=p.route.element:b=h,w.createElement(lS,{match:p,routeContext:{outlet:h,matches:y,isDataRoute:n!=null},children:b})};return n&&(p.route.ErrorBoundary||p.route.errorElement||m===0)?w.createElement(oS,{location:n.location,revalidation:n.revalidation,component:j,error:v,children:_(),routeContext:{outlet:null,matches:y,isDataRoute:!0},onError:d}):_()},null)}function Rm(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function uS(t){let e=w.useContext(va);return tt(e,Rm(t)),e}function dS(t){let e=w.useContext(Lu);return tt(e,Rm(t)),e}function hS(t){let e=w.useContext(er);return tt(e,Rm(t)),e}function Am(t){let e=hS(t),n=e.matches[e.matches.length-1];return tt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function fS(){return Am("useRouteId")}function mS(){var r;let t=w.useContext(Cm),e=dS("useRouteError"),n=Am("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function pS(){let{router:t}=uS("useNavigate"),e=Am("useNavigate"),n=w.useRef(!1);return Ow(()=>{n.current=!0}),w.useCallback(async(s,i={})=>{Fn(n.current,Lw),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Fy={};function Vw(t,e,n){!e&&!Fy[t]&&(Fy[t]=!0,Fn(!1,n))}w.memo(gS);function gS({routes:t,future:e,state:n,unstable_onError:r}){return Mw(t,void 0,n,r,e)}function yS({to:t,replace:e,state:n,relative:r}){tt(wa(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=w.useContext(Zn);Fn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=w.useContext(er),{pathname:o}=tr(),l=at(),u=jm(t,Im(i),o,r==="path"),d=JSON.stringify(u);return w.useEffect(()=>{l(JSON.parse(d),{replace:e,state:n,relative:r})},[l,d,r,e,n]),null}function St(t){tt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function xS({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){tt(!wa(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let o=t.replace(/^\/*/,"/"),l=w.useMemo(()=>({basename:o,navigator:s,static:i,future:{}}),[o,s,i]);typeof n=="string"&&(n=xa(n));let{pathname:u="/",search:d="",hash:h="",state:p=null,key:m="default"}=n,v=w.useMemo(()=>{let T=Vr(u,o);return T==null?null:{location:{pathname:T,search:d,hash:h,state:p,key:m},navigationType:r}},[o,u,d,h,p,m,r]);return Fn(v!=null,`<Router basename="${o}"> is not able to match the URL "${u}${d}${h}" because it does not start with the basename, so the <Router> won't render anything.`),v==null?null:w.createElement(Zn.Provider,{value:l},w.createElement(el.Provider,{children:e,value:v}))}function vS({children:t,location:e}){return sS(af(t),e)}function af(t,e=[]){let n=[];return w.Children.forEach(t,(r,s)=>{if(!w.isValidElement(r))return;let i=[...e,s];if(r.type===w.Fragment){n.push.apply(n,af(r.props.children,i));return}tt(r.type===St,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),tt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let o={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,middleware:r.props.middleware,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=af(r.props.children,i)),n.push(o)}),n}var wc="get",_c="application/x-www-form-urlencoded";function Ou(t){return t!=null&&typeof t.tagName=="string"}function wS(t){return Ou(t)&&t.tagName.toLowerCase()==="button"}function _S(t){return Ou(t)&&t.tagName.toLowerCase()==="form"}function bS(t){return Ou(t)&&t.tagName.toLowerCase()==="input"}function NS(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function ES(t,e){return t.button===0&&(!e||e==="_self")&&!NS(t)}var ec=null;function kS(){if(ec===null)try{new FormData(document.createElement("form"),0),ec=!1}catch{ec=!0}return ec}var TS=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Yd(t){return t!=null&&!TS.has(t)?(Fn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_c}"`),null):t}function SS(t,e){let n,r,s,i,o;if(_S(t)){let l=t.getAttribute("action");r=l?Vr(l,e):null,n=t.getAttribute("method")||wc,s=Yd(t.getAttribute("enctype"))||_c,i=new FormData(t)}else if(wS(t)||bS(t)&&(t.type==="submit"||t.type==="image")){let l=t.form;if(l==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||l.getAttribute("action");if(r=u?Vr(u,e):null,n=t.getAttribute("formmethod")||l.getAttribute("method")||wc,s=Yd(t.getAttribute("formenctype"))||Yd(l.getAttribute("enctype"))||_c,i=new FormData(l,t),!kS()){let{name:d,type:h,value:p}=t;if(h==="image"){let m=d?`${d}.`:"";i.append(`${m}x`,"0"),i.append(`${m}y`,"0")}else d&&i.append(d,p)}}else{if(Ou(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=wc,r=null,s=_c,o=t}return i&&s==="text/plain"&&(o=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:o}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function Pm(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function IS(t,e,n){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${n}`:e&&Vr(r.pathname,e)==="/"?r.pathname=`${e.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function jS(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function CS(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function RS(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let o=await jS(i,n);return o.links?o.links():[]}return[]}));return LS(r.flat(1).filter(CS).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Uy(t,e,n,r,s,i){let o=(u,d)=>n[d]?u.route.id!==n[d].route.id:!0,l=(u,d)=>{var h;return n[d].pathname!==u.pathname||((h=n[d].route.path)==null?void 0:h.endsWith("*"))&&n[d].params["*"]!==u.params["*"]};return i==="assets"?e.filter((u,d)=>o(u,d)||l(u,d)):i==="data"?e.filter((u,d)=>{var p;let h=r.routes[u.route.id];if(!h||!h.hasLoader)return!1;if(o(u,d)||l(u,d))return!0;if(u.route.shouldRevalidate){let m=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:((p=n[0])==null?void 0:p.params)||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof m=="boolean")return m}return!0}):[]}function AS(t,e,{includeHydrateFallback:n}={}){return PS(t.map(r=>{let s=e.routes[r.route.id];if(!s)return[];let i=[s.module];return s.clientActionModule&&(i=i.concat(s.clientActionModule)),s.clientLoaderModule&&(i=i.concat(s.clientLoaderModule)),n&&s.hydrateFallbackModule&&(i=i.concat(s.hydrateFallbackModule)),s.imports&&(i=i.concat(s.imports)),i}).flat(1))}function PS(t){return[...new Set(t)]}function DS(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function LS(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(DS(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function Fw(){let t=w.useContext(va);return Pm(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function OS(){let t=w.useContext(Lu);return Pm(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var Dm=w.createContext(void 0);Dm.displayName="FrameworkContext";function Uw(){let t=w.useContext(Dm);return Pm(t,"You must render this element inside a <HydratedRouter> element"),t}function MS(t,e){let n=w.useContext(Dm),[r,s]=w.useState(!1),[i,o]=w.useState(!1),{onFocus:l,onBlur:u,onMouseEnter:d,onMouseLeave:h,onTouchStart:p}=e,m=w.useRef(null);w.useEffect(()=>{if(t==="render"&&o(!0),t==="viewport"){let j=y=>{y.forEach(_=>{o(_.isIntersecting)})},I=new IntersectionObserver(j,{threshold:.5});return m.current&&I.observe(m.current),()=>{I.disconnect()}}},[t]),w.useEffect(()=>{if(r){let j=setTimeout(()=>{o(!0)},100);return()=>{clearTimeout(j)}}},[r]);let v=()=>{s(!0)},T=()=>{s(!1),o(!1)};return n?t!=="intent"?[i,m,{}]:[i,m,{onFocus:qa(l,v),onBlur:qa(u,T),onMouseEnter:qa(d,v),onMouseLeave:qa(h,T),onTouchStart:qa(p,v)}]:[!1,m,{}]}function qa(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function VS({page:t,...e}){let{router:n}=Fw(),r=w.useMemo(()=>Cw(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?w.createElement(US,{page:t,matches:r,...e}):null}function FS(t){let{manifest:e,routeModules:n}=Uw(),[r,s]=w.useState([]);return w.useEffect(()=>{let i=!1;return RS(t,e,n).then(o=>{i||s(o)}),()=>{i=!0}},[t,e,n]),r}function US({page:t,matches:e,...n}){let r=tr(),{manifest:s,routeModules:i}=Uw(),{basename:o}=Fw(),{loaderData:l,matches:u}=OS(),d=w.useMemo(()=>Uy(t,e,u,s,r,"data"),[t,e,u,s,r]),h=w.useMemo(()=>Uy(t,e,u,s,r,"assets"),[t,e,u,s,r]),p=w.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let T=new Set,j=!1;if(e.forEach(y=>{var b;let _=s.routes[y.route.id];!_||!_.hasLoader||(!d.some(A=>A.route.id===y.route.id)&&y.route.id in l&&((b=i[y.route.id])!=null&&b.shouldRevalidate)||_.hasClientLoader?j=!0:T.add(y.route.id))}),T.size===0)return[];let I=IS(t,o,"data");return j&&T.size>0&&I.searchParams.set("_routes",e.filter(y=>T.has(y.route.id)).map(y=>y.route.id).join(",")),[I.pathname+I.search]},[o,l,r,s,d,e,t,i]),m=w.useMemo(()=>AS(h,s),[h,s]),v=FS(h);return w.createElement(w.Fragment,null,p.map(T=>w.createElement("link",{key:T,rel:"prefetch",as:"fetch",href:T,...n})),m.map(T=>w.createElement("link",{key:T,rel:"modulepreload",href:T,...n})),v.map(({key:T,link:j})=>w.createElement("link",{key:T,nonce:n.nonce,...j})))}function BS(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var Bw=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{Bw&&(window.__reactRouterVersion="7.9.6")}catch{}function $S({basename:t,children:e,window:n}){let r=w.useRef();r.current==null&&(r.current=IT({window:n,v5Compat:!0}));let s=r.current,[i,o]=w.useState({action:s.action,location:s.location}),l=w.useCallback(u=>{w.startTransition(()=>o(u))},[o]);return w.useLayoutEffect(()=>s.listen(l),[s,l]),w.createElement(xS,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var $w=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,zw=w.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:o,state:l,target:u,to:d,preventScrollReset:h,viewTransition:p,...m},v){let{basename:T}=w.useContext(Zn),j=typeof d=="string"&&$w.test(d),I,y=!1;if(typeof d=="string"&&j&&(I=d,Bw))try{let E=new URL(window.location.href),S=d.startsWith("//")?new URL(E.protocol+d):new URL(d),R=Vr(S.pathname,T);S.origin===E.origin&&R!=null?d=R+S.search+S.hash:y=!0}catch{Fn(!1,`<Link to="${d}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let _=nS(d,{relative:s}),[b,A,V]=MS(r,m),M=HS(d,{replace:o,state:l,target:u,preventScrollReset:h,relative:s,viewTransition:p});function N(E){e&&e(E),E.defaultPrevented||M(E)}let x=w.createElement("a",{...m,...V,href:I||_,onClick:y||i?e:N,ref:BS(v,A),target:u,"data-discover":!j&&n==="render"?"true":void 0});return b&&!j?w.createElement(w.Fragment,null,x,w.createElement(VS,{page:_})):x});zw.displayName="Link";var zS=w.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:o,viewTransition:l,children:u,...d},h){let p=nl(o,{relative:d.relative}),m=tr(),v=w.useContext(Lu),{navigator:T,basename:j}=w.useContext(Zn),I=v!=null&&JS(p)&&l===!0,y=T.encodeLocation?T.encodeLocation(p).pathname:p.pathname,_=m.pathname,b=v&&v.navigation&&v.navigation.location?v.navigation.location.pathname:null;n||(_=_.toLowerCase(),b=b?b.toLowerCase():null,y=y.toLowerCase()),b&&j&&(b=Vr(b,j)||b);const A=y!=="/"&&y.endsWith("/")?y.length-1:y.length;let V=_===y||!s&&_.startsWith(y)&&_.charAt(A)==="/",M=b!=null&&(b===y||!s&&b.startsWith(y)&&b.charAt(y.length)==="/"),N={isActive:V,isPending:M,isTransitioning:I},x=V?e:void 0,E;typeof r=="function"?E=r(N):E=[r,V?"active":null,M?"pending":null,I?"transitioning":null].filter(Boolean).join(" ");let S=typeof i=="function"?i(N):i;return w.createElement(zw,{...d,"aria-current":x,className:E,ref:h,style:S,to:o,viewTransition:l},typeof u=="function"?u(N):u)});zS.displayName="NavLink";var WS=w.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:o=wc,action:l,onSubmit:u,relative:d,preventScrollReset:h,viewTransition:p,...m},v)=>{let T=QS(),j=YS(l,{relative:d}),I=o.toLowerCase()==="get"?"get":"post",y=typeof l=="string"&&$w.test(l),_=b=>{if(u&&u(b),b.defaultPrevented)return;b.preventDefault();let A=b.nativeEvent.submitter,V=(A==null?void 0:A.getAttribute("formmethod"))||o;T(A||b.currentTarget,{fetcherKey:e,method:V,navigate:n,replace:s,state:i,relative:d,preventScrollReset:h,viewTransition:p})};return w.createElement("form",{ref:v,method:I,action:j,onSubmit:r?u:_,...m,"data-discover":!y&&t==="render"?"true":void 0})});WS.displayName="Form";function qS(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function Ww(t){let e=w.useContext(va);return tt(e,qS(t)),e}function HS(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:o}={}){let l=at(),u=tr(),d=nl(t,{relative:i});return w.useCallback(h=>{if(ES(h,e)){h.preventDefault();let p=n!==void 0?n:Fo(u)===Fo(d);l(t,{replace:p,state:r,preventScrollReset:s,relative:i,viewTransition:o})}},[u,l,d,n,r,e,t,s,i,o])}var GS=0,KS=()=>`__${String(++GS)}__`;function QS(){let{router:t}=Ww("useSubmit"),{basename:e}=w.useContext(Zn),n=fS();return w.useCallback(async(r,s={})=>{let{action:i,method:o,encType:l,formData:u,body:d}=SS(r,e);if(s.navigate===!1){let h=s.fetcherKey||KS();await t.fetch(h,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:d,formMethod:s.method||o,formEncType:s.encType||l,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:d,formMethod:s.method||o,formEncType:s.encType||l,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function YS(t,{relative:e}={}){let{basename:n}=w.useContext(Zn),r=w.useContext(er);tt(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...nl(t||".",{relative:e})},o=tr();if(t==null){i.search=o.search;let l=new URLSearchParams(i.search),u=l.getAll("index");if(u.some(h=>h==="")){l.delete("index"),u.filter(p=>p).forEach(p=>l.append("index",p));let h=l.toString();i.search=h?`?${h}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Rr([n,i.pathname])),Fo(i)}function JS(t,{relative:e}={}){let n=w.useContext(Dw);tt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=Ww("useViewTransitionState"),s=nl(t,{relative:e});if(!n.isTransitioning)return!1;let i=Vr(n.currentLocation.pathname,r)||n.currentLocation.pathname,o=Vr(n.nextLocation.pathname,r)||n.nextLocation.pathname;return tu(s.pathname,o)!=null||tu(s.pathname,i)!=null}var By={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qw=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},XS=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Hw={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,v=d&63;u||(v=64,o||(m=64)),r.push(n[h],n[p],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(qw(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):XS(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||p==null)throw new ZS;const m=i<<2|l>>4;if(r.push(m),d!==64){const v=l<<4&240|d>>2;if(r.push(v),p!==64){const T=d<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let ZS=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const eI=function(t){const e=qw(t);return Hw.encodeByteArray(e,!0)},Gw=function(t){return eI(t).replace(/\./g,"")},tI=function(t){try{return Hw.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rI=()=>nI().__FIREBASE_DEFAULTS__,sI=()=>{if(typeof process>"u"||typeof By>"u")return;const t=By.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},iI=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&tI(t[1]);return e&&JSON.parse(e)},aI=()=>{try{return rI()||sI()||iI()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},Kw=()=>{var t;return(t=aI())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}function lI(){try{return typeof indexedDB=="object"}catch{return!1}}function cI(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uI="FirebaseError";let Lm=class Qw extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=uI,Object.setPrototypeOf(this,Qw.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Yw.prototype.create)}},Yw=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?dI(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Lm(s,l,r)}};function dI(t,e){return t.replace(hI,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const hI=/\{\$([^}]+)}/g;function of(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if($y(i)&&$y(o)){if(!of(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function $y(t){return t!==null&&typeof t=="object"}let nu=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zs="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new oI;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(pI(e))try{this.getOrInitializeService({instanceIdentifier:zs})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=zs){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zs){return this.instances.has(e)}getOptions(e=zs){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:mI(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=zs){return this.component?this.component.multipleInstances?e:zs:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function mI(t){return t===zs?void 0:t}function pI(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new fI(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Je;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Je||(Je={}));const yI={debug:Je.DEBUG,verbose:Je.VERBOSE,info:Je.INFO,warn:Je.WARN,error:Je.ERROR,silent:Je.SILENT},xI=Je.INFO,vI={[Je.DEBUG]:"log",[Je.VERBOSE]:"log",[Je.INFO]:"info",[Je.WARN]:"warn",[Je.ERROR]:"error"},wI=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=vI[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let _I=class{constructor(e){this.name=e,this._logLevel=xI,this._logHandler=wI,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Je))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?yI[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Je.DEBUG,...e),this._logHandler(this,Je.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Je.VERBOSE,...e),this._logHandler(this,Je.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Je.INFO,...e),this._logHandler(this,Je.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Je.WARN,...e),this._logHandler(this,Je.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Je.ERROR,...e),this._logHandler(this,Je.ERROR,...e)}};const bI=(t,e)=>e.some(n=>t instanceof n);let zy,Wy;function NI(){return zy||(zy=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function EI(){return Wy||(Wy=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const Jw=new WeakMap,lf=new WeakMap,Xw=new WeakMap,Jd=new WeakMap,Om=new WeakMap;function kI(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(ws(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&Jw.set(n,t)}).catch(()=>{}),Om.set(e,t),e}function TI(t){if(lf.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});lf.set(t,e)}let cf={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return lf.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Xw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ws(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function SI(t){cf=t(cf)}function II(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(Xd(this),e,...n);return Xw.set(r,e.sort?e.sort():[e]),ws(r)}:EI().includes(t)?function(...e){return t.apply(Xd(this),e),ws(Jw.get(this))}:function(...e){return ws(t.apply(Xd(this),e))}}function jI(t){return typeof t=="function"?II(t):(t instanceof IDBTransaction&&TI(t),bI(t,NI())?new Proxy(t,cf):t)}function ws(t){if(t instanceof IDBRequest)return kI(t);if(Jd.has(t))return Jd.get(t);const e=jI(t);return e!==t&&(Jd.set(t,e),Om.set(e,t)),e}const Xd=t=>Om.get(t);function CI(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=ws(o);return r&&o.addEventListener("upgradeneeded",u=>{r(ws(o.result),u.oldVersion,u.newVersion,ws(o.transaction),u)}),n&&o.addEventListener("blocked",u=>n(u.oldVersion,u.newVersion,u)),l.then(u=>{i&&u.addEventListener("close",()=>i()),s&&u.addEventListener("versionchange",d=>s(d.oldVersion,d.newVersion,d))}).catch(()=>{}),l}const RI=["get","getKey","getAll","getAllKeys","count"],AI=["put","add","delete","clear"],Zd=new Map;function qy(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(Zd.get(e))return Zd.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=AI.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||RI.includes(n)))return;const i=async function(o,...l){const u=this.transaction(o,s?"readwrite":"readonly");let d=u.store;return r&&(d=d.index(l.shift())),(await Promise.all([d[n](...l),s&&u.done]))[0]};return Zd.set(e,i),i}SI(t=>({...t,get:(e,n,r)=>qy(e,n)||t.get(e,n,r),has:(e,n)=>!!qy(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PI{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(DI(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function DI(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const uf="@firebase/app",Hy="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fr=new _I("@firebase/app"),LI="@firebase/app-compat",OI="@firebase/analytics-compat",MI="@firebase/analytics",VI="@firebase/app-check-compat",FI="@firebase/app-check",UI="@firebase/auth",BI="@firebase/auth-compat",$I="@firebase/database",zI="@firebase/data-connect",WI="@firebase/database-compat",qI="@firebase/functions",HI="@firebase/functions-compat",GI="@firebase/installations",KI="@firebase/installations-compat",QI="@firebase/messaging",YI="@firebase/messaging-compat",JI="@firebase/performance",XI="@firebase/performance-compat",ZI="@firebase/remote-config",ej="@firebase/remote-config-compat",tj="@firebase/storage",nj="@firebase/storage-compat",rj="@firebase/firestore",sj="@firebase/vertexai-preview",ij="@firebase/firestore-compat",aj="firebase",oj="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const df="[DEFAULT]",lj={[uf]:"fire-core",[LI]:"fire-core-compat",[MI]:"fire-analytics",[OI]:"fire-analytics-compat",[FI]:"fire-app-check",[VI]:"fire-app-check-compat",[UI]:"fire-auth",[BI]:"fire-auth-compat",[$I]:"fire-rtdb",[zI]:"fire-data-connect",[WI]:"fire-rtdb-compat",[qI]:"fire-fn",[HI]:"fire-fn-compat",[GI]:"fire-iid",[KI]:"fire-iid-compat",[QI]:"fire-fcm",[YI]:"fire-fcm-compat",[JI]:"fire-perf",[XI]:"fire-perf-compat",[ZI]:"fire-rc",[ej]:"fire-rc-compat",[tj]:"fire-gcs",[nj]:"fire-gcs-compat",[rj]:"fire-fst",[ij]:"fire-fst-compat",[sj]:"fire-vertex","fire-js":"fire-js",[aj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ru=new Map,cj=new Map,hf=new Map;function Gy(t,e){try{t.container.addComponent(e)}catch(n){Fr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function ri(t){const e=t.name;if(hf.has(e))return Fr.debug(`There were multiple attempts to register component ${e}.`),!1;hf.set(e,t);for(const n of ru.values())Gy(n,t);for(const n of cj.values())Gy(n,t);return!0}function Mu(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function or(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uj={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_s=new Yw("app","Firebase",uj);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dj{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new nu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _s.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hi=oj;function Zw(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:df,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw _s.create("bad-app-name",{appName:String(s)});if(n||(n=Kw()),!n)throw _s.create("no-options");const i=ru.get(s);if(i){if(of(n,i.options)&&of(r,i.config))return i;throw _s.create("duplicate-app",{appName:s})}const o=new gI(s);for(const u of hf.values())o.addComponent(u);const l=new dj(n,r,o);return ru.set(s,l),l}function Mm(t=df){const e=ru.get(t);if(!e&&t===df&&Kw())return Zw();if(!e)throw _s.create("no-app",{appName:t});return e}function dr(t,e,n){var r;let s=(r=lj[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Fr.warn(l.join(" "));return}ri(new nu(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hj="firebase-heartbeat-database",fj=1,Uo="firebase-heartbeat-store";let eh=null;function e_(){return eh||(eh=CI(hj,fj,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Uo)}catch(n){console.warn(n)}}}}).catch(t=>{throw _s.create("idb-open",{originalErrorMessage:t.message})})),eh}async function mj(t){try{const n=(await e_()).transaction(Uo),r=await n.objectStore(Uo).get(t_(t));return await n.done,r}catch(e){if(e instanceof Lm)Fr.warn(e.message);else{const n=_s.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Fr.warn(n.message)}}}async function Ky(t,e){try{const r=(await e_()).transaction(Uo,"readwrite");await r.objectStore(Uo).put(e,t_(t)),await r.done}catch(n){if(n instanceof Lm)Fr.warn(n.message);else{const r=_s.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Fr.warn(r.message)}}}function t_(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pj=1024,gj=30*24*60*60*1e3;class yj{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new vj(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Qy();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=gj}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Fr.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Qy(),{heartbeatsToSend:r,unsentEntries:s}=xj(this._heartbeatsCache.heartbeats),i=Gw(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Fr.warn(n),""}}}function Qy(){return new Date().toISOString().substring(0,10)}function xj(t,e=pj){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),Yy(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Yy(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class vj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lI()?cI().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await mj(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ky(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Ky(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function Yy(t){return Gw(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wj(t){ri(new nu("platform-logger",e=>new PI(e),"PRIVATE")),ri(new nu("heartbeat",e=>new yj(e),"PRIVATE")),dr(uf,Hy,t),dr(uf,Hy,"esm2017"),dr("fire-js","")}wj("");var Jy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _j=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},bj=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},Nj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,v=d&63;u||(v=64,o||(m=64)),r.push(n[h],n[p],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_j(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):bj(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||p==null)throw new Ej;const m=i<<2|l>>4;if(r.push(m),d!==64){const v=l<<4&240|d>>2;if(r.push(v),p!==64){const T=d<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let Ej=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const n_=function(t){try{return Nj.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kj(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tj=()=>kj().__FIREBASE_DEFAULTS__,Sj=()=>{if(typeof process>"u"||typeof Jy>"u")return;const t=Jy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Ij=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&n_(t[1]);return e&&JSON.parse(e)},r_=()=>{try{return Tj()||Sj()||Ij()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},jj=t=>{var e,n;return(n=(e=r_())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},s_=t=>{var e;return(e=r_())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function Cj(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(sn())}function Rj(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Aj(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function Pj(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function Dj(){const t=sn();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lj="FirebaseError";let Vu=class i_ extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=Lj,Object.setPrototypeOf(this,i_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Fu.prototype.create)}},Fu=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?Oj(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Vu(s,l,r)}};function Oj(t,e){return t.replace(Mj,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const Mj=/\{\$([^}]+)}/g;function Vj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function a_(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(Xy(i)&&Xy(o)){if(!a_(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function Xy(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rl(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Za(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function eo(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function Fj(t,e){const n=new Uj(t,e);return n.subscribe.bind(n)}class Uj{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");Bj(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=th),s.error===void 0&&(s.error=th),s.complete===void 0&&(s.complete=th);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function Bj(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function th(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xr(t){return t&&t._delegate?t._delegate:t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ze;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(ze||(ze={}));const $j={debug:ze.DEBUG,verbose:ze.VERBOSE,info:ze.INFO,warn:ze.WARN,error:ze.ERROR,silent:ze.SILENT},zj=ze.INFO,Wj={[ze.DEBUG]:"log",[ze.VERBOSE]:"log",[ze.INFO]:"info",[ze.WARN]:"warn",[ze.ERROR]:"error"},qj=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Wj[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let Hj=class{constructor(e){this.name=e,this._logLevel=zj,this._logHandler=qj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in ze))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$j[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,ze.DEBUG,...e),this._logHandler(this,ze.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,ze.VERBOSE,...e),this._logHandler(this,ze.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,ze.INFO,...e),this._logHandler(this,ze.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,ze.WARN,...e),this._logHandler(this,ze.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,ze.ERROR,...e),this._logHandler(this,ze.ERROR,...e)}};function Vm(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}let Zy=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};function o_(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Gj=o_,l_=new Fu("auth","Firebase",o_());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=new Hj("@firebase/auth");function Kj(t,...e){su.logLevel<=ze.WARN&&su.warn(`Auth (${hi}): ${t}`,...e)}function bc(t,...e){su.logLevel<=ze.ERROR&&su.error(`Auth (${hi}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(t,...e){throw Fm(t,...e)}function hr(t,...e){return Fm(t,...e)}function c_(t,e,n){const r=Object.assign(Object.assign({},Gj()),{[e]:n});return new Fu("auth","Firebase",r).create(e,{appName:t.name})}function Ar(t){return c_(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Fm(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return l_.create(t,...e)}function de(t,e,...n){if(!t)throw Fm(e,...n)}function Sr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw bc(e),new Error(e)}function Ur(t,e){t||Sr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ff(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Qj(){return ex()==="http:"||ex()==="https:"}function ex(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Qj()||Aj()||"connection"in navigator)?navigator.onLine:!0}function Jj(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sl{constructor(e,n){this.shortDelay=e,this.longDelay=n,Ur(n>e,"Short delay should be less than long delay!"),this.isMobile=Cj()||Pj()}get(){return Yj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Um(t,e){Ur(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u_{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Sr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Sr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Sr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zj=new sl(3e4,6e4);function Wr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function vr(t,e,n,r,s={}){return d_(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=rl(Object.assign({key:t.config.apiKey},o)).slice(1),u=await t._getAdditionalHeaders();u["Content-Type"]="application/json",t.languageCode&&(u["X-Firebase-Locale"]=t.languageCode);const d=Object.assign({method:e,headers:u},i);return Rj()||(d.referrerPolicy="no-referrer"),u_.fetch()(h_(t,t.config.apiHost,n,l),d)})}async function d_(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Xj),e);try{const s=new t1(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw tc(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[u,d]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw tc(t,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw tc(t,"email-already-in-use",o);if(u==="USER_DISABLED")throw tc(t,"user-disabled",o);const h=r[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(d)throw c_(t,h,d);Jn(t,h)}}catch(s){if(s instanceof Vu)throw s;Jn(t,"network-request-failed",{message:String(s)})}}async function il(t,e,n,r,s={}){const i=await vr(t,e,n,r,s);return"mfaPendingCredential"in i&&Jn(t,"multi-factor-auth-required",{_serverResponse:i}),i}function h_(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?Um(t.config,s):`${t.config.apiScheme}://${s}`}function e1(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class t1{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(hr(this.auth,"network-request-failed")),Zj.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function tc(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=hr(t,e,r);return s.customData._tokenResponse=n,s}function tx(t){return t!==void 0&&t.enterprise!==void 0}class n1{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return e1(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function r1(t,e){return vr(t,"GET","/v2/recaptchaConfig",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s1(t,e){return vr(t,"POST","/v1/accounts:delete",e)}async function f_(t,e){return vr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function po(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function i1(t,e=!1){const n=xr(t),r=await n.getIdToken(e),s=Bm(r);de(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:po(nh(s.auth_time)),issuedAtTime:po(nh(s.iat)),expirationTime:po(nh(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function nh(t){return Number(t)*1e3}function Bm(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return bc("JWT malformed, contained fewer than 3 sections"),null;try{const s=n_(n);return s?JSON.parse(s):(bc("Failed to decode base64 JWT payload"),null)}catch(s){return bc("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function nx(t){const e=Bm(t);return de(e,"internal-error"),de(typeof e.exp<"u","internal-error"),de(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ia(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Vu&&a1(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function a1({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mf{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=po(this.lastLoginAt),this.creationTime=po(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iu(t){var e;const n=t.auth,r=await t.getIdToken(),s=await ia(t,f_(n,{idToken:r}));de(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?m_(i.providerUserInfo):[],l=c1(t.providerData,o),u=t.isAnonymous,d=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=u?d:!1,p={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new mf(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,p)}async function l1(t){const e=xr(t);await iu(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function c1(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function m_(t){return t.map(e=>{var{providerId:n}=e,r=Vm(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function u1(t,e){const n=await d_(t,{},async()=>{const r=rl({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=h_(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",u_.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function d1(t,e){return vr(t,"POST","/v2/accounts:revokeToken",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ki{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){de(e.idToken,"internal-error"),de(typeof e.idToken<"u","internal-error"),de(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):nx(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){de(e.length!==0,"internal-error");const n=nx(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(de(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await u1(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ki;return r&&(de(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(de(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(de(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ki,this.toJSON())}_performRefresh(){return Sr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t,e){de(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ir{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Vm(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new o1(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new mf(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await ia(this,this.stsTokenManager.getToken(this.auth,e));return de(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return i1(this,e)}reload(){return l1(this)}_assign(e){this!==e&&(de(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ir(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){de(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await iu(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(or(this.auth.app))return Promise.reject(Ar(this.auth));const e=await this.getIdToken();return await ia(this,s1(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,u,d,h;const p=(r=n.displayName)!==null&&r!==void 0?r:void 0,m=(s=n.email)!==null&&s!==void 0?s:void 0,v=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,T=(o=n.photoURL)!==null&&o!==void 0?o:void 0,j=(l=n.tenantId)!==null&&l!==void 0?l:void 0,I=(u=n._redirectEventId)!==null&&u!==void 0?u:void 0,y=(d=n.createdAt)!==null&&d!==void 0?d:void 0,_=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:b,emailVerified:A,isAnonymous:V,providerData:M,stsTokenManager:N}=n;de(b&&N,e,"internal-error");const x=Ki.fromJSON(this.name,N);de(typeof b=="string",e,"internal-error"),Zr(p,e.name),Zr(m,e.name),de(typeof A=="boolean",e,"internal-error"),de(typeof V=="boolean",e,"internal-error"),Zr(v,e.name),Zr(T,e.name),Zr(j,e.name),Zr(I,e.name),Zr(y,e.name),Zr(_,e.name);const E=new Ir({uid:b,auth:e,email:m,emailVerified:A,displayName:p,isAnonymous:V,photoURL:T,phoneNumber:v,tenantId:j,stsTokenManager:x,createdAt:y,lastLoginAt:_});return M&&Array.isArray(M)&&(E.providerData=M.map(S=>Object.assign({},S))),I&&(E._redirectEventId=I),E}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ki;s.updateFromServerResponse(n);const i=new Ir({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await iu(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];de(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?m_(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Ki;l.updateFromIdToken(r);const u=new Ir({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),d={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new mf(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(u,d),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx=new Map;function jr(t){Ur(t instanceof Function,"Expected a class definition");let e=rx.get(t);return e?(Ur(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,rx.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p_{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}p_.type="NONE";const sx=p_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Nc(t,e,n){return`firebase:${t}:${e}:${n}`}class Qi{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Nc(this.userKey,s.apiKey,i),this.fullPersistenceKey=Nc("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Ir._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Qi(jr(sx),e,r);const s=(await Promise.all(n.map(async d=>{if(await d._isAvailable())return d}))).filter(d=>d);let i=s[0]||jr(sx);const o=Nc(r,e.config.apiKey,e.name);let l=null;for(const d of n)try{const h=await d._get(o);if(h){const p=Ir._fromJSON(e,h);d!==i&&(l=p),i=d;break}}catch{}const u=s.filter(d=>d._shouldAllowMigration);return!i._shouldAllowMigration||!u.length?new Qi(i,e,r):(i=u[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async d=>{if(d!==i)try{await d._remove(o)}catch{}})),new Qi(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ix(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(v_(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(g_(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(__(e))return"Blackberry";if(b_(e))return"Webos";if(y_(e))return"Safari";if((e.includes("chrome/")||x_(e))&&!e.includes("edge/"))return"Chrome";if(w_(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function g_(t=sn()){return/firefox\//i.test(t)}function y_(t=sn()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function x_(t=sn()){return/crios\//i.test(t)}function v_(t=sn()){return/iemobile/i.test(t)}function w_(t=sn()){return/android/i.test(t)}function __(t=sn()){return/blackberry/i.test(t)}function b_(t=sn()){return/webos/i.test(t)}function $m(t=sn()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function h1(t=sn()){var e;return $m(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function f1(){return Dj()&&document.documentMode===10}function N_(t=sn()){return $m(t)||w_(t)||b_(t)||__(t)||/windows phone/i.test(t)||v_(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E_(t,e=[]){let n;switch(t){case"Browser":n=ix(sn());break;case"Worker":n=`${ix(sn())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${hi}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m1{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const u=e(i);o(u)}catch(u){l(u)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function p1(t,e={}){return vr(t,"GET","/v2/passwordPolicy",Wr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g1=6;class y1{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:g1,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(n=u.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(r=u.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),u.isValid&&(u.isValid=(s=u.containsLowercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(i=u.containsUppercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x1{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new ax(this),this.idTokenSubscription=new ax(this),this.beforeStateQueue=new m1(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=l_,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=jr(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Qi.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await f_(this,{idToken:e}),r=await Ir._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(or(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(s=u.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return de(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await iu(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Jj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(or(this.app))return Promise.reject(Ar(this));const n=e?xr(e):null;return n&&de(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&de(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return or(this.app)?Promise.reject(Ar(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return or(this.app)?Promise.reject(Ar(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await p1(this),n=new y1(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Fu("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await d1(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&jr(e)||this._popupRedirectResolver;de(n,this,"argument-error"),this.redirectPersistenceManager=await Qi.create(this,[jr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(de(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const u=e.addObserver(n,r,s);return()=>{o=!0,u()}}else{const u=e.addObserver(n);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return de(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=E_(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Kj(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Ps(t){return xr(t)}class ax{constructor(e){this.auth=e,this.observer=null,this.addObserver=Fj(n=>this.observer=n)}get next(){return de(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Uu={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function v1(t){Uu=t}function k_(t){return Uu.loadJS(t)}function w1(){return Uu.recaptchaEnterpriseScript}function _1(){return Uu.gapiScript}function b1(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const N1="recaptcha-enterprise",E1="NO_RECAPTCHA";class k1{constructor(e){this.type=N1,this.auth=Ps(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{r1(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const d=new n1(u);return i.tenantId==null?i._agentRecaptchaConfig=d:i._tenantRecaptchaConfigs[i.tenantId]=d,o(d.siteKey)}}).catch(u=>{l(u)})})}function s(i,o,l){const u=window.grecaptcha;tx(u)?u.enterprise.ready(()=>{u.enterprise.execute(i,{action:e}).then(d=>{o(d)}).catch(()=>{o(E1)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&tx(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=w1();u.length!==0&&(u+=l),k_(u).then(()=>{s(l,i,o)}).catch(d=>{o(d)})}}).catch(l=>{o(l)})})}}async function ox(t,e,n,r=!1){const s=new k1(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const o=Object.assign({},e);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function au(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await ox(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await ox(t,e,n,n==="getOobCode");return r(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T1(t,e){const n=Mu(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(a_(i,e??{}))return s;Jn(s,"already-initialized")}return n.initialize({options:e})}function S1(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(jr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function I1(t,e,n){const r=Ps(t);de(r._canInitEmulator,r,"emulator-config-failed"),de(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=T_(e),{host:o,port:l}=j1(e),u=l===null?"":`:${l}`;r.config.emulator={url:`${i}//${o}${u}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),C1()}function T_(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function j1(t){const e=T_(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:lx(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:lx(o)}}}function lx(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function C1(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zm{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Sr("not implemented")}_getIdTokenResponse(e){return Sr("not implemented")}_linkToIdToken(e,n){return Sr("not implemented")}_getReauthenticationResolver(e){return Sr("not implemented")}}async function R1(t,e){return vr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A1(t,e){return il(t,"POST","/v1/accounts:signInWithPassword",Wr(t,e))}async function P1(t,e){return vr(t,"POST","/v1/accounts:sendOobCode",Wr(t,e))}async function D1(t,e){return P1(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function L1(t,e){return il(t,"POST","/v1/accounts:signInWithEmailLink",Wr(t,e))}async function O1(t,e){return il(t,"POST","/v1/accounts:signInWithEmailLink",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo extends zm{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Bo(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Bo(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return au(e,n,"signInWithPassword",A1);case"emailLink":return L1(e,{email:this._email,oobCode:this._password});default:Jn(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return au(e,r,"signUpPassword",R1);case"emailLink":return O1(e,{idToken:n,email:this._email,oobCode:this._password});default:Jn(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Yi(t,e){return il(t,"POST","/v1/accounts:signInWithIdp",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M1="http://localhost";class si extends zm{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new si(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Jn("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Vm(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new si(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Yi(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Yi(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Yi(e,n)}buildRequest(){const e={requestUri:M1,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=rl(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V1(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function F1(t){const e=Za(eo(t)).link,n=e?Za(eo(e)).deep_link_id:null,r=Za(eo(t)).deep_link_id;return(r?Za(eo(r)).link:null)||r||n||e||t}class Wm{constructor(e){var n,r,s,i,o,l;const u=Za(eo(e)),d=(n=u.apiKey)!==null&&n!==void 0?n:null,h=(r=u.oobCode)!==null&&r!==void 0?r:null,p=V1((s=u.mode)!==null&&s!==void 0?s:null);de(d&&h&&p,"argument-error"),this.apiKey=d,this.operation=p,this.code=h,this.continueUrl=(i=u.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=u.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=F1(e);try{return new Wm(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a{constructor(){this.providerId=_a.PROVIDER_ID}static credential(e,n){return Bo._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=Wm.parseLink(n);return de(r,"argument-error"),Bo._fromEmailAndCode(e,r.code,r.tenantId)}}_a.PROVIDER_ID="password";_a.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_a.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S_{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al extends S_{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ss extends al{constructor(){super("facebook.com")}static credential(e){return si._fromParams({providerId:ss.PROVIDER_ID,signInMethod:ss.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ss.credentialFromTaggedObject(e)}static credentialFromError(e){return ss.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return ss.credential(e.oauthAccessToken)}catch{return null}}}ss.FACEBOOK_SIGN_IN_METHOD="facebook.com";ss.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class is extends al{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return si._fromParams({providerId:is.PROVIDER_ID,signInMethod:is.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return is.credentialFromTaggedObject(e)}static credentialFromError(e){return is.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return is.credential(n,r)}catch{return null}}}is.GOOGLE_SIGN_IN_METHOD="google.com";is.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class as extends al{constructor(){super("github.com")}static credential(e){return si._fromParams({providerId:as.PROVIDER_ID,signInMethod:as.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return as.credentialFromTaggedObject(e)}static credentialFromError(e){return as.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return as.credential(e.oauthAccessToken)}catch{return null}}}as.GITHUB_SIGN_IN_METHOD="github.com";as.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class os extends al{constructor(){super("twitter.com")}static credential(e,n){return si._fromParams({providerId:os.PROVIDER_ID,signInMethod:os.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return os.credentialFromTaggedObject(e)}static credentialFromError(e){return os.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return os.credential(n,r)}catch{return null}}}os.TWITTER_SIGN_IN_METHOD="twitter.com";os.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U1(t,e){return il(t,"POST","/v1/accounts:signUp",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ii{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Ir._fromIdTokenResponse(e,r,s),o=cx(r);return new ii({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=cx(r);return new ii({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function cx(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou extends Vu{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,ou.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new ou(e,n,r,s)}}function I_(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ou._fromErrorAndOperation(t,i,e,r):i})}async function B1(t,e,n=!1){const r=await ia(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return ii._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $1(t,e,n=!1){const{auth:r}=t;if(or(r.app))return Promise.reject(Ar(r));const s="reauthenticate";try{const i=await ia(t,I_(r,s,e,t),n);de(i.idToken,r,"internal-error");const o=Bm(i.idToken);de(o,r,"internal-error");const{sub:l}=o;return de(t.uid===l,r,"user-mismatch"),ii._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Jn(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function j_(t,e,n=!1){if(or(t.app))return Promise.reject(Ar(t));const r="signIn",s=await I_(t,r,e),i=await ii._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function z1(t,e){return j_(Ps(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function C_(t){const e=Ps(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function W1(t,e,n){const r=Ps(t);await au(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",D1)}async function q1(t,e,n){if(or(t.app))return Promise.reject(Ar(t));const r=Ps(t),o=await au(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",U1).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&C_(t),u}),l=await ii._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function H1(t,e,n){return or(t.app)?Promise.reject(Ar(t)):z1(xr(t),_a.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&C_(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function G1(t,e){return vr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K1(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=xr(t),i={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await ia(r,G1(r.auth,i));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;const l=r.providerData.find(({providerId:u})=>u==="password");l&&(l.displayName=r.displayName,l.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function Q1(t,e,n,r){return xr(t).onIdTokenChanged(e,n,r)}function Y1(t,e,n){return xr(t).beforeAuthStateChanged(e,n)}function Tt(t,e,n,r){return xr(t).onAuthStateChanged(e,n,r)}function Bu(t){return xr(t).signOut()}const lu="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R_{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(lu,"1"),this.storage.removeItem(lu),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J1=1e3,X1=10;class A_ extends R_{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=N_(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);f1()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,X1):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},J1)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}A_.type="LOCAL";const Z1=A_;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P_ extends R_{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}P_.type="SESSION";const D_=P_;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $u{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new $u(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async d=>d(n.origin,i)),u=await eC(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:u})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}$u.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qm(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tC{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,u)=>{const d=qm("",20);s.port1.start();const h=setTimeout(()=>{u(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(p){const m=p;if(m.data.eventId===d)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(h),clearTimeout(i),u(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:d,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(){return window}function nC(t){fr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L_(){return typeof fr().WorkerGlobalScope<"u"&&typeof fr().importScripts=="function"}async function rC(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function sC(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function iC(){return L_()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O_="firebaseLocalStorageDb",aC=1,cu="firebaseLocalStorage",M_="fbase_key";class ol{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function zu(t,e){return t.transaction([cu],e?"readwrite":"readonly").objectStore(cu)}function oC(){const t=indexedDB.deleteDatabase(O_);return new ol(t).toPromise()}function pf(){const t=indexedDB.open(O_,aC);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(cu,{keyPath:M_})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(cu)?e(r):(r.close(),await oC(),e(await pf()))})})}async function ux(t,e,n){const r=zu(t,!0).put({[M_]:e,value:n});return new ol(r).toPromise()}async function lC(t,e){const n=zu(t,!1).get(e),r=await new ol(n).toPromise();return r===void 0?null:r.value}function dx(t,e){const n=zu(t,!0).delete(e);return new ol(n).toPromise()}const cC=800,uC=3;class V_{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await pf(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>uC)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return L_()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=$u._getInstance(iC()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await rC(),!this.activeServiceWorker)return;this.sender=new tC(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||sC()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await pf();return await ux(e,lu,"1"),await dx(e,lu),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>ux(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>lC(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>dx(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=zu(s,!1).getAll();return new ol(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),cC)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}V_.type="LOCAL";const dC=V_;new sl(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hC(t,e){return e?jr(e):(de(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hm extends zm{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Yi(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Yi(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Yi(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function fC(t){return j_(t.auth,new Hm(t),t.bypassAuthState)}function mC(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),$1(n,new Hm(t),t.bypassAuthState)}async function pC(t){const{auth:e,user:n}=t;return de(n,e,"internal-error"),B1(n,new Hm(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F_{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(d){this.reject(d)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return fC;case"linkViaPopup":case"linkViaRedirect":return pC;case"reauthViaPopup":case"reauthViaRedirect":return mC;default:Jn(this.auth,"internal-error")}}resolve(e){Ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ur(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gC=new sl(2e3,1e4);class Bi extends F_{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Bi.currentPopupAction&&Bi.currentPopupAction.cancel(),Bi.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return de(e,this.auth,"internal-error"),e}async onExecution(){Ur(this.filter.length===1,"Popup operations only handle one event");const e=qm();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(hr(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(hr(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Bi.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(hr(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,gC.get())};e()}}Bi.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yC="pendingRedirect",Ec=new Map;class xC extends F_{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ec.get(this.auth._key());if(!e){try{const r=await vC(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ec.set(this.auth._key(),e)}return this.bypassAuthState||Ec.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function vC(t,e){const n=bC(e),r=_C(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function wC(t,e){Ec.set(t._key(),e)}function _C(t){return jr(t._redirectPersistence)}function bC(t){return Nc(yC,t.config.apiKey,t.name)}async function NC(t,e,n=!1){if(or(t.app))return Promise.reject(Ar(t));const r=Ps(t),s=hC(r,e),o=await new xC(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EC=10*60*1e3;class kC{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!TC(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!U_(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(hr(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=EC&&this.cachedEventUids.clear(),this.cachedEventUids.has(hx(e))}saveEventToCache(e){this.cachedEventUids.add(hx(e)),this.lastProcessedEventTime=Date.now()}}function hx(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function U_({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function TC(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return U_(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SC(t,e={}){return vr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IC=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,jC=/^https?/;async function CC(t){if(t.config.emulator)return;const{authorizedDomains:e}=await SC(t);for(const n of e)try{if(RC(n))return}catch{}Jn(t,"unauthorized-domain")}function RC(t){const e=ff(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!jC.test(n))return!1;if(IC.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC=new sl(3e4,6e4);function fx(){const t=fr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function PC(t){return new Promise((e,n)=>{var r,s,i;function o(){fx(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{fx(),n(hr(t,"network-request-failed"))},timeout:AC.get()})}if(!((s=(r=fr().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=fr().gapi)===null||i===void 0)&&i.load)o();else{const l=b1("iframefcb");return fr()[l]=()=>{gapi.load?o():n(hr(t,"network-request-failed"))},k_(`${_1()}?onload=${l}`).catch(u=>n(u))}}).catch(e=>{throw kc=null,e})}let kc=null;function DC(t){return kc=kc||PC(t),kc}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LC=new sl(5e3,15e3),OC="__/auth/iframe",MC="emulator/auth/iframe",VC={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},FC=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function UC(t){const e=t.config;de(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?Um(e,MC):`https://${t.config.authDomain}/${OC}`,r={apiKey:e.apiKey,appName:t.name,v:hi},s=FC.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${rl(r).slice(1)}`}async function BC(t){const e=await DC(t),n=fr().gapi;return de(n,t,"internal-error"),e.open({where:document.body,url:UC(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:VC,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=hr(t,"network-request-failed"),l=fr().setTimeout(()=>{i(o)},LC.get());function u(){fr().clearTimeout(l),s(r)}r.ping(u).then(u,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $C={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},zC=500,WC=600,qC="_blank",HC="http://localhost";class mx{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function GC(t,e,n,r=zC,s=WC){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const u=Object.assign(Object.assign({},$C),{width:r.toString(),height:s.toString(),top:i,left:o}),d=sn().toLowerCase();n&&(l=x_(d)?qC:n),g_(d)&&(e=e||HC,u.scrollbars="yes");const h=Object.entries(u).reduce((m,[v,T])=>`${m}${v}=${T},`,"");if(h1(d)&&l!=="_self")return KC(e||"",l),new mx(null);const p=window.open(e||"",l,h);de(p,t,"popup-blocked");try{p.focus()}catch{}return new mx(p)}function KC(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QC="__/auth/handler",YC="emulator/auth/handler",JC=encodeURIComponent("fac");async function px(t,e,n,r,s,i){de(t.config.authDomain,t,"auth-domain-config-required"),de(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:hi,eventId:s};if(e instanceof S_){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",Vj(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,p]of Object.entries({}))o[h]=p}if(e instanceof al){const h=e.getScopes().filter(p=>p!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const u=await t._getAppCheckToken(),d=u?`#${JC}=${encodeURIComponent(u)}`:"";return`${XC(t)}?${rl(l).slice(1)}${d}`}function XC({config:t}){return t.emulator?Um(t,YC):`https://${t.authDomain}/${QC}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rh="webStorageSupport";class ZC{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=D_,this._completeRedirectFn=NC,this._overrideRedirectResult=wC}async _openPopup(e,n,r,s){var i;Ur((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await px(e,n,r,ff(),s);return GC(e,o,qm())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await px(e,n,r,ff(),s);return nC(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Ur(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await BC(e),r=new kC(e);return n.register("authEvent",s=>(de(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(rh,{type:rh},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[rh];o!==void 0&&n(!!o),Jn(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=CC(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return N_()||y_()||$m()}}const eR=ZC;var gx="@firebase/auth",yx="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tR{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){de(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nR(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function rR(t){ri(new Zy("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;de(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const u={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:E_(t)},d=new x1(r,s,i,u);return S1(d,n),d},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),ri(new Zy("auth-internal",e=>{const n=Ps(e.getProvider("auth").getImmediate());return(r=>new tR(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),dr(gx,yx,nR(t)),dr(gx,yx,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sR=5*60,iR=s_("authIdTokenMaxAge")||sR;let xx=null;const aR=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>iR)return;const s=n==null?void 0:n.token;xx!==s&&(xx=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function oR(t=Mm()){const e=Mu(t,"auth");if(e.isInitialized())return e.getImmediate();const n=T1(t,{popupRedirectResolver:eR,persistence:[dC,Z1,D_]}),r=s_("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=aR(i.toString());Y1(n,o,()=>o(n.currentUser)),Q1(n,l=>o(l))}}const s=jj("auth");return s&&I1(n,`http://${s}`),n}function lR(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}v1({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=hr("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",lR().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});rR("Browser");var cR="firebase",uR="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */dr(cR,uR,"app");var vx={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B_=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},dR=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},$_={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,v=d&63;u||(v=64,o||(m=64)),r.push(n[h],n[p],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(B_(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):dR(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||p==null)throw new hR;const m=i<<2|l>>4;if(r.push(m),d!==64){const v=l<<4&240|d>>2;if(r.push(v),p!==64){const T=d<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let hR=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const fR=function(t){const e=B_(t);return $_.encodeByteArray(e,!0)},wx=function(t){return fR(t).replace(/\./g,"")},mR=function(t){try{return $_.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pR(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gR=()=>pR().__FIREBASE_DEFAULTS__,yR=()=>{if(typeof process>"u"||typeof vx>"u")return;const t=vx.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},xR=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&mR(t[1]);return e&&JSON.parse(e)},z_=()=>{try{return gR()||yR()||xR()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},vR=t=>{var e,n;return(n=(e=z_())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},wR=t=>{const e=vR(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _R(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[wx(JSON.stringify(n)),wx(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function NR(){var t;const e=(t=z_())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ER(){return!NR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kR="FirebaseError";let W_=class q_ extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=kR,Object.setPrototypeOf(this,q_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,TR.prototype.create)}},TR=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?SR(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new W_(s,l,r)}};function SR(t,e){return t.replace(IR,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const IR=/\{\$([^}]+)}/g;function Gm(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(_x(i)&&_x(o)){if(!Gm(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function _x(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(t){return t&&t._delegate?t._delegate:t}let jR=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ce;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ce||(Ce={}));const CR={debug:Ce.DEBUG,verbose:Ce.VERBOSE,info:Ce.INFO,warn:Ce.WARN,error:Ce.ERROR,silent:Ce.SILENT},RR=Ce.INFO,AR={[Ce.DEBUG]:"log",[Ce.VERBOSE]:"log",[Ce.INFO]:"info",[Ce.WARN]:"warn",[Ce.ERROR]:"error"},PR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=AR[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class DR{constructor(e){this.name=e,this._logLevel=RR,this._logHandler=PR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ce))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?CR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ce.DEBUG,...e),this._logHandler(this,Ce.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ce.VERBOSE,...e),this._logHandler(this,Ce.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ce.INFO,...e),this._logHandler(this,Ce.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ce.WARN,...e),this._logHandler(this,Ce.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ce.ERROR,...e),this._logHandler(this,Ce.ERROR,...e)}}var bx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Ys,H_;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,x){function E(){}E.prototype=x.prototype,N.D=x.prototype,N.prototype=new E,N.prototype.constructor=N,N.C=function(S,R,P){for(var C=Array(arguments.length-2),he=2;he<arguments.length;he++)C[he-2]=arguments[he];return x.prototype[R].apply(S,C)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(N,x,E){E||(E=0);var S=Array(16);if(typeof x=="string")for(var R=0;16>R;++R)S[R]=x.charCodeAt(E++)|x.charCodeAt(E++)<<8|x.charCodeAt(E++)<<16|x.charCodeAt(E++)<<24;else for(R=0;16>R;++R)S[R]=x[E++]|x[E++]<<8|x[E++]<<16|x[E++]<<24;x=N.g[0],E=N.g[1],R=N.g[2];var P=N.g[3],C=x+(P^E&(R^P))+S[0]+3614090360&4294967295;x=E+(C<<7&4294967295|C>>>25),C=P+(R^x&(E^R))+S[1]+3905402710&4294967295,P=x+(C<<12&4294967295|C>>>20),C=R+(E^P&(x^E))+S[2]+606105819&4294967295,R=P+(C<<17&4294967295|C>>>15),C=E+(x^R&(P^x))+S[3]+3250441966&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(P^E&(R^P))+S[4]+4118548399&4294967295,x=E+(C<<7&4294967295|C>>>25),C=P+(R^x&(E^R))+S[5]+1200080426&4294967295,P=x+(C<<12&4294967295|C>>>20),C=R+(E^P&(x^E))+S[6]+2821735955&4294967295,R=P+(C<<17&4294967295|C>>>15),C=E+(x^R&(P^x))+S[7]+4249261313&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(P^E&(R^P))+S[8]+1770035416&4294967295,x=E+(C<<7&4294967295|C>>>25),C=P+(R^x&(E^R))+S[9]+2336552879&4294967295,P=x+(C<<12&4294967295|C>>>20),C=R+(E^P&(x^E))+S[10]+4294925233&4294967295,R=P+(C<<17&4294967295|C>>>15),C=E+(x^R&(P^x))+S[11]+2304563134&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(P^E&(R^P))+S[12]+1804603682&4294967295,x=E+(C<<7&4294967295|C>>>25),C=P+(R^x&(E^R))+S[13]+4254626195&4294967295,P=x+(C<<12&4294967295|C>>>20),C=R+(E^P&(x^E))+S[14]+2792965006&4294967295,R=P+(C<<17&4294967295|C>>>15),C=E+(x^R&(P^x))+S[15]+1236535329&4294967295,E=R+(C<<22&4294967295|C>>>10),C=x+(R^P&(E^R))+S[1]+4129170786&4294967295,x=E+(C<<5&4294967295|C>>>27),C=P+(E^R&(x^E))+S[6]+3225465664&4294967295,P=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(P^x))+S[11]+643717713&4294967295,R=P+(C<<14&4294967295|C>>>18),C=E+(P^x&(R^P))+S[0]+3921069994&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(R^P&(E^R))+S[5]+3593408605&4294967295,x=E+(C<<5&4294967295|C>>>27),C=P+(E^R&(x^E))+S[10]+38016083&4294967295,P=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(P^x))+S[15]+3634488961&4294967295,R=P+(C<<14&4294967295|C>>>18),C=E+(P^x&(R^P))+S[4]+3889429448&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(R^P&(E^R))+S[9]+568446438&4294967295,x=E+(C<<5&4294967295|C>>>27),C=P+(E^R&(x^E))+S[14]+3275163606&4294967295,P=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(P^x))+S[3]+4107603335&4294967295,R=P+(C<<14&4294967295|C>>>18),C=E+(P^x&(R^P))+S[8]+1163531501&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(R^P&(E^R))+S[13]+2850285829&4294967295,x=E+(C<<5&4294967295|C>>>27),C=P+(E^R&(x^E))+S[2]+4243563512&4294967295,P=x+(C<<9&4294967295|C>>>23),C=R+(x^E&(P^x))+S[7]+1735328473&4294967295,R=P+(C<<14&4294967295|C>>>18),C=E+(P^x&(R^P))+S[12]+2368359562&4294967295,E=R+(C<<20&4294967295|C>>>12),C=x+(E^R^P)+S[5]+4294588738&4294967295,x=E+(C<<4&4294967295|C>>>28),C=P+(x^E^R)+S[8]+2272392833&4294967295,P=x+(C<<11&4294967295|C>>>21),C=R+(P^x^E)+S[11]+1839030562&4294967295,R=P+(C<<16&4294967295|C>>>16),C=E+(R^P^x)+S[14]+4259657740&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(E^R^P)+S[1]+2763975236&4294967295,x=E+(C<<4&4294967295|C>>>28),C=P+(x^E^R)+S[4]+1272893353&4294967295,P=x+(C<<11&4294967295|C>>>21),C=R+(P^x^E)+S[7]+4139469664&4294967295,R=P+(C<<16&4294967295|C>>>16),C=E+(R^P^x)+S[10]+3200236656&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(E^R^P)+S[13]+681279174&4294967295,x=E+(C<<4&4294967295|C>>>28),C=P+(x^E^R)+S[0]+3936430074&4294967295,P=x+(C<<11&4294967295|C>>>21),C=R+(P^x^E)+S[3]+3572445317&4294967295,R=P+(C<<16&4294967295|C>>>16),C=E+(R^P^x)+S[6]+76029189&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(E^R^P)+S[9]+3654602809&4294967295,x=E+(C<<4&4294967295|C>>>28),C=P+(x^E^R)+S[12]+3873151461&4294967295,P=x+(C<<11&4294967295|C>>>21),C=R+(P^x^E)+S[15]+530742520&4294967295,R=P+(C<<16&4294967295|C>>>16),C=E+(R^P^x)+S[2]+3299628645&4294967295,E=R+(C<<23&4294967295|C>>>9),C=x+(R^(E|~P))+S[0]+4096336452&4294967295,x=E+(C<<6&4294967295|C>>>26),C=P+(E^(x|~R))+S[7]+1126891415&4294967295,P=x+(C<<10&4294967295|C>>>22),C=R+(x^(P|~E))+S[14]+2878612391&4294967295,R=P+(C<<15&4294967295|C>>>17),C=E+(P^(R|~x))+S[5]+4237533241&4294967295,E=R+(C<<21&4294967295|C>>>11),C=x+(R^(E|~P))+S[12]+1700485571&4294967295,x=E+(C<<6&4294967295|C>>>26),C=P+(E^(x|~R))+S[3]+2399980690&4294967295,P=x+(C<<10&4294967295|C>>>22),C=R+(x^(P|~E))+S[10]+4293915773&4294967295,R=P+(C<<15&4294967295|C>>>17),C=E+(P^(R|~x))+S[1]+2240044497&4294967295,E=R+(C<<21&4294967295|C>>>11),C=x+(R^(E|~P))+S[8]+1873313359&4294967295,x=E+(C<<6&4294967295|C>>>26),C=P+(E^(x|~R))+S[15]+4264355552&4294967295,P=x+(C<<10&4294967295|C>>>22),C=R+(x^(P|~E))+S[6]+2734768916&4294967295,R=P+(C<<15&4294967295|C>>>17),C=E+(P^(R|~x))+S[13]+1309151649&4294967295,E=R+(C<<21&4294967295|C>>>11),C=x+(R^(E|~P))+S[4]+4149444226&4294967295,x=E+(C<<6&4294967295|C>>>26),C=P+(E^(x|~R))+S[11]+3174756917&4294967295,P=x+(C<<10&4294967295|C>>>22),C=R+(x^(P|~E))+S[2]+718787259&4294967295,R=P+(C<<15&4294967295|C>>>17),C=E+(P^(R|~x))+S[9]+3951481745&4294967295,N.g[0]=N.g[0]+x&4294967295,N.g[1]=N.g[1]+(R+(C<<21&4294967295|C>>>11))&4294967295,N.g[2]=N.g[2]+R&4294967295,N.g[3]=N.g[3]+P&4294967295}r.prototype.u=function(N,x){x===void 0&&(x=N.length);for(var E=x-this.blockSize,S=this.B,R=this.h,P=0;P<x;){if(R==0)for(;P<=E;)s(this,N,P),P+=this.blockSize;if(typeof N=="string"){for(;P<x;)if(S[R++]=N.charCodeAt(P++),R==this.blockSize){s(this,S),R=0;break}}else for(;P<x;)if(S[R++]=N[P++],R==this.blockSize){s(this,S),R=0;break}}this.h=R,this.o+=x},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var x=1;x<N.length-8;++x)N[x]=0;var E=8*this.o;for(x=N.length-8;x<N.length;++x)N[x]=E&255,E/=256;for(this.u(N),N=Array(16),x=E=0;4>x;++x)for(var S=0;32>S;S+=8)N[E++]=this.g[x]>>>S&255;return N};function i(N,x){var E=l;return Object.prototype.hasOwnProperty.call(E,N)?E[N]:E[N]=x(N)}function o(N,x){this.h=x;for(var E=[],S=!0,R=N.length-1;0<=R;R--){var P=N[R]|0;S&&P==x||(E[R]=P,S=!1)}this.g=E}var l={};function u(N){return-128<=N&&128>N?i(N,function(x){return new o([x|0],0>x?-1:0)}):new o([N|0],0>N?-1:0)}function d(N){if(isNaN(N)||!isFinite(N))return p;if(0>N)return I(d(-N));for(var x=[],E=1,S=0;N>=E;S++)x[S]=N/E|0,E*=4294967296;return new o(x,0)}function h(N,x){if(N.length==0)throw Error("number format error: empty string");if(x=x||10,2>x||36<x)throw Error("radix out of range: "+x);if(N.charAt(0)=="-")return I(h(N.substring(1),x));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=d(Math.pow(x,8)),S=p,R=0;R<N.length;R+=8){var P=Math.min(8,N.length-R),C=parseInt(N.substring(R,R+P),x);8>P?(P=d(Math.pow(x,P)),S=S.j(P).add(d(C))):(S=S.j(E),S=S.add(d(C)))}return S}var p=u(0),m=u(1),v=u(16777216);t=o.prototype,t.m=function(){if(j(this))return-I(this).m();for(var N=0,x=1,E=0;E<this.g.length;E++){var S=this.i(E);N+=(0<=S?S:4294967296+S)*x,x*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(T(this))return"0";if(j(this))return"-"+I(this).toString(N);for(var x=d(Math.pow(N,6)),E=this,S="";;){var R=A(E,x).g;E=y(E,R.j(x));var P=((0<E.g.length?E.g[0]:E.h)>>>0).toString(N);if(E=R,T(E))return P+S;for(;6>P.length;)P="0"+P;S=P+S}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function T(N){if(N.h!=0)return!1;for(var x=0;x<N.g.length;x++)if(N.g[x]!=0)return!1;return!0}function j(N){return N.h==-1}t.l=function(N){return N=y(this,N),j(N)?-1:T(N)?0:1};function I(N){for(var x=N.g.length,E=[],S=0;S<x;S++)E[S]=~N.g[S];return new o(E,~N.h).add(m)}t.abs=function(){return j(this)?I(this):this},t.add=function(N){for(var x=Math.max(this.g.length,N.g.length),E=[],S=0,R=0;R<=x;R++){var P=S+(this.i(R)&65535)+(N.i(R)&65535),C=(P>>>16)+(this.i(R)>>>16)+(N.i(R)>>>16);S=C>>>16,P&=65535,C&=65535,E[R]=C<<16|P}return new o(E,E[E.length-1]&-2147483648?-1:0)};function y(N,x){return N.add(I(x))}t.j=function(N){if(T(this)||T(N))return p;if(j(this))return j(N)?I(this).j(I(N)):I(I(this).j(N));if(j(N))return I(this.j(I(N)));if(0>this.l(v)&&0>N.l(v))return d(this.m()*N.m());for(var x=this.g.length+N.g.length,E=[],S=0;S<2*x;S++)E[S]=0;for(S=0;S<this.g.length;S++)for(var R=0;R<N.g.length;R++){var P=this.i(S)>>>16,C=this.i(S)&65535,he=N.i(R)>>>16,Ie=N.i(R)&65535;E[2*S+2*R]+=C*Ie,_(E,2*S+2*R),E[2*S+2*R+1]+=P*Ie,_(E,2*S+2*R+1),E[2*S+2*R+1]+=C*he,_(E,2*S+2*R+1),E[2*S+2*R+2]+=P*he,_(E,2*S+2*R+2)}for(S=0;S<x;S++)E[S]=E[2*S+1]<<16|E[2*S];for(S=x;S<2*x;S++)E[S]=0;return new o(E,0)};function _(N,x){for(;(N[x]&65535)!=N[x];)N[x+1]+=N[x]>>>16,N[x]&=65535,x++}function b(N,x){this.g=N,this.h=x}function A(N,x){if(T(x))throw Error("division by zero");if(T(N))return new b(p,p);if(j(N))return x=A(I(N),x),new b(I(x.g),I(x.h));if(j(x))return x=A(N,I(x)),new b(I(x.g),x.h);if(30<N.g.length){if(j(N)||j(x))throw Error("slowDivide_ only works with positive integers.");for(var E=m,S=x;0>=S.l(N);)E=V(E),S=V(S);var R=M(E,1),P=M(S,1);for(S=M(S,2),E=M(E,2);!T(S);){var C=P.add(S);0>=C.l(N)&&(R=R.add(E),P=C),S=M(S,1),E=M(E,1)}return x=y(N,R.j(x)),new b(R,x)}for(R=p;0<=N.l(x);){for(E=Math.max(1,Math.floor(N.m()/x.m())),S=Math.ceil(Math.log(E)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),P=d(E),C=P.j(x);j(C)||0<C.l(N);)E-=S,P=d(E),C=P.j(x);T(P)&&(P=m),R=R.add(P),N=y(N,C)}return new b(R,N)}t.A=function(N){return A(this,N).h},t.and=function(N){for(var x=Math.max(this.g.length,N.g.length),E=[],S=0;S<x;S++)E[S]=this.i(S)&N.i(S);return new o(E,this.h&N.h)},t.or=function(N){for(var x=Math.max(this.g.length,N.g.length),E=[],S=0;S<x;S++)E[S]=this.i(S)|N.i(S);return new o(E,this.h|N.h)},t.xor=function(N){for(var x=Math.max(this.g.length,N.g.length),E=[],S=0;S<x;S++)E[S]=this.i(S)^N.i(S);return new o(E,this.h^N.h)};function V(N){for(var x=N.g.length+1,E=[],S=0;S<x;S++)E[S]=N.i(S)<<1|N.i(S-1)>>>31;return new o(E,N.h)}function M(N,x){var E=x>>5;x%=32;for(var S=N.g.length-E,R=[],P=0;P<S;P++)R[P]=0<x?N.i(P+E)>>>x|N.i(P+E+1)<<32-x:N.i(P+E);return new o(R,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,H_=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=d,o.fromString=h,Ys=o}).apply(typeof bx<"u"?bx:typeof self<"u"?self:typeof window<"u"?window:{});var nc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var G_,to,K_,Tc,gf,Q_,Y_,J_;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,f,g){return c==Array.prototype||c==Object.prototype||(c[f]=g.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof nc=="object"&&nc];for(var f=0;f<c.length;++f){var g=c[f];if(g&&g.Math==Math)return g}throw Error("Cannot find global object")}var r=n(this);function s(c,f){if(f)e:{var g=r;c=c.split(".");for(var k=0;k<c.length-1;k++){var L=c[k];if(!(L in g))break e;g=g[L]}c=c[c.length-1],k=g[c],f=f(k),f!=k&&f!=null&&e(g,c,{configurable:!0,writable:!0,value:f})}}function i(c,f){c instanceof String&&(c+="");var g=0,k=!1,L={next:function(){if(!k&&g<c.length){var B=g++;return{value:f(B,c[B]),done:!1}}return k=!0,{done:!0,value:void 0}}};return L[Symbol.iterator]=function(){return L},L}s("Array.prototype.values",function(c){return c||function(){return i(this,function(f,g){return g})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(c){var f=typeof c;return f=f!="object"?f:c?Array.isArray(c)?"array":f:"null",f=="array"||f=="object"&&typeof c.length=="number"}function d(c){var f=typeof c;return f=="object"&&c!=null||f=="function"}function h(c,f,g){return c.call.apply(c.bind,arguments)}function p(c,f,g){if(!c)throw Error();if(2<arguments.length){var k=Array.prototype.slice.call(arguments,2);return function(){var L=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(L,k),c.apply(f,L)}}return function(){return c.apply(f,arguments)}}function m(c,f,g){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:p,m.apply(null,arguments)}function v(c,f){var g=Array.prototype.slice.call(arguments,1);return function(){var k=g.slice();return k.push.apply(k,arguments),c.apply(this,k)}}function T(c,f){function g(){}g.prototype=f.prototype,c.aa=f.prototype,c.prototype=new g,c.prototype.constructor=c,c.Qb=function(k,L,B){for(var Q=Array(arguments.length-2),$e=2;$e<arguments.length;$e++)Q[$e-2]=arguments[$e];return f.prototype[L].apply(k,Q)}}function j(c){const f=c.length;if(0<f){const g=Array(f);for(let k=0;k<f;k++)g[k]=c[k];return g}return[]}function I(c,f){for(let g=1;g<arguments.length;g++){const k=arguments[g];if(u(k)){const L=c.length||0,B=k.length||0;c.length=L+B;for(let Q=0;Q<B;Q++)c[L+Q]=k[Q]}else c.push(k)}}class y{constructor(f,g){this.i=f,this.j=g,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function _(c){return/^[\s\xa0]*$/.test(c)}function b(){var c=l.navigator;return c&&(c=c.userAgent)?c:""}function A(c){return A[" "](c),c}A[" "]=function(){};var V=b().indexOf("Gecko")!=-1&&!(b().toLowerCase().indexOf("webkit")!=-1&&b().indexOf("Edge")==-1)&&!(b().indexOf("Trident")!=-1||b().indexOf("MSIE")!=-1)&&b().indexOf("Edge")==-1;function M(c,f,g){for(const k in c)f.call(g,c[k],k,c)}function N(c,f){for(const g in c)f.call(void 0,c[g],g,c)}function x(c){const f={};for(const g in c)f[g]=c[g];return f}const E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(c,f){let g,k;for(let L=1;L<arguments.length;L++){k=arguments[L];for(g in k)c[g]=k[g];for(let B=0;B<E.length;B++)g=E[B],Object.prototype.hasOwnProperty.call(k,g)&&(c[g]=k[g])}}function R(c){var f=1;c=c.split(":");const g=[];for(;0<f&&c.length;)g.push(c.shift()),f--;return c.length&&g.push(c.join(":")),g}function P(c){l.setTimeout(()=>{throw c},0)}function C(){var c=ee;let f=null;return c.g&&(f=c.g,c.g=c.g.next,c.g||(c.h=null),f.next=null),f}class he{constructor(){this.h=this.g=null}add(f,g){const k=Ie.get();k.set(f,g),this.h?this.h.next=k:this.g=k,this.h=k}}var Ie=new y(()=>new Be,c=>c.reset());class Be{constructor(){this.next=this.g=this.h=null}set(f,g){this.h=f,this.g=g,this.next=null}reset(){this.next=this.g=this.h=null}}let Ve,G=!1,ee=new he,X=()=>{const c=l.Promise.resolve(void 0);Ve=()=>{c.then(fe)}};var fe=()=>{for(var c;c=C();){try{c.h.call(c.g)}catch(g){P(g)}var f=Ie;f.j(c),100>f.h&&(f.h++,c.next=f.g,f.g=c)}G=!1};function ae(){this.s=this.s,this.C=this.C}ae.prototype.s=!1,ae.prototype.ma=function(){this.s||(this.s=!0,this.N())},ae.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function q(c,f){this.type=c,this.g=this.target=f,this.defaultPrevented=!1}q.prototype.h=function(){this.defaultPrevented=!0};var oe=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var c=!1,f=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const g=()=>{};l.addEventListener("test",g,f),l.removeEventListener("test",g,f)}catch{}return c}();function pe(c,f){if(q.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var g=this.type=c.type,k=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=f,f=c.relatedTarget){if(V){e:{try{A(f.nodeName);var L=!0;break e}catch{}L=!1}L||(f=null)}}else g=="mouseover"?f=c.fromElement:g=="mouseout"&&(f=c.toElement);this.relatedTarget=f,k?(this.clientX=k.clientX!==void 0?k.clientX:k.pageX,this.clientY=k.clientY!==void 0?k.clientY:k.pageY,this.screenX=k.screenX||0,this.screenY=k.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:O[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&pe.aa.h.call(this)}}T(pe,q);var O={2:"touch",3:"pen",4:"mouse"};pe.prototype.h=function(){pe.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var re="closure_listenable_"+(1e6*Math.random()|0),Ae=0;function z(c,f,g,k,L){this.listener=c,this.proxy=null,this.src=f,this.type=g,this.capture=!!k,this.ha=L,this.key=++Ae,this.da=this.fa=!1}function se(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function we(c){this.src=c,this.g={},this.h=0}we.prototype.add=function(c,f,g,k,L){var B=c.toString();c=this.g[B],c||(c=this.g[B]=[],this.h++);var Q=te(c,f,k,L);return-1<Q?(f=c[Q],g||(f.fa=!1)):(f=new z(f,this.src,B,!!k,L),f.fa=g,c.push(f)),f};function $(c,f){var g=f.type;if(g in c.g){var k=c.g[g],L=Array.prototype.indexOf.call(k,f,void 0),B;(B=0<=L)&&Array.prototype.splice.call(k,L,1),B&&(se(f),c.g[g].length==0&&(delete c.g[g],c.h--))}}function te(c,f,g,k){for(var L=0;L<c.length;++L){var B=c[L];if(!B.da&&B.listener==f&&B.capture==!!g&&B.ha==k)return L}return-1}var ge="closure_lm_"+(1e6*Math.random()|0),Pe={};function pt(c,f,g,k,L){if(Array.isArray(f)){for(var B=0;B<f.length;B++)pt(c,f[B],g,k,L);return null}return g=Rn(g),c&&c[re]?c.K(f,g,d(k)?!!k.capture:!1,L):gt(c,f,g,!1,k,L)}function gt(c,f,g,k,L,B){if(!f)throw Error("Invalid event type");var Q=d(L)?!!L.capture:!!L,$e=Se(c);if($e||(c[ge]=$e=new we(c)),g=$e.add(f,g,k,Q,B),g.proxy)return g;if(k=Bt(),g.proxy=k,k.src=c,k.listener=g,c.addEventListener)oe||(L=Q),L===void 0&&(L=!1),c.addEventListener(f.toString(),k,L);else if(c.attachEvent)c.attachEvent(ye(f.toString()),k);else if(c.addListener&&c.removeListener)c.addListener(k);else throw Error("addEventListener and attachEvent are unavailable.");return g}function Bt(){function c(g){return f.call(c.src,c.listener,g)}const f=De;return c}function F(c,f,g,k,L){if(Array.isArray(f))for(var B=0;B<f.length;B++)F(c,f[B],g,k,L);else k=d(k)?!!k.capture:!!k,g=Rn(g),c&&c[re]?(c=c.i,f=String(f).toString(),f in c.g&&(B=c.g[f],g=te(B,g,k,L),-1<g&&(se(B[g]),Array.prototype.splice.call(B,g,1),B.length==0&&(delete c.g[f],c.h--)))):c&&(c=Se(c))&&(f=c.g[f.toString()],c=-1,f&&(c=te(f,g,k,L)),(g=-1<c?f[c]:null)&&ce(g))}function ce(c){if(typeof c!="number"&&c&&!c.da){var f=c.src;if(f&&f[re])$(f.i,c);else{var g=c.type,k=c.proxy;f.removeEventListener?f.removeEventListener(g,k,c.capture):f.detachEvent?f.detachEvent(ye(g),k):f.addListener&&f.removeListener&&f.removeListener(k),(g=Se(f))?($(g,c),g.h==0&&(g.src=null,f[ge]=null)):se(c)}}}function ye(c){return c in Pe?Pe[c]:Pe[c]="on"+c}function De(c,f){if(c.da)c=!0;else{f=new pe(f,this);var g=c.listener,k=c.ha||c.src;c.fa&&ce(c),c=g.call(k,f)}return c}function Se(c){return c=c[ge],c instanceof we?c:null}var _t="__closure_events_fn_"+(1e9*Math.random()>>>0);function Rn(c){return typeof c=="function"?c:(c[_t]||(c[_t]=function(f){return c.handleEvent(f)}),c[_t])}function ht(){ae.call(this),this.i=new we(this),this.M=this,this.F=null}T(ht,ae),ht.prototype[re]=!0,ht.prototype.removeEventListener=function(c,f,g,k){F(this,c,f,g,k)};function Rt(c,f){var g,k=c.F;if(k)for(g=[];k;k=k.F)g.push(k);if(c=c.M,k=f.type||f,typeof f=="string")f=new q(f,c);else if(f instanceof q)f.target=f.target||c;else{var L=f;f=new q(k,c),S(f,L)}if(L=!0,g)for(var B=g.length-1;0<=B;B--){var Q=f.g=g[B];L=yi(Q,k,!0,f)&&L}if(Q=f.g=c,L=yi(Q,k,!0,f)&&L,L=yi(Q,k,!1,f)&&L,g)for(B=0;B<g.length;B++)Q=f.g=g[B],L=yi(Q,k,!1,f)&&L}ht.prototype.N=function(){if(ht.aa.N.call(this),this.i){var c=this.i,f;for(f in c.g){for(var g=c.g[f],k=0;k<g.length;k++)se(g[k]);delete c.g[f],c.h--}}this.F=null},ht.prototype.K=function(c,f,g,k){return this.i.add(String(c),f,!1,g,k)},ht.prototype.L=function(c,f,g,k){return this.i.add(String(c),f,!0,g,k)};function yi(c,f,g,k){if(f=c.i.g[String(f)],!f)return!0;f=f.concat();for(var L=!0,B=0;B<f.length;++B){var Q=f[B];if(Q&&!Q.da&&Q.capture==g){var $e=Q.listener,Pt=Q.ha||Q.src;Q.fa&&$(c.i,Q),L=$e.call(Pt,k)!==!1&&L}}return L&&!k.defaultPrevented}function xl(c,f,g){if(typeof c=="function")g&&(c=m(c,g));else if(c&&typeof c.handleEvent=="function")c=m(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:l.setTimeout(c,f||0)}function vl(c){c.g=xl(()=>{c.g=null,c.i&&(c.i=!1,vl(c))},c.l);const f=c.h;c.h=null,c.m.apply(null,f)}class ud extends ae{constructor(f,g){super(),this.m=f,this.l=g,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:vl(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ls(c){ae.call(this),this.h=c,this.g={}}T(Ls,ae);var wl=[];function _l(c){M(c.g,function(f,g){this.g.hasOwnProperty(g)&&ce(f)},c),c.g={}}Ls.prototype.N=function(){Ls.aa.N.call(this),_l(this)},Ls.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Ta=l.JSON.stringify,bl=l.JSON.parse,Hr=class{stringify(c){return l.JSON.stringify(c,void 0)}parse(c){return l.JSON.parse(c,void 0)}};function wr(){}wr.prototype.h=null;function Sa(c){return c.h||(c.h=c.i())}function xi(){}var Gr={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function vi(){q.call(this,"d")}T(vi,q);function wi(){q.call(this,"c")}T(wi,q);var nr={},D=null;function be(){return D=D||new ht}nr.La="serverreachability";function Ne(c){q.call(this,nr.La,c)}T(Ne,q);function Ke(c){const f=be();Rt(f,new Ne(f))}nr.STAT_EVENT="statevent";function At(c,f){q.call(this,nr.STAT_EVENT,c),this.stat=f}T(At,q);function Le(c){const f=be();Rt(f,new At(f,c))}nr.Ma="timingevent";function Nl(c,f){q.call(this,nr.Ma,c),this.size=f}T(Nl,q);function Os(c,f){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){c()},f)}function Ms(){this.g=!0}Ms.prototype.xa=function(){this.g=!1};function Bn(c,f,g,k,L,B){c.info(function(){if(c.g)if(B)for(var Q="",$e=B.split("&"),Pt=0;Pt<$e.length;Pt++){var Oe=$e[Pt].split("=");if(1<Oe.length){var $t=Oe[0];Oe=Oe[1];var zt=$t.split("_");Q=2<=zt.length&&zt[1]=="type"?Q+($t+"="+Oe+"&"):Q+($t+"=redacted&")}}else Q=null;else Q=B;return"XMLHTTP REQ ("+k+") [attempt "+L+"]: "+f+`
`+g+`
`+Q})}function $n(c,f,g,k,L,B,Q){c.info(function(){return"XMLHTTP RESP ("+k+") [ attempt "+L+"]: "+f+`
`+g+`
`+B+" "+Q})}function cn(c,f,g,k){c.info(function(){return"XMLHTTP TEXT ("+f+"): "+rr(c,g)+(k?" "+k:"")})}function _i(c,f){c.info(function(){return"TIMEOUT: "+f})}Ms.prototype.info=function(){};function rr(c,f){if(!c.g)return f;if(!f)return null;try{var g=JSON.parse(f);if(g){for(c=0;c<g.length;c++)if(Array.isArray(g[c])){var k=g[c];if(!(2>k.length)){var L=k[1];if(Array.isArray(L)&&!(1>L.length)){var B=L[0];if(B!="noop"&&B!="stop"&&B!="close")for(var Q=1;Q<L.length;Q++)L[Q]=""}}}}return Ta(g)}catch{return f}}var Kr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ia={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},dd;function El(){}T(El,wr),El.prototype.g=function(){return new XMLHttpRequest},El.prototype.i=function(){return{}},dd=new El;function Qr(c,f,g,k){this.j=c,this.i=f,this.l=g,this.R=k||1,this.U=new Ls(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new $p}function $p(){this.i=null,this.g="",this.h=!1}var zp={},hd={};function fd(c,f,g){c.L=1,c.v=Il(_r(f)),c.m=g,c.P=!0,Wp(c,null)}function Wp(c,f){c.F=Date.now(),kl(c),c.A=_r(c.v);var g=c.A,k=c.R;Array.isArray(k)||(k=[String(k)]),sg(g.i,"t",k),c.C=0,g=c.j.J,c.h=new $p,c.g=bg(c.j,g?f:null,!c.m),0<c.O&&(c.M=new ud(m(c.Y,c,c.g),c.O)),f=c.U,g=c.g,k=c.ca;var L="readystatechange";Array.isArray(L)||(L&&(wl[0]=L.toString()),L=wl);for(var B=0;B<L.length;B++){var Q=pt(g,L[B],k||f.handleEvent,!1,f.h||f);if(!Q)break;f.g[Q.key]=Q}f=c.H?x(c.H):{},c.m?(c.u||(c.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,f)):(c.u="GET",c.g.ea(c.A,c.u,null,f)),Ke(),Bn(c.i,c.u,c.A,c.l,c.R,c.m)}Qr.prototype.ca=function(c){c=c.target;const f=this.M;f&&br(c)==3?f.j():this.Y(c)},Qr.prototype.Y=function(c){try{if(c==this.g)e:{const zt=br(this.g);var f=this.g.Ba();const Ei=this.g.Z();if(!(3>zt)&&(zt!=3||this.g&&(this.h.h||this.g.oa()||dg(this.g)))){this.J||zt!=4||f==7||(f==8||0>=Ei?Ke(3):Ke(2)),md(this);var g=this.g.Z();this.X=g;t:if(qp(this)){var k=dg(this.g);c="";var L=k.length,B=br(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Vs(this),ja(this);var Q="";break t}this.h.i=new l.TextDecoder}for(f=0;f<L;f++)this.h.h=!0,c+=this.h.i.decode(k[f],{stream:!(B&&f==L-1)});k.length=0,this.h.g+=c,this.C=0,Q=this.h.g}else Q=this.g.oa();if(this.o=g==200,$n(this.i,this.u,this.A,this.l,this.R,zt,g),this.o){if(this.T&&!this.K){t:{if(this.g){var $e,Pt=this.g;if(($e=Pt.g?Pt.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_($e)){var Oe=$e;break t}}Oe=null}if(g=Oe)cn(this.i,this.l,g,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,pd(this,g);else{this.o=!1,this.s=3,Le(12),Vs(this),ja(this);break e}}if(this.P){g=!0;let zn;for(;!this.J&&this.C<Q.length;)if(zn=ON(this,Q),zn==hd){zt==4&&(this.s=4,Le(14),g=!1),cn(this.i,this.l,null,"[Incomplete Response]");break}else if(zn==zp){this.s=4,Le(15),cn(this.i,this.l,Q,"[Invalid Chunk]"),g=!1;break}else cn(this.i,this.l,zn,null),pd(this,zn);if(qp(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),zt!=4||Q.length!=0||this.h.h||(this.s=1,Le(16),g=!1),this.o=this.o&&g,!g)cn(this.i,this.l,Q,"[Invalid Chunked Response]"),Vs(this),ja(this);else if(0<Q.length&&!this.W){this.W=!0;var $t=this.j;$t.g==this&&$t.ba&&!$t.M&&($t.j.info("Great, no buffering proxy detected. Bytes received: "+Q.length),_d($t),$t.M=!0,Le(11))}}else cn(this.i,this.l,Q,null),pd(this,Q);zt==4&&Vs(this),this.o&&!this.J&&(zt==4?xg(this.j,this):(this.o=!1,kl(this)))}else ZN(this.g),g==400&&0<Q.indexOf("Unknown SID")?(this.s=3,Le(12)):(this.s=0,Le(13)),Vs(this),ja(this)}}}catch{}finally{}};function qp(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function ON(c,f){var g=c.C,k=f.indexOf(`
`,g);return k==-1?hd:(g=Number(f.substring(g,k)),isNaN(g)?zp:(k+=1,k+g>f.length?hd:(f=f.slice(k,k+g),c.C=k+g,f)))}Qr.prototype.cancel=function(){this.J=!0,Vs(this)};function kl(c){c.S=Date.now()+c.I,Hp(c,c.I)}function Hp(c,f){if(c.B!=null)throw Error("WatchDog timer not null");c.B=Os(m(c.ba,c),f)}function md(c){c.B&&(l.clearTimeout(c.B),c.B=null)}Qr.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(_i(this.i,this.A),this.L!=2&&(Ke(),Le(17)),Vs(this),this.s=2,ja(this)):Hp(this,this.S-c)};function ja(c){c.j.G==0||c.J||xg(c.j,c)}function Vs(c){md(c);var f=c.M;f&&typeof f.ma=="function"&&f.ma(),c.M=null,_l(c.U),c.g&&(f=c.g,c.g=null,f.abort(),f.ma())}function pd(c,f){try{var g=c.j;if(g.G!=0&&(g.g==c||gd(g.h,c))){if(!c.K&&gd(g.h,c)&&g.G==3){try{var k=g.Da.g.parse(f)}catch{k=null}if(Array.isArray(k)&&k.length==3){var L=k;if(L[0]==0){e:if(!g.u){if(g.g)if(g.g.F+3e3<c.F)Dl(g),Al(g);else break e;wd(g),Le(18)}}else g.za=L[1],0<g.za-g.T&&37500>L[2]&&g.F&&g.v==0&&!g.C&&(g.C=Os(m(g.Za,g),6e3));if(1>=Qp(g.h)&&g.ca){try{g.ca()}catch{}g.ca=void 0}}else Us(g,11)}else if((c.K||g.g==c)&&Dl(g),!_(f))for(L=g.Da.g.parse(f),f=0;f<L.length;f++){let Oe=L[f];if(g.T=Oe[0],Oe=Oe[1],g.G==2)if(Oe[0]=="c"){g.K=Oe[1],g.ia=Oe[2];const $t=Oe[3];$t!=null&&(g.la=$t,g.j.info("VER="+g.la));const zt=Oe[4];zt!=null&&(g.Aa=zt,g.j.info("SVER="+g.Aa));const Ei=Oe[5];Ei!=null&&typeof Ei=="number"&&0<Ei&&(k=1.5*Ei,g.L=k,g.j.info("backChannelRequestTimeoutMs_="+k)),k=g;const zn=c.g;if(zn){const Ol=zn.g?zn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Ol){var B=k.h;B.g||Ol.indexOf("spdy")==-1&&Ol.indexOf("quic")==-1&&Ol.indexOf("h2")==-1||(B.j=B.l,B.g=new Set,B.h&&(yd(B,B.h),B.h=null))}if(k.D){const bd=zn.g?zn.g.getResponseHeader("X-HTTP-Session-Id"):null;bd&&(k.ya=bd,Qe(k.I,k.D,bd))}}g.G=3,g.l&&g.l.ua(),g.ba&&(g.R=Date.now()-c.F,g.j.info("Handshake RTT: "+g.R+"ms")),k=g;var Q=c;if(k.qa=_g(k,k.J?k.ia:null,k.W),Q.K){Yp(k.h,Q);var $e=Q,Pt=k.L;Pt&&($e.I=Pt),$e.B&&(md($e),kl($e)),k.g=Q}else gg(k);0<g.i.length&&Pl(g)}else Oe[0]!="stop"&&Oe[0]!="close"||Us(g,7);else g.G==3&&(Oe[0]=="stop"||Oe[0]=="close"?Oe[0]=="stop"?Us(g,7):vd(g):Oe[0]!="noop"&&g.l&&g.l.ta(Oe),g.v=0)}}Ke(4)}catch{}}var MN=class{constructor(c,f){this.g=c,this.map=f}};function Gp(c){this.l=c||10,l.PerformanceNavigationTiming?(c=l.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Kp(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Qp(c){return c.h?1:c.g?c.g.size:0}function gd(c,f){return c.h?c.h==f:c.g?c.g.has(f):!1}function yd(c,f){c.g?c.g.add(f):c.h=f}function Yp(c,f){c.h&&c.h==f?c.h=null:c.g&&c.g.has(f)&&c.g.delete(f)}Gp.prototype.cancel=function(){if(this.i=Jp(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Jp(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let f=c.i;for(const g of c.g.values())f=f.concat(g.D);return f}return j(c.i)}function VN(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(u(c)){for(var f=[],g=c.length,k=0;k<g;k++)f.push(c[k]);return f}f=[],g=0;for(k in c)f[g++]=c[k];return f}function FN(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(u(c)||typeof c=="string"){var f=[];c=c.length;for(var g=0;g<c;g++)f.push(g);return f}f=[],g=0;for(const k in c)f[g++]=k;return f}}}function Xp(c,f){if(c.forEach&&typeof c.forEach=="function")c.forEach(f,void 0);else if(u(c)||typeof c=="string")Array.prototype.forEach.call(c,f,void 0);else for(var g=FN(c),k=VN(c),L=k.length,B=0;B<L;B++)f.call(void 0,k[B],g&&g[B],c)}var Zp=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function UN(c,f){if(c){c=c.split("&");for(var g=0;g<c.length;g++){var k=c[g].indexOf("="),L=null;if(0<=k){var B=c[g].substring(0,k);L=c[g].substring(k+1)}else B=c[g];f(B,L?decodeURIComponent(L.replace(/\+/g," ")):"")}}}function Fs(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Fs){this.h=c.h,Tl(this,c.j),this.o=c.o,this.g=c.g,Sl(this,c.s),this.l=c.l;var f=c.i,g=new Aa;g.i=f.i,f.g&&(g.g=new Map(f.g),g.h=f.h),eg(this,g),this.m=c.m}else c&&(f=String(c).match(Zp))?(this.h=!1,Tl(this,f[1]||"",!0),this.o=Ca(f[2]||""),this.g=Ca(f[3]||"",!0),Sl(this,f[4]),this.l=Ca(f[5]||"",!0),eg(this,f[6]||"",!0),this.m=Ca(f[7]||"")):(this.h=!1,this.i=new Aa(null,this.h))}Fs.prototype.toString=function(){var c=[],f=this.j;f&&c.push(Ra(f,tg,!0),":");var g=this.g;return(g||f=="file")&&(c.push("//"),(f=this.o)&&c.push(Ra(f,tg,!0),"@"),c.push(encodeURIComponent(String(g)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),g=this.s,g!=null&&c.push(":",String(g))),(g=this.l)&&(this.g&&g.charAt(0)!="/"&&c.push("/"),c.push(Ra(g,g.charAt(0)=="/"?zN:$N,!0))),(g=this.i.toString())&&c.push("?",g),(g=this.m)&&c.push("#",Ra(g,qN)),c.join("")};function _r(c){return new Fs(c)}function Tl(c,f,g){c.j=g?Ca(f,!0):f,c.j&&(c.j=c.j.replace(/:$/,""))}function Sl(c,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);c.s=f}else c.s=null}function eg(c,f,g){f instanceof Aa?(c.i=f,HN(c.i,c.h)):(g||(f=Ra(f,WN)),c.i=new Aa(f,c.h))}function Qe(c,f,g){c.i.set(f,g)}function Il(c){return Qe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function Ca(c,f){return c?f?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function Ra(c,f,g){return typeof c=="string"?(c=encodeURI(c).replace(f,BN),g&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function BN(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var tg=/[#\/\?@]/g,$N=/[#\?:]/g,zN=/[#\?]/g,WN=/[#\?@]/g,qN=/#/g;function Aa(c,f){this.h=this.g=null,this.i=c||null,this.j=!!f}function Yr(c){c.g||(c.g=new Map,c.h=0,c.i&&UN(c.i,function(f,g){c.add(decodeURIComponent(f.replace(/\+/g," ")),g)}))}t=Aa.prototype,t.add=function(c,f){Yr(this),this.i=null,c=bi(this,c);var g=this.g.get(c);return g||this.g.set(c,g=[]),g.push(f),this.h+=1,this};function ng(c,f){Yr(c),f=bi(c,f),c.g.has(f)&&(c.i=null,c.h-=c.g.get(f).length,c.g.delete(f))}function rg(c,f){return Yr(c),f=bi(c,f),c.g.has(f)}t.forEach=function(c,f){Yr(this),this.g.forEach(function(g,k){g.forEach(function(L){c.call(f,L,k,this)},this)},this)},t.na=function(){Yr(this);const c=Array.from(this.g.values()),f=Array.from(this.g.keys()),g=[];for(let k=0;k<f.length;k++){const L=c[k];for(let B=0;B<L.length;B++)g.push(f[k])}return g},t.V=function(c){Yr(this);let f=[];if(typeof c=="string")rg(this,c)&&(f=f.concat(this.g.get(bi(this,c))));else{c=Array.from(this.g.values());for(let g=0;g<c.length;g++)f=f.concat(c[g])}return f},t.set=function(c,f){return Yr(this),this.i=null,c=bi(this,c),rg(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[f]),this.h+=1,this},t.get=function(c,f){return c?(c=this.V(c),0<c.length?String(c[0]):f):f};function sg(c,f,g){ng(c,f),0<g.length&&(c.i=null,c.g.set(bi(c,f),j(g)),c.h+=g.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],f=Array.from(this.g.keys());for(var g=0;g<f.length;g++){var k=f[g];const B=encodeURIComponent(String(k)),Q=this.V(k);for(k=0;k<Q.length;k++){var L=B;Q[k]!==""&&(L+="="+encodeURIComponent(String(Q[k]))),c.push(L)}}return this.i=c.join("&")};function bi(c,f){return f=String(f),c.j&&(f=f.toLowerCase()),f}function HN(c,f){f&&!c.j&&(Yr(c),c.i=null,c.g.forEach(function(g,k){var L=k.toLowerCase();k!=L&&(ng(this,k),sg(this,L,g))},c)),c.j=f}function GN(c,f){const g=new Ms;if(l.Image){const k=new Image;k.onload=v(Jr,g,"TestLoadImage: loaded",!0,f,k),k.onerror=v(Jr,g,"TestLoadImage: error",!1,f,k),k.onabort=v(Jr,g,"TestLoadImage: abort",!1,f,k),k.ontimeout=v(Jr,g,"TestLoadImage: timeout",!1,f,k),l.setTimeout(function(){k.ontimeout&&k.ontimeout()},1e4),k.src=c}else f(!1)}function KN(c,f){const g=new Ms,k=new AbortController,L=setTimeout(()=>{k.abort(),Jr(g,"TestPingServer: timeout",!1,f)},1e4);fetch(c,{signal:k.signal}).then(B=>{clearTimeout(L),B.ok?Jr(g,"TestPingServer: ok",!0,f):Jr(g,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(L),Jr(g,"TestPingServer: error",!1,f)})}function Jr(c,f,g,k,L){try{L&&(L.onload=null,L.onerror=null,L.onabort=null,L.ontimeout=null),k(g)}catch{}}function QN(){this.g=new Hr}function YN(c,f,g){const k=g||"";try{Xp(c,function(L,B){let Q=L;d(L)&&(Q=Ta(L)),f.push(k+B+"="+encodeURIComponent(Q))})}catch(L){throw f.push(k+"type="+encodeURIComponent("_badmap")),L}}function jl(c){this.l=c.Ub||null,this.j=c.eb||!1}T(jl,wr),jl.prototype.g=function(){return new Cl(this.l,this.j)},jl.prototype.i=function(c){return function(){return c}}({});function Cl(c,f){ht.call(this),this.D=c,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}T(Cl,ht),t=Cl.prototype,t.open=function(c,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=f,this.readyState=1,Da(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(f.body=c),(this.D||l).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Pa(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,Da(this)),this.g&&(this.readyState=3,Da(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;ig(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function ig(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var f=c.value?c.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!c.done}))&&(this.response=this.responseText+=f)}c.done?Pa(this):Da(this),this.readyState==3&&ig(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,Pa(this))},t.Qa=function(c){this.g&&(this.response=c,Pa(this))},t.ga=function(){this.g&&Pa(this)};function Pa(c){c.readyState=4,c.l=null,c.j=null,c.v=null,Da(c)}t.setRequestHeader=function(c,f){this.u.append(c,f)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],f=this.h.entries();for(var g=f.next();!g.done;)g=g.value,c.push(g[0]+": "+g[1]),g=f.next();return c.join(`\r
`)};function Da(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Cl.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function ag(c){let f="";return M(c,function(g,k){f+=k,f+=":",f+=g,f+=`\r
`}),f}function xd(c,f,g){e:{for(k in g){var k=!1;break e}k=!0}k||(g=ag(g),typeof c=="string"?g!=null&&encodeURIComponent(String(g)):Qe(c,f,g))}function ot(c){ht.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}T(ot,ht);var JN=/^https?$/i,XN=["POST","PUT"];t=ot.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,f,g,k){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);f=f?f.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():dd.g(),this.v=this.o?Sa(this.o):Sa(dd),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(f,String(c),!0),this.B=!1}catch(B){og(this,B);return}if(c=g||"",g=new Map(this.headers),k)if(Object.getPrototypeOf(k)===Object.prototype)for(var L in k)g.set(L,k[L]);else if(typeof k.keys=="function"&&typeof k.get=="function")for(const B of k.keys())g.set(B,k.get(B));else throw Error("Unknown input type for opt_headers: "+String(k));k=Array.from(g.keys()).find(B=>B.toLowerCase()=="content-type"),L=l.FormData&&c instanceof l.FormData,!(0<=Array.prototype.indexOf.call(XN,f,void 0))||k||L||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[B,Q]of g)this.g.setRequestHeader(B,Q);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ug(this),this.u=!0,this.g.send(c),this.u=!1}catch(B){og(this,B)}};function og(c,f){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=f,c.m=5,lg(c),Rl(c)}function lg(c){c.A||(c.A=!0,Rt(c,"complete"),Rt(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,Rt(this,"complete"),Rt(this,"abort"),Rl(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Rl(this,!0)),ot.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?cg(this):this.bb())},t.bb=function(){cg(this)};function cg(c){if(c.h&&typeof o<"u"&&(!c.v[1]||br(c)!=4||c.Z()!=2)){if(c.u&&br(c)==4)xl(c.Ea,0,c);else if(Rt(c,"readystatechange"),br(c)==4){c.h=!1;try{const Q=c.Z();e:switch(Q){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break e;default:f=!1}var g;if(!(g=f)){var k;if(k=Q===0){var L=String(c.D).match(Zp)[1]||null;!L&&l.self&&l.self.location&&(L=l.self.location.protocol.slice(0,-1)),k=!JN.test(L?L.toLowerCase():"")}g=k}if(g)Rt(c,"complete"),Rt(c,"success");else{c.m=6;try{var B=2<br(c)?c.g.statusText:""}catch{B=""}c.l=B+" ["+c.Z()+"]",lg(c)}}finally{Rl(c)}}}}function Rl(c,f){if(c.g){ug(c);const g=c.g,k=c.v[0]?()=>{}:null;c.g=null,c.v=null,f||Rt(c,"ready");try{g.onreadystatechange=k}catch{}}}function ug(c){c.I&&(l.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function br(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<br(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var f=this.g.responseText;return c&&f.indexOf(c)==0&&(f=f.substring(c.length)),bl(f)}};function dg(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function ZN(c){const f={};c=(c.g&&2<=br(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let k=0;k<c.length;k++){if(_(c[k]))continue;var g=R(c[k]);const L=g[0];if(g=g[1],typeof g!="string")continue;g=g.trim();const B=f[L]||[];f[L]=B,B.push(g)}N(f,function(k){return k.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function La(c,f,g){return g&&g.internalChannelParams&&g.internalChannelParams[c]||f}function hg(c){this.Aa=0,this.i=[],this.j=new Ms,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=La("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=La("baseRetryDelayMs",5e3,c),this.cb=La("retryDelaySeedMs",1e4,c),this.Wa=La("forwardChannelMaxRetries",2,c),this.wa=La("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new Gp(c&&c.concurrentRequestLimit),this.Da=new QN,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=hg.prototype,t.la=8,t.G=1,t.connect=function(c,f,g,k){Le(0),this.W=c,this.H=f||{},g&&k!==void 0&&(this.H.OSID=g,this.H.OAID=k),this.F=this.X,this.I=_g(this,null,this.W),Pl(this)};function vd(c){if(fg(c),c.G==3){var f=c.U++,g=_r(c.I);if(Qe(g,"SID",c.K),Qe(g,"RID",f),Qe(g,"TYPE","terminate"),Oa(c,g),f=new Qr(c,c.j,f),f.L=2,f.v=Il(_r(g)),g=!1,l.navigator&&l.navigator.sendBeacon)try{g=l.navigator.sendBeacon(f.v.toString(),"")}catch{}!g&&l.Image&&(new Image().src=f.v,g=!0),g||(f.g=bg(f.j,null),f.g.ea(f.v)),f.F=Date.now(),kl(f)}wg(c)}function Al(c){c.g&&(_d(c),c.g.cancel(),c.g=null)}function fg(c){Al(c),c.u&&(l.clearTimeout(c.u),c.u=null),Dl(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&l.clearTimeout(c.s),c.s=null)}function Pl(c){if(!Kp(c.h)&&!c.s){c.s=!0;var f=c.Ga;Ve||X(),G||(Ve(),G=!0),ee.add(f,c),c.B=0}}function eE(c,f){return Qp(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=f.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=Os(m(c.Ga,c,f),vg(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const L=new Qr(this,this.j,c);let B=this.o;if(this.S&&(B?(B=x(B),S(B,this.S)):B=this.S),this.m!==null||this.O||(L.H=B,B=null),this.P)e:{for(var f=0,g=0;g<this.i.length;g++){t:{var k=this.i[g];if("__data__"in k.map&&(k=k.map.__data__,typeof k=="string")){k=k.length;break t}k=void 0}if(k===void 0)break;if(f+=k,4096<f){f=g;break e}if(f===4096||g===this.i.length-1){f=g+1;break e}}f=1e3}else f=1e3;f=pg(this,L,f),g=_r(this.I),Qe(g,"RID",c),Qe(g,"CVER",22),this.D&&Qe(g,"X-HTTP-Session-Id",this.D),Oa(this,g),B&&(this.O?f="headers="+encodeURIComponent(String(ag(B)))+"&"+f:this.m&&xd(g,this.m,B)),yd(this.h,L),this.Ua&&Qe(g,"TYPE","init"),this.P?(Qe(g,"$req",f),Qe(g,"SID","null"),L.T=!0,fd(L,g,null)):fd(L,g,f),this.G=2}}else this.G==3&&(c?mg(this,c):this.i.length==0||Kp(this.h)||mg(this))};function mg(c,f){var g;f?g=f.l:g=c.U++;const k=_r(c.I);Qe(k,"SID",c.K),Qe(k,"RID",g),Qe(k,"AID",c.T),Oa(c,k),c.m&&c.o&&xd(k,c.m,c.o),g=new Qr(c,c.j,g,c.B+1),c.m===null&&(g.H=c.o),f&&(c.i=f.D.concat(c.i)),f=pg(c,g,1e3),g.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),yd(c.h,g),fd(g,k,f)}function Oa(c,f){c.H&&M(c.H,function(g,k){Qe(f,k,g)}),c.l&&Xp({},function(g,k){Qe(f,k,g)})}function pg(c,f,g){g=Math.min(c.i.length,g);var k=c.l?m(c.l.Na,c.l,c):null;e:{var L=c.i;let B=-1;for(;;){const Q=["count="+g];B==-1?0<g?(B=L[0].g,Q.push("ofs="+B)):B=0:Q.push("ofs="+B);let $e=!0;for(let Pt=0;Pt<g;Pt++){let Oe=L[Pt].g;const $t=L[Pt].map;if(Oe-=B,0>Oe)B=Math.max(0,L[Pt].g-100),$e=!1;else try{YN($t,Q,"req"+Oe+"_")}catch{k&&k($t)}}if($e){k=Q.join("&");break e}}}return c=c.i.splice(0,g),f.D=c,k}function gg(c){if(!c.g&&!c.u){c.Y=1;var f=c.Fa;Ve||X(),G||(Ve(),G=!0),ee.add(f,c),c.v=0}}function wd(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=Os(m(c.Fa,c),vg(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,yg(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=Os(m(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Le(10),Al(this),yg(this))};function _d(c){c.A!=null&&(l.clearTimeout(c.A),c.A=null)}function yg(c){c.g=new Qr(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var f=_r(c.qa);Qe(f,"RID","rpc"),Qe(f,"SID",c.K),Qe(f,"AID",c.T),Qe(f,"CI",c.F?"0":"1"),!c.F&&c.ja&&Qe(f,"TO",c.ja),Qe(f,"TYPE","xmlhttp"),Oa(c,f),c.m&&c.o&&xd(f,c.m,c.o),c.L&&(c.g.I=c.L);var g=c.g;c=c.ia,g.L=1,g.v=Il(_r(f)),g.m=null,g.P=!0,Wp(g,c)}t.Za=function(){this.C!=null&&(this.C=null,Al(this),wd(this),Le(19))};function Dl(c){c.C!=null&&(l.clearTimeout(c.C),c.C=null)}function xg(c,f){var g=null;if(c.g==f){Dl(c),_d(c),c.g=null;var k=2}else if(gd(c.h,f))g=f.D,Yp(c.h,f),k=1;else return;if(c.G!=0){if(f.o)if(k==1){g=f.m?f.m.length:0,f=Date.now()-f.F;var L=c.B;k=be(),Rt(k,new Nl(k,g)),Pl(c)}else gg(c);else if(L=f.s,L==3||L==0&&0<f.X||!(k==1&&eE(c,f)||k==2&&wd(c)))switch(g&&0<g.length&&(f=c.h,f.i=f.i.concat(g)),L){case 1:Us(c,5);break;case 4:Us(c,10);break;case 3:Us(c,6);break;default:Us(c,2)}}}function vg(c,f){let g=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(g*=2),g*f}function Us(c,f){if(c.j.info("Error code "+f),f==2){var g=m(c.fb,c),k=c.Xa;const L=!k;k=new Fs(k||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Tl(k,"https"),Il(k),L?GN(k.toString(),g):KN(k.toString(),g)}else Le(2);c.G=0,c.l&&c.l.sa(f),wg(c),fg(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),Le(2)):(this.j.info("Failed to ping google.com"),Le(1))};function wg(c){if(c.G=0,c.ka=[],c.l){const f=Jp(c.h);(f.length!=0||c.i.length!=0)&&(I(c.ka,f),I(c.ka,c.i),c.h.i.length=0,j(c.i),c.i.length=0),c.l.ra()}}function _g(c,f,g){var k=g instanceof Fs?_r(g):new Fs(g);if(k.g!="")f&&(k.g=f+"."+k.g),Sl(k,k.s);else{var L=l.location;k=L.protocol,f=f?f+"."+L.hostname:L.hostname,L=+L.port;var B=new Fs(null);k&&Tl(B,k),f&&(B.g=f),L&&Sl(B,L),g&&(B.l=g),k=B}return g=c.D,f=c.ya,g&&f&&Qe(k,g,f),Qe(k,"VER",c.la),Oa(c,k),k}function bg(c,f,g){if(f&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=c.Ca&&!c.pa?new ot(new jl({eb:g})):new ot(c.pa),f.Ha(c.J),f}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ng(){}t=Ng.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Ll(){}Ll.prototype.g=function(c,f){return new yn(c,f)};function yn(c,f){ht.call(this),this.g=new hg(f),this.l=c,this.h=f&&f.messageUrlParams||null,c=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(c?c["X-WebChannel-Content-Type"]=f.messageContentType:c={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(c?c["X-WebChannel-Client-Profile"]=f.va:c={"X-WebChannel-Client-Profile":f.va}),this.g.S=c,(c=f&&f.Sb)&&!_(c)&&(this.g.m=c),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!_(f)&&(this.g.D=f,c=this.h,c!==null&&f in c&&(c=this.h,f in c&&delete c[f])),this.j=new Ni(this)}T(yn,ht),yn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},yn.prototype.close=function(){vd(this.g)},yn.prototype.o=function(c){var f=this.g;if(typeof c=="string"){var g={};g.__data__=c,c=g}else this.u&&(g={},g.__data__=Ta(c),c=g);f.i.push(new MN(f.Ya++,c)),f.G==3&&Pl(f)},yn.prototype.N=function(){this.g.l=null,delete this.j,vd(this.g),delete this.g,yn.aa.N.call(this)};function Eg(c){vi.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var f=c.__sm__;if(f){e:{for(const g in f){c=g;break e}c=void 0}(this.i=c)&&(c=this.i,f=f!==null&&c in f?f[c]:void 0),this.data=f}else this.data=c}T(Eg,vi);function kg(){wi.call(this),this.status=1}T(kg,wi);function Ni(c){this.g=c}T(Ni,Ng),Ni.prototype.ua=function(){Rt(this.g,"a")},Ni.prototype.ta=function(c){Rt(this.g,new Eg(c))},Ni.prototype.sa=function(c){Rt(this.g,new kg)},Ni.prototype.ra=function(){Rt(this.g,"b")},Ll.prototype.createWebChannel=Ll.prototype.g,yn.prototype.send=yn.prototype.o,yn.prototype.open=yn.prototype.m,yn.prototype.close=yn.prototype.close,J_=function(){return new Ll},Y_=function(){return be()},Q_=nr,gf={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Kr.NO_ERROR=0,Kr.TIMEOUT=8,Kr.HTTP_ERROR=6,Tc=Kr,Ia.COMPLETE="complete",K_=Ia,xi.EventType=Gr,Gr.OPEN="a",Gr.CLOSE="b",Gr.ERROR="c",Gr.MESSAGE="d",ht.prototype.listen=ht.prototype.K,to=xi,ot.prototype.listenOnce=ot.prototype.L,ot.prototype.getLastError=ot.prototype.Ka,ot.prototype.getLastErrorCode=ot.prototype.Ba,ot.prototype.getStatus=ot.prototype.Z,ot.prototype.getResponseJson=ot.prototype.Oa,ot.prototype.getResponseText=ot.prototype.oa,ot.prototype.send=ot.prototype.ea,ot.prototype.setWithCredentials=ot.prototype.Ha,G_=ot}).apply(typeof nc<"u"?nc:typeof self<"u"?self:typeof window<"u"?window:{});const Nx="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gt{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Gt.UNAUTHENTICATED=new Gt(null),Gt.GOOGLE_CREDENTIALS=new Gt("google-credentials-uid"),Gt.FIRST_PARTY=new Gt("first-party-uid"),Gt.MOCK_USER=new Gt("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ba="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ai=new DR("@firebase/firestore");function Ha(){return ai.logLevel}function ne(t,...e){if(ai.logLevel<=Ce.DEBUG){const n=e.map(Km);ai.debug(`Firestore (${ba}): ${t}`,...n)}}function Br(t,...e){if(ai.logLevel<=Ce.ERROR){const n=e.map(Km);ai.error(`Firestore (${ba}): ${t}`,...n)}}function aa(t,...e){if(ai.logLevel<=Ce.WARN){const n=e.map(Km);ai.warn(`Firestore (${ba}): ${t}`,...n)}}function Km(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function me(t="Unexpected state"){const e=`FIRESTORE (${ba}) INTERNAL ASSERTION FAILED: `+t;throw Br(e),new Error(e)}function Ue(t,e){t||me()}function ve(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class J extends W_{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class LR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Gt.UNAUTHENTICATED))}shutdown(){}}class OR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class MR{constructor(e){this.t=e,this.currentUser=Gt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ue(this.o===void 0);let r=this.i;const s=u=>this.i!==r?(r=this.i,n(u)):Promise.resolve();let i=new Pr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new Pr,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const u=i;e.enqueueRetryable(async()=>{await u.promise,await s(this.currentUser)})},l=u=>{ne("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(ne("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new Pr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ne("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ue(typeof r.accessToken=="string"),new X_(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ue(e===null||typeof e=="string"),new Gt(e)}}class VR{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Gt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class FR{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new VR(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Gt.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class UR{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class BR{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Ue(this.o===void 0);const r=i=>{i.error!=null&&ne("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,ne("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{ne("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):ne("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ue(typeof n.token=="string"),this.R=n.token,new UR(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $R(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z_{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=$R(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Me(t,e){return t<e?-1:t>e?1:0}function oa(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kt{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new J(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new J(W.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new J(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new J(W.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return kt.fromMillis(Date.now())}static fromDate(e){return kt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new kt(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Me(this.nanoseconds,e.nanoseconds):Me(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xe{constructor(e){this.timestamp=e}static fromTimestamp(e){return new xe(e)}static min(){return new xe(new kt(0,0))}static max(){return new xe(new kt(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $o{constructor(e,n,r){n===void 0?n=0:n>e.length&&me(),r===void 0?r=e.length-n:r>e.length-n&&me(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return $o.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof $o?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),o=n.get(s);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class Xe extends $o{construct(e,n,r){return new Xe(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new J(W.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Xe(n)}static emptyPath(){return new Xe([])}}const zR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ot extends $o{construct(e,n,r){return new Ot(e,n,r)}static isValidIdentifier(e){return zR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ot.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new Ot(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new J(W.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new J(W.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[s+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new J(W.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=u,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new J(W.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ot(n)}static emptyPath(){return new Ot([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class le{constructor(e){this.path=e}static fromPath(e){return new le(Xe.fromString(e))}static fromName(e){return new le(Xe.fromString(e).popFirst(5))}static empty(){return new le(Xe.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Xe.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Xe.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new le(new Xe(e.slice()))}}function WR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=xe.fromTimestamp(r===1e9?new kt(n+1,0):new kt(n,r));return new ks(s,le.empty(),e)}function qR(t){return new ks(t.readTime,t.key,-1)}class ks{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ks(xe.min(),le.empty(),-1)}static max(){return new ks(xe.max(),le.empty(),-1)}}function HR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=le.comparator(t.documentKey,e.documentKey),n!==0?n:Me(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class KR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ll(t){if(t.code!==W.FAILED_PRECONDITION||t.message!==GR)throw t;ne("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&me(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new H((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof H?n:H.resolve(n)}catch(n){return H.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):H.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):H.reject(n)}static resolve(e){return new H((n,r)=>{n(e)})}static reject(e){return new H((n,r)=>{r(e)})}static waitFor(e){return new H((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},u=>r(u))}),o=!0,i===s&&n()})}static or(e){let n=H.resolve(!1);for(const r of e)n=n.next(s=>s?H.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new H((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let u=0;u<i;u++){const d=u;n(e[d]).next(h=>{o[d]=h,++l,l===i&&r(o)},h=>s(h))}})}static doWhile(e,n){return new H((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function QR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function cl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qm{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Qm.oe=-1;function Wu(t){return t==null}function uu(t){return t===0&&1/t==-1/0}function YR(t){return typeof t=="number"&&Number.isInteger(t)&&!uu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function fi(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function eb(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e,n){this.comparator=e,this.root=n||Lt.EMPTY}insert(e,n){return new it(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Lt.BLACK,null,null))}remove(e){return new it(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Lt.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rc(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rc(this.root,e,this.comparator,!1)}getReverseIterator(){return new rc(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rc(this.root,e,this.comparator,!0)}}class rc{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Lt{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??Lt.RED,this.left=s??Lt.EMPTY,this.right=i??Lt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new Lt(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return Lt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return Lt.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Lt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Lt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw me();const e=this.left.check();if(e!==this.right.check())throw me();return e+(this.isRed()?0:1)}}Lt.EMPTY=null,Lt.RED=!0,Lt.BLACK=!1;Lt.EMPTY=new class{constructor(){this.size=0}get key(){throw me()}get value(){throw me()}get color(){throw me()}get left(){throw me()}get right(){throw me()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Lt(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vt{constructor(e){this.comparator=e,this.data=new it(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new kx(this.data.getIterator())}getIteratorFrom(e){return new kx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Vt)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Vt(this.comparator);return n.data=e,n}}class kx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wn{constructor(e){this.fields=e,e.sort(Ot.comparator)}static empty(){return new wn([])}unionWith(e){let n=new Vt(Ot.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new wn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return oa(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tb extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new tb("Invalid base64 string: "+i):i}}(e);return new Ut(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Ut(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Me(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Ut.EMPTY_BYTE_STRING=new Ut("");const JR=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ts(t){if(Ue(!!t),typeof t=="string"){let e=0;const n=JR.exec(t);if(Ue(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ft(t.seconds),nanos:ft(t.nanos)}}function ft(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function oi(t){return typeof t=="string"?Ut.fromBase64String(t):Ut.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ym(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Jm(t){const e=t.mapValue.fields.__previous_value__;return Ym(e)?Jm(e):e}function zo(t){const e=Ts(t.mapValue.fields.__local_write_time__.timestampValue);return new kt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XR{constructor(e,n,r,s,i,o,l,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=d}}class Wo{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Wo("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Wo&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sc={mapValue:{}};function li(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Ym(t)?4:eA(t)?9007199254740991:ZR(t)?10:11:me()}function gr(t,e){if(t===e)return!0;const n=li(t);if(n!==li(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return zo(t).isEqual(zo(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=Ts(s.timestampValue),l=Ts(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return oi(s.bytesValue).isEqual(oi(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ft(s.geoPointValue.latitude)===ft(i.geoPointValue.latitude)&&ft(s.geoPointValue.longitude)===ft(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ft(s.integerValue)===ft(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ft(s.doubleValue),l=ft(i.doubleValue);return o===l?uu(o)===uu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return oa(t.arrayValue.values||[],e.arrayValue.values||[],gr);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(Ex(o)!==Ex(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!gr(o[u],l[u])))return!1;return!0}(t,e);default:return me()}}function qo(t,e){return(t.values||[]).find(n=>gr(n,e))!==void 0}function la(t,e){if(t===e)return 0;const n=li(t),r=li(e);if(n!==r)return Me(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Me(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ft(i.integerValue||i.doubleValue),u=ft(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(t,e);case 3:return Tx(t.timestampValue,e.timestampValue);case 4:return Tx(zo(t),zo(e));case 5:return Me(t.stringValue,e.stringValue);case 6:return function(i,o){const l=oi(i),u=oi(o);return l.compareTo(u)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),u=o.split("/");for(let d=0;d<l.length&&d<u.length;d++){const h=Me(l[d],u[d]);if(h!==0)return h}return Me(l.length,u.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Me(ft(i.latitude),ft(o.latitude));return l!==0?l:Me(ft(i.longitude),ft(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Sx(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,u,d,h;const p=i.fields||{},m=o.fields||{},v=(l=p.value)===null||l===void 0?void 0:l.arrayValue,T=(u=m.value)===null||u===void 0?void 0:u.arrayValue,j=Me(((d=v==null?void 0:v.values)===null||d===void 0?void 0:d.length)||0,((h=T==null?void 0:T.values)===null||h===void 0?void 0:h.length)||0);return j!==0?j:Sx(v,T)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===sc.mapValue&&o===sc.mapValue)return 0;if(i===sc.mapValue)return 1;if(o===sc.mapValue)return-1;const l=i.fields||{},u=Object.keys(l),d=o.fields||{},h=Object.keys(d);u.sort(),h.sort();for(let p=0;p<u.length&&p<h.length;++p){const m=Me(u[p],h[p]);if(m!==0)return m;const v=la(l[u[p]],d[h[p]]);if(v!==0)return v}return Me(u.length,h.length)}(t.mapValue,e.mapValue);default:throw me()}}function Tx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Me(t,e);const n=Ts(t),r=Ts(e),s=Me(n.seconds,r.seconds);return s!==0?s:Me(n.nanos,r.nanos)}function Sx(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=la(n[s],r[s]);if(i)return i}return Me(n.length,r.length)}function ca(t){return yf(t)}function yf(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ts(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return oi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return le.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=yf(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${yf(n.fields[o])}`;return s+"}"}(t.mapValue):me()}function Ix(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function xf(t){return!!t&&"integerValue"in t}function Xm(t){return!!t&&"arrayValue"in t}function jx(t){return!!t&&"nullValue"in t}function Cx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Sc(t){return!!t&&"mapValue"in t}function ZR(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function go(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return fi(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=go(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=go(t.arrayValue.values[n]);return e}return Object.assign({},t)}function eA(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dn{constructor(e){this.value=e}static empty(){return new dn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Sc(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=go(n)}setAll(e){let n=Ot.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const u=this.getFieldsMap(n);this.applyChanges(u,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=go(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Sc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return gr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Sc(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){fi(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new dn(go(this.value))}}function nb(t){const e=[];return fi(t.fields,(n,r)=>{const s=new Ot([n]);if(Sc(r)){const i=nb(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new wn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qt{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Qt(e,0,xe.min(),xe.min(),xe.min(),dn.empty(),0)}static newFoundDocument(e,n,r,s){return new Qt(e,1,n,xe.min(),r,s,0)}static newNoDocument(e,n){return new Qt(e,2,n,xe.min(),xe.min(),dn.empty(),0)}static newUnknownDocument(e,n){return new Qt(e,3,n,xe.min(),xe.min(),dn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(xe.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=dn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=dn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=xe.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Qt&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Qt(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,n){this.position=e,this.inclusive=n}}function Rx(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=le.comparator(le.fromName(o.referenceValue),n.key):r=la(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function Ax(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!gr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ho{constructor(e,n="asc"){this.field=e,this.dir=n}}function tA(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rb{}class wt extends rb{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new rA(e,n,r):n==="array-contains"?new aA(e,r):n==="in"?new oA(e,r):n==="not-in"?new lA(e,r):n==="array-contains-any"?new cA(e,r):new wt(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new sA(e,r):new iA(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(la(n,this.value)):n!==null&&li(this.value)===li(n)&&this.matchesComparison(la(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return me()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Xn extends rb{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new Xn(e,n)}matches(e){return sb(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function sb(t){return t.op==="and"}function ib(t){return nA(t)&&sb(t)}function nA(t){for(const e of t.filters)if(e instanceof Xn)return!1;return!0}function vf(t){if(t instanceof wt)return t.field.canonicalString()+t.op.toString()+ca(t.value);if(ib(t))return t.filters.map(e=>vf(e)).join(",");{const e=t.filters.map(n=>vf(n)).join(",");return`${t.op}(${e})`}}function ab(t,e){return t instanceof wt?function(r,s){return s instanceof wt&&r.op===s.op&&r.field.isEqual(s.field)&&gr(r.value,s.value)}(t,e):t instanceof Xn?function(r,s){return s instanceof Xn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&ab(o,s.filters[l]),!0):!1}(t,e):void me()}function ob(t){return t instanceof wt?function(n){return`${n.field.canonicalString()} ${n.op} ${ca(n.value)}`}(t):t instanceof Xn?function(n){return n.op.toString()+" {"+n.getFilters().map(ob).join(" ,")+"}"}(t):"Filter"}class rA extends wt{constructor(e,n,r){super(e,n,r),this.key=le.fromName(r.referenceValue)}matches(e){const n=le.comparator(e.key,this.key);return this.matchesComparison(n)}}class sA extends wt{constructor(e,n){super(e,"in",n),this.keys=lb("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class iA extends wt{constructor(e,n){super(e,"not-in",n),this.keys=lb("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function lb(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>le.fromName(r.referenceValue))}class aA extends wt{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Xm(n)&&qo(n.arrayValue,this.value)}}class oA extends wt{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&qo(this.value.arrayValue,n)}}class lA extends wt{constructor(e,n){super(e,"not-in",n)}matches(e){if(qo(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!qo(this.value.arrayValue,n)}}class cA extends wt{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Xm(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>qo(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uA{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Px(t,e=null,n=[],r=[],s=null,i=null,o=null){return new uA(t,e,n,r,s,i,o)}function Zm(t){const e=ve(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>vf(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Wu(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>ca(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>ca(r)).join(",")),e.ue=n}return e.ue}function ep(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!tA(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!ab(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Ax(t.startAt,e.startAt)&&Ax(t.endAt,e.endAt)}function wf(t){return le.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Na{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=u,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function dA(t,e,n,r,s,i,o,l){return new Na(t,e,n,r,s,i,o,l)}function qu(t){return new Na(t)}function Dx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function cb(t){return t.collectionGroup!==null}function yo(t){const e=ve(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Vt(Ot.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(d=>{d.isInequality()&&(l=l.add(d.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Ho(i,r))}),n.has(Ot.keyField().canonicalString())||e.ce.push(new Ho(Ot.keyField(),r))}return e.ce}function mr(t){const e=ve(t);return e.le||(e.le=hA(e,yo(t))),e.le}function hA(t,e){if(t.limitType==="F")return Px(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Ho(s.field,i)});const n=t.endAt?new du(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new du(t.startAt.position,t.startAt.inclusive):null;return Px(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function _f(t,e){const n=t.filters.concat([e]);return new Na(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function hu(t,e,n){return new Na(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Hu(t,e){return ep(mr(t),mr(e))&&t.limitType===e.limitType}function ub(t){return`${Zm(mr(t))}|lt:${t.limitType}`}function Ti(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>ob(s)).join(", ")}]`),Wu(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>ca(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>ca(s)).join(",")),`Target(${r})`}(mr(t))}; limitType=${t.limitType})`}function Gu(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):le.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of yo(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,u){const d=Rx(o,l,u);return o.inclusive?d<=0:d<0}(r.startAt,yo(r),s)||r.endAt&&!function(o,l,u){const d=Rx(o,l,u);return o.inclusive?d>=0:d>0}(r.endAt,yo(r),s))}(t,e)}function fA(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function db(t){return(e,n)=>{let r=!1;for(const s of yo(t)){const i=mA(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function mA(t,e,n){const r=t.field.isKeyField()?le.comparator(e.key,n.key):function(i,o,l){const u=o.data.field(i),d=l.data.field(i);return u!==null&&d!==null?la(u,d):me()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return me()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ea{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){fi(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return eb(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pA=new it(le.comparator);function $r(){return pA}const hb=new it(le.comparator);function no(...t){let e=hb;for(const n of t)e=e.insert(n.key,n);return e}function fb(t){let e=hb;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function Gs(){return xo()}function mb(){return xo()}function xo(){return new Ea(t=>t.toString(),(t,e)=>t.isEqual(e))}const gA=new it(le.comparator),yA=new Vt(le.comparator);function Te(...t){let e=yA;for(const n of t)e=e.add(n);return e}const xA=new Vt(Me);function vA(){return xA}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tp(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uu(e)?"-0":e}}function pb(t){return{integerValue:""+t}}function gb(t,e){return YR(e)?pb(e):tp(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ku{constructor(){this._=void 0}}function wA(t,e,n){return t instanceof Go?function(s,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Ym(i)&&(i=Jm(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof ua?xb(t,e):t instanceof da?vb(t,e):function(s,i){const o=yb(s,i),l=Lx(o)+Lx(s.Pe);return xf(o)&&xf(s.Pe)?pb(l):tp(s.serializer,l)}(t,e)}function _A(t,e,n){return t instanceof ua?xb(t,e):t instanceof da?vb(t,e):n}function yb(t,e){return t instanceof Ko?function(r){return xf(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class Go extends Ku{}class ua extends Ku{constructor(e){super(),this.elements=e}}function xb(t,e){const n=wb(e);for(const r of t.elements)n.some(s=>gr(s,r))||n.push(r);return{arrayValue:{values:n}}}class da extends Ku{constructor(e){super(),this.elements=e}}function vb(t,e){let n=wb(e);for(const r of t.elements)n=n.filter(s=>!gr(s,r));return{arrayValue:{values:n}}}class Ko extends Ku{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function Lx(t){return ft(t.integerValue||t.doubleValue)}function wb(t){return Xm(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e,n){this.field=e,this.transform=n}}function bA(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof ua&&s instanceof ua||r instanceof da&&s instanceof da?oa(r.elements,s.elements,gr):r instanceof Ko&&s instanceof Ko?gr(r.Pe,s.Pe):r instanceof Go&&s instanceof Go}(t.transform,e.transform)}class NA{constructor(e,n){this.version=e,this.transformResults=n}}class nn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new nn}static exists(e){return new nn(void 0,e)}static updateTime(e){return new nn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Ic(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Yu{}function _b(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Ju(t.key,nn.none()):new ul(t.key,t.data,nn.none());{const n=t.data,r=dn.empty();let s=new Vt(Ot.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Ds(t.key,r,new wn(s.toArray()),nn.none())}}function EA(t,e,n){t instanceof ul?function(s,i,o){const l=s.value.clone(),u=Mx(s.fieldTransforms,i,o.transformResults);l.setAll(u),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Ds?function(s,i,o){if(!Ic(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=Mx(s.fieldTransforms,i,o.transformResults),u=i.data;u.setAll(bb(s)),u.setAll(l),i.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function vo(t,e,n,r){return t instanceof ul?function(i,o,l,u){if(!Ic(i.precondition,o))return l;const d=i.value.clone(),h=Vx(i.fieldTransforms,u,o);return d.setAll(h),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ds?function(i,o,l,u){if(!Ic(i.precondition,o))return l;const d=Vx(i.fieldTransforms,u,o),h=o.data;return h.setAll(bb(i)),h.setAll(d),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(p=>p.field))}(t,e,n,r):function(i,o,l){return Ic(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function kA(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=yb(r.transform,s||null);i!=null&&(n===null&&(n=dn.empty()),n.set(r.field,i))}return n||null}function Ox(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&oa(r,s,(i,o)=>bA(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ul extends Yu{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Ds extends Yu{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function bb(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Mx(t,e,n){const r=new Map;Ue(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,_A(o,l,n[s]))}return r}function Vx(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,wA(i,o,e))}return r}class Ju extends Yu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class TA extends Yu{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SA{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&EA(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=vo(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=vo(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=mb();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const u=_b(o,l);u!==null&&r.set(s.key,u),o.isValidDocument()||o.convertToNoDocument(xe.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Te())}isEqual(e){return this.batchId===e.batchId&&oa(this.mutations,e.mutations,(n,r)=>Ox(n,r))&&oa(this.baseMutations,e.baseMutations,(n,r)=>Ox(n,r))}}class np{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Ue(e.mutations.length===r.length);let s=function(){return gA}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new np(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IA{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt,je;function CA(t){switch(t){default:return me();case W.CANCELLED:case W.UNKNOWN:case W.DEADLINE_EXCEEDED:case W.RESOURCE_EXHAUSTED:case W.INTERNAL:case W.UNAVAILABLE:case W.UNAUTHENTICATED:return!1;case W.INVALID_ARGUMENT:case W.NOT_FOUND:case W.ALREADY_EXISTS:case W.PERMISSION_DENIED:case W.FAILED_PRECONDITION:case W.ABORTED:case W.OUT_OF_RANGE:case W.UNIMPLEMENTED:case W.DATA_LOSS:return!0}}function Nb(t){if(t===void 0)return Br("GRPC error has no .code"),W.UNKNOWN;switch(t){case yt.OK:return W.OK;case yt.CANCELLED:return W.CANCELLED;case yt.UNKNOWN:return W.UNKNOWN;case yt.DEADLINE_EXCEEDED:return W.DEADLINE_EXCEEDED;case yt.RESOURCE_EXHAUSTED:return W.RESOURCE_EXHAUSTED;case yt.INTERNAL:return W.INTERNAL;case yt.UNAVAILABLE:return W.UNAVAILABLE;case yt.UNAUTHENTICATED:return W.UNAUTHENTICATED;case yt.INVALID_ARGUMENT:return W.INVALID_ARGUMENT;case yt.NOT_FOUND:return W.NOT_FOUND;case yt.ALREADY_EXISTS:return W.ALREADY_EXISTS;case yt.PERMISSION_DENIED:return W.PERMISSION_DENIED;case yt.FAILED_PRECONDITION:return W.FAILED_PRECONDITION;case yt.ABORTED:return W.ABORTED;case yt.OUT_OF_RANGE:return W.OUT_OF_RANGE;case yt.UNIMPLEMENTED:return W.UNIMPLEMENTED;case yt.DATA_LOSS:return W.DATA_LOSS;default:return me()}}(je=yt||(yt={}))[je.OK=0]="OK",je[je.CANCELLED=1]="CANCELLED",je[je.UNKNOWN=2]="UNKNOWN",je[je.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",je[je.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",je[je.NOT_FOUND=5]="NOT_FOUND",je[je.ALREADY_EXISTS=6]="ALREADY_EXISTS",je[je.PERMISSION_DENIED=7]="PERMISSION_DENIED",je[je.UNAUTHENTICATED=16]="UNAUTHENTICATED",je[je.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",je[je.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",je[je.ABORTED=10]="ABORTED",je[je.OUT_OF_RANGE=11]="OUT_OF_RANGE",je[je.UNIMPLEMENTED=12]="UNIMPLEMENTED",je[je.INTERNAL=13]="INTERNAL",je[je.UNAVAILABLE=14]="UNAVAILABLE",je[je.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RA(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AA=new Ys([4294967295,4294967295],0);function Fx(t){const e=RA().encode(t),n=new H_;return n.update(e),new Uint8Array(n.digest())}function Ux(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Ys([n,r],0),new Ys([s,i],0)]}class rp{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new ro(`Invalid padding: ${n}`);if(r<0)throw new ro(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new ro(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new ro(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Ys.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Ys.fromNumber(r)));return s.compare(AA)===1&&(s=new Ys([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=Fx(e),[r,s]=Ux(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);if(!this.de(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new rp(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=Fx(e),[r,s]=Ux(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(r,s,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class ro extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xu{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,dl.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Xu(xe.min(),s,new it(Me),$r(),Te())}}class dl{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new dl(r,n,Te(),Te(),Te())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jc{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class Eb{constructor(e,n){this.targetId=e,this.me=n}}class kb{constructor(e,n,r=Ut.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class Bx{constructor(){this.fe=0,this.ge=zx(),this.pe=Ut.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Te(),n=Te(),r=Te();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:me()}}),new dl(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=zx()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Ue(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class PA{constructor(e){this.Le=e,this.Be=new Map,this.ke=$r(),this.qe=$x(),this.Qe=new it(Me)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:me()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(wf(i))if(r===0){const o=new le(i.path);this.Ue(n,o,Qt.newNoDocument(o,xe.min()))}else Ue(r===1);else{const o=this.Ye(n);if(o!==r){const l=this.Ze(e),u=l?this.Xe(l,e,o):1;if(u!==0){this.je(n);const d=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,d)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=oi(r).toUint8Array()}catch(u){if(u instanceof tb)return aa("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new rp(o,s,i)}catch(u){return aa(u instanceof ro?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.Ie===0?null:l}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&wf(l.target)){const u=new le(l.target.path);this.ke.get(u)!==null||this.it(o,u)||this.Ue(o,u,Qt.newNoDocument(u,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let r=Te();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(u=>{const d=this.Je(u);return!d||d.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const s=new Xu(e,n,this.Qe,this.ke,r);return this.ke=$r(),this.qe=$x(),this.Qe=new it(Me),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new Bx,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new Vt(Me),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||ne("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Bx),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function $x(){return new it(le.comparator)}function zx(){return new it(le.comparator)}const DA={asc:"ASCENDING",desc:"DESCENDING"},LA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OA={and:"AND",or:"OR"};class MA{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function bf(t,e){return t.useProto3Json||Wu(e)?e:{value:e}}function fu(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Tb(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function VA(t,e){return fu(t,e.toTimestamp())}function pr(t){return Ue(!!t),xe.fromTimestamp(function(n){const r=Ts(n);return new kt(r.seconds,r.nanos)}(t))}function sp(t,e){return Nf(t,e).canonicalString()}function Nf(t,e){const n=function(s){return new Xe(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function Sb(t){const e=Xe.fromString(t);return Ue(Ab(e)),e}function Ef(t,e){return sp(t.databaseId,e.path)}function sh(t,e){const n=Sb(e);if(n.get(1)!==t.databaseId.projectId)throw new J(W.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new J(W.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new le(jb(n))}function Ib(t,e){return sp(t.databaseId,e)}function FA(t){const e=Sb(t);return e.length===4?Xe.emptyPath():jb(e)}function kf(t){return new Xe(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function jb(t){return Ue(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function Wx(t,e,n){return{name:Ef(t,e),fields:n.value.mapValue.fields}}function UA(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(d){return d==="NO_CHANGE"?0:d==="ADD"?1:d==="REMOVE"?2:d==="CURRENT"?3:d==="RESET"?4:me()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(d,h){return d.useProto3Json?(Ue(h===void 0||typeof h=="string"),Ut.fromBase64String(h||"")):(Ue(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Ut.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(d){const h=d.code===void 0?W.UNKNOWN:Nb(d.code);return new J(h,d.message||"")}(o);n=new kb(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=sh(t,r.document.name),i=pr(r.document.updateTime),o=r.document.createTime?pr(r.document.createTime):xe.min(),l=new dn({mapValue:{fields:r.document.fields}}),u=Qt.newFoundDocument(s,i,o,l),d=r.targetIds||[],h=r.removedTargetIds||[];n=new jc(d,h,u.key,u)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=sh(t,r.document),i=r.readTime?pr(r.readTime):xe.min(),o=Qt.newNoDocument(s,i),l=r.removedTargetIds||[];n=new jc([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=sh(t,r.document),i=r.removedTargetIds||[];n=new jc([],i,s,null)}else{if(!("filter"in e))return me();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new jA(s,i),l=r.targetId;n=new Eb(l,o)}}return n}function BA(t,e){let n;if(e instanceof ul)n={update:Wx(t,e.key,e.value)};else if(e instanceof Ju)n={delete:Ef(t,e.key)};else if(e instanceof Ds)n={update:Wx(t,e.key,e.data),updateMask:YA(e.fieldMask)};else{if(!(e instanceof TA))return me();n={verify:Ef(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof Go)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof ua)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof da)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Ko)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw me()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:VA(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:me()}(t,e.precondition)),n}function $A(t,e){return t&&t.length>0?(Ue(e!==void 0),t.map(n=>function(s,i){let o=s.updateTime?pr(s.updateTime):pr(i);return o.isEqual(xe.min())&&(o=pr(i)),new NA(o,s.transformResults||[])}(n,e))):[]}function zA(t,e){return{documents:[Ib(t,e.path)]}}function WA(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ib(t,s);const i=function(d){if(d.length!==0)return Rb(Xn.create(d,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(d){if(d.length!==0)return d.map(h=>function(m){return{field:Si(m.field),direction:GA(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=bf(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(d){return{before:d.inclusive,values:d.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(d){return{before:!d.inclusive,values:d.position}}(e.endAt)),{_t:n,parent:s}}function qA(t){let e=FA(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Ue(r===1);const h=n.from[0];h.allDescendants?s=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(p){const m=Cb(p);return m instanceof Xn&&ib(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(p){return p.map(m=>function(T){return new Ho(Ii(T.field),function(I){switch(I){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(T.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(p){let m;return m=typeof p=="object"?p.value:p,Wu(m)?null:m}(n.limit));let u=null;n.startAt&&(u=function(p){const m=!!p.before,v=p.values||[];return new du(v,m)}(n.startAt));let d=null;return n.endAt&&(d=function(p){const m=!p.before,v=p.values||[];return new du(v,m)}(n.endAt)),dA(e,s,o,i,l,"F",u,d)}function HA(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return me()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function Cb(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ii(n.unaryFilter.field);return wt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Ii(n.unaryFilter.field);return wt.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Ii(n.unaryFilter.field);return wt.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Ii(n.unaryFilter.field);return wt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return me()}}(t):t.fieldFilter!==void 0?function(n){return wt.create(Ii(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return me()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return Xn.create(n.compositeFilter.filters.map(r=>Cb(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return me()}}(n.compositeFilter.op))}(t):me()}function GA(t){return DA[t]}function KA(t){return LA[t]}function QA(t){return OA[t]}function Si(t){return{fieldPath:t.canonicalString()}}function Ii(t){return Ot.fromServerFormat(t.fieldPath)}function Rb(t){return t instanceof wt?function(n){if(n.op==="=="){if(Cx(n.value))return{unaryFilter:{field:Si(n.field),op:"IS_NAN"}};if(jx(n.value))return{unaryFilter:{field:Si(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(Cx(n.value))return{unaryFilter:{field:Si(n.field),op:"IS_NOT_NAN"}};if(jx(n.value))return{unaryFilter:{field:Si(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Si(n.field),op:KA(n.op),value:n.value}}}(t):t instanceof Xn?function(n){const r=n.getFilters().map(s=>Rb(s));return r.length===1?r[0]:{compositeFilter:{op:QA(n.op),filters:r}}}(t):me()}function YA(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function Ab(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ds{constructor(e,n,r,s,i=xe.min(),o=xe.min(),l=Ut.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new ds(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ds(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JA{constructor(e){this.ct=e}}function XA(t){const e=qA({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?hu(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZA{constructor(){this.un=new eP}addToCollectionParentIndex(e,n){return this.un.add(n),H.resolve()}getCollectionParents(e,n){return H.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return H.resolve()}deleteFieldIndex(e,n){return H.resolve()}deleteAllFieldIndexes(e){return H.resolve()}createTargetIndexes(e,n){return H.resolve()}getDocumentsMatchingTarget(e,n){return H.resolve(null)}getIndexType(e,n){return H.resolve(0)}getFieldIndexes(e,n){return H.resolve([])}getNextCollectionGroupToUpdate(e){return H.resolve(null)}getMinOffset(e,n){return H.resolve(ks.min())}getMinOffsetFromCollectionGroup(e,n){return H.resolve(ks.min())}updateCollectionGroup(e,n,r){return H.resolve()}updateIndexEntries(e,n){return H.resolve()}}class eP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Vt(Xe.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Vt(Xe.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new ha(0)}static kn(){return new ha(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(){this.changes=new Ea(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Qt.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?H.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rP{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&vo(r.mutation,s,wn.empty(),kt.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Te()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Te()){const s=Gs();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=no();return i.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=Gs();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Te()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=$r();const o=xo(),l=function(){return xo()}();return n.forEach((u,d)=>{const h=r.get(d.key);s.has(d.key)&&(h===void 0||h.mutation instanceof Ds)?i=i.insert(d.key,d):h!==void 0?(o.set(d.key,h.mutation.getFieldMask()),vo(h.mutation,d,h.mutation.getFieldMask(),kt.now())):o.set(d.key,wn.empty())}),this.recalculateAndSaveOverlays(e,i).next(u=>(u.forEach((d,h)=>o.set(d,h)),n.forEach((d,h)=>{var p;return l.set(d,new nP(h,(p=o.get(d))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,n){const r=xo();let s=new it((o,l)=>o-l),i=Te();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(u=>{const d=n.get(u);if(d===null)return;let h=r.get(u)||wn.empty();h=l.applyToLocalView(d,h),r.set(u,h);const p=(s.get(l.batchId)||Te()).add(u);s=s.insert(l.batchId,p)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),d=u.key,h=u.value,p=mb();h.forEach(m=>{if(!i.has(m)){const v=_b(n.get(m),r.get(m));v!==null&&p.set(m,v),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,d,p))}return H.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return le.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):cb(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):H.resolve(Gs());let l=-1,u=i;return o.next(d=>H.forEach(d,(h,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),i.get(h)?H.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{u=u.insert(h,m)}))).next(()=>this.populateOverlays(e,d,i)).next(()=>this.computeViews(e,u,d,Te())).next(h=>({batchId:l,changes:fb(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new le(n)).next(r=>{let s=no();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=no();return this.indexManager.getCollectionParents(e,i).next(l=>H.forEach(l,u=>{const d=function(p,m){return new Na(m,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,u.child(i));return this.getDocumentsMatchingCollectionQuery(e,d,r,s).next(h=>{h.forEach((p,m)=>{o=o.insert(p,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((u,d)=>{const h=d.getKey();o.get(h)===null&&(o=o.insert(h,Qt.newInvalidDocument(h)))});let l=no();return o.forEach((u,d)=>{const h=i.get(u);h!==void 0&&vo(h.mutation,d,wn.empty(),kt.now()),Gu(n,d)&&(l=l.insert(u,d))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sP{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return H.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:pr(s.createTime)}}(n)),H.resolve()}getNamedQuery(e,n){return H.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:XA(s.bundledQuery),readTime:pr(s.readTime)}}(n)),H.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iP{constructor(){this.overlays=new it(le.comparator),this.Ir=new Map}getOverlay(e,n){return H.resolve(this.overlays.get(n))}getOverlays(e,n){const r=Gs();return H.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),H.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),H.resolve()}getOverlaysForCollection(e,n,r){const s=Gs(),i=n.length+1,o=new le(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,d=u.getKey();if(!n.isPrefixOf(d.path))break;d.path.length===i&&u.largestBatchId>r&&s.set(u.getKey(),u)}return H.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new it((d,h)=>d-h);const o=this.overlays.getIterator();for(;o.hasNext();){const d=o.getNext().value;if(d.getKey().getCollectionGroup()===n&&d.largestBatchId>r){let h=i.get(d.largestBatchId);h===null&&(h=Gs(),i=i.insert(d.largestBatchId,h)),h.set(d.getKey(),d)}}const l=Gs(),u=i.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((d,h)=>l.set(d,h)),!(l.size()>=s)););return H.resolve(l)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new IA(n,r));let i=this.Ir.get(n);i===void 0&&(i=Te(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(){this.sessionToken=Ut.EMPTY_BYTE_STRING}getSessionToken(e){return H.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,H.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ip{constructor(){this.Tr=new Vt(It.Er),this.dr=new Vt(It.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new It(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new It(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new le(new Xe([])),r=new It(n,e),s=new It(n,e+1),i=[];return this.dr.forEachInRange([r,s],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new le(new Xe([])),r=new It(n,e),s=new It(n,e+1);let i=Te();return this.dr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new It(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class It{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return le.comparator(e.key,n.key)||Me(e.wr,n.wr)}static Ar(e,n){return Me(e.wr,n.wr)||le.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oP{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new Vt(It.Er)}checkEmpty(e){return H.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new SA(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.br=this.br.add(new It(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return H.resolve(o)}lookupMutationBatch(e,n){return H.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return H.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return H.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return H.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new It(n,0),s=new It(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],o=>{const l=this.Dr(o.wr);i.push(l)}),H.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Vt(Me);return n.forEach(s=>{const i=new It(s,0),o=new It(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{r=r.add(l.wr)})}),H.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;le.isDocumentKey(i)||(i=i.child(""));const o=new It(new le(i),0);let l=new Vt(Me);return this.br.forEachWhile(u=>{const d=u.key.path;return!!r.isPrefixOf(d)&&(d.length===s&&(l=l.add(u.wr)),!0)},o),H.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Ue(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return H.forEach(n.mutations,s=>{const i=new It(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new It(n,0),s=this.br.firstAfterOrEqual(r);return H.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,H.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lP{constructor(e){this.Mr=e,this.docs=function(){return new it(le.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return H.resolve(r?r.document.mutableCopy():Qt.newInvalidDocument(n))}getEntries(e,n){let r=$r();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Qt.newInvalidDocument(s))}),H.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=$r();const o=n.path,l=new le(o.child("")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:d,value:{document:h}}=u.getNext();if(!o.isPrefixOf(d.path))break;d.path.length>o.length+1||HR(qR(h),r)<=0||(s.has(h.key)||Gu(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return H.resolve(i)}getAllFromCollectionGroup(e,n,r,s){me()}Or(e,n){return H.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new cP(this)}getSize(e){return H.resolve(this.size)}}class cP extends tP{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),H.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uP{constructor(e){this.persistence=e,this.Nr=new Ea(n=>Zm(n),ep),this.lastRemoteSnapshotVersion=xe.min(),this.highestTargetId=0,this.Lr=0,this.Br=new ip,this.targetCount=0,this.kr=ha.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),H.resolve()}getLastRemoteSnapshotVersion(e){return H.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return H.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),H.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),H.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new ha(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,H.resolve()}updateTargetData(e,n){return this.Kn(n),H.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,H.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),H.waitFor(i).next(()=>s)}getTargetCount(e){return H.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return H.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),H.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),H.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),H.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return H.resolve(r)}containsKey(e,n){return H.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Qm(0),this.Kr=!1,this.Kr=!0,this.$r=new aP,this.referenceDelegate=e(this),this.Ur=new uP(this),this.indexManager=new ZA,this.remoteDocumentCache=function(s){return new lP(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new JA(n),this.Gr=new sP(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new iP,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new oP(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){ne("MemoryPersistence","Starting transaction:",e);const s=new hP(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return H.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class hP extends KR{constructor(e){super(),this.currentSequenceNumber=e}}class ap{constructor(e){this.persistence=e,this.Jr=new ip,this.Yr=null}static Zr(e){return new ap(e)}get Xr(){if(this.Yr)return this.Yr;throw me()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),H.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),H.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),H.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return H.forEach(this.Xr,r=>{const s=le.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,xe.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return H.or([()=>H.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class op{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Te(),s=Te();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new op(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fP{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mP{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return ER()?8:QR(bR())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new fP;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(Ha()<=Ce.DEBUG&&ne("QueryEngine","SDK will not create cache indexes for query:",Ti(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),H.resolve()):(Ha()<=Ce.DEBUG&&ne("QueryEngine","Query:",Ti(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(Ha()<=Ce.DEBUG&&ne("QueryEngine","The SDK decides to create cache indexes for query:",Ti(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,mr(n))):H.resolve())}Yi(e,n){if(Dx(n))return H.resolve(null);let r=mr(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=hu(n,null,"F"),r=mr(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Te(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(u=>{const d=this.ts(n,l);return this.ns(n,d,o,u.readTime)?this.Yi(e,hu(n,null,"F")):this.rs(e,d,n,u)}))})))}Zi(e,n,r,s){return Dx(n)||s.isEqual(xe.min())?H.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const o=this.ts(n,i);return this.ns(n,o,r,s)?H.resolve(null):(Ha()<=Ce.DEBUG&&ne("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Ti(n)),this.rs(e,o,n,WR(s,-1)).next(l=>l))})}ts(e,n){let r=new Vt(db(e));return n.forEach((s,i)=>{Gu(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return Ha()<=Ce.DEBUG&&ne("QueryEngine","Using full collection scan to execute query:",Ti(n)),this.Ji.getDocumentsMatchingQuery(e,n,ks.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new it(Me),this._s=new Ea(i=>Zm(i),ep),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new rP(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function gP(t,e,n,r){return new pP(t,e,n,r)}async function Pb(t,e){const n=ve(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let u=Te();for(const d of s){o.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}for(const d of i){l.push(d.batchId);for(const h of d.mutations)u=u.add(h.key)}return n.localDocuments.getDocuments(r,u).next(d=>({hs:d,removedBatchIds:o,addedBatchIds:l}))})})}function yP(t,e){const n=ve(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,u,d,h){const p=d.batch,m=p.keys();let v=H.resolve();return m.forEach(T=>{v=v.next(()=>h.getEntry(u,T)).next(j=>{const I=d.docVersions.get(T);Ue(I!==null),j.version.compareTo(I)<0&&(p.applyToRemoteDocument(j,d),j.isValidDocument()&&(j.setReadTime(d.commitVersion),h.addEntry(j)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(u,p))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let u=Te();for(let d=0;d<l.mutationResults.length;++d)l.mutationResults[d].transformResults.length>0&&(u=u.add(l.batch.mutations[d].key));return u}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function Db(t){const e=ve(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function xP(t,e){const n=ve(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const l=[];e.targetChanges.forEach((h,p)=>{const m=s.get(p);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,p).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,p)));let v=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Ut.EMPTY_BYTE_STRING,xe.min()).withLastLimboFreeSnapshotVersion(xe.min()):h.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(h.resumeToken,r)),s=s.insert(p,v),function(j,I,y){return j.resumeToken.approximateByteSize()===0||I.snapshotVersion.toMicroseconds()-j.snapshotVersion.toMicroseconds()>=3e8?!0:y.addedDocuments.size+y.modifiedDocuments.size+y.removedDocuments.size>0}(m,v,h)&&l.push(n.Ur.updateTargetData(i,v))});let u=$r(),d=Te();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(vP(i,o,e.documentUpdates).next(h=>{u=h.Ps,d=h.Is})),!r.isEqual(xe.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(p=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(h)}return H.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,u,d)).next(()=>u)}).then(i=>(n.os=s,i))}function vP(t,e,n){let r=Te(),s=Te();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=$r();return n.forEach((l,u)=>{const d=i.get(l);u.isFoundDocument()!==d.isFoundDocument()&&(s=s.add(l)),u.isNoDocument()&&u.version.isEqual(xe.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!d.isValidDocument()||u.version.compareTo(d.version)>0||u.version.compareTo(d.version)===0&&d.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):ne("LocalStore","Ignoring outdated watch update for ",l,". Current version:",d.version," Watch version:",u.version)}),{Ps:o,Is:s}})}function wP(t,e){const n=ve(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function _P(t,e){const n=ve(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,H.resolve(s)):n.Ur.allocateTargetId(r).next(o=>(s=new ds(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Tf(t,e,n){const r=ve(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!cl(o))throw o;ne("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function qx(t,e,n){const r=ve(t);let s=xe.min(),i=Te();return r.persistence.runTransaction("Execute query","readwrite",o=>function(u,d,h){const p=ve(u),m=p._s.get(h);return m!==void 0?H.resolve(p.os.get(m)):p.Ur.getTargetData(d,h)}(r,o,mr(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(o,l.targetId).next(u=>{i=u})}).next(()=>r.ss.getDocumentsMatchingQuery(o,e,n?s:xe.min(),n?i:Te())).next(l=>(bP(r,fA(e),l),{documents:l,Ts:i})))}function bP(t,e,n){let r=t.us.get(e)||xe.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class Hx{constructor(){this.activeTargetIds=vA()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class NP{constructor(){this.so=new Hx,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Hx,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EP{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gx{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){ne("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){ne("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ic=null;function ih(){return ic===null?ic=function(){return 268435456+Math.round(2147483648*Math.random())}():ic++,"0x"+ic.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ht="WebChannelConnection";class SP extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,o){const l=ih(),u=this.xo(n,r.toUriEncodedString());ne("RestConnection",`Sending RPC '${n}' ${l}:`,u,s);const d={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(d,i,o),this.No(n,u,d,s).then(h=>(ne("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw aa("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",u,"request:",s),h})}Lo(n,r,s,i,o,l){return this.Mo(n,r,s,i,o)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+ba}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,o)=>n[o]=i),s&&s.headers.forEach((i,o)=>n[o]=i)}xo(n,r){const s=kP[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=ih();return new Promise((o,l)=>{const u=new G_;u.setWithCredentials(!0),u.listenOnce(K_.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Tc.NO_ERROR:const h=u.getResponseJson();ne(Ht,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case Tc.TIMEOUT:ne(Ht,`RPC '${e}' ${i} timed out`),l(new J(W.DEADLINE_EXCEEDED,"Request time out"));break;case Tc.HTTP_ERROR:const p=u.getStatus();if(ne(Ht,`RPC '${e}' ${i} failed with status:`,p,"response text:",u.getResponseText()),p>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const v=m==null?void 0:m.error;if(v&&v.status&&v.message){const T=function(I){const y=I.toLowerCase().replace(/_/g,"-");return Object.values(W).indexOf(y)>=0?y:W.UNKNOWN}(v.status);l(new J(T,v.message))}else l(new J(W.UNKNOWN,"Server responded with status "+u.getStatus()))}else l(new J(W.UNAVAILABLE,"Connection failed."));break;default:me()}}finally{ne(Ht,`RPC '${e}' ${i} completed.`)}});const d=JSON.stringify(s);ne(Ht,`RPC '${e}' ${i} sending request:`,s),u.send(n,"POST",d,r,15)})}Bo(e,n,r){const s=ih(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=J_(),l=Y_(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},d=this.longPollingOptions.timeoutSeconds;d!==void 0&&(u.longPollingTimeout=Math.round(1e3*d)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Oo(u.initMessageHeaders,n,r),u.encodeInitMessageHeaders=!0;const h=i.join("");ne(Ht,`Creating RPC '${e}' stream ${s}: ${h}`,u);const p=o.createWebChannel(h,u);let m=!1,v=!1;const T=new TP({Io:I=>{v?ne(Ht,`Not sending because RPC '${e}' stream ${s} is closed:`,I):(m||(ne(Ht,`Opening RPC '${e}' stream ${s} transport.`),p.open(),m=!0),ne(Ht,`RPC '${e}' stream ${s} sending:`,I),p.send(I))},To:()=>p.close()}),j=(I,y,_)=>{I.listen(y,b=>{try{_(b)}catch(A){setTimeout(()=>{throw A},0)}})};return j(p,to.EventType.OPEN,()=>{v||(ne(Ht,`RPC '${e}' stream ${s} transport opened.`),T.yo())}),j(p,to.EventType.CLOSE,()=>{v||(v=!0,ne(Ht,`RPC '${e}' stream ${s} transport closed`),T.So())}),j(p,to.EventType.ERROR,I=>{v||(v=!0,aa(Ht,`RPC '${e}' stream ${s} transport errored:`,I),T.So(new J(W.UNAVAILABLE,"The operation could not be completed")))}),j(p,to.EventType.MESSAGE,I=>{var y;if(!v){const _=I.data[0];Ue(!!_);const b=_,A=b.error||((y=b[0])===null||y===void 0?void 0:y.error);if(A){ne(Ht,`RPC '${e}' stream ${s} received error:`,A);const V=A.status;let M=function(E){const S=yt[E];if(S!==void 0)return Nb(S)}(V),N=A.message;M===void 0&&(M=W.INTERNAL,N="Unknown error status: "+V+" with message "+A.message),v=!0,T.So(new J(M,N)),p.close()}else ne(Ht,`RPC '${e}' stream ${s} received:`,_),T.bo(_)}}),j(l,Q_.STAT_EVENT,I=>{I.stat===gf.PROXY?ne(Ht,`RPC '${e}' stream ${s} detected buffering proxy`):I.stat===gf.NOPROXY&&ne(Ht,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{T.wo()},0),T}}function ah(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(t){return new MA(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&ne("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e,n,r,s,i,o,l,u){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Lb(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===W.RESOURCE_EXHAUSTED?(Br(n.toString()),Br("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===W.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new J(W.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return ne("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(ne("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class IP extends Ob{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=UA(this.serializer,e),r=function(i){if(!("targetChange"in i))return xe.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?xe.min():o.readTime?pr(o.readTime):xe.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=kf(this.serializer),n.addTarget=function(i,o){let l;const u=o.target;if(l=wf(u)?{documents:zA(i,u)}:{query:WA(i,u)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Tb(i,o.resumeToken);const d=bf(i,o.expectedCount);d!==null&&(l.expectedCount=d)}else if(o.snapshotVersion.compareTo(xe.min())>0){l.readTime=fu(i,o.snapshotVersion.toTimestamp());const d=bf(i,o.expectedCount);d!==null&&(l.expectedCount=d)}return l}(this.serializer,e);const r=HA(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=kf(this.serializer),n.removeTarget=e,this.a_(n)}}class jP extends Ob{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,Ue(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Ue(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=$A(e.writeResults,e.commitTime),r=pr(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=kf(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>BA(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new J(W.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Nf(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new J(W.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Nf(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===W.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new J(W.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class RP{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Br(n),this.D_=!1):ne("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AP{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{r.enqueueAndForget(async()=>{mi(this)&&(ne("RemoteStore","Restarting streams for network reachability change."),await async function(u){const d=ve(u);d.L_.add(4),await hl(d),d.q_.set("Unknown"),d.L_.delete(4),await ed(d)}(this))})}),this.q_=new RP(r,s)}}async function ed(t){if(mi(t))for(const e of t.B_)await e(!0)}async function hl(t){for(const e of t.B_)await e(!1)}function Mb(t,e){const n=ve(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),dp(n)?up(n):ka(n).r_()&&cp(n,e))}function lp(t,e){const n=ve(t),r=ka(n);n.N_.delete(e),r.r_()&&Vb(n,e),n.N_.size===0&&(r.r_()?r.o_():mi(n)&&n.q_.set("Unknown"))}function cp(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(xe.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}ka(t).A_(e)}function Vb(t,e){t.Q_.xe(e),ka(t).R_(e)}function up(t){t.Q_=new PA({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),ka(t).start(),t.q_.v_()}function dp(t){return mi(t)&&!ka(t).n_()&&t.N_.size>0}function mi(t){return ve(t).L_.size===0}function Fb(t){t.Q_=void 0}async function PP(t){t.q_.set("Online")}async function DP(t){t.N_.forEach((e,n)=>{cp(t,e)})}async function LP(t,e){Fb(t),dp(t)?(t.q_.M_(e),up(t)):t.q_.set("Unknown")}async function OP(t,e,n){if(t.q_.set("Online"),e instanceof kb&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.N_.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.N_.delete(l),s.Q_.removeTarget(l))}(t,e)}catch(r){ne("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await mu(t,r)}else if(e instanceof jc?t.Q_.Ke(e):e instanceof Eb?t.Q_.He(e):t.Q_.We(e),!n.isEqual(xe.min()))try{const r=await Db(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((u,d)=>{if(u.resumeToken.approximateByteSize()>0){const h=i.N_.get(d);h&&i.N_.set(d,h.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,d)=>{const h=i.N_.get(u);if(!h)return;i.N_.set(u,h.withResumeToken(Ut.EMPTY_BYTE_STRING,h.snapshotVersion)),Vb(i,u);const p=new ds(h.target,u,d,h.sequenceNumber);cp(i,p)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){ne("RemoteStore","Failed to raise snapshot:",r),await mu(t,r)}}async function mu(t,e,n){if(!cl(e))throw e;t.L_.add(1),await hl(t),t.q_.set("Offline"),n||(n=()=>Db(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ne("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await ed(t)})}function Ub(t,e){return e().catch(n=>mu(t,n,e))}async function td(t){const e=ve(t),n=Ss(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;MP(e);)try{const s=await wP(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,VP(e,s)}catch(s){await mu(e,s)}Bb(e)&&$b(e)}function MP(t){return mi(t)&&t.O_.length<10}function VP(t,e){t.O_.push(e);const n=Ss(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Bb(t){return mi(t)&&!Ss(t).n_()&&t.O_.length>0}function $b(t){Ss(t).start()}async function FP(t){Ss(t).p_()}async function UP(t){const e=Ss(t);for(const n of t.O_)e.m_(n.mutations)}async function BP(t,e,n){const r=t.O_.shift(),s=np.from(r,e,n);await Ub(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await td(t)}async function $P(t,e){e&&Ss(t).V_&&await async function(r,s){if(function(o){return CA(o)&&o!==W.ABORTED}(s.code)){const i=r.O_.shift();Ss(r).s_(),await Ub(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await td(r)}}(t,e),Bb(t)&&$b(t)}async function Kx(t,e){const n=ve(t);n.asyncQueue.verifyOperationInProgress(),ne("RemoteStore","RemoteStore received new credentials");const r=mi(n);n.L_.add(3),await hl(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await ed(n)}async function zP(t,e){const n=ve(t);e?(n.L_.delete(2),await ed(n)):e||(n.L_.add(2),await hl(n),n.q_.set("Unknown"))}function ka(t){return t.K_||(t.K_=function(n,r,s){const i=ve(n);return i.w_(),new IP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:PP.bind(null,t),Ro:DP.bind(null,t),mo:LP.bind(null,t),d_:OP.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),dp(t)?up(t):t.q_.set("Unknown")):(await t.K_.stop(),Fb(t))})),t.K_}function Ss(t){return t.U_||(t.U_=function(n,r,s){const i=ve(n);return i.w_(),new jP(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:FP.bind(null,t),mo:$P.bind(null,t),f_:UP.bind(null,t),g_:BP.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await td(t)):(await t.U_.stop(),t.O_.length>0&&(ne("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hp{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new Pr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new hp(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new J(W.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function fp(t,e){if(Br("AsyncQueue",`${e}: ${t}`),cl(t))return new J(W.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ji{constructor(e){this.comparator=e?(n,r)=>e(n,r)||le.comparator(n.key,r.key):(n,r)=>le.comparator(n.key,r.key),this.keyedMap=no(),this.sortedSet=new it(this.comparator)}static emptySet(e){return new Ji(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ji)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ji;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qx{constructor(){this.W_=new it(le.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):me():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class fa{constructor(e,n,r,s,i,o,l,u,d){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=d}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new fa(e,n,Ji.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Hu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WP{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class qP{constructor(){this.queries=Yx(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ve(n),i=s.queries;s.queries=Yx(),i.forEach((o,l)=>{for(const u of l.j_)u.onError(r)})})(this,new J(W.ABORTED,"Firestore shutting down"))}}function Yx(){return new Ea(t=>ub(t),Hu)}async function mp(t,e){const n=ve(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new WP,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=fp(o,`Initialization of query '${Ti(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&gp(n)}async function pp(t,e){const n=ve(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function HP(t,e){const n=ve(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(s)&&(r=!0);o.z_=s}}r&&gp(n)}function GP(t,e,n){const r=ve(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function gp(t){t.Y_.forEach(e=>{e.next()})}var Sf,Jx;(Jx=Sf||(Sf={})).ea="default",Jx.Cache="cache";class yp{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new fa(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=fa.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Sf.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zb{constructor(e){this.key=e}}class Wb{constructor(e){this.key=e}}class KP{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Te(),this.mutatedKeys=Te(),this.Aa=db(e),this.Ra=new Ji(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new Qx,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const u=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,d=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((h,p)=>{const m=s.get(h),v=Gu(this.query,p)?p:null,T=!!m&&this.mutatedKeys.has(m.key),j=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let I=!1;m&&v?m.data.isEqual(v.data)?T!==j&&(r.track({type:3,doc:v}),I=!0):this.ga(m,v)||(r.track({type:2,doc:v}),I=!0,(u&&this.Aa(v,u)>0||d&&this.Aa(v,d)<0)&&(l=!0)):!m&&v?(r.track({type:0,doc:v}),I=!0):m&&!v&&(r.track({type:1,doc:m}),I=!0,(u||d)&&(l=!0)),I&&(v?(o=o.add(v),i=j?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),r.track({type:1,doc:h})}return{Ra:o,fa:r,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,p)=>function(v,T){const j=I=>{switch(I){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return me()}};return j(v)-j(T)}(h.type,p.type)||this.Aa(h.doc,p.doc)),this.pa(r),s=s!=null&&s;const l=n&&!s?this.ya():[],u=this.da.size===0&&this.current&&!s?1:0,d=u!==this.Ea;return this.Ea=u,o.length!==0||d?{snapshot:new fa(this.query,e.Ra,i,o,e.mutatedKeys,u===0,d,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Qx,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Te(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Wb(r))}),this.da.forEach(r=>{e.has(r)||n.push(new zb(r))}),n}ba(e){this.Ta=e.Ts,this.da=Te();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return fa.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class QP{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class YP{constructor(e){this.key=e,this.va=!1}}class JP{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Ea(l=>ub(l),Hu),this.Ma=new Map,this.xa=new Set,this.Oa=new it(le.comparator),this.Na=new Map,this.La=new ip,this.Ba={},this.ka=new Map,this.qa=ha.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function XP(t,e,n=!0){const r=Yb(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await qb(r,e,n,!0),s}async function ZP(t,e){const n=Yb(t);await qb(n,e,!0,!1)}async function qb(t,e,n,r){const s=await _P(t.localStore,mr(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await e2(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&Mb(t.remoteStore,s),l}async function e2(t,e,n,r,s){t.Ka=(p,m,v)=>async function(j,I,y,_){let b=I.view.ma(y);b.ns&&(b=await qx(j.localStore,I.query,!1).then(({documents:N})=>I.view.ma(N,b)));const A=_&&_.targetChanges.get(I.targetId),V=_&&_.targetMismatches.get(I.targetId)!=null,M=I.view.applyChanges(b,j.isPrimaryClient,A,V);return Zx(j,I.targetId,M.wa),M.snapshot}(t,p,m,v);const i=await qx(t.localStore,e,!0),o=new KP(e,i.Ts),l=o.ma(i.documents),u=dl.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),d=o.applyChanges(l,t.isPrimaryClient,u);Zx(t,n,d.wa);const h=new QP(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),d.snapshot}async function t2(t,e,n){const r=ve(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(o=>!Hu(o,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Tf(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&lp(r.remoteStore,s.targetId),If(r,s.targetId)}).catch(ll)):(If(r,s.targetId),await Tf(r.localStore,s.targetId,!0))}async function n2(t,e){const n=ve(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),lp(n.remoteStore,r.targetId))}async function r2(t,e,n){const r=u2(t);try{const s=await function(o,l){const u=ve(o),d=kt.now(),h=l.reduce((v,T)=>v.add(T.key),Te());let p,m;return u.persistence.runTransaction("Locally write mutations","readwrite",v=>{let T=$r(),j=Te();return u.cs.getEntries(v,h).next(I=>{T=I,T.forEach((y,_)=>{_.isValidDocument()||(j=j.add(y))})}).next(()=>u.localDocuments.getOverlayedDocuments(v,T)).next(I=>{p=I;const y=[];for(const _ of l){const b=kA(_,p.get(_.key).overlayedDocument);b!=null&&y.push(new Ds(_.key,b,nb(b.value.mapValue),nn.exists(!0)))}return u.mutationQueue.addMutationBatch(v,d,y,l)}).next(I=>{m=I;const y=I.applyToLocalDocumentSet(p,j);return u.documentOverlayCache.saveOverlays(v,I.batchId,y)})}).then(()=>({batchId:m.batchId,changes:fb(p)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,u){let d=o.Ba[o.currentUser.toKey()];d||(d=new it(Me)),d=d.insert(l,u),o.Ba[o.currentUser.toKey()]=d}(r,s.batchId,n),await fl(r,s.changes),await td(r.remoteStore)}catch(s){const i=fp(s,"Failed to persist write");n.reject(i)}}async function Hb(t,e){const n=ve(t);try{const r=await xP(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Na.get(i);o&&(Ue(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?o.va=!0:s.modifiedDocuments.size>0?Ue(o.va):s.removedDocuments.size>0&&(Ue(o.va),o.va=!1))}),await fl(n,r,e)}catch(r){await ll(r)}}function Xx(t,e,n){const r=ve(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const u=ve(o);u.onlineState=l;let d=!1;u.queries.forEach((h,p)=>{for(const m of p.j_)m.Z_(l)&&(d=!0)}),d&&gp(u)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function s2(t,e,n){const r=ve(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let o=new it(le.comparator);o=o.insert(i,Qt.newNoDocument(i,xe.min()));const l=Te().add(i),u=new Xu(xe.min(),new Map,new it(Me),o,l);await Hb(r,u),r.Oa=r.Oa.remove(i),r.Na.delete(e),xp(r)}else await Tf(r.localStore,e,!1).then(()=>If(r,e,n)).catch(ll)}async function i2(t,e){const n=ve(t),r=e.batch.batchId;try{const s=await yP(n.localStore,e);Kb(n,r,null),Gb(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await fl(n,s)}catch(s){await ll(s)}}async function a2(t,e,n){const r=ve(t);try{const s=await function(o,l){const u=ve(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",d=>{let h;return u.mutationQueue.lookupMutationBatch(d,l).next(p=>(Ue(p!==null),h=p.keys(),u.mutationQueue.removeMutationBatch(d,p))).next(()=>u.mutationQueue.performConsistencyCheck(d)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(d,h,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(d,h)).next(()=>u.localDocuments.getDocuments(d,h))})}(r.localStore,e);Kb(r,e,n),Gb(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await fl(r,s)}catch(s){await ll(s)}}function Gb(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function Kb(t,e,n){const r=ve(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function If(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||Qb(t,r)})}function Qb(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(lp(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),xp(t))}function Zx(t,e,n){for(const r of n)r instanceof zb?(t.La.addReference(r.key,e),o2(t,r)):r instanceof Wb?(ne("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||Qb(t,r.key)):me()}function o2(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(ne("SyncEngine","New document in limbo: "+n),t.xa.add(r),xp(t))}function xp(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new le(Xe.fromString(e)),r=t.qa.next();t.Na.set(r,new YP(n)),t.Oa=t.Oa.insert(n,r),Mb(t.remoteStore,new ds(mr(qu(n.path)),r,"TargetPurposeLimboResolution",Qm.oe))}}async function fl(t,e,n){const r=ve(t),s=[],i=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach((l,u)=>{o.push(r.Ka(u,e,n).then(d=>{var h;if((d||n)&&r.isPrimaryClient){const p=d?!d.fromCache:(h=n==null?void 0:n.targetChanges.get(u.targetId))===null||h===void 0?void 0:h.current;r.sharedClientState.updateQueryState(u.targetId,p?"current":"not-current")}if(d){s.push(d);const p=op.Wi(u.targetId,d);i.push(p)}}))}),await Promise.all(o),r.Ca.d_(s),await async function(u,d){const h=ve(u);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>H.forEach(d,m=>H.forEach(m.$i,v=>h.persistence.referenceDelegate.addReference(p,m.targetId,v)).next(()=>H.forEach(m.Ui,v=>h.persistence.referenceDelegate.removeReference(p,m.targetId,v)))))}catch(p){if(!cl(p))throw p;ne("LocalStore","Failed to update sequence numbers: "+p)}for(const p of d){const m=p.targetId;if(!p.fromCache){const v=h.os.get(m),T=v.snapshotVersion,j=v.withLastLimboFreeSnapshotVersion(T);h.os=h.os.insert(m,j)}}}(r.localStore,i))}async function l2(t,e){const n=ve(t);if(!n.currentUser.isEqual(e)){ne("SyncEngine","User change. New user:",e.toKey());const r=await Pb(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(u=>{u.reject(new J(W.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await fl(n,r.hs)}}function c2(t,e){const n=ve(t),r=n.Na.get(e);if(r&&r.va)return Te().add(r.key);{let s=Te();const i=n.Ma.get(e);if(!i)return s;for(const o of i){const l=n.Fa.get(o);s=s.unionWith(l.view.Va)}return s}}function Yb(t){const e=ve(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Hb.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=c2.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=s2.bind(null,e),e.Ca.d_=HP.bind(null,e.eventManager),e.Ca.$a=GP.bind(null,e.eventManager),e}function u2(t){const e=ve(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=i2.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=a2.bind(null,e),e}class pu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Zu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return gP(this.persistence,new mP,e.initialUser,this.serializer)}Ga(e){return new dP(ap.Zr,this.serializer)}Wa(e){return new NP}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}pu.provider={build:()=>new pu};class jf{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Xx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=l2.bind(null,this.syncEngine),await zP(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new qP}()}createDatastore(e){const n=Zu(e.databaseInfo.databaseId),r=function(i){return new SP(i)}(e.databaseInfo);return function(i,o,l,u){return new CP(i,o,l,u)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new AP(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Xx(this.syncEngine,n,0),function(){return Gx.D()?new Gx:new EP}())}createSyncEngine(e,n){return function(s,i,o,l,u,d,h){const p=new JP(s,i,o,l,u,d);return h&&(p.Qa=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ve(s);ne("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await hl(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}jf.provider={build:()=>new jf};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Br("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Gt.UNAUTHENTICATED,this.clientId=Z_.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{ne("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(ne("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Pr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=fp(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function oh(t,e){t.asyncQueue.verifyOperationInProgress(),ne("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await Pb(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function ev(t,e){t.asyncQueue.verifyOperationInProgress();const n=await h2(t);ne("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Kx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>Kx(e.remoteStore,s)),t._onlineComponents=e}async function h2(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ne("FirestoreClient","Using user provided OfflineComponentProvider");try{await oh(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===W.FAILED_PRECONDITION||s.code===W.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;aa("Error using user provided cache. Falling back to memory cache: "+n),await oh(t,new pu)}}else ne("FirestoreClient","Using default OfflineComponentProvider"),await oh(t,new pu);return t._offlineComponents}async function Jb(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ne("FirestoreClient","Using user provided OnlineComponentProvider"),await ev(t,t._uninitializedComponentsProvider._online)):(ne("FirestoreClient","Using default OnlineComponentProvider"),await ev(t,new jf))),t._onlineComponents}function f2(t){return Jb(t).then(e=>e.syncEngine)}async function gu(t){const e=await Jb(t),n=e.eventManager;return n.onListen=XP.bind(null,e.syncEngine),n.onUnlisten=t2.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=ZP.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=n2.bind(null,e.syncEngine),n}function m2(t,e,n={}){const r=new Pr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new vp({next:m=>{h.Za(),o.enqueueAndForget(()=>pp(i,p));const v=m.docs.has(l);!v&&m.fromCache?d.reject(new J(W.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&m.fromCache&&u&&u.source==="server"?d.reject(new J(W.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new yp(qu(l.path),h,{includeMetadataChanges:!0,_a:!0});return mp(i,p)}(await gu(t),t.asyncQueue,e,n,r)),r.promise}function p2(t,e,n={}){const r=new Pr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,u,d){const h=new vp({next:m=>{h.Za(),o.enqueueAndForget(()=>pp(i,p)),m.fromCache&&u.source==="server"?d.reject(new J(W.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):d.resolve(m)},error:m=>d.reject(m)}),p=new yp(l,h,{includeMetadataChanges:!0,_a:!0});return mp(i,p)}(await gu(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xb(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tv=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zb(t,e,n){if(!n)throw new J(W.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function g2(t,e,n,r){if(e===!0&&r===!0)throw new J(W.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function nv(t){if(!le.isDocumentKey(t))throw new J(W.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function rv(t){if(le.isDocumentKey(t))throw new J(W.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function nd(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":me()}function rn(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new J(W.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=nd(t);throw new J(W.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function y2(t,e){if(e<=0)throw new J(W.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sv{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new J(W.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new J(W.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}g2("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Xb((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new J(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new J(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new J(W.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class rd{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new sv({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new J(W.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new J(W.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new sv(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new LR;switch(r.type){case"firstParty":return new FR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new J(W.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=tv.get(n);r&&(ne("ComponentProvider","Removing Datastore"),tv.delete(n),r.terminate())}(this),Promise.resolve()}}function x2(t,e,n,r={}){var s;const i=(t=rn(t,rd))._getSettings(),o=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==o&&aa("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:o,ssl:!1})),r.mockUserToken){let l,u;if(typeof r.mockUserToken=="string")l=r.mockUserToken,u=Gt.MOCK_USER;else{l=_R(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const d=r.mockUserToken.sub||r.mockUserToken.user_id;if(!d)throw new J(W.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");u=new Gt(d)}t._authCredentials=new OR(new X_(l,u))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qr{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qr(this.firestore,e,this._query)}}class Yt{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new bs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Yt(this.firestore,e,this._key)}}class bs extends qr{constructor(e,n,r){super(e,n,qu(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Yt(this.firestore,null,new le(e))}withConverter(e){return new bs(this.firestore,e,this._path)}}function ie(t,e,...n){if(t=Un(t),Zb("collection","path",e),t instanceof rd){const r=Xe.fromString(e,...n);return rv(r),new bs(t,null,r)}{if(!(t instanceof Yt||t instanceof bs))throw new J(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Xe.fromString(e,...n));return rv(r),new bs(t.firestore,null,r)}}function Y(t,e,...n){if(t=Un(t),arguments.length===1&&(e=Z_.newId()),Zb("doc","path",e),t instanceof rd){const r=Xe.fromString(e,...n);return nv(r),new Yt(t,null,new le(r))}{if(!(t instanceof Yt||t instanceof bs))throw new J(W.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Xe.fromString(e,...n));return nv(r),new Yt(t.firestore,t instanceof bs?t.converter:null,new le(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Lb(this,"async_queue_retry"),this.Vu=()=>{const r=ah();r&&ne("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=ah();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=ah();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new Pr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!cl(e))throw e;ne("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(r);throw Br("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=hp.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&me()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function av(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}class yr extends rd{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new iv,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new iv(e),this._firestoreClient=void 0,await e}}}function v2(t,e){const n=typeof t=="object"?t:Mm(),r=typeof t=="string"?t:"(default)",s=Mu(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=wR("firestore");i&&x2(s,...i)}return s}function ml(t){if(t._terminated)throw new J(W.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||w2(t),t._firestoreClient}function w2(t){var e,n,r;const s=t._freezeSettings(),i=function(l,u,d,h){return new XR(l,u,d,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,Xb(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new d2(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ma(Ut.fromBase64String(e))}catch(n){throw new J(W.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ma(Ut.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new J(W.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ot(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wp{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new J(W.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new J(W.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Me(this._lat,e._lat)||Me(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _p{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2=/^__.*__$/;class b2{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ds(e,this.data,this.fieldMask,n,this.fieldTransforms):new ul(e,this.data,n,this.fieldTransforms)}}class eN{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Ds(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function tN(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw me()}}class sd{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new sd(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return yu(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(tN(this.Cu)&&_2.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class N2{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Zu(e)}Qu(e,n,r,s=!1){return new sd({Cu:e,methodName:n,qu:r,path:Ot.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function gl(t){const e=t._freezeSettings(),n=Zu(t._databaseId);return new N2(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bp(t,e,n,r,s,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Sp("Data must be an object, but it was:",o,r);const l=iN(r,o);let u,d;if(i.merge)u=new wn(o.fieldMask),d=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const p of i.mergeFields){const m=Cf(e,p,n);if(!o.contains(m))throw new J(W.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);oN(h,m)||h.push(m)}u=new wn(h),d=o.fieldTransforms.filter(p=>u.covers(p.field))}else u=null,d=o.fieldTransforms;return new b2(new dn(l),u,d)}class id extends pi{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof id}}function nN(t,e,n){return new sd({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Np extends pi{_toFieldTransform(e){return new Qu(e.path,new Go)}isEqual(e){return e instanceof Np}}class Ep extends pi{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=nN(this,e,!0),r=this.Ku.map(i=>gi(i,n)),s=new ua(r);return new Qu(e.path,s)}isEqual(e){return e instanceof Ep&&Gm(this.Ku,e.Ku)}}class kp extends pi{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=nN(this,e,!0),r=this.Ku.map(i=>gi(i,n)),s=new da(r);return new Qu(e.path,s)}isEqual(e){return e instanceof kp&&Gm(this.Ku,e.Ku)}}class Tp extends pi{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new Ko(e.serializer,gb(e.serializer,this.$u));return new Qu(e.path,n)}isEqual(e){return e instanceof Tp&&this.$u===e.$u}}function rN(t,e,n,r){const s=t.Qu(1,e,n);Sp("Data must be an object, but it was:",s,r);const i=[],o=dn.empty();fi(r,(u,d)=>{const h=Ip(e,u,n);d=Un(d);const p=s.Nu(h);if(d instanceof id)i.push(h);else{const m=gi(d,p);m!=null&&(i.push(h),o.set(h,m))}});const l=new wn(i);return new eN(o,l,s.fieldTransforms)}function sN(t,e,n,r,s,i){const o=t.Qu(1,e,n),l=[Cf(e,r,n)],u=[s];if(i.length%2!=0)throw new J(W.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(Cf(e,i[m])),u.push(i[m+1]);const d=[],h=dn.empty();for(let m=l.length-1;m>=0;--m)if(!oN(d,l[m])){const v=l[m];let T=u[m];T=Un(T);const j=o.Nu(v);if(T instanceof id)d.push(v);else{const I=gi(T,j);I!=null&&(d.push(v),h.set(v,I))}}const p=new wn(d);return new eN(h,p,o.fieldTransforms)}function E2(t,e,n,r=!1){return gi(n,t.Qu(r?4:3,e))}function gi(t,e){if(aN(t=Un(t)))return Sp("Unsupported field value:",e,t),iN(t,e);if(t instanceof pi)return function(r,s){if(!tN(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let u=gi(l,s.Lu(o));u==null&&(u={nullValue:"NULL_VALUE"}),i.push(u),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Un(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gb(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=kt.fromDate(r);return{timestampValue:fu(s.serializer,i)}}if(r instanceof kt){const i=new kt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:fu(s.serializer,i)}}if(r instanceof wp)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ma)return{bytesValue:Tb(s.serializer,r._byteString)};if(r instanceof Yt){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:sp(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof _p)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Bu("VectorValues must only contain numeric values.");return tp(l.serializer,u)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${nd(r)}`)}(t,e)}function iN(t,e){const n={};return eb(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):fi(t,(r,s)=>{const i=gi(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function aN(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof kt||t instanceof wp||t instanceof ma||t instanceof Yt||t instanceof pi||t instanceof _p)}function Sp(t,e,n){if(!aN(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=nd(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function Cf(t,e,n){if((e=Un(e))instanceof pl)return e._internalPath;if(typeof e=="string")return Ip(t,e);throw yu("Field path arguments must be of type string or ",t,!1,void 0,n)}const k2=new RegExp("[~\\*/\\[\\]]");function Ip(t,e,n){if(e.search(k2)>=0)throw yu(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new pl(...e.split("."))._internalPath}catch{throw yu(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function yu(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(i||o)&&(u+=" (found",i&&(u+=` in field ${r}`),o&&(u+=` in document ${s}`),u+=")"),new J(W.INVALID_ARGUMENT,l+t+u)}function oN(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Yt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new T2(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(ad("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class T2 extends lN{data(){return super.data()}}function ad(t,e){return typeof e=="string"?Ip(t,e):e instanceof pl?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cN(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new J(W.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class jp{}class Cp extends jp{}function We(t,e,...n){let r=[];e instanceof jp&&r.push(e),r=r.concat(n),function(i){const o=i.filter(u=>u instanceof Rp).length,l=i.filter(u=>u instanceof od).length;if(o>1||o>0&&l>0)throw new J(W.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class od extends Cp{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new od(e,n,r)}_apply(e){const n=this._parse(e);return uN(e._query,n),new qr(e.firestore,e.converter,_f(e._query,n))}_parse(e){const n=gl(e.firestore);return function(i,o,l,u,d,h,p){let m;if(d.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new J(W.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){lv(p,h);const v=[];for(const T of p)v.push(ov(u,i,T));m={arrayValue:{values:v}}}else m=ov(u,i,p)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||lv(p,h),m=E2(l,o,p,h==="in"||h==="not-in");return wt.create(d,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function ct(t,e,n){const r=e,s=ad("where",t);return od._create(s,r,n)}class Rp extends jp{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Rp(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:Xn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const u of l)uN(o,u),o=_f(o,u)}(e._query,n),new qr(e.firestore,e.converter,_f(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Ap extends Cp{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Ap(e,n)}_apply(e){const n=function(s,i,o){if(s.startAt!==null)throw new J(W.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new J(W.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Ho(i,o)}(e._query,this._field,this._direction);return new qr(e.firestore,e.converter,function(s,i){const o=s.explicitOrderBy.concat([i]);return new Na(s.path,s.collectionGroup,o,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function Xt(t,e="asc"){const n=e,r=ad("orderBy",t);return Ap._create(r,n)}class Pp extends Cp{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Pp(e,n,r)}_apply(e){return new qr(e.firestore,e.converter,hu(e._query,this._limit,this._limitType))}}function Is(t){return y2("limit",t),Pp._create("limit",t,"F")}function ov(t,e,n){if(typeof(n=Un(n))=="string"){if(n==="")throw new J(W.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cb(e)&&n.indexOf("/")!==-1)throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Xe.fromString(n));if(!le.isDocumentKey(r))throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Ix(t,new le(r))}if(n instanceof Yt)return Ix(t,n._key);throw new J(W.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${nd(n)}.`)}function lv(t,e){if(!Array.isArray(t)||t.length===0)throw new J(W.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function uN(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new J(W.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new J(W.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class S2{convertValue(e,n="none"){switch(li(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ft(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(oi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw me()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return fi(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>ft(o.doubleValue));return new _p(i)}convertGeoPoint(e){return new wp(ft(e.latitude),ft(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Jm(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(zo(e));default:return null}}convertTimestamp(e){const n=Ts(e);return new kt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Xe.fromString(e);Ue(Ab(r));const s=new Wo(r.get(1),r.get(3)),i=new le(r.popFirst(5));return s.isEqual(n)||Br(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dp(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class dN extends lN{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Cc(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(ad("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class Cc extends dN{data(e={}){return super.data(e)}}class hN{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new so(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Cc(this._firestore,this._userDataWriter,r.key,r,new so(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new J(W.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const u=new Cc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new so(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const u=new Cc(s._firestore,s._userDataWriter,l.doc.key,l.doc,new so(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let d=-1,h=-1;return l.type!==0&&(d=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:I2(l.type),doc:u,oldIndex:d,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function I2(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return me()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _n(t){t=rn(t,Yt);const e=rn(t.firestore,yr);return m2(ml(e),t._key).then(n=>fN(e,t,n))}class Lp extends S2{constructor(e){super(),this.firestore=e}convertBytes(e){return new ma(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Yt(this.firestore,null,n)}}function Dn(t){t=rn(t,qr);const e=rn(t.firestore,yr),n=ml(e),r=new Lp(e);return cN(t._query),p2(n,t._query).then(s=>new hN(e,r,t,s))}function xu(t,e,n){t=rn(t,Yt);const r=rn(t.firestore,yr),s=Dp(t.converter,e,n);return yl(r,[bp(gl(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,nn.none())])}function ue(t,e,n,...r){t=rn(t,Yt);const s=rn(t.firestore,yr),i=gl(s);let o;return o=typeof(e=Un(e))=="string"||e instanceof pl?sN(i,"updateDoc",t._key,e,n,r):rN(i,"updateDoc",t._key,e),yl(s,[o.toMutation(t._key,nn.exists(!0))])}function js(t){return yl(rn(t.firestore,yr),[new Ju(t._key,nn.none())])}function Ge(t,e){const n=rn(t.firestore,yr),r=Y(t),s=Dp(t.converter,e);return yl(n,[bp(gl(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,nn.exists(!1))]).then(()=>r)}function qe(t,...e){var n,r,s;t=Un(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||av(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(av(e[o])){const p=e[o];e[o]=(n=p.next)===null||n===void 0?void 0:n.bind(p),e[o+1]=(r=p.error)===null||r===void 0?void 0:r.bind(p),e[o+2]=(s=p.complete)===null||s===void 0?void 0:s.bind(p)}let u,d,h;if(t instanceof Yt)d=rn(t.firestore,yr),h=qu(t._key.path),u={next:p=>{e[o]&&e[o](fN(d,t,p))},error:e[o+1],complete:e[o+2]};else{const p=rn(t,qr);d=rn(p.firestore,yr),h=p._query;const m=new Lp(d);u={next:v=>{e[o]&&e[o](new hN(d,m,p,v))},error:e[o+1],complete:e[o+2]},cN(t._query)}return function(m,v,T,j){const I=new vp(j),y=new yp(v,I,T);return m.asyncQueue.enqueueAndForget(async()=>mp(await gu(m),y)),()=>{I.Za(),m.asyncQueue.enqueueAndForget(async()=>pp(await gu(m),y))}}(ml(d),h,l,u)}function yl(t,e){return function(r,s){const i=new Pr;return r.asyncQueue.enqueueAndForget(async()=>r2(await f2(r),s,i)),i.promise}(ml(t),e)}function fN(t,e,n){const r=n.docs.get(e._key),s=new Lp(t);return new dN(t,s,e._key,r,new so(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j2{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=gl(e)}set(e,n,r){this._verifyNotCommitted();const s=lh(e,this._firestore),i=Dp(s.converter,n,r),o=bp(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(o.toMutation(s._key,nn.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=lh(e,this._firestore);let o;return o=typeof(n=Un(n))=="string"||n instanceof pl?sN(this._dataReader,"WriteBatch.update",i._key,n,r,s):rN(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,nn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=lh(e,this._firestore);return this._mutations=this._mutations.concat(new Ju(n._key,nn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new J(W.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function lh(t,e){if((t=Un(t)).firestore!==e)throw new J(W.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function ke(){return new Np("serverTimestamp")}function Et(...t){return new Ep("arrayUnion",t)}function hn(...t){return new kp("arrayRemove",t)}function xt(t){return new Tp("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rf(t){return ml(t=rn(t,yr)),new j2(t,e=>yl(t,e))}(function(e,n=!0){(function(s){ba=s})(hi),ri(new jR("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new yr(new MR(r.getProvider("auth-internal")),new BR(r.getProvider("app-check-internal")),function(d,h){if(!Object.prototype.hasOwnProperty.apply(d.options,["projectId"]))throw new J(W.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Wo(d.options.projectId,h)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),dr(Nx,"4.7.3",e),dr(Nx,"4.7.3","esm2017")})();var cv={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},C2=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],u=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(u&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},pN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,u=s+2<t.length,d=u?t[s+2]:0,h=i>>2,p=(i&3)<<4|l>>4;let m=(l&15)<<2|d>>6,v=d&63;u||(v=64,o||(m=64)),r.push(n[h],n[p],n[m],n[v])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(mN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):C2(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const d=s<t.length?n[t.charAt(s)]:64;++s;const p=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||d==null||p==null)throw new R2;const m=i<<2|l>>4;if(r.push(m),d!==64){const v=l<<4&240|d>>2;if(r.push(v),p!==64){const T=d<<6&192|p;r.push(T)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class R2 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const A2=function(t){const e=mN(t);return pN.encodeByteArray(e,!0)},uv=function(t){return A2(t).replace(/\./g,"")},P2=function(t){try{return pN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D2(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L2=()=>D2().__FIREBASE_DEFAULTS__,O2=()=>{if(typeof process>"u"||typeof cv>"u")return;const t=cv.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},M2=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&P2(t[1]);return e&&JSON.parse(e)},V2=()=>{try{return L2()||O2()||M2()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},F2=t=>{var e,n;return(n=(e=V2())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},U2=t=>{const e=F2(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B2(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[uv(JSON.stringify(n)),uv(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $2="FirebaseError";class ld extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=$2,Object.setPrototypeOf(this,ld.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,z2.prototype.create)}}class z2{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?W2(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new ld(s,l,r)}}function W2(t,e){return t.replace(q2,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const q2=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cd(t){return t&&t._delegate?t._delegate:t}class H2{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gN="firebasestorage.googleapis.com",yN="storageBucket",G2=2*60*1e3,K2=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt extends ld{constructor(e,n,r=0){super(ch(e),`Firebase Storage: ${n} (${ch(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,dt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ch(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var ut;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(ut||(ut={}));function ch(t){return"storage/"+t}function Op(){const t="An unknown error occurred, please check the error payload for server response.";return new dt(ut.UNKNOWN,t)}function Q2(t){return new dt(ut.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Y2(t){return new dt(ut.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function J2(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new dt(ut.UNAUTHENTICATED,t)}function X2(){return new dt(ut.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Z2(t){return new dt(ut.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function eD(){return new dt(ut.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function tD(){return new dt(ut.CANCELED,"User canceled the upload/download.")}function nD(t){return new dt(ut.INVALID_URL,"Invalid URL '"+t+"'.")}function rD(t){return new dt(ut.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function sD(){return new dt(ut.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+yN+"' property when initializing the app?")}function iD(){return new dt(ut.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function aD(){return new dt(ut.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function oD(t){return new dt(ut.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function Af(t){return new dt(ut.INVALID_ARGUMENT,t)}function xN(){return new dt(ut.APP_DELETED,"The Firebase app was deleted.")}function lD(t){return new dt(ut.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function wo(t,e){return new dt(ut.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function Ga(t){throw new dt(ut.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bn{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=bn.makeFromUrl(e,n)}catch{return new bn(e,"")}if(r.path==="")return r;throw rD(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(A){A.path.charAt(A.path.length-1)==="/"&&(A.path_=A.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),u={bucket:1,path:3};function d(A){A.path_=decodeURIComponent(A.path)}const h="v[A-Za-z0-9_]+",p=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",v=new RegExp(`^https?://${p}/${h}/b/${s}/o${m}`,"i"),T={bucket:1,path:3},j=n===gN?"(?:storage.googleapis.com|storage.cloud.google.com)":n,I="([^?#]*)",y=new RegExp(`^https?://${j}/${s}/${I}`,"i"),b=[{regex:l,indices:u,postModify:i},{regex:v,indices:T,postModify:d},{regex:y,indices:{bucket:1,path:2},postModify:d}];for(let A=0;A<b.length;A++){const V=b[A],M=V.regex.exec(e);if(M){const N=M[V.indices.bucket];let x=M[V.indices.path];x||(x=""),r=new bn(N,x),V.postModify(r);break}}if(r==null)throw nD(e);return r}}class cD{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uD(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function u(){return l===2}let d=!1;function h(...I){d||(d=!0,e.apply(null,I))}function p(I){s=setTimeout(()=>{s=null,t(v,u())},I)}function m(){i&&clearTimeout(i)}function v(I,...y){if(d){m();return}if(I){m(),h.call(null,I,...y);return}if(u()||o){m(),h.call(null,I,...y);return}r<64&&(r*=2);let b;l===1?(l=2,b=0):b=(r+Math.random())*1e3,p(b)}let T=!1;function j(I){T||(T=!0,m(),!d&&(s!==null?(I||(l=2),clearTimeout(s),p(0)):I||(l=1)))}return p(0),i=setTimeout(()=>{o=!0,j(!0)},n),j}function dD(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hD(t){return t!==void 0}function fD(t){return typeof t=="object"&&!Array.isArray(t)}function Mp(t){return typeof t=="string"||t instanceof String}function dv(t){return Vp()&&t instanceof Blob}function Vp(){return typeof Blob<"u"}function hv(t,e,n,r){if(r<e)throw Af(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw Af(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fp(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function vN(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Js;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Js||(Js={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mD(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(e,n,r,s,i,o,l,u,d,h,p,m=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=u,this.timeout_=d,this.progressCallback_=h,this.connectionFactory_=p,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((v,T)=>{this.resolve_=v,this.reject_=T,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ac(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const u=l.loaded,d=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(u,d)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Js.NO_ERROR,u=i.getStatus();if(!l||mD(u,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Js.ABORT;r(!1,new ac(!1,null,h));return}const d=this.successCodes_.indexOf(u)!==-1;r(!0,new ac(d,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const u=this.callback_(l,l.getResponse());hD(u)?i(u):i()}catch(u){o(u)}else if(l!==null){const u=Op();u.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,u)):o(u)}else if(s.canceled){const u=this.appDelete_?xN():tD();o(u)}else{const u=eD();o(u)}};this.canceled_?n(!1,new ac(!1,null,!0)):this.backoffId_=uD(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&dD(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ac{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function gD(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function yD(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function xD(t,e){e&&(t["X-Firebase-GMPID"]=e)}function vD(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function wD(t,e,n,r,s,i,o=!0){const l=vN(t.urlParams),u=t.url+l,d=Object.assign({},t.headers);return xD(d,e),gD(d,n),yD(d,i),vD(d,r),new pD(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function bD(...t){const e=_D();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(Vp())return new Blob(t);throw new dt(ut.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function ND(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ED(t){if(typeof atob>"u")throw oD("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class uh{constructor(e,n){this.data=e,this.contentType=n||null}}function kD(t,e){switch(t){case lr.RAW:return new uh(wN(e));case lr.BASE64:case lr.BASE64URL:return new uh(_N(t,e));case lr.DATA_URL:return new uh(SD(e),ID(e))}throw Op()}function wN(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function TD(t){let e;try{e=decodeURIComponent(t)}catch{throw wo(lr.DATA_URL,"Malformed data URL.")}return wN(e)}function _N(t,e){switch(t){case lr.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw wo(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case lr.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw wo(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ED(e)}catch(s){throw s.message.includes("polyfill")?s:wo(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class bN{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw wo(lr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=jD(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function SD(t){const e=new bN(t);return e.base64?_N(lr.BASE64,e.rest):TD(e.rest)}function ID(t){return new bN(t).contentType}function jD(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ls{constructor(e,n){let r=0,s="";dv(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(dv(this.data_)){const r=this.data_,s=ND(r,e,n);return s===null?null:new ls(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new ls(r,!0)}}static getBlob(...e){if(Vp()){const n=e.map(r=>r instanceof ls?r.data_:r);return new ls(bD.apply(null,n))}else{const n=e.map(o=>Mp(o)?kD(lr.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new ls(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NN(t){let e;try{e=JSON.parse(t)}catch{return null}return fD(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CD(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function RD(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function EN(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function AD(t,e){return e}class Zt{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||AD}}let oc=null;function PD(t){return!Mp(t)||t.length<2?t:EN(t)}function kN(){if(oc)return oc;const t=[];t.push(new Zt("bucket")),t.push(new Zt("generation")),t.push(new Zt("metageneration")),t.push(new Zt("name","fullPath",!0));function e(i,o){return PD(o)}const n=new Zt("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Zt("size");return s.xform=r,t.push(s),t.push(new Zt("timeCreated")),t.push(new Zt("updated")),t.push(new Zt("md5Hash",null,!0)),t.push(new Zt("cacheControl",null,!0)),t.push(new Zt("contentDisposition",null,!0)),t.push(new Zt("contentEncoding",null,!0)),t.push(new Zt("contentLanguage",null,!0)),t.push(new Zt("contentType",null,!0)),t.push(new Zt("metadata","customMetadata",!0)),oc=t,oc}function DD(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new bn(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function LD(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return DD(r,t),r}function TN(t,e,n){const r=NN(e);return r===null?null:LD(t,r,n)}function OD(t,e,n,r){const s=NN(e);if(s===null||!Mp(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(d=>{const h=t.bucket,p=t.fullPath,m="/b/"+o(h)+"/o/"+o(p),v=Fp(m,n,r),T=vN({alt:"media",token:d});return v+T})[0]}function MD(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class SN{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(t){if(!t)throw Op()}function VD(t,e){function n(r,s){const i=TN(t,s,e);return IN(i!==null),i}return n}function FD(t,e){function n(r,s){const i=TN(t,s,e);return IN(i!==null),OD(i,s,t.host,t._protocol)}return n}function jN(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=X2():s=J2():n.getStatus()===402?s=Y2(t.bucket):n.getStatus()===403?s=Z2(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function UD(t){const e=jN(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=Q2(t.path)),i.serverResponse=s.serverResponse,i}return n}function BD(t,e,n){const r=e.fullServerUrl(),s=Fp(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new SN(s,i,FD(t,n),o);return l.errorHandler=UD(e),l}function $D(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function zD(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=$D(null,e)),r}function WD(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let b="";for(let A=0;A<2;A++)b=b+Math.random().toString().slice(2);return b}const u=l();o["Content-Type"]="multipart/related; boundary="+u;const d=zD(e,r,s),h=MD(d,n),p="--"+u+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+u+`\r
Content-Type: `+d.contentType+`\r
\r
`,m=`\r
--`+u+"--",v=ls.getBlob(p,r,m);if(v===null)throw iD();const T={name:d.fullPath},j=Fp(i,t.host,t._protocol),I="POST",y=t.maxUploadRetryTime,_=new SN(j,I,VD(t,n),y);return _.urlParams=T,_.headers=o,_.body=v.uploadData(),_.errorHandler=jN(e),_}class qD{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Js.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Js.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Js.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s){if(this.sent_)throw Ga("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),s!==void 0)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw Ga("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw Ga("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw Ga("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw Ga("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class HD extends qD{initXhr(){this.xhr_.responseType="text"}}function CN(){return new HD}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ci{constructor(e,n){this._service=e,n instanceof bn?this._location=n:this._location=bn.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ci(e,n)}get root(){const e=new bn(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return EN(this._location.path)}get storage(){return this._service}get parent(){const e=CD(this._location.path);if(e===null)return null;const n=new bn(this._location.bucket,e);return new ci(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw lD(e)}}function GD(t,e,n){t._throwIfRoot("uploadBytes");const r=WD(t.storage,t._location,kN(),new ls(e,!0),n);return t.storage.makeRequestWithTokens(r,CN).then(s=>({metadata:s,ref:t}))}function KD(t){t._throwIfRoot("getDownloadURL");const e=BD(t.storage,t._location,kN());return t.storage.makeRequestWithTokens(e,CN).then(n=>{if(n===null)throw aD();return n})}function QD(t,e){const n=RD(t._location.path,e),r=new bn(t._location.bucket,n);return new ci(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YD(t){return/^[A-Za-z]+:\/\//.test(t)}function JD(t,e){return new ci(t,e)}function RN(t,e){if(t instanceof Up){const n=t;if(n._bucket==null)throw sD();const r=new ci(n,n._bucket);return e!=null?RN(r,e):r}else return e!==void 0?QD(t,e):t}function XD(t,e){if(e&&YD(e)){if(t instanceof Up)return JD(t,e);throw Af("To use ref(service, url), the first argument must be a Storage instance.")}else return RN(t,e)}function fv(t,e){const n=e==null?void 0:e[yN];return n==null?null:bn.makeFromBucketSpec(n,t)}function ZD(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:B2(s,t.app.options.projectId))}class Up{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=gN,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=G2,this._maxUploadRetryTime=K2,this._requests=new Set,s!=null?this._bucket=bn.makeFromBucketSpec(s,this._host):this._bucket=fv(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=bn.makeFromBucketSpec(this._url,e):this._bucket=fv(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){hv("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){hv("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ci(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new cD(xN());{const o=wD(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const mv="@firebase/storage",pv="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AN="storage";function En(t,e,n){return t=cd(t),GD(t,e,n)}function kn(t){return t=cd(t),KD(t)}function Tn(t,e){return t=cd(t),XD(t,e)}function e4(t=Mm(),e){t=cd(t);const r=Mu(t,AN).getImmediate({identifier:e}),s=U2("storage");return s&&t4(r,...s),r}function t4(t,e,n,r={}){ZD(t,e,n,r)}function n4(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Up(n,r,s,e,hi)}function r4(){ri(new H2(AN,n4,"PUBLIC").setMultipleInstances(!0)),dr(mv,pv,""),dr(mv,pv,"esm2017")}r4();const s4={apiKey:"AIzaSyCeBLEh6xtwDtnMWrj8N3As7tcJ_ZX8Yis",authDomain:"tukumi-7d3b8.firebaseapp.com",projectId:"tukumi-7d3b8",storageBucket:"tukumi-7d3b8.firebasestorage.app",messagingSenderId:"1040756277051",appId:"1:1040756277051:web:8d4604e5bbe7f35edc411e",measurementId:"G-WY8V9GB1RW"},Bp=Zw(s4),_e=oR(Bp),U=v2(Bp),Sn=e4(Bp),i4=()=>{const t=at(),e=tr(),n=l=>e.pathname===l||l!=="/"&&e.pathname.startsWith(l+"/"),[r,s]=w.useState({displayName:"",handle:"",photoURL:null});w.useEffect(()=>{const l=Tt(_e,u=>{if(u){s(h=>({...h,displayName:u.displayName||"Aristocrat",handle:u.email?u.email.split("@")[0]:"user-handle",photoURL:u.photoURL}));const d=qe(Y(U,"users",u.uid),h=>{h.exists()&&s(h.data())});return()=>d()}else s({displayName:"",handle:"",photoURL:null})});return()=>l()},[]);const i=async()=>{try{await Bu(_e),t("/auth")}catch(l){console.error("Error signing out",l)}},o=({to:l,icon:u,label:d,badge:h})=>a.jsxs("div",{onClick:()=>t(l),className:`group flex items-center p-3 my-2 rounded-2xl cursor-pointer transition-all duration-200 font-medium
			${n(l)&&l!=="/"||n(l)&&l==="/"&&e.pathname==="/"?"bg-primary text-white shadow-lg shadow-primary/30 translate-x-2":"text-gray-600 hover:bg-white hover:text-primary hover:translate-x-1"}`,children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center mr-3 transition-all
				${n(l)?"bg-white/20":"bg-white shadow-sm group-hover:shadow-md"}`,children:a.jsx("i",{className:`fas ${u} text-lg`})}),a.jsx("span",{className:"tracking-wide",children:d}),h&&a.jsx("span",{className:"ml-auto bg-accent text-white text-[10px] font-bold px-2 py-1 rounded-full shadow-sm",children:h})]});return a.jsx("div",{className:"hidden md:flex flex-col w-[280px] h-[calc(100vh-40px)] fixed top-5 left-5 z-50",children:a.jsxs("div",{className:"glass-panel flex-1 rounded-[30px] p-6 flex flex-col overflow-y-auto no-scrollbar",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-10 pl-2 cursor-pointer",onClick:()=>t("/"),children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-tr from-primary to-gold rounded-xl flex items-center justify-center shadow-lg shadow-primary/20 relative",children:a.jsx("i",{className:"fas fa-cube text-white text-lg transform -rotate-12"})}),a.jsx("h1",{className:"text-2xl font-black tracking-tighter text-dark",children:"TUKUMI"})]}),a.jsxs("div",{onClick:()=>t("/profile"),className:"mb-8 p-3 bg-white/60 rounded-2xl border border-white flex items-center gap-3 cursor-pointer hover:shadow-md transition-all group",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex-shrink-0 overflow-hidden bg-gray-100 border border-white shadow-sm group-hover:scale-105 transition-transform",children:r.photoURL?a.jsx("img",{src:r.photoURL,onError:l=>{l.target.onerror=null,l.target.src="https://via.placeholder.com/150"},className:"w-full h-full object-cover",alt:"Profile"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center text-gray-300",children:a.jsx("i",{className:"fas fa-user text-xl"})})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:r.displayName||"User"}),a.jsx("p",{className:"text-[10px] text-primary font-bold uppercase tracking-wider",children:"View Profile"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] text-gray-400 font-bold mb-3 pl-4",children:"Menu"}),a.jsx(o,{to:"/",icon:"fa-home",label:"Feed"}),a.jsx(o,{to:"/explore",icon:"fa-compass",label:"Explore",badge:""}),a.jsx(o,{to:"/circles",icon:"fa-dot-circle",label:"Circles"}),a.jsx(o,{to:"/dating",icon:"fa-heart",label:"Dating"}),a.jsx(o,{to:"/watch",icon:"fa-play",label:"Watch"}),a.jsx(o,{to:"/marketplace",icon:"fa-store",label:"Market"}),a.jsx(o,{to:"/messages",icon:"fa-comment-dots",label:"Messages"})]}),a.jsxs("div",{className:"mt-auto pt-6 space-y-3",children:[a.jsxs("div",{className:"bg-gradient-to-br from-primary to-primary-dark rounded-2xl p-5 text-white text-center relative overflow-hidden shadow-lg shadow-primary/20",children:[a.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-white/10 rounded-full -mr-10 -mt-10 blur-xl"}),a.jsx("h5",{className:"font-bold relative z-10",children:"Go Premium"}),a.jsx("p",{className:"text-xs opacity-80 mt-1 mb-3 relative z-10",children:"Unlock Gold Badge"}),a.jsx("button",{className:"bg-white text-primary text-xs font-bold py-2 px-4 rounded-lg w-full hover:bg-gold hover:text-white transition-colors relative z-10",children:"Upgrade"})]}),a.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center gap-2 p-3 rounded-xl text-gray-500 hover:bg-red-50 hover:text-red-500 transition-all font-bold text-sm",children:[a.jsx("i",{className:"fas fa-sign-out-alt"})," Sign Out"]})]})]})})},PN=({onClose:t})=>{const e=at(),[n,r]=w.useState(""),[s,i]=w.useState("all"),[o,l]=w.useState({people:[],business:[],products:[],circles:[],videos:[]}),[u,d]=w.useState(!1);w.useEffect(()=>{const m=setTimeout(()=>{n.trim().length>1?h():l({people:[],business:[],products:[],circles:[],videos:[]})},500);return()=>clearTimeout(m)},[n]);const h=async()=>{d(!0);const m=n.toLowerCase(),v=m.startsWith("@"),T=v?m.substring(1):m,j=(y,_,b)=>We(y,ct(_,">=",b),ct(_,"<=",b+""),Is(5));let I={people:[],business:[],products:[],circles:[],videos:[]};try{if(v){const y=j(ie(U,"users"),"handle",T),_=await Dn(y);I.people=_.docs.map(b=>({id:b.id,...b.data()}))}else{const y=j(ie(U,"users"),"displayName",n),_=await Dn(y);I.people=_.docs.map(b=>({id:b.id,...b.data()}))}if(!v){const y=j(ie(U,"business_pages"),"name",n),_=await Dn(y);I.business=_.docs.map(E=>({id:E.id,...E.data()}));const b=j(ie(U,"marketplace"),"title",n),A=await Dn(b);I.products=A.docs.map(E=>({id:E.id,...E.data()}));const V=j(ie(U,"circles"),"name",n),M=await Dn(V);I.circles=M.docs.map(E=>({id:E.id,...E.data()}));const N=We(ie(U,"posts"),ct("mediaType","==","video"),Xt("timestamp","desc"),Is(20)),x=await Dn(N);I.videos=x.docs.map(E=>({id:E.id,...E.data()})).filter(E=>{var S;return(S=E.text)==null?void 0:S.toLowerCase().includes(m)})}l(I)}catch(y){console.error("Search error:",y)}finally{d(!1)}},p=m=>{e(m),t()};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-start justify-center z-[9999] p-4 pt-20 animate-fade-in cursor-pointer",onClick:t,children:a.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] cursor-default",onClick:m=>m.stopPropagation(),children:[a.jsxs("div",{className:"p-4 border-b border-gray-100 bg-[#F8FAFD]",children:[a.jsxs("div",{className:"flex items-center gap-3 bg-white p-3 rounded-2xl border border-gray-200 shadow-sm focus-within:ring-2 ring-primary/20 transition-all",children:[a.jsx("i",{className:"fas fa-search text-gray-400 text-xl ml-2"}),a.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search Products, Business, People...",className:"flex-1 bg-transparent outline-none text-lg font-medium text-dark placeholder-gray-400",value:n,onChange:m=>r(m.target.value)}),n&&a.jsx("button",{onClick:()=>r(""),className:"text-gray-400 hover:text-dark",children:a.jsx("i",{className:"fas fa-times-circle"})})]}),a.jsx("div",{className:"flex gap-6 mt-4 px-2 overflow-x-auto no-scrollbar",children:["all","products","business","people","circles","videos"].map(m=>a.jsx("button",{onClick:()=>i(m),className:`pb-2 font-bold text-sm capitalize border-b-2 transition-all whitespace-nowrap ${s===m?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:m},m))})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white min-h-[300px]",children:u?a.jsxs("div",{className:"text-center py-10 text-gray-400",children:[a.jsx("i",{className:"fas fa-circle-notch fa-spin text-2xl"}),a.jsx("p",{className:"mt-2 text-xs font-bold",children:"Searching..."})]}):n.length<2?a.jsxs("div",{className:"text-center py-20 text-gray-300",children:[a.jsx("i",{className:"fas fa-search text-4xl mb-4"}),a.jsx("p",{children:"Find products, businesses, or friends."})]}):a.jsxs("div",{className:"space-y-8",children:[(s==="all"||s==="products")&&o.products.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Products"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.products.map(m=>a.jsxs("div",{onClick:()=>p(`/product/${m.id}`),className:"bg-white border border-gray-100 rounded-xl p-2 cursor-pointer hover:shadow-md transition-all flex flex-col",children:[a.jsx("img",{src:m.image,className:"w-full h-24 object-cover rounded-lg mb-2 bg-gray-100",alt:m.title}),a.jsx("h5",{className:"font-bold text-sm text-dark truncate",children:m.title}),a.jsxs("p",{className:"text-primary font-black text-xs",children:[m.currency==="BDT"?"":m.currency,m.price]})]},m.id))})]}),(s==="all"||s==="business")&&o.business.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Businesses"}),a.jsx("div",{className:"space-y-2",children:o.business.map(m=>a.jsxs("div",{onClick:()=>p(`/business/${m.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors border border-transparent hover:border-gray-100",children:[a.jsx("img",{src:m.logo,className:"w-12 h-12 rounded-xl object-cover shadow-sm",alt:m.name}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h5",{className:"font-bold text-dark flex items-center gap-1",children:[m.name,m.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:m.category})]}),a.jsx("button",{className:"text-xs bg-white border border-gray-200 px-3 py-1 rounded-full font-bold hover:bg-dark hover:text-white transition-colors",children:"Visit"})]},m.id))})]}),(s==="all"||s==="people")&&o.people.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"People"}),a.jsx("div",{className:"space-y-2",children:o.people.map(m=>a.jsxs("div",{onClick:()=>p(`/profile/${m.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors",children:[a.jsx("img",{src:m.photoURL||"https://via.placeholder.com/150",className:"w-10 h-10 rounded-full object-cover border border-gray-100",alt:m.displayName}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-sm",children:m.displayName}),a.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:["@",m.handle||"user"]})]})]},m.id))})]}),(s==="all"||s==="circles")&&o.circles.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Circles"}),a.jsx("div",{className:"space-y-2",children:o.circles.map(m=>a.jsxs("div",{onClick:()=>p(`/circles/${m.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors",children:[a.jsx("img",{src:m.image,className:"w-10 h-10 rounded-xl object-cover",alt:m.name}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-sm",children:m.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[m.memberCount||0," Members"]})]})]},m.id))})]}),(s==="all"||s==="videos")&&o.videos.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Videos"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.videos.map(m=>a.jsxs("div",{onClick:()=>p("/watch"),className:"relative rounded-xl overflow-hidden aspect-video cursor-pointer group bg-black",children:[a.jsx("video",{src:m.mediaURL,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white",children:a.jsx("i",{className:"fas fa-play text-xs"})})}),a.jsx("p",{className:"absolute bottom-2 left-2 text-white text-[10px] font-bold truncate w-11/12 shadow-black drop-shadow-md",children:m.text})]},m.id))})]}),Object.values(o).every(m=>m.length===0)&&a.jsxs("div",{className:"text-center py-10 text-gray-400",children:[a.jsx("i",{className:"far fa-folder-open text-2xl mb-2"}),a.jsxs("p",{children:['No results found for "',n,'"']})]})]})}),a.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100 text-center",children:a.jsx("button",{onClick:t,className:"text-gray-500 font-bold text-sm hover:text-dark",children:"Close Search"})})]})})},a4=()=>{const t=at(),e=tr(),n=I=>e.pathname===I,[r,s]=w.useState(!1),[i,o]=w.useState(!0),[l,u]=w.useState(0),d=w.useRef(null),h=w.useRef(!1),p=()=>{h.current=!1,d.current=setTimeout(()=>{h.current=!0,v()},3e3)},m=()=>{clearTimeout(d.current)},v=async()=>{if(navigator.vibrate&&navigator.vibrate(200),window.confirm("Do you want to sign out?"))try{await Bu(_e)}catch(I){console.error(I)}},T=I=>{h.current||t("/")};w.useEffect(()=>{const I=Tt(_e,y=>{if(y){const _=We(ie(U,"conversations"),ct("participants","array-contains",y.uid)),b=qe(_,A=>{let V=0;A.docs.forEach(M=>{const N=M.data();N.unreadCounts&&N.unreadCounts[y.uid]&&(V+=N.unreadCounts[y.uid])}),u(V)});return()=>b()}});return()=>I()},[]),w.useEffect(()=>{const I=b=>{(["input","textarea"].includes(b.target.tagName.toLowerCase())||b.target.isContentEditable)&&o(!1)},y=()=>{setTimeout(()=>{["input","textarea"].includes(document.activeElement.tagName.toLowerCase())||o(!0)},200)},_=b=>o(b.detail.visible);return document.addEventListener("focusin",I),document.addEventListener("focusout",y),window.addEventListener("toggle-nav",_),o(!0),()=>{document.removeEventListener("focusin",I),document.removeEventListener("focusout",y),window.removeEventListener("toggle-nav",_)}},[e.pathname]);const j=({to:I,icon:y,activeColor:_="text-primary",badgeCount:b=0})=>a.jsxs("button",{onClick:()=>t(I),className:`relative flex flex-col items-center justify-center w-full h-full transition-all duration-200 ${n(I)?`${_} -translate-y-1`:"text-gray-400 hover:text-gray-600"}`,children:[a.jsx("span",{className:`text-xl mb-1 ${n(I)?"drop-shadow-sm scale-110":""}`,children:a.jsx("i",{className:`fas ${y}`})}),n(I)&&a.jsx("span",{className:`absolute bottom-2 w-1 h-1 rounded-full ${n(I)&&I==="/dating"?"bg-pink-500":"bg-primary"}`}),b>0&&a.jsx("span",{className:"absolute top-2 right-3 bg-red-500 text-white text-[9px] font-bold min-w-[16px] h-[16px] flex items-center justify-center rounded-full border-2 border-white animate-bounce-in",children:b>9?"9+":b})]});return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`md:hidden fixed bottom-0 left-0 right-0 z-[90] transition-transform duration-300 ease-in-out ${i?"translate-y-0":"translate-y-full"}`,children:a.jsxs("div",{className:"h-[65px] bg-white/95 backdrop-blur-xl border-t border-gray-200 flex justify-between items-center shadow-[0_-5px_20px_rgba(0,0,0,0.05)] px-1 pb-safe",children:[a.jsx(j,{to:"/dating",icon:"fa-heart",activeColor:"text-pink-500"}),a.jsx(j,{to:"/circles",icon:"fa-dot-circle"}),a.jsx(j,{to:"/messages",icon:"fa-comment-dots",badgeCount:l}),a.jsx("div",{className:"relative -top-6 mx-1",children:a.jsx("button",{onMouseDown:p,onMouseUp:m,onTouchStart:p,onTouchEnd:m,onClick:T,className:"w-14 h-14 bg-gradient-to-tr from-primary to-gold rounded-2xl flex items-center justify-center text-white shadow-lg shadow-primary/40 border-4 border-white transform active:scale-95 transition-transform select-none",children:a.jsx("i",{className:"fas fa-cube text-2xl"})})}),a.jsx(j,{to:"/watch",icon:"fa-play"}),a.jsx(j,{to:"/marketplace",icon:"fa-store"}),a.jsx(j,{to:"/profile",icon:"fa-user"})]})}),r&&a.jsx(PN,{onClose:()=>s(!1)})]})},o4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState(null),[i,o]=w.useState(null),l=w.useRef(new Audio("https://assets.mixkit.co/sfx/preview/mixkit-message-pop-alert-2354.mp3")),u=w.useRef(new Audio("https://assets.mixkit.co/sfx/preview/mixkit-marimba-ringtone-1359.mp3"));w.useEffect(()=>{u.current.loop=!0;const m=Tt(_e,v=>{if(n(v),v){const T=We(ie(U,"calls"),ct("receiverId","==",v.uid),ct("status","==","ringing"),Xt("timestamp","desc"),Is(1)),j=qe(T,_=>{if(_.empty)o(null),u.current.pause(),u.current.currentTime=0;else{const b={id:_.docs[0].id,..._.docs[0].data()};o(b),u.current.play().catch(A=>console.log("Audio play failed",A))}}),I=We(ie(U,"conversations"),ct("participants","array-contains",v.uid),Xt("updatedAt","desc"),Is(1)),y=qe(I,_=>{_.docChanges().forEach(b=>{var A,V;if(b.type==="modified"||b.type==="added"){const M=b.doc.data(),N=((A=M.updatedAt)==null?void 0:A.seconds)>Date.now()/1e3-5;M.lastMessageSenderId,v.uid;const x=((V=M.unreadCounts)==null?void 0:V[v.uid])>0;if(N&&x){const E=M.users.find(S=>S.uid!==v.uid);s({id:b.doc.id,senderName:(E==null?void 0:E.displayName)||"Someone",senderAvatar:E==null?void 0:E.photoURL,text:M.lastMessage}),l.current.play().catch(S=>{}),setTimeout(()=>s(null),4e3)}}})});return()=>{j(),y()}}});return()=>{m(),u.current.pause()}},[]);const d=()=>{i&&(u.current.pause(),t("/messages",{state:{activeConversationId:i.conversationId,incomingCallData:i}}),o(null))},h=async()=>{i&&(u.current.pause(),await ue(Y(U,"calls",i.id),{status:"rejected"}),o(null))},p=()=>{r&&(t("/messages",{state:{activeConversationId:r.id}}),s(null))};return a.jsxs("div",{className:"fixed z-[9999] pointer-events-none inset-0 flex flex-col items-center pt-4 px-4",children:[i&&a.jsxs("div",{className:"pointer-events-auto bg-dark/95 backdrop-blur-md text-white p-4 rounded-2xl shadow-2xl w-full max-w-sm flex items-center gap-4 animate-slide-down border border-white/10",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:i.callerAvatar||"https://via.placeholder.com/50",className:"w-14 h-14 rounded-full border-2 border-green-500 animate-pulse",alt:"Caller"}),a.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1",children:a.jsx("i",{className:"fas fa-phone text-xs"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-lg truncate",children:i.callerName}),a.jsxs("p",{className:"text-xs text-gray-300 flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-video"})," ",i.type==="video"?"Video Call":"Audio Call","..."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:h,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center transition-transform hover:scale-110",children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("button",{onClick:d,className:"w-10 h-10 rounded-full bg-green-500 hover:bg-green-600 flex items-center justify-center transition-transform hover:scale-110 animate-bounce",children:a.jsx("i",{className:"fas fa-phone"})})]})]}),r&&!i&&a.jsxs("div",{onClick:p,className:"pointer-events-auto mt-4 bg-white/90 backdrop-blur-xl p-3 rounded-2xl shadow-lg border border-gray-100 flex items-center gap-3 w-full max-w-sm cursor-pointer hover:scale-105 transition-all animate-fade-in-up",children:[a.jsx("img",{src:r.senderAvatar||"https://via.placeholder.com/40",className:"w-10 h-10 rounded-full object-cover"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h5",{className:"font-black text-dark text-sm",children:r.senderName}),a.jsx("p",{className:"text-gray-600 text-xs truncate",children:r.text})]}),a.jsx("div",{className:"w-2 h-2 bg-primary rounded-full"})]})]})},l4=()=>{w.useEffect(()=>{console.log("Auth Page Mounted. Auth instance:",_e?"Present":"Missing")},[]);const[t,e]=w.useState(!1),[n,r]=w.useState(!1),[s,i]=w.useState(null),[o,l]=w.useState(""),[u,d]=w.useState(""),[h,p]=w.useState(""),[m,v]=w.useState(""),[T,j]=w.useState(""),[I,y]=w.useState(""),_=async b=>{b.preventDefault(),console.log(" Form Submitted! Mode:",t?"Sign Up":"Sign In"),i(null),r(!0);try{if(t){if(!h||!m||!T||!I)throw new Error("Please fill in all fields to continue.");console.log("Creating user with:",o);const V=(await q1(_e,o,u)).user;console.log("User created:",V.uid),console.log("Updating profile..."),await K1(V,{displayName:h}),console.log("Creating Firestore document..."),await xu(Y(U,"users",V.uid),{uid:V.uid,displayName:h,email:V.email,handle:h.toLowerCase().replace(/\s+/g,"_")+Math.floor(Math.random()*1e3),birthday:m,gender:T,profession:I,isDatingActive:!1,photoURL:null,coverPhotoURL:"https://images.unsplash.com/photo-1579546929518-9e396f3cc809",bio:`I am a ${I}. New to Tukumi.`,joinedAt:ke(),followers:0,following:0}),console.log("User document created successfully.")}else console.log("Signing in with:",o),await H1(_e,o,u),console.log("Sign in successful.")}catch(A){console.error(" Auth Error Detail:",A);let V=A.message;A.code==="auth/invalid-credential"&&(V="Invalid email or password."),A.code==="auth/user-not-found"&&(V="No account found with this email."),A.code==="auth/wrong-password"&&(V="Incorrect password."),A.code==="auth/email-already-in-use"&&(V="This email is already in use. Please sign in."),A.code==="auth/weak-password"&&(V="Password should be at least 6 characters."),i(V),r(!1)}};return a.jsxs("div",{className:"min-h-screen w-full flex items-center justify-center p-4 relative overflow-hidden bg-[#f0f4f8]",children:[a.jsx("div",{className:"absolute top-0 left-0 w-[500px] h-[500px] bg-primary/20 rounded-full blur-[120px] -translate-x-1/2 -translate-y-1/2"}),a.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gold/20 rounded-full blur-[120px] translate-x-1/2 translate-y-1/2"}),a.jsxs("div",{className:"glass-panel w-full max-w-5xl min-h-[600px] rounded-[40px] flex overflow-hidden shadow-2xl relative z-10",children:[a.jsxs("div",{className:"hidden md:flex flex-1 bg-gradient-to-br from-primary to-primary-dark text-white flex-col justify-center p-12 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"w-20 h-20 mb-8 relative perspective-container",children:a.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-md rounded-xl border border-white/40 shadow-2xl flex items-center justify-center transform rotate-12",children:a.jsx("div",{className:"w-10 h-10 bg-gold/80 rounded-lg shadow-inner"})})}),a.jsx("h1",{className:"text-5xl font-black tracking-tight mb-4",children:"TUKUMI"}),a.jsx("p",{className:"text-lg text-white/80 font-medium leading-relaxed",children:"The aristocratic social network. Connect, Trade, and Date in a premium environment."})]})]}),a.jsxs("div",{className:"flex-1 bg-white/80 backdrop-blur-xl p-8 md:p-12 flex flex-col justify-center relative overflow-y-auto",children:[a.jsx("h2",{className:"text-3xl font-bold text-dark mb-2",children:t?"Join the Elite":"Welcome Back"}),a.jsx("p",{className:"text-gray-500 mb-6",children:t?"Create your identity.":"Enter your credentials to access."}),a.jsxs("form",{className:"space-y-4",onSubmit:_,children:[t&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Full Name"}),a.jsx("input",{type:"text",placeholder:"Your Name",required:t,className:"w-full bg-white border border-gray-200 rounded-xl pl-4 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all",value:h,onChange:b=>p(b.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Profession"}),a.jsx("input",{type:"text",placeholder:"e.g. Software Engineer",required:t,className:"w-full bg-white border border-gray-200 rounded-xl pl-4 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all",value:I,onChange:b=>y(b.target.value)})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Birthday"}),a.jsx("input",{type:"date",required:t,className:"w-full bg-white border border-gray-200 rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all text-sm",value:m,onChange:b=>v(b.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Gender"}),a.jsxs("select",{required:t,className:"w-full bg-white border border-gray-200 rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all text-sm appearance-none",value:T,onChange:b=>j(b.target.value),children:[a.jsx("option",{value:"",disabled:!0,children:"Select..."}),a.jsx("option",{value:"Male",children:"Male"}),a.jsx("option",{value:"Female",children:"Female"}),a.jsx("option",{value:"Non-binary",children:"Non-binary"}),a.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Email Address"}),a.jsx("input",{type:"email",placeholder:"you@example.com",required:!0,className:"w-full bg-white border border-gray-200 rounded-xl pl-4 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all",value:o,onChange:b=>l(b.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Password"}),a.jsx("input",{type:"password",placeholder:"",required:!0,className:"w-full bg-white border border-gray-200 rounded-xl pl-4 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all",value:u,onChange:b=>d(b.target.value)})]}),s&&a.jsx("div",{className:"text-red-500 text-sm font-medium bg-red-50 p-3 rounded-lg",children:s}),a.jsx("button",{type:"submit",disabled:n,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg shadow-dark/20 transform active:scale-95 disabled:opacity-50 mt-4",children:n?"Processing...":t?"Create Account":"Sign In"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsxs("p",{className:"text-gray-500 text-sm",children:[t?"Already a member?":"Don't have an account?",a.jsx("button",{onClick:()=>{e(!t),i(null)},className:"ml-2 text-primary font-bold hover:underline",children:t?"Sign In":"Sign Up"})]})})]})]})]})},DN=({user:t,onClose:e,onSave:n})=>{const[r,s]=w.useState({displayName:t.displayName||"",bio:t.bio||"",profession:t.profession||"",location:t.location||"",handle:t.handle||""}),[i,o]=w.useState(null),[l,u]=w.useState(null),[d,h]=w.useState(!1),p=async()=>{h(!0);try{let m=t.photoURL,v=t.coverPhotoURL;if(i){const T=Tn(Sn,`users/${t.uid}/profile_${Date.now()}`);await En(T,i),m=await kn(T)}if(l){const T=Tn(Sn,`users/${t.uid}/cover_${Date.now()}`);await En(T,l),v=await kn(T)}await ue(Y(U,"users",t.uid),{...r,photoURL:m,coverPhotoURL:v}),n(),e()}catch(m){console.error("Error updating profile:",m),alert("Failed to update profile.")}finally{h(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Edit Profile"}),a.jsx("button",{onClick:e,children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[a.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"Profile Photo"}),a.jsx("input",{type:"file",onChange:m=>o(m.target.files[0]),className:"text-sm"})]}),a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[a.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"Cover Photo"}),a.jsx("input",{type:"file",onChange:m=>u(m.target.files[0]),className:"text-sm"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Display Name"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold",value:r.displayName,onChange:m=>s({...r,displayName:m.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Bio"}),a.jsx("textarea",{rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl",value:r.bio,onChange:m=>s({...r,bio:m.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Profession"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl",value:r.profession,onChange:m=>s({...r,profession:m.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Location"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl",value:r.location,onChange:m=>s({...r,location:m.target.value})})]})]})]})]}),a.jsx("div",{className:"p-6 border-t border-gray-100 bg-white",children:a.jsx("button",{onClick:p,disabled:d,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg",children:d?"Saving...":"Save Changes"})})]})})},c4=({user:t,onClose:e})=>{var j;const[n,r]=w.useState("main"),[s,i]=w.useState(!1),[o,l]=w.useState(!1),[u,d]=w.useState({privateAccount:t.isPrivate||!1,activeStatus:t.isOnline||!0,notifications:!0,darkMode:!1}),h=async I=>{const y=!u[I];d({...u,[I]:y});try{I==="privateAccount"&&await ue(Y(U,"users",t.uid),{isPrivate:y})}catch(_){console.error("Error updating setting:",_)}},p=async()=>{if(!t.email)return alert("No email found.");l(!0);try{await W1(_e,t.email),alert(`Password reset email sent to ${t.email}`)}catch(I){alert("Error sending reset email: "+I.message)}finally{l(!1)}},m=async()=>{window.confirm("Are you sure you want to sign out?")&&(await Bu(_e),window.location.reload())},v=({id:I,icon:y,label:_,color:b="text-gray-600",bg:A="bg-gray-100"})=>a.jsxs("button",{onClick:()=>r(I),className:"w-full bg-white border border-gray-100 p-4 rounded-2xl flex items-center justify-between hover:bg-gray-50 transition-all shadow-sm mb-3 group",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${A} ${b} group-hover:scale-110 transition-transform`,children:a.jsx("i",{className:`fas ${y}`})}),a.jsx("span",{className:"font-bold text-dark text-lg",children:_})]}),a.jsx("i",{className:"fas fa-chevron-right text-gray-300"})]}),T=({title:I})=>a.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-gray-100",children:[a.jsx("button",{onClick:()=>r("main"),className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center hover:bg-gray-200 transition-colors",children:a.jsx("i",{className:"fas fa-arrow-left text-gray-600"})}),a.jsx("h2",{className:"text-xl font-black text-dark",children:I})]});return a.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:[a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] relative",children:[a.jsx("button",{onClick:e,className:"absolute top-5 right-5 z-10 text-gray-400 hover:text-dark w-8 h-8 flex items-center justify-center rounded-full bg-gray-50 hover:bg-gray-100 transition-all",children:a.jsx("i",{className:"fas fa-times text-lg"})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 md:p-8",children:[n==="main"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx("h2",{className:"text-3xl font-black text-dark mb-2",children:"Settings"}),a.jsx("p",{className:"text-gray-500 font-bold mb-8",children:"Manage your account & preferences"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(v,{id:"account",icon:"fa-user-circle",label:"Account",color:"text-blue-500",bg:"bg-blue-50"}),a.jsx(v,{id:"privacy",icon:"fa-lock",label:"Privacy",color:"text-purple-500",bg:"bg-purple-50"}),a.jsx(v,{id:"security",icon:"fa-shield-alt",label:"Security",color:"text-green-500",bg:"bg-green-50"}),a.jsx(v,{id:"display",icon:"fa-moon",label:"Display",color:"text-orange-500",bg:"bg-orange-50"}),a.jsx(v,{id:"help",icon:"fa-question-circle",label:"Help & Support",color:"text-cyan-500",bg:"bg-cyan-50"})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100",children:a.jsxs("button",{onClick:m,className:"w-full bg-red-50 text-red-500 p-4 rounded-2xl flex items-center justify-center gap-2 font-bold hover:bg-red-100 transition-all",children:[a.jsx("i",{className:"fas fa-sign-out-alt"})," Log Out"]})})]}),n==="account"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(T,{title:"Account"}),a.jsxs("div",{className:"flex flex-col items-center mb-8",children:[a.jsx("img",{src:t.photoURL||"https://via.placeholder.com/150",className:"w-24 h-24 rounded-full object-cover border-4 border-gray-50 mb-3"}),a.jsx("h3",{className:"text-xl font-bold text-dark",children:t.displayName}),a.jsxs("p",{className:"text-gray-500 font-medium",children:["@",t.handle||"username"]}),a.jsx("button",{onClick:()=>i(!0),className:"mt-4 bg-dark text-white px-6 py-2 rounded-xl font-bold text-sm shadow-lg hover:bg-primary transition-all",children:"Edit Profile"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 p-4 rounded-2xl",children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:"Email"}),a.jsx("p",{className:"font-bold text-dark",children:t.email})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-2xl",children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase",children:"Member Since"}),a.jsx("p",{className:"font-bold text-dark",children:(j=t.metadata)!=null&&j.creationTime?new Date(t.metadata.creationTime).toDateString():"N/A"})]})]})]}),n==="privacy"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(T,{title:"Privacy"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 rounded-2xl",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-lg",children:"Private Account"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only followers can see your posts."})]}),a.jsx("div",{onClick:()=>h("privateAccount"),className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${u.privateAccount?"bg-primary":"bg-gray-300"}`,children:a.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${u.privateAccount?"left-7":"left-1"}`})})]}),a.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 rounded-2xl",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-lg",children:"Active Status"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Show when you're online."})]}),a.jsx("div",{onClick:()=>h("activeStatus"),className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${u.activeStatus?"bg-primary":"bg-gray-300"}`,children:a.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${u.activeStatus?"left-7":"left-1"}`})})]})]})]}),n==="security"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(T,{title:"Security"}),a.jsxs("div",{className:"p-6 border border-orange-100 bg-orange-50 rounded-3xl text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center text-orange-500 text-2xl shadow-sm mx-auto mb-4",children:a.jsx("i",{className:"fas fa-key"})}),a.jsx("h4",{className:"font-bold text-dark text-lg mb-2",children:"Change Password"}),a.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"We'll send you an email to reset your password securely."}),a.jsx("button",{onClick:p,disabled:o,className:"w-full bg-orange-500 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-orange-600 transition-all",children:o?"Sending...":"Send Reset Link"})]})]}),n==="display"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(T,{title:"Display"}),a.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 rounded-2xl opacity-60",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-lg",children:"Dark Mode"}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Coming Soon"})]}),a.jsx("div",{className:"w-14 h-8 bg-gray-200 rounded-full relative cursor-not-allowed",children:a.jsx("div",{className:"w-6 h-6 bg-white rounded-full absolute top-1 left-1 shadow-sm"})})]})]}),n==="help"&&a.jsxs("div",{className:"animate-slide-in text-center pt-10",children:[a.jsx(T,{title:"Help"}),a.jsx("div",{className:"w-24 h-24 bg-cyan-50 rounded-full flex items-center justify-center text-cyan-500 text-4xl mx-auto mb-6",children:a.jsx("i",{className:"fas fa-life-ring"})}),a.jsx("h3",{className:"text-2xl font-black text-dark mb-2",children:"Need Support?"}),a.jsx("p",{className:"text-gray-500 mb-8 max-w-xs mx-auto",children:"Our team is here to help you with any issues regarding your account."}),a.jsx("button",{className:"bg-dark text-white px-8 py-3 rounded-xl font-bold hover:bg-primary transition-all shadow-lg",children:"Contact Support"})]})]})]}),s&&a.jsx("div",{className:"absolute inset-0 z-[10000]",children:a.jsx(DN,{user:t,onClose:()=>i(!1),onSave:()=>window.location.reload()})})]})},an=()=>{var I,y;const t=at(),[e,n]=w.useState(null),[r,s]=w.useState(0),[i,o]=w.useState(!1),[l,u]=w.useState(!1),[d,h]=w.useState(!1),p=new Date().getHours(),m=p<12?"Good Morning":p<18?"Good Afternoon":"Good Evening",v=w.useRef(new Audio("https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3")),T=w.useRef(0);w.useEffect(()=>{const _=Tt(_e,A=>{if(A){n(A);const V=We(ie(U,"notifications"),ct("recipientId","==",A.uid),ct("isRead","==",!1)),M=qe(V,N=>{const x=N.docs.length;x>T.current&&v.current.play().catch(()=>{}),s(x),T.current=x});return()=>M()}else n(null)}),b=A=>{A.target.closest(".app-menu-container")||u(!1)};return document.addEventListener("click",b),()=>{_(),document.removeEventListener("click",b)}},[]);const j=async()=>{window.confirm("Sign out of Tukumi?")&&(await Bu(_e),window.location.reload())};return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex justify-between items-center bg-white rounded-[24px] p-4 md:p-5 shadow-sm mb-6 relative z-[50]",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"text-2xl md:text-3xl mr-3 md:mr-4 animate-gentle-float",children:p<18?"":""}),a.jsx("div",{children:a.jsxs("h2",{className:"text-lg md:text-xl font-bold text-[#2C3E50] leading-tight",children:[m,", ",a.jsxs("span",{className:"hidden md:inline",children:[((I=e==null?void 0:e.displayName)==null?void 0:I.split(" ")[0])||"Friend","!"]}),a.jsx("span",{className:"md:hidden",children:((y=e==null?void 0:e.displayName)==null?void 0:y.split(" ")[0])||"Friend"})]})})]}),a.jsxs("div",{className:"flex gap-2 md:gap-3",children:[a.jsx("div",{onClick:()=>o(!0),className:"w-10 h-10 rounded-full bg-[#F8FAFD] flex items-center justify-center cursor-pointer hover:shadow-md transition-all text-[#2C3E50] hover:scale-105",children:a.jsx("i",{className:"fas fa-search text-lg"})}),a.jsxs("div",{onClick:()=>t("/notifications"),className:"w-10 h-10 rounded-full bg-[#F8FAFD] flex items-center justify-center cursor-pointer hover:shadow-md transition-all text-[#2C3E50] hover:scale-105 relative",children:[a.jsx("i",{className:"fas fa-bell text-lg"}),r>0&&a.jsx("span",{className:"absolute top-0 right-0 bg-accent text-white text-[10px] font-bold w-4 h-4 flex items-center justify-center rounded-full border-2 border-white animate-bounce-in",children:r>9?"9+":r})]}),a.jsxs("div",{className:"relative app-menu-container",children:[a.jsx("div",{onClick:()=>u(!l),className:`w-10 h-10 rounded-full bg-gradient-to-tr from-primary to-gold text-white flex items-center justify-center cursor-pointer hover:shadow-md transition-all hover:scale-105 ${l?"ring-4 ring-primary/20":""}`,children:a.jsx("i",{className:"fas fa-bars text-lg"})}),l&&a.jsxs("div",{className:"absolute right-0 top-14 w-64 bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden animate-fade-in z-[100]",children:[a.jsx("div",{className:"p-3 border-b border-gray-50 text-xs font-bold text-gray-400 uppercase tracking-wider bg-gray-50/50",children:"Menu"}),a.jsxs("div",{className:"flex flex-col p-2 space-y-1",children:[a.jsxs("button",{onClick:()=>{t("/explore"),u(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-dark font-bold text-sm transition-colors text-left",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-purple-100 text-purple-600 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-compass text-sm"})})," Explore"]}),a.jsxs("button",{onClick:()=>{t("/business"),u(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-dark font-bold text-sm transition-colors text-left",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 text-blue-600 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-briefcase text-sm"})})," Business"]}),a.jsxs("button",{onClick:()=>{h(!0),u(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-dark font-bold text-sm transition-colors text-left",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-100 text-gray-600 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-cog text-sm"})})," Settings"]}),a.jsx("div",{className:"h-px bg-gray-100 my-1"}),a.jsxs("button",{onClick:j,className:"flex items-center gap-3 px-4 py-3 hover:bg-red-50 rounded-xl text-red-500 font-bold text-sm transition-colors text-left",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-red-100 text-red-500 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-sign-out-alt text-sm"})})," Sign Out"]})]})]})]})]})]}),i&&a.jsx(PN,{onClose:()=>o(!1)}),d&&e&&a.jsx(c4,{user:e,onClose:()=>h(!1)})]})},Pf="https://via.placeholder.com/150/000000/FFFFFF?text=A",u4=({text:t,hasMedia:e})=>{const[n,r]=w.useState(!1),s=e?2:6,i=t.split(`
`),o=i.length>s||t.length>(e?100:300),l=n||!o?t:i.slice(0,s).join(`
`).slice(0,e?100:300)+"...";return a.jsxs("div",{className:"text-gray-800 mb-3 text-[15px] leading-relaxed whitespace-pre-wrap transition-all",children:[l,o&&a.jsx("button",{onClick:u=>{u.stopPropagation(),r(!n)},className:"text-primary font-bold ml-1 hover:underline focus:outline-none text-sm",children:n?"Show Less":"Read More"})]})},d4=({postId:t,user:e,setCommentText:n,setActiveCommentBox:r,setReplyingToId:s})=>{const i=at(),[o,l]=w.useState([]),[u,d]=w.useState({});w.useEffect(()=>{if(!t)return;const j=We(ie(U,"posts",t,"comments"),Xt("timestamp","asc")),I=qe(j,y=>{l(y.docs.map(_=>({id:_.id,..._.data()})))});return()=>I()},[t]);const h=o.filter(j=>!j.parentId),p=j=>o.filter(I=>I.parentId===j),m=j=>{n(`@${j.userName} `),r(t),s(j.parentId||j.id)},v=j=>d(I=>({...I,[j]:!I[j]})),T=({c:j,isReply:I})=>{var y;return a.jsxs("div",{className:`flex gap-3 items-start text-sm mb-3 ${I?"ml-10 mt-2":""}`,children:[a.jsx("img",{src:j.userAvatar||Pf,className:"w-8 h-8 rounded-full object-cover flex-shrink-0 cursor-pointer border border-gray-200",alt:j.userName,onClick:()=>i(`/profile/${j.uid}`)}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none inline-block border border-gray-100",children:[a.jsx("span",{className:"font-bold text-xs block text-dark cursor-pointer hover:underline mb-0.5",onClick:()=>i(`/profile/${j.uid}`),children:j.userName}),a.jsx("p",{className:"text-gray-700 leading-snug",children:j.text})]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1 ml-1",children:[a.jsx("span",{className:"text-[10px] text-gray-400",children:(y=j.timestamp)!=null&&y.seconds?new Date(j.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"}),a.jsx("button",{onClick:()=>m(j),className:"text-[10px] font-bold text-gray-500 hover:text-primary transition-colors",children:"Reply"})]})]})]})};return a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-50",children:a.jsxs("div",{className:"max-h-[350px] overflow-y-auto custom-scrollbar px-1",children:[o.length===0&&a.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"No comments yet. Start the conversation!"}),h.map(j=>{const I=p(j.id);return a.jsxs("div",{children:[a.jsx(T,{c:j,isReply:!1}),I.length>0&&a.jsxs("div",{className:"ml-12 mb-2",children:[a.jsxs("button",{onClick:()=>v(j.id),className:"text-xs text-primary font-bold flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"w-4 h-px bg-primary"})," ",u[j.id]?"Hide replies":`View ${I.length} replies`]}),u[j.id]&&I.map(y=>a.jsx(T,{c:y,isReply:!0},y.id))]})]},j.id)})]})})},h4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState(""),[l,u]=w.useState(!1),[d,h]=w.useState(null),[p,m]=w.useState(null),[v,T]=w.useState(null),[j,I]=w.useState(!1),y=w.useRef(null),[_,b]=w.useState(null),[A,V]=w.useState(""),[M,N]=w.useState(null),[x,E]=w.useState(null),[S,R]=w.useState(null),[P,C]=w.useState(!1),[he,Ie]=w.useState(null),Be=["","","","","","","","",""];w.useEffect(()=>{const z=Tt(_e,te=>{if(te){const ge=qe(Y(U,"users",te.uid),Pe=>{Pe.exists()?n({uid:te.uid,...Pe.data()}):n(te)});return()=>ge()}else n(null)}),se=We(ie(U,"posts"),Xt("timestamp","desc")),we=qe(se,te=>s(te.docs.map(ge=>({id:ge.id,...ge.data()})))),$=te=>{te.target.closest(".post-menu-container")||E(null),te.target.closest(".emoji-picker-container")||I(!1)};return document.addEventListener("click",$),()=>{z(),we(),document.removeEventListener("click",$)}},[]);const Ve=async()=>{if(!(!i.trim()&&!d||!e)){u(!0);try{let z=null;if(d){const se=Tn(Sn,`posts/${e.uid}/${Date.now()}_${d.name}`);await En(se,d),z=await kn(se)}await Ge(ie(U,"posts"),{text:i,uid:e.uid,userName:e.displayName||"Aristocrat",userAvatar:e.photoURL,mediaURL:z,mediaType:v,timestamp:ke(),likes:0,likedBy:[],comments:0,isPrivate:!1}),o(""),h(null),m(null)}catch(z){console.error(z)}finally{u(!1)}}},G=async z=>{if(!e)return alert("Sign in.");const se=Y(U,"posts",z.id);z.likedBy&&z.likedBy.includes(e.uid)?await ue(se,{likes:xt(-1),likedBy:hn(e.uid)}):(await ue(se,{likes:xt(1),likedBy:Et(e.uid)}),z.uid!==e.uid&&await Ge(ie(U,"notifications"),{recipientId:z.uid,senderId:e.uid,senderName:e.displayName,senderAvatar:e.photoURL,type:"like",targetId:z.id,timestamp:ke(),isRead:!1}))},ee=async z=>{if(!(!A.trim()||!e))try{await Ge(ie(U,"posts",z,"comments"),{text:A,uid:e.uid,userName:e.displayName,userAvatar:e.photoURL,parentId:M,timestamp:ke()}),await ue(Y(U,"posts",z),{comments:xt(1)});const se=r.find(we=>we.id===z);se&&se.uid!==e.uid&&await Ge(ie(U,"notifications"),{recipientId:se.uid,senderId:e.uid,senderName:e.displayName,senderAvatar:e.photoURL,type:"comment",targetId:z,timestamp:ke(),isRead:!1}),V(""),N(null)}catch(se){console.error("Comment failed",se)}},X=async z=>{if(!e)return alert("Sign in to save.");await ue(Y(U,"users",e.uid),{savedPosts:Et(z.id)}),alert("Post saved!"),E(null)},fe=async z=>{!he||!e||(await Ge(ie(U,"reports"),{targetId:he,type:"post",reporter:e.uid,reason:z,timestamp:ke()}),alert("Report submitted."),C(!1),Ie(null))},ae=async z=>{await ue(Y(U,"posts",z.id),{isPrivate:!z.isPrivate}),E(null)},q=async z=>{window.confirm("Are you sure you want to delete this post?")&&await js(Y(U,"posts",z))},oe=z=>{const se=z.target.files[0];se&&(h(se),T(se.type.startsWith("video/")?"video":"image"),m(URL.createObjectURL(se)))},pe=z=>{_===z?b(null):(b(z),V(""),N(null))},O=async z=>{const se=`${window.location.origin}/post/${z.id}`;navigator.share?navigator.share({title:z.userName,text:z.text,url:se}):navigator.clipboard.writeText(se).then(()=>{alert("Link copied!")})},re=z=>{t(`/profile/${z}`)},Ae=()=>a.jsxs("div",{className:"glass-panel rounded-[30px] p-6",children:[a.jsx("h3",{className:"font-bold text-dark mb-6",children:"Trending"}),[1,2,3].map(z=>a.jsxs("div",{className:"flex items-center gap-4 mb-4 last:mb-0 cursor-pointer group",children:[a.jsxs("span",{className:"text-3xl font-black text-gray-200 group-hover:text-primary/30",children:["0",z]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-dark text-sm group-hover:text-primary",children:"#TukumiLife"}),a.jsx("p",{className:"text-xs text-gray-400",children:"12.5K posts"})]})]},z))]});return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1200px] mx-auto",children:[a.jsx(an,{}),a.jsx("div",{className:"flex justify-between items-center mb-8",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-black text-dark tracking-tight",children:"The Feed"}),a.jsx("p",{className:"text-gray-500 font-medium",children:"Curated for you"})]})}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start",children:[a.jsxs("div",{className:"flex-1 w-full min-w-0 space-y-8",children:[a.jsx("div",{className:"glass-panel rounded-[30px] p-2 z-20 relative",children:a.jsxs("div",{className:"bg-white/60 rounded-[24px] p-5 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsx("img",{src:(e==null?void 0:e.photoURL)||Pf,className:"w-12 h-12 rounded-2xl object-cover",alt:"User Avatar"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("textarea",{placeholder:"Share your thoughts...",className:"w-full bg-transparent border-none outline-none text-lg resize-none mt-2 placeholder-gray-400",rows:"2",value:i,onChange:z=>o(z.target.value)}),p&&a.jsxs("div",{className:"relative mt-2 inline-block group",children:[v==="video"?a.jsx("video",{src:p,controls:!0,className:"h-32 rounded-xl bg-black"}):a.jsx("img",{src:p,className:"h-32 rounded-xl"}),a.jsx("button",{onClick:()=>{h(null),m(null)},className:"absolute top-1 right-1 bg-black/50 text-white rounded-full w-6 h-6 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times text-xs"})})]})]})]}),a.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200/50 relative",children:[a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"file",ref:y,className:"hidden",accept:"image/*,video/*",onChange:oe}),a.jsx("button",{onClick:()=>y.current.click(),className:"w-9 h-9 rounded-xl hover:bg-primary/10 text-primary flex items-center justify-center",children:a.jsx("i",{className:"fas fa-image"})}),a.jsxs("div",{className:"relative emoji-picker-container",children:[a.jsx("button",{onClick:()=>I(!j),className:"w-9 h-9 rounded-xl hover:bg-primary/10 text-primary flex items-center justify-center",children:a.jsx("i",{className:"far fa-smile"})}),j&&a.jsx("div",{className:"absolute top-full left-0 mt-2 bg-white/95 backdrop-blur-xl p-3 rounded-2xl shadow-xl border border-white/50 grid grid-cols-5 gap-2 z-30 animate-fade-in w-64",children:Be.map(z=>a.jsx("button",{onClick:()=>{o(se=>se+z),I(!1)},className:"text-2xl hover:scale-125 transition-transform",children:z},z))})]})]}),a.jsx("button",{onClick:Ve,disabled:l||!i.trim()&&!d,className:"bg-gradient-to-r from-primary to-primary-dark text-white px-6 py-2.5 rounded-xl font-bold hover:shadow-lg transition-all shadow-primary/20 disabled:opacity-50",children:l?"Publishing...":"Tukumi"})]})]})}),r.map(z=>{var we;const se=e&&z.likedBy&&z.likedBy.includes(e.uid);return z.isPrivate&&z.uid!==(e==null?void 0:e.uid)?null:a.jsxs("div",{className:"glass-panel rounded-[30px] p-6 hover:shadow-xl transition-all duration-300 border border-white/60",children:[a.jsxs("div",{className:"flex justify-between items-start mb-5",children:[a.jsxs("div",{className:"flex items-center gap-4 cursor-pointer group",onClick:()=>re(z.uid),children:[a.jsx("img",{src:z.userAvatar||Pf,className:"w-12 h-12 rounded-2xl object-cover",alt:"User Avatar"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-dark text-lg leading-tight flex items-center gap-2 group-hover:text-primary",children:[z.userName,z.isPrivate&&a.jsx("i",{className:"fas fa-lock text-xs text-gray-400 ml-1"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-medium",children:(we=z.timestamp)!=null&&we.seconds?new Date(z.timestamp.seconds*1e3).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"short"}):"Just now"})]})]}),a.jsxs("div",{className:"relative post-menu-container",children:[a.jsx("button",{onClick:()=>E(x===z.id?null:z.id),className:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),x===z.id&&a.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white/95 backdrop-blur-xl rounded-2xl shadow-xl border border-white/50 overflow-hidden z-20 py-1 animate-fade-in",children:(e==null?void 0:e.uid)===z.uid?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>ae(z),className:"w-full text-left px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-3",children:[a.jsx("i",{className:`fas ${z.isPrivate?"fa-globe":"fa-lock"} text-gray-500 w-4`})," ",z.isPrivate?"Make Public":"Make Private"]}),a.jsxs("button",{onClick:()=>q(z.id),className:"w-full text-left px-4 py-2.5 text-sm text-accent hover:bg-red-50 font-bold flex items-center gap-3",children:[a.jsx("i",{className:"fas fa-trash w-4"})," Delete"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>X(z),className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[a.jsx("i",{className:"far fa-bookmark w-4 text-center"})," Save Post"]}),a.jsxs("button",{onClick:()=>{Ie(z.id),C(!0),E(null)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-flag w-4 text-center"})," Report"]})]})})]})]}),a.jsx(u4,{text:z.text,hasMedia:!!z.mediaURL}),z.mediaURL&&a.jsx("div",{className:"rounded-[24px] overflow-hidden mb-5 shadow-md border border-white/50 cursor-pointer group relative",onClick:()=>R({url:z.mediaURL,type:z.mediaType}),children:z.mediaType==="video"?a.jsx("video",{src:z.mediaURL,controls:!0,className:"w-full max-h-[500px] bg-black object-contain"}):a.jsx("img",{src:z.mediaURL,className:"w-full max-h-[500px] object-cover transition-transform duration-700 group-hover:scale-105",alt:"Post Media"})}),a.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-100/50",children:[a.jsxs("button",{onClick:()=>G(z),className:`h-10 px-5 rounded-xl border flex items-center gap-2 transition-all group shadow-sm ${se?"bg-accent/10 border-accent/20 text-accent":"bg-white/50 border-white text-gray-600 hover:text-accent hover:bg-white"}`,children:[a.jsx("i",{className:`${se?"fas":"far"} fa-heart group-hover:scale-110`}),a.jsx("span",{className:"font-bold text-sm",children:z.likes||0})]}),a.jsxs("button",{onClick:()=>pe(z.id),className:"h-10 px-5 rounded-xl bg-white/50 border border-white flex items-center gap-2 text-gray-600 hover:text-primary hover:bg-white transition-all group shadow-sm",children:[a.jsx("i",{className:"far fa-comment group-hover:scale-110 transition-transform"}),a.jsx("span",{className:"font-bold text-sm",children:z.comments||0})]}),a.jsx("button",{onClick:()=>O(z),className:"h-10 w-10 rounded-xl bg-white/50 border border-white flex items-center justify-center text-gray-600 hover:text-dark hover:bg-white ml-auto transition-all shadow-sm",children:a.jsx("i",{className:"far fa-share-square"})})]}),_===z.id&&a.jsxs("div",{className:"mt-4 animate-fade-in",children:[a.jsx(d4,{postId:z.id,user:e,setCommentText:V,setActiveCommentBox:b,setReplyingToId:N}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsx("input",{type:"text",placeholder:"Write a comment...",className:"flex-1 bg-white/80 border border-white/50 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 shadow-inner",value:A,onChange:$=>V($.target.value),onKeyDown:$=>$.key==="Enter"&&ee(z.id),autoFocus:!0}),a.jsx("button",{onClick:()=>ee(z.id),disabled:!A.trim(),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md hover:bg-primary-dark transition-colors disabled:opacity-50",children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})]},z.id)})]}),a.jsx("div",{className:"hidden lg:block w-[340px] space-y-6 sticky top-6",children:a.jsx(Ae,{})})]}),S&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 z-[100] flex items-center justify-center p-4 cursor-pointer",onClick:()=>R(null),children:[S.type==="video"?a.jsx("video",{src:S.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-full",onClick:z=>z.stopPropagation()}):a.jsx("img",{src:S.url,alt:"Fullscreen Media",className:"max-w-full max-h-full object-contain",onClick:z=>z.stopPropagation()}),a.jsx("button",{onClick:()=>R(null),className:"absolute top-4 right-4 text-white text-3xl",children:""})]}),P&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center animate-fade-in p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3 text-red-500 text-xl",children:a.jsx("i",{className:"fas fa-flag"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Report Post"})]}),a.jsx("div",{className:"space-y-2 mb-6",children:["Spam or Fraud","Harassment","Violence","False Information"].map(z=>a.jsx("button",{onClick:()=>fe(z),className:"w-full text-left p-3 rounded-xl bg-gray-50 hover:bg-red-50 hover:text-red-600 text-gray-700 font-medium transition-colors",children:z},z))}),a.jsx("button",{onClick:()=>C(!1),className:"w-full py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancel"})]})})]})},_o=({src:t,name:e,size:n="md",className:r="",isGroup:s=!1})=>{const i=e?e.split(" ").map(l=>l[0]).join("").substring(0,2).toUpperCase():"??",o={sm:"w-8 h-8 text-xs",md:"w-12 h-12 text-sm",lg:"w-16 h-16 text-lg",xl:"w-32 h-32 text-4xl"};return a.jsx("div",{className:`relative flex-shrink-0 ${r}`,children:t?a.jsx("img",{src:t,className:`${o[n]} rounded-[1.5rem] object-cover border-2 border-white shadow-sm`,alt:e}):a.jsx("div",{className:`${o[n]} rounded-[1.5rem] bg-gradient-to-br ${s?"from-purple-500 to-indigo-600":"from-primary to-primary-light"} text-white flex items-center justify-center font-black shadow-inner`,children:s?a.jsx("i",{className:"fas fa-users"}):i})})},f4=({onClose:t,onCreate:e,currentUserId:n})=>{const[r,s]=w.useState(""),[i,o]=w.useState([]),[l,u]=w.useState([]),[d,h]=w.useState("");w.useEffect(()=>{if(r.length<2)return;const v=setTimeout(async()=>{const T=We(ie(U,"users"),ct("displayName",">=",r),Is(5)),j=await Dn(T);o(j.docs.map(I=>({uid:I.id,...I.data()})).filter(I=>I.uid!==n))},300);return()=>clearTimeout(v)},[r]);const p=()=>{!d||l.length===0||e(d,l)};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[100] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-[30px] p-6 shadow-2xl",children:[a.jsx("h3",{className:"text-2xl font-black text-dark mb-1",children:"Form an Entourage"}),a.jsx("p",{className:"text-gray-500 text-sm mb-6",children:"Create a private circle."}),a.jsx("input",{className:"w-full bg-gray-50 p-4 rounded-xl font-bold mb-4 border border-transparent focus:border-primary outline-none",placeholder:"Entourage Name (e.g. The Elites)",value:d,onChange:m=>h(m.target.value)}),a.jsxs("div",{className:"mb-4",children:[a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-2",placeholder:"Search people to add...",value:r,onChange:m=>s(m.target.value)}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:l.map(m=>a.jsxs("span",{className:"bg-primary/10 text-primary text-xs font-bold px-2 py-1 rounded-lg flex items-center gap-1",children:[m.displayName," ",a.jsx("button",{onClick:()=>u(l.filter(v=>v.uid!==m.uid)),children:a.jsx("i",{className:"fas fa-times"})})]},m.uid))}),a.jsx("div",{className:"max-h-32 overflow-y-auto space-y-1",children:i.map(m=>a.jsxs("div",{onClick:()=>{l.find(v=>v.uid===m.uid)||u([...l,m]),s(""),o([])},className:"flex items-center gap-2 p-2 hover:bg-gray-50 rounded-lg cursor-pointer",children:[a.jsx(_o,{src:m.photoURL,name:m.displayName,size:"sm"}),a.jsx("span",{className:"text-sm font-bold text-dark",children:m.displayName})]},m.uid))})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:t,className:"flex-1 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-50",children:"Cancel"}),a.jsx("button",{onClick:p,disabled:!d||l.length===0,className:"flex-1 bg-dark text-white py-3 rounded-xl font-bold hover:bg-primary disabled:opacity-50 transition-colors",children:"Create"})]})]})})},m4=({chat:t,onClose:e,media:n,onBlock:r,onMute:s,onSearchClick:i})=>{var o,l,u;return a.jsxs("div",{className:"absolute inset-y-0 right-0 w-full md:w-80 bg-white shadow-2xl z-[50] flex flex-col animate-slide-in border-l border-gray-100",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-lg text-dark",children:"Details"}),a.jsx("button",{onClick:e,className:"w-8 h-8 rounded-full bg-white text-gray-400 hover:text-dark flex items-center justify-center shadow-sm transition-all",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(_o,{src:t.isGroup?null:(o=t.otherUser)==null?void 0:o.photoURL,name:t.isGroup?t.groupName:(l=t.otherUser)==null?void 0:l.displayName,size:"xl",isGroup:t.isGroup})}),a.jsx("h2",{className:"text-2xl font-black text-dark",children:t.isGroup?t.groupName:(u=t.otherUser)==null?void 0:u.displayName}),a.jsx("p",{className:"text-gray-500 font-bold text-sm mt-1",children:t.isGroup?`${t.users.length} Members`:"Aristocrat"})]}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsxs("button",{onClick:s,className:"flex flex-col items-center gap-2 text-gray-500 hover:text-dark transition-colors group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-xl group-hover:bg-gray-200",children:a.jsx("i",{className:"fas fa-bell-slash"})}),a.jsx("span",{className:"text-xs font-bold",children:"Mute"})]}),a.jsxs("button",{onClick:i,className:"flex flex-col items-center gap-2 text-gray-500 hover:text-dark transition-colors group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center text-xl group-hover:bg-gray-200",children:a.jsx("i",{className:"fas fa-search"})}),a.jsx("span",{className:"text-xs font-bold",children:"Search"})]}),a.jsxs("button",{onClick:r,className:"flex flex-col items-center gap-2 text-red-500 hover:text-red-700 transition-colors group",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-red-50 flex items-center justify-center text-xl group-hover:bg-red-100",children:a.jsx("i",{className:"fas fa-ban"})}),a.jsx("span",{className:"text-xs font-bold",children:"Block"})]})]}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-dark mb-4 flex justify-between items-center",children:["Shared Media ",a.jsx("span",{className:"text-gray-400 text-xs",children:n.length})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[n.slice(0,6).map(d=>a.jsx("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-100 border border-gray-200",children:d.mediaType==="video"?a.jsx("video",{src:d.mediaURL,className:"w-full h-full object-cover"}):a.jsx("img",{src:d.mediaURL,className:"w-full h-full object-cover"})},d.id)),n.length===0&&a.jsx("p",{className:"col-span-3 text-center text-xs text-gray-400 py-4",children:"No media shared yet."})]})]})]})]})},p4=({onSend:t,onCancel:e})=>{const[n,r]=w.useState(!1),[s,i]=w.useState(0),o=w.useRef(null),l=w.useRef([]),u=w.useRef(null),d=async()=>{try{const m=await navigator.mediaDevices.getUserMedia({audio:!0});o.current=new MediaRecorder(m),l.current=[],o.current.ondataavailable=v=>{v.data.size>0&&l.current.push(v.data)},o.current.onstop=()=>{const v=new Blob(l.current,{type:"audio/webm"}),T=new File([v],"voice_note.webm",{type:"audio/webm"});t(T),m.getTracks().forEach(j=>j.stop())},o.current.start(),r(!0),i(0),u.current=setInterval(()=>i(v=>v+1),1e3)}catch{alert("Microphone access denied."),e()}},h=()=>{o.current&&n&&(o.current.stop(),clearInterval(u.current),r(!1))},p=m=>`${Math.floor(m/60)}:${(m%60).toString().padStart(2,"0")}`;return a.jsxs("div",{className:"flex items-center gap-4 w-full animate-fade-in bg-red-50 p-2 rounded-[20px]",children:[a.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full animate-pulse ml-2"}),a.jsx("span",{className:"text-red-500 font-bold font-mono text-sm",children:n?p(s):"Ready"}),s>50&&a.jsx("span",{className:"text-[10px] text-red-600 font-bold animate-bounce",children:"Limit: 60s"}),a.jsx("div",{className:"flex-1"}),n?a.jsx("button",{onClick:h,className:"bg-white border border-red-200 text-red-500 px-4 py-2 rounded-xl text-xs font-bold",children:"Send"}):a.jsx("button",{onClick:d,className:"bg-red-500 text-white px-4 py-2 rounded-xl text-xs font-bold",children:"Record"}),a.jsx("button",{onClick:()=>{h(),e()},className:"w-8 h-8 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]})},g4=()=>{var se,we,$,te,ge,Pe,pt,gt,Bt;const t=tr(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState(null),[l,u]=w.useState([]),[d,h]=w.useState(""),[p,m]=w.useState(!1),[v,T]=w.useState(!1),[j,I]=w.useState(!1),[y,_]=w.useState(!1),[b,A]=w.useState(!1),[V,M]=w.useState(null),[N,x]=w.useState(!1),[E,S]=w.useState(!1),[R,P]=w.useState(""),[C,he]=w.useState(!1),Ie=w.useRef(),Be=w.useRef(null),[Ve,G]=w.useState(null),X=((se=t.state)==null?void 0:se.asBusiness)&&((we=t.state)!=null&&we.businessId)?t.state.businessId:e==null?void 0:e.uid;w.useEffect(()=>{const F=Tt(_e,ce=>{n(ce)});if(X){const ce=We(ie(U,"conversations"),ct("participants","array-contains",X),Xt("updatedAt","desc")),ye=qe(ce,De=>{s(De.docs.map(Se=>{const _t=Se.data(),Rn=_t.isGroup?null:_t.users.find(ht=>ht.uid!==X);return{id:Se.id,..._t,otherUser:Rn}}))});return()=>{F(),ye()}}return()=>F()},[X]),w.useEffect(()=>{var F;e&&((F=t.state)!=null&&F.startChatWith)&&(fe(t.state.startChatWith),window.history.replaceState({},document.title))},[e,t.state]),w.useEffect(()=>{if(!i)return;const F=We(ie(U,`conversations/${i.id}/messages`),Xt("timestamp","asc")),ce=qe(F,ye=>{u(ye.docs.map(De=>({id:De.id,...De.data()}))),setTimeout(()=>{var De;return(De=Ie.current)==null?void 0:De.scrollIntoView({behavior:"smooth"})},100)});return()=>ce()},[i]);const fe=async F=>{const ce=[e.uid,F.uid].sort().join("_"),ye=r.find(Se=>Se.id===ce);if(ye){o(ye),m(!0);return}const De={participants:[e.uid,F.uid],users:[{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL},{uid:F.uid,displayName:F.displayName,photoURL:F.photoURL}],updatedAt:ke(),isGroup:!1};await xu(Y(U,"conversations",ce),De,{merge:!0}),o({id:ce,...De,otherUser:F}),m(!0)},ae=async(F,ce)=>{const ye=[...ce,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL}],De=ye.map(_t=>_t.uid),Se=await Ge(ie(U,"conversations"),{groupName:F,isGroup:!0,adminId:e.uid,participants:De,users:ye,updatedAt:ke(),lastMessage:`${e.displayName} formed the entourage.`});A(!1),o({id:Se.id,isGroup:!0,groupName:F,users:ye}),m(!0)},q=async(F,ce="text",ye=null)=>{if(!i)return;if(ye&&ye.size>5*1024*1024)return alert("File too large. Limit is 5MB.");let De=null;if(ye){x(!0);try{const Se=Tn(Sn,`chat/${i.id}/${Date.now()}_${ye.name}`);await En(Se,ye),De=await kn(Se)}catch(Se){console.error(Se);return}finally{x(!1)}}await Ge(ie(U,`conversations/${i.id}/messages`),{text:ce==="text"?F:"",mediaURL:De,mediaType:ce,senderId:X,senderName:e.displayName,timestamp:ke()}),await ue(Y(U,"conversations",i.id),{lastMessage:ce==="text"?F:`Sent a ${ce}`,lastMessageSenderId:X,updatedAt:ke()}),h(""),I(!1),_(!1)},oe=F=>{const ce=F.target.files[0];if(!ce)return;const ye=ce.type.startsWith("image")?"image":ce.type.startsWith("video")?"video":"file";q(null,ye,ce)},pe=async F=>{if(i){M({type:F,status:"calling"});try{const ce=await navigator.mediaDevices.getUserMedia({audio:!0,video:F==="video"});G(ce),Be.current&&(Be.current.srcObject=ce);const ye=i.isGroup?i.users.find(De=>De.uid!==X).uid:i.otherUser.uid;await Ge(ie(U,"calls"),{callerId:e.uid,callerName:e.displayName,callerAvatar:e.photoURL,receiverId:ye,conversationId:i.id,type:F,status:"ringing",timestamp:ke()})}catch{alert("Permission denied for Call."),O()}}},O=()=>{Ve&&Ve.getTracks().forEach(F=>F.stop()),G(null),M(null)},re=async()=>{confirm("Block this user?")&&(await ue(Y(U,"users",e.uid),{blockedUsers:Et(i.otherUser.uid)}),T(!1),alert("User blocked."))},Ae=async()=>{await ue(Y(U,"users",e.uid),{mutedChats:Et(i.id)}),alert("Notifications muted for this chat.")},z=l.filter(F=>!C||F.text&&F.text.toLowerCase().includes(R.toLowerCase()));return a.jsxs("div",{className:"fixed inset-0 md:static md:h-[calc(100vh-40px)] w-full max-w-[1600px] mx-auto flex gap-6 bg-[#f0f4f8] md:bg-transparent z-[50]",children:[a.jsxs("div",{className:`${p?"hidden":"flex"} w-full md:w-[400px] flex-col h-full md:glass-panel md:rounded-[35px] overflow-hidden bg-white md:bg-white/80 shrink-0`,children:[a.jsxs("div",{className:"p-6 pt-12 md:pt-8 border-b border-gray-100 bg-white/50 backdrop-blur-md sticky top-0 z-10",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-3xl font-black text-dark tracking-tight",children:"Messages"}),a.jsx("button",{onClick:()=>A(!0),className:"w-12 h-12 rounded-full bg-dark text-white flex items-center justify-center hover:bg-primary shadow-lg transition-all hover:rotate-90",children:a.jsx("i",{className:"fas fa-plus text-lg"})})]}),a.jsxs("div",{className:"relative group",children:[a.jsx("i",{className:"fas fa-search absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search conversations...",className:"w-full bg-gray-50 border-none rounded-2xl pl-12 pr-4 py-3 text-sm font-bold text-dark focus:ring-2 focus:ring-primary/20 transition-all"})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-3 space-y-2 pb-20 md:pb-2",children:r.map(F=>{var De,Se,_t,Rn;const ce=((De=F.unreadCounts)==null?void 0:De[X])||0,ye=F.isGroup?F.groupName:(Se=F.otherUser)==null?void 0:Se.displayName;return a.jsxs("div",{onClick:()=>{o(F),m(!0)},className:`flex items-center gap-4 p-4 rounded-[20px] cursor-pointer transition-all ${(i==null?void 0:i.id)===F.id?"bg-white shadow-lg scale-[1.02]":"hover:bg-white/60"}`,children:[a.jsx(_o,{src:F.isGroup?null:(_t=F.otherUser)==null?void 0:_t.photoURL,name:ye,size:"md",isGroup:F.isGroup}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("h4",{className:`text-base truncate ${ce?"font-black":"font-bold text-gray-700"}`,children:ye}),a.jsx("span",{className:"text-[10px] text-gray-400 font-bold",children:(Rn=F.updatedAt)!=null&&Rn.seconds?new Date(F.updatedAt.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""})]}),a.jsx("p",{className:`text-sm truncate ${ce?"font-bold text-dark":"text-gray-500"}`,children:F.lastMessage})]})]},F.id)})})]}),a.jsx("div",{className:`${p?"flex":"hidden"} fixed inset-0 md:static z-[60] md:z-auto flex-col flex-1 h-full bg-[#f0f4f8] md:glass-panel md:rounded-[35px] overflow-hidden shadow-2xl`,children:i?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"p-4 pt-safe-top md:p-6 border-b border-white/50 bg-white/80 backdrop-blur-xl flex justify-between items-center shadow-sm z-20",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("button",{onClick:()=>m(!1),className:"md:hidden w-10 h-10 flex items-center justify-center bg-white rounded-full shadow-sm text-dark",children:a.jsx("i",{className:"fas fa-arrow-left"})}),a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>T(!0),children:[a.jsx(_o,{src:i.isGroup?null:($=i.otherUser)==null?void 0:$.photoURL,name:i.isGroup?i.groupName:(te=i.otherUser)==null?void 0:te.displayName,isGroup:i.isGroup}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-black text-dark text-lg leading-tight",children:i.isGroup?i.groupName:(ge=i.otherUser)==null?void 0:ge.displayName}),a.jsx("p",{className:"text-xs font-bold text-primary",children:i.isGroup?`${i.users.length} Members`:"Active Now"})]})]})]}),C?a.jsxs("div",{className:"flex items-center gap-2 flex-1 justify-end animate-slide-in",children:[a.jsx("input",{autoFocus:!0,className:"bg-gray-50 rounded-full px-4 py-2 text-sm",placeholder:"Search chat...",value:R,onChange:F=>P(F.target.value)}),a.jsx("button",{onClick:()=>{he(!1),P("")},className:"text-gray-500",children:a.jsx("i",{className:"fas fa-times"})})]}):a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>pe("audio"),className:"w-12 h-12 rounded-2xl bg-gray-50 text-dark hover:bg-primary hover:text-white transition-all flex items-center justify-center shadow-sm",children:a.jsx("i",{className:"fas fa-phone-alt"})}),a.jsx("button",{onClick:()=>pe("video"),className:"w-12 h-12 rounded-2xl bg-gray-50 text-dark hover:bg-primary hover:text-white transition-all flex items-center justify-center shadow-sm",children:a.jsx("i",{className:"fas fa-video"})}),a.jsx("button",{onClick:()=>T(!0),className:"w-12 h-12 rounded-2xl bg-gray-50 text-dark hover:bg-dark hover:text-white transition-all flex items-center justify-center shadow-sm",children:a.jsx("i",{className:"fas fa-info"})})]})]}),a.jsxs("div",{className:`flex-1 overflow-y-auto p-4 md:p-8 space-y-6 bg-[#f0f4f8] md:bg-transparent relative transition-all ${E?"pb-4":"pb-24 md:pb-4"}`,children:[z.map((F,ce)=>{const ye=F.senderId===X;return a.jsx("div",{className:`flex ${ye?"justify-end":"justify-start"} animate-fade-in-up`,children:a.jsxs("div",{className:`max-w-[75%] px-5 py-3.5 rounded-[20px] text-[15px] shadow-sm backdrop-blur-sm break-words ${ye?"bg-gradient-to-br from-primary to-primary-dark text-white rounded-br-none":"bg-white text-dark border border-gray-100 rounded-bl-none"}`,children:[F.mediaType==="audio"&&a.jsx("audio",{src:F.mediaURL,controls:!0,className:"max-w-[200px] h-8"}),F.mediaType==="image"&&a.jsx("img",{src:F.mediaURL,className:"rounded-lg mb-2 max-h-60 object-cover"}),F.text&&a.jsx("p",{children:F.text})]})},F.id)}),a.jsx("div",{ref:Ie,className:"h-4"})]}),a.jsx("div",{className:`p-3 md:p-4 bg-white/95 backdrop-blur-xl border-t border-white/50 pb-safe-bottom relative z-30 transition-all duration-300 ${E?"mb-0":"mb-[65px] md:mb-0"}`,children:y?a.jsx(p4,{onSend:F=>q(null,"audio",F),onCancel:()=>_(!1)}):a.jsxs("div",{className:"flex gap-2 items-end bg-gray-50 border border-gray-200 rounded-[24px] p-2 shadow-inner relative",children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>I(!j),className:`w-10 h-10 rounded-full transition-all flex items-center justify-center ${j?"bg-dark text-white rotate-45":"text-gray-400 hover:bg-white"}`,children:a.jsx("i",{className:"fas fa-plus text-xl"})}),j&&a.jsxs("div",{className:"absolute bottom-14 left-0 bg-white rounded-2xl shadow-xl border border-gray-100 p-2 flex flex-col gap-2 animate-scale-in min-w-[140px] z-50",children:[a.jsxs("button",{onClick:()=>_(!0),className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 rounded-xl text-sm font-bold text-dark",children:[a.jsx("i",{className:"fas fa-microphone text-primary w-5"})," Voice Note"]}),a.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 rounded-xl text-sm font-bold text-dark cursor-pointer",children:[a.jsx("i",{className:"fas fa-image text-purple-500 w-5"})," Media ",a.jsx("input",{type:"file",className:"hidden",accept:"image/*,video/*",onChange:oe})]}),a.jsxs("label",{className:"flex items-center gap-3 px-3 py-2 hover:bg-gray-50 rounded-xl text-sm font-bold text-dark cursor-pointer",children:[a.jsx("i",{className:"fas fa-paperclip text-blue-500 w-5"})," File ",a.jsx("input",{type:"file",className:"hidden",onChange:oe})]})]})]}),a.jsx("textarea",{value:d,onFocus:()=>S(!0),onBlur:()=>setTimeout(()=>S(!1),200),onChange:F=>h(F.target.value),onKeyDown:F=>{F.key==="Enter"&&!F.shiftKey&&(F.preventDefault(),q(d))},placeholder:"Type a message...",rows:"1",className:"flex-1 bg-transparent border-none outline-none py-3 text-dark font-medium resize-none max-h-32"}),a.jsx("button",{disabled:!d.trim()&&!N,onClick:()=>q(d),className:"w-12 h-10 bg-dark text-white rounded-[18px] shadow-lg hover:bg-primary transition-all disabled:opacity-50 flex items-center justify-center",children:N?a.jsx("i",{className:"fas fa-spinner fa-spin"}):a.jsx("i",{className:"fas fa-paper-plane"})})]})}),v&&a.jsx(m4,{chat:i,media:l.filter(F=>["image","video"].includes(F.mediaType)),onClose:()=>T(!1),onBlock:re,onMute:Ae,onSearchClick:()=>{T(!1),he(!0)}})]}):a.jsxs("div",{className:"hidden md:flex flex-1 flex-col items-center justify-center text-center bg-white/50",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-tr from-primary/20 to-gold/20 rounded-full flex items-center justify-center mb-6 animate-pulse",children:a.jsx("i",{className:"fas fa-comments text-4xl text-primary"})}),a.jsx("h3",{className:"text-2xl font-black text-dark mb-2",children:"Welcome to Messages"}),a.jsx("p",{className:"text-gray-500",children:"Select a chat or start a new Entourage to connect."}),a.jsx("button",{onClick:()=>A(!0),className:"mt-8 bg-dark text-white px-8 py-3 rounded-xl font-bold hover:bg-primary transition-all shadow-lg",children:"Start New Chat"})]})}),V&&a.jsxs("div",{className:"fixed inset-0 z-[200] bg-[#0F172A] flex flex-col animate-fade-in",children:[a.jsx("div",{className:"absolute inset-0 opacity-30 bg-cover bg-center",style:{backgroundImage:`url(${i.isGroup?"https://via.placeholder.com/800":((Pe=i.otherUser)==null?void 0:Pe.photoURL)||"https://images.unsplash.com/photo-1534528741775-53994a69daeb"})`}}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/60 via-transparent to-black/80"}),a.jsxs("div",{className:"relative flex-1 flex flex-col items-center justify-center p-10",children:[a.jsxs("div",{className:"relative mb-8",children:[a.jsx("div",{className:"absolute inset-0 bg-primary/30 rounded-full animate-ping"}),a.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full animate-ping animation-delay-200"}),a.jsx("div",{className:"relative z-10",children:a.jsx(_o,{src:i.isGroup?null:(pt=i.otherUser)==null?void 0:pt.photoURL,name:i.isGroup?i.groupName:(gt=i.otherUser)==null?void 0:gt.displayName,size:"xl",className:"shadow-2xl shadow-primary/50 border-4 border-white/10",isGroup:i.isGroup})})]}),a.jsx("h2",{className:"text-4xl md:text-5xl font-black text-white mb-2 text-center tracking-tight",children:i.isGroup?i.groupName:(Bt=i.otherUser)==null?void 0:Bt.displayName}),a.jsxs("p",{className:"text-primary-light font-bold text-lg uppercase tracking-widest animate-pulse",children:[V.status,"..."]}),V.type==="video"&&a.jsx("div",{className:"mt-8 w-48 h-72 bg-black rounded-2xl overflow-hidden shadow-2xl border-2 border-white/20",children:a.jsx("video",{ref:Be,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"})})]}),a.jsxs("div",{className:"relative pb-12 pt-8 flex justify-center gap-8",children:[a.jsx("button",{className:"w-16 h-16 rounded-full bg-white/10 backdrop-blur-md text-white hover:bg-white hover:text-dark transition-all flex items-center justify-center",children:a.jsx("i",{className:"fas fa-microphone-slash text-xl"})}),a.jsx("button",{className:"w-16 h-16 rounded-full bg-white/10 backdrop-blur-md text-white hover:bg-white hover:text-dark transition-all flex items-center justify-center",children:a.jsx("i",{className:"fas fa-video-slash text-xl"})}),a.jsx("button",{onClick:O,className:"w-20 h-20 rounded-full bg-red-500 text-white shadow-xl shadow-red-500/40 hover:scale-110 transition-transform flex items-center justify-center",children:a.jsx("i",{className:"fas fa-phone-slash text-3xl"})})]})]}),b&&a.jsx(f4,{onClose:()=>A(!1),onCreate:ae,currentUserId:e==null?void 0:e.uid})]})},y4=({postId:t,currentUser:e,onReply:n})=>{const r=at(),[s,i]=w.useState([]);if(w.useEffect(()=>{const d=We(ie(U,"posts",t,"comments"),Xt("timestamp","asc")),h=qe(d,p=>{const m=p.docs.map(v=>({id:v.id,...v.data()}));i(m)});return()=>h()},[t]),s.length===0)return null;const o=s.filter(d=>!d.parentId),l=d=>s.filter(h=>h.parentId===d),u=({c:d,isReply:h})=>a.jsxs("div",{className:`flex gap-3 items-start text-sm mb-3 ${h?"ml-10":""}`,children:[a.jsx("img",{src:d.userAvatar||"https://via.placeholder.com/150",className:"w-8 h-8 rounded-full object-cover flex-shrink-0 cursor-pointer border border-gray-100",alt:d.userName,onClick:()=>r(`/profile/${d.uid}`)}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none inline-block border border-gray-100",children:[a.jsx("span",{className:"font-bold text-xs block text-dark cursor-pointer hover:underline",onClick:()=>r(`/profile/${d.uid}`),children:d.userName}),a.jsx("p",{className:"text-gray-700 leading-tight",children:d.text})]}),!h&&a.jsx("button",{onClick:()=>n(d.id,d.userName),className:"text-[10px] font-bold text-gray-500 ml-2 mt-1 hover:text-primary",children:"Reply"})]})]});return a.jsx("div",{className:"mt-3 px-2 max-h-60 overflow-y-auto custom-scrollbar",children:o.map(d=>a.jsxs("div",{children:[a.jsx(u,{c:d,isReply:!1}),l(d.id).map(h=>a.jsx(u,{c:h,isReply:!0},h.id))]},d.id))})},gv=()=>{const{id:t}=tl(),e=at(),[n,r]=w.useState(null),[s,i]=w.useState([]),[o,l]=w.useState(!1),[u,d]=w.useState(!1),[h,p]=w.useState(null),[m,v]=w.useState(!1),[T,j]=w.useState(!1),[I,y]=w.useState(null),[_,b]=w.useState(""),[A,V]=w.useState(null),[M,N]=w.useState(null),[x,E]=w.useState(null),[S,R]=w.useState(null),[P,C]=w.useState(""),[he,Ie]=w.useState(!1),[Be,Ve]=w.useState(null);w.useEffect(()=>{const $=Tt(_e,ge=>{if(ge){p(ge.uid);const Pe=t||ge.uid;l(Pe===ge.uid),G(Pe),Pe!==ge.uid&&ee(Pe,ge.uid)}else t&&G(t)}),te=ge=>{ge.target.closest(".post-menu-container")||E(null)};return document.addEventListener("click",te),()=>{$(),document.removeEventListener("click",te)}},[t]);const G=$=>{const te=qe(Y(U,"users",$),gt=>{var Bt;gt.exists()?r(gt.data()):$===((Bt=_e.currentUser)==null?void 0:Bt.uid)?r({displayName:_e.currentUser.displayName,handle:"user",photoURL:_e.currentUser.photoURL,coverPhotoURL:null,bio:"New user",followers:0,following:0}):r(null)}),ge=ie(U,"posts"),Pe=We(ge,ct("uid","==",$),Xt("timestamp","desc")),pt=qe(Pe,gt=>{i(gt.docs.map(Bt=>({id:Bt.id,...Bt.data()})))});return()=>{te(),pt()}},ee=async($,te)=>{const ge=Y(U,"users",$,"followers",te),Pe=await _n(ge);v(Pe.exists())},X=async()=>{if(!h||T)return;j(!0);const $=t||h;try{const te=Rf(U),ge=Y(U,"users",$),Pe=Y(U,"users",h),pt=Y(U,"users",$,"followers",h),gt=Y(U,"users",h,"following",$);m?(te.delete(pt),te.delete(gt),te.update(ge,{followers:xt(-1)}),te.update(Pe,{following:xt(-1)}),v(!1)):(te.set(pt,{timestamp:ke()}),te.set(gt,{timestamp:ke()}),te.update(ge,{followers:xt(1)}),te.update(Pe,{following:xt(1)}),v(!0),$!==h&&await Ge(ie(U,"notifications"),{recipientId:$,senderId:h,senderName:_e.currentUser.displayName,senderAvatar:_e.currentUser.photoURL,type:"follow",targetId:h,timestamp:ke(),isRead:!1})),await te.commit()}catch(te){console.error("Follow error:",te)}finally{j(!1)}},fe=()=>{if(!h)return console.error("Please sign in.");e("/messages",{state:{startChatWith:{...n,uid:t||h}}})},ae=async $=>{if(!h)return console.error("Sign in.");const te=Y(U,"posts",$.id);$.likedBy&&$.likedBy.includes(h)?await ue(te,{likes:xt(-1),likedBy:hn(h)}):(await ue(te,{likes:xt(1),likedBy:Et(h)}),$.uid!==h&&await Ge(ie(U,"notifications"),{recipientId:$.uid,senderId:h,senderName:_e.currentUser.displayName,senderAvatar:_e.currentUser.photoURL,type:"like",targetId:$.id,timestamp:ke(),isRead:!1}))},q=$=>{if(!h)return console.error("Sign in to comment.");I===$?y(null):(y($),b(""),V(null))},oe=($,te)=>{V($),b(`@${te} `),document.querySelector(`#comment-input-${I}`).focus()},pe=async $=>{var ge;if(!_.trim()||!h)return;let te=(ge=s.find(Pe=>Pe.id===$))==null?void 0:ge.uid;await Ge(ie(U,"posts",$,"comments"),{text:_,uid:h,userName:_e.currentUser.displayName,userAvatar:_e.currentUser.photoURL,parentId:A,timestamp:ke()}),await ue(Y(U,"posts",$),{comments:xt(1)}),te&&te!==h&&await Ge(ie(U,"notifications"),{recipientId:te,senderId:h,senderName:_e.currentUser.displayName,senderAvatar:_e.currentUser.photoURL,type:"comment",targetId:$,timestamp:ke(),isRead:!1}),b(""),V(null)},O=async $=>{const te=`${window.location.origin}/post/${$.id}`;if(navigator.share)navigator.share({title:"Check this post on Tukumi",url:te});else{const ge=document.createElement("textarea");ge.value=te,document.body.appendChild(ge),ge.select();try{document.execCommand("copy"),console.log("Link copied to clipboard!")}catch(Pe){console.error("Could not copy text: ",Pe)}document.body.removeChild(ge)}},re=async $=>{console.log("Delete action triggered. Implement a modal to confirm deletion for post:",$),await js(Y(U,"posts",$))},Ae=async $=>{await ue(Y(U,"posts",$.id),{isPrivate:!$.isPrivate}),E(null)},z=async $=>{!Be||!h||(await Ge(ie(U,"reports"),{targetId:Be,type:"post",reporter:h,reason:$,timestamp:ke()}),console.log("Post reported successfully. Thank you for making our platform safer."),Ie(!1),Ve(null))},se=$=>{R($.id),C($.text),E(null)},we=async $=>{P.trim()&&(await ue(Y(U,"posts",$),{text:P}),R(null))};return n?a.jsxs("div",{className:"p-2 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm overflow-hidden mb-8 relative group transition-all hover:shadow-md",children:[a.jsx("div",{className:"h-48 md:h-80 w-full bg-gray-200 bg-cover bg-center relative",style:{backgroundImage:`url(${n.coverPhotoURL||"https://images.unsplash.com/photo-1579546929518-9e396f3cc809"})`}}),a.jsxs("div",{className:"px-6 md:px-10 pb-8 relative",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end -mt-16 md:-mt-20 mb-6",children:[a.jsx("div",{className:"relative mx-auto md:mx-0",children:a.jsx("div",{className:"w-32 h-32 md:w-44 md:h-44 rounded-[2rem] p-1 bg-white shadow-2xl",children:n.photoURL?a.jsx("img",{src:n.photoURL,className:"w-full h-full rounded-[1.8rem] object-cover",alt:`${n.displayName} avatar`}):a.jsx("div",{className:"w-full h-full rounded-[1.8rem] bg-gray-100 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-user text-5xl text-gray-300"})})})}),a.jsxs("div",{className:"flex flex-col items-center w-full md:w-auto mt-4 md:mt-0 md:mb-4 gap-3",children:[a.jsxs("div",{className:"flex items-center gap-6 bg-white/90 backdrop-blur-md px-6 py-3 rounded-2xl shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("span",{className:"block font-black text-lg text-dark",children:s.length}),a.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Posts"})]}),a.jsx("div",{className:"w-px h-8 bg-gray-200"}),a.jsxs("div",{className:"text-center cursor-pointer hover:opacity-70 transition-opacity",onClick:()=>e(`/profile/${t||h}/connections`),children:[a.jsx("span",{className:"block font-black text-lg text-dark",children:n.followers||0}),a.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Followers"})]}),a.jsx("div",{className:"w-px h-8 bg-gray-200"}),a.jsxs("div",{className:"text-center cursor-pointer hover:opacity-70 transition-opacity",onClick:()=>e(`/profile/${t||h}/connections`),children:[a.jsx("span",{className:"block font-black text-lg text-dark",children:n.following||0}),a.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Following"})]})]}),a.jsx("div",{className:"flex gap-2",children:o?a.jsx("button",{onClick:()=>d(!0),className:"bg-gray-100 text-dark border border-gray-200 px-8 py-2 rounded-2xl font-bold hover:bg-gray-200 transition-all",children:"Edit Profile"}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:X,disabled:T,className:`px-6 py-2 rounded-2xl font-bold shadow-md transition-all ${m?"bg-white text-dark border hover:bg-gray-100":"bg-primary text-white hover:bg-primary-dark"}`,children:T?a.jsx("i",{className:"fas fa-spinner fa-spin"}):m?"Following":"Follow"}),a.jsx("button",{onClick:fe,className:"bg-white text-primary border px-4 py-2 rounded-2xl font-bold shadow-md hover:bg-primary-light/10",children:a.jsx("i",{className:"fas fa-comment-alt text-xl"})})]})})]})]}),a.jsxs("div",{className:"text-center md:text-left",children:[a.jsx("h1",{className:"text-3xl font-black text-dark mb-1",children:n.displayName}),a.jsxs("p",{className:"text-primary font-bold text-sm mb-4",children:["@",n.handle||"user"]}),a.jsx("p",{className:"text-gray-600 leading-relaxed text-lg",children:n.bio}),a.jsxs("div",{className:"flex flex-wrap gap-3 mt-4 justify-center md:justify-start",children:[n.profession&&a.jsxs("span",{className:"px-4 py-2 rounded-xl bg-[#F8FAFD] text-gray-600 text-sm font-bold flex items-center gap-2 border border-gray-100",children:[a.jsx("i",{className:"fas fa-briefcase text-primary"})," ",n.profession]}),n.location&&a.jsxs("span",{className:"px-4 py-2 rounded-xl bg-[#F8FAFD] text-gray-600 text-sm font-bold flex items-center gap-2 border border-gray-100",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-primary"})," ",n.location]})]})]})]})]}),a.jsx("div",{className:"flex flex-col gap-6",children:s.map($=>{var Pe;const te=$.likedBy&&$.likedBy.includes(h),ge=h===$.uid;return $.isPrivate&&!ge?null:a.jsxs("div",{className:"bg-white rounded-[24px] p-6 shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[$.userAvatar?a.jsx("img",{src:$.userAvatar,className:"w-12 h-12 rounded-2xl object-cover",alt:`${$.userName} avatar`}):a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-100"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-dark text-lg",children:[$.userName," ",$.isPrivate&&a.jsx("i",{className:"fas fa-lock text-xs text-gray-400",title:"Private Post"})]}),a.jsx("p",{className:"text-xs text-gray-400 font-bold",children:(Pe=$.timestamp)!=null&&Pe.seconds?new Date($.timestamp.seconds*1e3).toLocaleDateString():"Just now"})]})]}),a.jsxs("div",{className:"relative post-menu-container",children:[a.jsx("button",{onClick:()=>E(x===$.id?null:$.id),className:"text-gray-300 hover:text-dark p-2 transition-colors",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),x===$.id&&a.jsx("div",{className:"absolute right-0 top-8 w-40 bg-white rounded-xl shadow-xl z-10 overflow-hidden border",children:ge?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Ae($),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50",children:$.isPrivate?"Make Public":"Make Private"}),a.jsx("button",{onClick:()=>se($),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50",children:"Edit"}),a.jsx("button",{onClick:()=>re($.id),className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-500",children:"Delete"})]}):a.jsx("button",{onClick:()=>{Ve($.id),Ie(!0),E(null)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-red-500",children:"Report"})})]})]}),S===$.id?a.jsxs("div",{className:"mb-4",children:[a.jsx("textarea",{value:P,onChange:pt=>C(pt.target.value),className:"w-full p-3 bg-gray-50 rounded-xl border focus:border-primary focus:outline-none transition-colors",rows:"4"}),a.jsx("button",{onClick:()=>we($.id),className:"mt-2 bg-primary text-white px-4 py-2 rounded-xl font-bold hover:bg-primary-dark transition-colors",children:"Save Edit"})]}):a.jsx("p",{className:"text-gray-800 mb-4 whitespace-pre-wrap",children:$.text}),$.mediaURL&&a.jsx("div",{className:"rounded-2xl overflow-hidden mb-4 shadow-sm cursor-pointer transition-all hover:opacity-90",onClick:()=>N({url:$.mediaURL,type:$.mediaType}),children:$.mediaType==="video"?a.jsx("video",{src:$.mediaURL,controls:!0,className:"w-full max-h-[500px] bg-black"}):a.jsx("img",{src:$.mediaURL,className:"w-full max-h-[500px] object-cover",alt:"Post Media"})}),a.jsxs("div",{className:"flex gap-6 text-gray-500 font-bold text-sm pt-2 border-t border-gray-100/50 items-center",children:[a.jsxs("button",{onClick:()=>ae($),className:`flex items-center gap-2 transition-colors ${te?"text-red-500":"hover:text-red-500"}`,children:[a.jsx("i",{className:`${te?"fas":"far"} fa-heart text-lg`})," ",$.likes||0]}),a.jsxs("button",{onClick:()=>q($.id),className:"flex items-center gap-2 hover:text-primary transition-colors",children:[a.jsx("i",{className:"far fa-comment text-lg"})," ",$.comments||0]}),a.jsx("button",{onClick:()=>O($),className:"ml-auto hover:text-dark transition-colors",children:a.jsx("i",{className:"far fa-share-square text-lg"})})]}),I===$.id&&a.jsxs("div",{className:"mt-4 animate-fade-in",children:[a.jsx(y4,{postId:$.id,currentUser:_e.currentUser,onReply:oe}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("input",{id:`comment-input-${$.id}`,type:"text",placeholder:A?"Replying to comment...":"Write a comment...",className:"flex-1 bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-primary transition-colors",value:_,onChange:pt=>b(pt.target.value),onKeyDown:pt=>pt.key==="Enter"&&pe($.id),autoFocus:!0}),a.jsx("button",{onClick:()=>pe($.id),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md hover:bg-primary-dark transition-colors disabled:opacity-50",disabled:!_.trim(),children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})]},$.id)})}),u&&n&&a.jsx(DN,{user:n,onClose:()=>d(!1),onSave:()=>G(h)}),M&&a.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4 transition-opacity duration-300",onClick:()=>N(null),children:[a.jsx("button",{onClick:()=>N(null),className:"absolute top-4 right-4 text-white text-3xl z-[101]",children:""}),M.type==="video"?a.jsx("video",{src:M.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-full object-contain",onClick:$=>$.stopPropagation()}):a.jsx("img",{src:M.url,alt:"Fullscreen Media",className:"max-w-full max-h-full object-contain",onClick:$=>$.stopPropagation()})]}),he&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center animate-fade-in p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3 text-red-500 text-xl",children:a.jsx("i",{className:"fas fa-flag"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Report Post"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Why are you reporting this content?"})]}),a.jsx("div",{className:"space-y-2 mb-6",children:["Spam or Fraud","Harassment","Violence","False Information","Inappropriate Content"].map($=>a.jsx("button",{onClick:()=>z($),className:"w-full text-left p-3 rounded-xl bg-gray-50 hover:bg-red-50 hover:text-red-600 text-gray-700 font-medium transition-colors",children:$},$))}),a.jsx("button",{onClick:()=>Ie(!1),className:"w-full py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancel"})]})})]}):a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading profile or profile not found..."})},x4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState([]),[l,u]=w.useState(!1),[d,h]=w.useState(!1),[p,m]=w.useState(""),[v,T]=w.useState(""),[j,I]=w.useState("Social"),[y,_]=w.useState(!1),[b,A]=w.useState(null),V=["Social","Science","Technology","Entertainment","Business","Lifestyle","Art","Gaming"];w.useEffect(()=>{const x=Tt(_e,R=>n(R)),E=We(ie(U,"circles"),Xt("memberCount","desc")),S=qe(E,R=>{const P=R.docs.map(C=>({id:C.id,...C.data()}));s(P)});return()=>{x(),S()}},[]),w.useEffect(()=>{e&&r.length>0&&o(r.filter(x=>x.members&&x.members.includes(e.uid)))},[e,r]);const M=async x=>{if(x.preventDefault(),!e)return alert("Please sign in.");h(!0);try{let E=`https://ui-avatars.com/api/?name=${p}&background=random`;if(b){const S=Tn(Sn,`circles/${Date.now()}_${b.name}`);await En(S,b),E=await kn(S)}await Ge(ie(U,"circles"),{name:p,description:v,category:j,isPrivate:y,image:E,createdBy:e.uid,createdAt:ke(),members:[e.uid],admins:[e.uid],joinRequests:[],memberCount:1}),u(!1),m(""),T(""),A(null),alert("Circle Created Successfully!")}catch(E){console.error(E),alert("Failed to create circle.")}finally{h(!1)}},N=async x=>{if(!e)return alert("Sign in required.");const E=Y(U,"circles",x.id);x.isPrivate?x.joinRequests&&x.joinRequests.includes(e.uid)?alert("Request already sent."):(await ue(E,{joinRequests:Et(e.uid)}),alert("Join request sent to admins.")):await ue(E,{members:Et(e.uid),memberCount:xt(1)})};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-black text-dark tracking-tight flex items-center gap-3",children:[a.jsx("i",{className:"fas fa-dot-circle text-primary"})," Circles"]}),a.jsx("p",{className:"text-gray-500 font-medium",children:"Find your tribe. Join the elite."})]}),a.jsxs("button",{onClick:()=>u(!0),className:"bg-gradient-to-r from-primary to-primary-light text-white px-6 py-3 rounded-full font-bold shadow-lg hover:shadow-primary/30 transition-all flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-plus"})," Create Circle"]})]}),i.length>0&&a.jsxs("div",{className:"mb-10",children:[a.jsx("h3",{className:"text-xl font-bold text-dark mb-4 px-2",children:"My Circles"}),a.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar",children:i.map(x=>a.jsxs("div",{onClick:()=>t(`/circles/${x.id}`),className:"flex-shrink-0 w-64 glass-panel rounded-[30px] p-4 hover:scale-105 transition-transform cursor-pointer border border-white/60 relative overflow-hidden group",children:[a.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-20 group-hover:opacity-30 transition-opacity",style:{backgroundImage:`url(${x.image})`}}),a.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[a.jsx("img",{src:x.image,className:"w-20 h-20 rounded-full border-4 border-white shadow-md mb-3 object-cover"}),a.jsx("h4",{className:"font-bold text-dark text-lg leading-tight mb-1 truncate w-full",children:x.name}),a.jsxs("span",{className:"text-xs font-bold text-primary bg-primary/10 px-3 py-1 rounded-full",children:[x.memberCount," Members"]})]})]},x.id))})]}),a.jsx("h3",{className:"text-xl font-bold text-dark mb-6 px-2",children:"Discover"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(x=>{const E=e&&x.members&&x.members.includes(e.uid),S=e&&x.joinRequests&&x.joinRequests.includes(e.uid);return a.jsxs("div",{className:"glass-panel rounded-[30px] p-6 flex items-center gap-5 hover:shadow-xl transition-all border border-white/50 cursor-pointer",onClick:()=>t(`/circles/${x.id}`),children:[a.jsx("img",{src:x.image,className:"w-24 h-24 rounded-full object-cover shadow-lg border-4 border-white/50"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("span",{className:"bg-gray-100 text-[10px] font-bold px-2 py-0.5 rounded-md text-gray-500 mb-1",children:x.category}),x.isPrivate&&a.jsx("i",{className:"fas fa-lock text-gray-400 text-xs"})]}),a.jsx("h4",{className:"font-black text-xl text-dark truncate",children:x.name}),a.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-4",children:x.description}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-xs font-bold text-gray-400",children:[a.jsx("i",{className:"fas fa-users mr-1"})," ",x.memberCount]}),a.jsx("button",{onClick:R=>{R.stopPropagation(),!E&&!S&&N(x)},className:`text-xs font-bold px-5 py-2 rounded-full transition-colors shadow-sm
                        ${E?"bg-gray-100 text-gray-400":S?"bg-yellow-100 text-yellow-600":"bg-dark text-white hover:bg-primary"}`,children:E?"Joined":S?"Pending":"Join"})]})]})]},x.id)})}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-[30px] shadow-2xl w-full max-w-md overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Create Circle"}),a.jsx("button",{onClick:()=>u(!1),children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),a.jsxs("form",{onSubmit:M,className:"p-6 space-y-4",children:[a.jsx("input",{type:"text",required:!0,placeholder:"Circle Name",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3",value:p,onChange:x=>m(x.target.value)}),a.jsx("textarea",{required:!0,placeholder:"Description",rows:"3",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3",value:v,onChange:x=>T(x.target.value)}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3",value:j,onChange:x=>I(x.target.value),children:V.map(x=>a.jsx("option",{value:x,children:x},x))}),a.jsx("div",{className:"flex items-center justify-center bg-gray-50 border border-gray-200 rounded-xl px-4",children:a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm text-gray-600 font-bold",children:[a.jsx("input",{type:"checkbox",checked:y,onChange:x=>_(x.target.checked)})," Private"]})})]}),a.jsxs("div",{className:"border-dashed border-2 border-gray-200 rounded-xl p-4 text-center",children:[a.jsxs("label",{className:"cursor-pointer",children:[a.jsx("span",{className:"text-primary font-bold text-sm",children:"Upload Cover Image"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:x=>A(x.target.files[0])})]}),b&&a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:b.name})]}),a.jsx("button",{type:"submit",disabled:d,className:"w-full bg-primary text-white font-bold py-4 rounded-xl hover:bg-primary-dark transition-all shadow-lg",children:d?"Creating...":"Launch Circle"})]})]})})]})},v4=({uid:t,isAdminView:e,onRemove:n})=>{const[r,s]=w.useState(null);return w.useEffect(()=>{(async()=>{const o=Y(U,"users",t),l=await _n(o);l.exists()?s(l.data()):s({displayName:"Unknown User",photoURL:null})})()},[t]),r?a.jsxs("div",{className:"flex justify-between items-center p-3 bg-white/60 rounded-xl border border-white/50 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:r.photoURL||"https://via.placeholder.com/40",className:"w-8 h-8 rounded-full object-cover",alt:r.displayName}),a.jsx("span",{className:"text-sm font-bold text-gray-700",children:r.displayName})]}),e&&a.jsx("button",{onClick:()=>n(t),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg text-xs font-bold",children:"Remove"})]}):a.jsx("div",{className:"p-3 text-xs text-gray-400",children:"Loading..."})},w4=()=>{var gt,Bt;const{circleId:t}=tl(),e=at(),[n,r]=w.useState(null),[s,i]=w.useState(null),[o,l]=w.useState([]),[u,d]=w.useState("feed"),[h,p]=w.useState(""),[m,v]=w.useState(null),[T,j]=w.useState(!1),[I,y]=w.useState(""),[_,b]=w.useState(null),[A,V]=w.useState(""),[M,N]=w.useState(null),[x,E]=w.useState(null),[S,R]=w.useState(""),[P,C]=w.useState(null),[he,Ie]=w.useState(""),[Be,Ve]=w.useState(null),[G,ee]=w.useState(!1);if(w.useEffect(()=>{Tt(_e,Se=>{if(Se){const _t=qe(Y(U,"users",Se.uid),Rn=>{Rn.exists()?r({uid:Se.uid,...Rn.data()}):r(Se)});return()=>_t()}else r(null)});const F=qe(Y(U,"circles",t),Se=>{Se.exists()?(i({id:Se.id,...Se.data()}),y(Se.data().name)):e("/circles")}),ce=We(ie(U,`circles/${t}/posts`),Xt("timestamp","desc")),ye=qe(ce,Se=>l(Se.docs.map(_t=>({id:_t.id,..._t.data()})))),De=Se=>{Se.target.closest(".post-menu-container")||N(null),Se.target.closest(".circle-menu-container")||ee(!1)};return document.addEventListener("click",De),()=>{F(),ye(),document.removeEventListener("click",De)}},[t,e]),!s)return a.jsx("div",{className:"p-10 text-center",children:"Loading Circle..."});const X=n&&s.members&&s.members.includes(n.uid),fe=n&&s.admins&&s.admins.includes(n.uid),ae=n&&s.createdBy===n.uid,q=n&&s.joinRequests&&s.joinRequests.includes(n.uid),oe=async()=>{if(!n)return alert("Sign in required.");const F=Y(U,"circles",t);if(s.isPrivate){if(q)return alert("Request already sent.");await ue(F,{joinRequests:Et(n.uid)}),alert("Join request sent to admins.")}else await ue(F,{members:Et(n.uid),memberCount:xt(1)}),alert("Welcome to the Circle!")},pe=async()=>{if(!(!h.trim()&&!m||!n)){j(!0);try{let F=null,ce=null;if(m){const ye=Tn(Sn,`circles/${t}/posts/${Date.now()}_${m.name}`);await En(ye,m),F=await kn(ye),ce=m.type.startsWith("video/")?"video":"image"}await Ge(ie(U,`circles/${t}/posts`),{text:h,uid:n.uid,userName:n.displayName,userAvatar:n.photoURL||null,mediaURL:F,mediaType:ce,timestamp:ke(),likes:0,comments:0,likedBy:[]}),p(""),v(null)}catch(F){console.error("Post error:",F)}finally{j(!1)}}},O=async F=>{confirm("Remove this member?")&&await ue(Y(U,"circles",t),{members:hn(F),admins:hn(F),memberCount:xt(-1)})},re=async()=>{if(ae)return alert("Owner cannot leave.");confirm("Are you sure you want to leave?")&&(await ue(Y(U,"circles",t),{members:hn(n.uid),admins:hn(n.uid),memberCount:xt(-1)}),e("/circles"))},Ae=async()=>{confirm("Delete permanently?")&&(await js(Y(U,"circles",t)),e("/circles"))},z=async()=>{try{let F=s.image;if(_){const ce=Tn(Sn,`circles/${t}/cover_${Date.now()}`);await En(ce,_),F=await kn(ce)}await ue(Y(U,"circles",t),{name:I,image:F}),alert("Updated!"),b(null)}catch(F){console.error(F)}},se=async()=>{if(!A)return alert("Select reason");await Ge(ie(U,"reports"),{targetId:t,type:"circle",reporter:n.uid,reason:A,timestamp:ke()}),alert("Reported."),V("")},we=async F=>{if(!n)return alert("Sign in required.");const ce=Y(U,`circles/${t}/posts`,F.id);F.likedBy&&F.likedBy.includes(n.uid)?await ue(ce,{likes:xt(-1),likedBy:hn(n.uid)}):await ue(ce,{likes:xt(1),likedBy:Et(n.uid)})},$=F=>{P===F?C(null):(C(F),Ie(""))},te=async F=>{!he.trim()||!n||(await Ge(ie(U,`circles/${t}/posts/${F}/comments`),{text:he,uid:n.uid,userName:n.displayName,userAvatar:n.photoURL,timestamp:ke()}),await ue(Y(U,`circles/${t}/posts`,F),{comments:xt(1)}),Ie(""),C(null))},ge=F=>{const ce={title:`Post in ${s.name}`,text:F.text,url:window.location.href};navigator.share?navigator.share(ce):(navigator.clipboard.writeText(window.location.href),alert("Link copied!"))},Pe=async F=>{confirm("Delete post?")&&await js(Y(U,`circles/${t}/posts`,F))},pt=async F=>{await Ge(ie(U,"reports"),{postId:F,circleId:t,reporter:n.uid,reason:"Flagged in Circle",timestamp:ke()}),alert("Post reported."),N(null)};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("button",{onClick:()=>e("/circles"),className:"mb-4 text-sm text-gray-500 hover:text-primary font-bold flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Circles"]}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm overflow-hidden mb-8 relative",children:[a.jsxs("div",{className:"h-60 w-full bg-gray-200 bg-cover bg-center",style:{backgroundImage:`url(${s.image})`},children:[a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"}),a.jsx("div",{className:"absolute bottom-0 left-0 p-8 text-white w-full",children:a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"bg-primary px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider",children:s.category||"Social"}),s.isPrivate&&a.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-3 py-1 rounded-lg text-xs font-bold",children:[a.jsx("i",{className:"fas fa-lock mr-1"})," Private"]})]}),a.jsx("h1",{className:"text-4xl font-black mb-2",children:s.name}),a.jsx("p",{className:"text-white/80 max-w-2xl text-sm",children:s.description})]}),a.jsx("div",{className:"flex items-center gap-3",children:X?a.jsxs("div",{className:"relative circle-menu-container",children:[a.jsx("button",{onClick:()=>ee(!G),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white hover:text-dark transition-all",children:a.jsx("i",{className:"fas fa-cog text-lg"})}),G&&a.jsxs("div",{className:"absolute right-0 bottom-12 w-48 bg-white rounded-xl shadow-xl border border-gray-100 z-50 overflow-hidden animate-fade-in p-1",children:[fe&&a.jsxs("button",{onClick:()=>{d("settings"),ee(!1)},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-sliders-h text-primary"})," Settings"]}),!ae&&a.jsxs("button",{onClick:()=>{re(),ee(!1)},className:"w-full text-left px-4 py-3 text-sm font-bold text-red-500 hover:bg-red-50 rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-sign-out-alt"})," Leave Circle"]}),!fe&&a.jsxs("button",{onClick:()=>{d("report"),ee(!1)},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-500 hover:bg-gray-50 rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-flag"})," Report"]})]})]}):a.jsx("button",{onClick:oe,className:`px-6 py-2 rounded-xl font-bold text-sm shadow-lg transition-all ${q?"bg-yellow-100 text-yellow-700":"bg-white text-dark hover:bg-primary hover:text-white"}`,disabled:q,children:q?"Request Pending":"Join Circle"})})]})})]}),a.jsxs("div",{className:"px-8 py-4 flex gap-8 text-sm font-bold text-gray-500 border-b border-gray-100",children:[a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-users mr-2"}),s.memberCount," Members"]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-layer-group mr-2"}),o.length," Posts"]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-user-shield mr-2"}),((gt=s.admins)==null?void 0:gt.length)||1," Admins"]})]})]}),X&&a.jsxs("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:[a.jsx("button",{onClick:()=>d("feed"),className:`px-6 py-2 font-bold text-sm rounded-full transition-colors ${u==="feed"?"bg-dark text-white":"bg-white text-gray-500 hover:bg-gray-100"}`,children:"Feed"}),a.jsx("button",{onClick:()=>d("members"),className:`px-6 py-2 font-bold text-sm rounded-full transition-colors ${u==="members"?"bg-dark text-white":"bg-white text-gray-500 hover:bg-gray-100"}`,children:"Members"}),fe&&s.isPrivate&&a.jsxs("button",{onClick:()=>d("requests"),className:`px-6 py-2 font-bold text-sm rounded-full transition-colors ${u==="requests"?"bg-dark text-white":"bg-white text-gray-500 hover:bg-gray-100"}`,children:["Requests ",((Bt=s.joinRequests)==null?void 0:Bt.length)>0&&a.jsx("span",{className:"ml-2 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:s.joinRequests.length})]})]}),a.jsx("div",{className:"flex flex-col lg:flex-row gap-8",children:a.jsxs("div",{className:"flex-1",children:[u==="feed"&&(X?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"glass-panel rounded-[24px] p-4",children:[a.jsx("textarea",{value:h,onChange:F=>p(F.target.value),placeholder:`Post something to ${s.name}...`,className:"w-full bg-white/60 rounded-xl p-4 outline-none resize-none text-sm focus:ring-2 focus:ring-primary/20",rows:"3"}),a.jsxs("div",{className:"flex justify-between items-center mt-3",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("label",{className:"cursor-pointer w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center text-gray-500 hover:bg-primary/10 hover:text-primary",children:[a.jsx("i",{className:"fas fa-image"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*,video/*",onChange:F=>v(F.target.files[0])})]}),m&&a.jsx("span",{className:"text-xs text-primary self-center truncate max-w-[100px]",children:m.name})]}),a.jsx("button",{onClick:pe,disabled:T,className:"bg-dark text-white px-6 py-2 rounded-xl font-bold text-sm hover:bg-primary shadow-lg disabled:opacity-50",children:T?"Posting...":"Post"})]})]}),o.map(F=>{var ye;const ce=F.likedBy&&F.likedBy.includes(n.uid);return a.jsxs("div",{className:"glass-panel rounded-[24px] p-6 border border-white/60 relative",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer group",onClick:()=>e(`/profile/${F.uid}`),children:[a.jsx("img",{src:F.userAvatar||"https://via.placeholder.com/40",className:"w-10 h-10 rounded-full border border-gray-200 object-cover"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-dark text-sm group-hover:text-primary",children:F.userName}),a.jsx("p",{className:"text-xs text-gray-400",children:(ye=F.timestamp)!=null&&ye.seconds?new Date(F.timestamp.seconds*1e3).toLocaleDateString():"Just now"})]})]}),a.jsxs("div",{className:"relative post-menu-container",children:[a.jsx("button",{onClick:()=>N(M===F.id?null:F.id),className:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),M===F.id&&a.jsx("div",{className:"absolute right-0 top-full mt-2 w-40 bg-white rounded-xl shadow-xl border border-gray-100 z-20 overflow-hidden py-1",children:(n==null?void 0:n.uid)===F.uid||fe?a.jsx(a.Fragment,{children:a.jsx("button",{onClick:()=>Pe(F.id),className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 font-bold",children:"Delete"})}):a.jsx("button",{onClick:()=>pt(F.id),className:"w-full text-left px-4 py-2 text-sm text-gray-500 hover:bg-gray-50",children:"Report"})})]})]}),a.jsx("p",{className:"text-gray-800 mb-4 leading-relaxed",children:F.text}),F.mediaURL&&a.jsx("div",{className:"rounded-xl overflow-hidden mb-4 shadow-sm cursor-pointer",onClick:()=>Ve({url:F.mediaURL,type:F.mediaType}),children:F.mediaType==="video"?a.jsx("video",{src:F.mediaURL,controls:!0,className:"w-full max-h-[400px] bg-black"}):a.jsx("img",{src:F.mediaURL,className:"w-full max-h-[400px] object-cover"})}),a.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-100/50",children:[a.jsxs("button",{onClick:()=>we(F),className:`h-10 px-5 rounded-xl border flex items-center gap-2 transition-all ${ce?"bg-accent/10 border-accent/20 text-accent":"bg-white/50 border-white text-gray-600"}`,children:[a.jsx("i",{className:`${ce?"fas":"far"} fa-heart`})," ",a.jsx("span",{className:"font-bold text-sm",children:F.likes||0})]}),a.jsxs("button",{onClick:()=>$(F.id),className:"h-10 px-5 rounded-xl bg-white/50 border border-white flex items-center gap-2 text-gray-600",children:[a.jsx("i",{className:"far fa-comment"})," ",a.jsx("span",{className:"font-bold text-sm",children:F.comments||0})]}),a.jsx("button",{onClick:()=>ge(F),className:"h-10 w-10 rounded-xl bg-white/50 border border-white flex items-center justify-center text-gray-600 ml-auto",children:a.jsx("i",{className:"far fa-share-square"})})]}),P===F.id&&a.jsxs("div",{className:"mt-4 flex gap-2",children:[a.jsx("input",{type:"text",placeholder:"Write a comment...",className:"flex-1 bg-white/80 border border-white/50 rounded-xl px-4 py-2 text-sm focus:outline-none",value:he,onChange:De=>Ie(De.target.value),onKeyDown:De=>De.key==="Enter"&&te(F.id),autoFocus:!0}),a.jsx("button",{onClick:()=>te(F.id),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md",children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]},F.id)})]}):a.jsxs("div",{className:"text-center py-20 text-gray-400 bg-white rounded-[30px] shadow-sm",children:[a.jsx("i",{className:"fas fa-lock text-4xl mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-bold text-dark",children:"Private Content"}),a.jsx("p",{children:"Join this circle to view posts."})]})),u==="members"&&X&&a.jsxs("div",{className:"glass-panel rounded-[24px] p-6",children:[a.jsxs("h3",{className:"font-bold text-dark mb-4 flex justify-between items-center",children:["Members",a.jsx("span",{className:"text-xs bg-gray-100 px-2 py-1 rounded-full",children:s.memberCount})]}),fe?a.jsx("div",{className:"space-y-1",children:s.members.map(F=>a.jsx(v4,{uid:F,isAdminView:!0,onRemove:O},F))}):a.jsxs("div",{className:"text-center py-10 bg-gray-50/50 rounded-xl border border-gray-100",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3 text-gray-400 text-2xl",children:a.jsx("i",{className:"fas fa-users"})}),a.jsxs("h4",{className:"font-bold text-dark",children:["Total Members: ",s.memberCount]}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only admins can view the full member list."})]})]}),u==="settings"&&fe&&a.jsxs("div",{className:"glass-panel rounded-[24px] p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-dark mb-2",children:"Edit Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{type:"text",value:I,onChange:F=>y(F.target.value),className:"w-full bg-white border border-gray-200 rounded-xl px-4 py-2 text-sm",placeholder:"Circle Name"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx("input",{type:"file",onChange:F=>b(F.target.files[0]),className:"text-sm text-gray-500"}),a.jsx("button",{onClick:z,className:"bg-dark text-white px-4 py-2 rounded-lg text-xs font-bold",children:"Save Changes"})]})]})]}),a.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[a.jsx("h3",{className:"font-bold text-red-500 mb-2",children:"Danger Zone"}),a.jsx("button",{onClick:Ae,className:"w-full bg-red-50 text-red-500 border border-red-200 py-3 rounded-xl font-bold text-sm hover:bg-red-100",children:"Delete Circle Permanently"})]})]}),u==="report"&&!fe&&a.jsxs("div",{className:"glass-panel rounded-[24px] p-6",children:[a.jsx("h3",{className:"font-bold text-dark mb-4",children:"Report Circle"}),a.jsx("textarea",{className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-3 border border-gray-200",rows:"3",placeholder:"Reason...",value:A,onChange:F=>V(F.target.value)}),a.jsx("button",{onClick:se,className:"w-full bg-red-500 text-white py-3 rounded-xl font-bold text-sm hover:bg-red-600",children:"Submit Report"})]})]})}),Be&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex items-center justify-center",onClick:()=>Ve(null),children:a.jsx("img",{src:Be.url,className:"max-w-full max-h-full object-contain"})})]})},_4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState(!0),[l,u]=w.useState("browse"),[d,h]=w.useState("All"),[p,m]=w.useState(""),[v,T]=w.useState([]),[j,I]=w.useState(!1),[y,_]=w.useState(!1),[b,A]=w.useState(null),[V,M]=w.useState(!1),[N,x]=w.useState({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),[E,S]=w.useState([]),[R,P]=w.useState([]),[C,he]=w.useState(null),Ie=["All","Food & Beverage","Digital Products","Fashion & Apparel","Electronics & Gadgets","Home & Garden","Handmade & Crafts","Vehicles & Parts","Sports","Books","Baby & Kids","Beauty & Health","Real Estate","Services"],Be=["Shop Pickup","Free Shipping","Collection Point","Local Delivery"],Ve=["No Return","7 Days Return","15 Days Return","30 Days Return"];w.useEffect(()=>{const O=Tt(_e,se=>{if(n(se),se){const we=Y(U,"users",se.uid),$=qe(we,te=>{te.exists()&&T(te.data().savedProducts||[])});return()=>$()}else T([])}),re=We(ie(U,"marketplace"),Xt("timestamp","desc")),Ae=qe(re,se=>{s(se.docs.map(we=>({id:we.id,...we.data()}))),o(!1)}),z=se=>{se.target.closest(".menu-trigger")||he(null)};return document.addEventListener("click",z),()=>{O(),Ae(),document.removeEventListener("click",z)}},[]);const G=()=>{x({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),S([]),P([]),_(!1),A(null)},ee=async O=>{var re;if(O.preventDefault(),!e)return alert("Sign in required.");if(E.length===0&&R.length===0)return alert("At least one photo/video required.");if(Number(N.price)<=0)return alert("Price must be greater than zero.");M(!0);try{const Ae=await Promise.all(E.map(async $=>{const te=Tn(Sn,`marketplace/${e.uid}/${Date.now()}_${$.name}`);return await En(te,$),{url:await kn(te),type:$.type.startsWith("video")?"video":"image"}})),se=[...R.map($=>typeof $=="string"?{url:$,type:"image"}:$),...Ae],we={...N,image:((re=se[0])==null?void 0:re.url)||null,media:se,price:Number(N.price),boost:null};y&&b?(await ue(Y(U,"marketplace",b.id),we),alert("Item Updated Successfully!")):(await Ge(ie(U,"marketplace"),{...we,sellerId:e.uid,sellerName:e.displayName,sellerAvatar:e.photoURL,timestamp:ke(),sold:!1,reviews:[],questions:[]}),alert("Item Listed Successfully!"),u("selling")),I(!1),G()}catch(Ae){console.error("Listing Error:",Ae),alert(`Failed to ${y?"update":"list"} item.`)}finally{M(!1)}},X=O=>{x({title:O.title,price:O.price.toString(),currency:O.currency||"BDT",condition:O.condition||"New",description:O.description,category:O.category,location:O.location||"Dhaka",address:O.address||"",stock:O.stock||1,shippingType:O.shippingType||"Shop Pickup",returnPolicy:O.returnPolicy||"No Return"});const re=Array.isArray(O.media)?O.media:O.image?[{url:O.image,type:"image"}]:[];P(re),S([]),A(O),_(!0),I(!0),he(null)},fe=async O=>{if(!(!e||!window.confirm(`Delete "${O.title}"? This cannot be undone.`)))try{await js(Y(U,"marketplace",O.id)),alert("Product deleted.")}catch(re){console.error(re),alert("Failed to delete.")}},ae=async O=>{await ue(Y(U,"marketplace",O.id),{sold:!O.sold}),he(null)},q=async(O,re)=>{if(O.stopPropagation(),!e)return alert("Sign in to save.");const z=v.includes(re.id)?hn(re.id):Et(re.id);await ue(Y(U,"users",e.uid),{savedProducts:z})},pe=(()=>{let O=r;if(l==="selling"){if(!e)return[];O=O.filter(re=>re.sellerId===e.uid)}else O=O.filter(re=>(d==="All"||re.category===d)&&re.title.toLowerCase().includes(p.toLowerCase()));return O})();return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-8 gap-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-black text-dark tracking-tight flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-store text-primary"})," Marketplace"]}),a.jsx("p",{className:"text-gray-500 font-medium",children:"Buy & Sell everything from Fresh Food to Luxury Cars."})]}),a.jsxs("div",{className:"flex gap-3 flex-wrap",children:[a.jsxs("button",{onClick:()=>t("/business"),className:"bg-white border border-gray-200 text-dark px-5 py-3 rounded-xl font-bold hover:bg-gray-50 transition-all shadow-sm text-sm",children:[a.jsx("i",{className:"fas fa-briefcase mr-2"})," Business Hub"]}),a.jsxs("button",{onClick:()=>t("/saved-items"),className:"bg-white border border-gray-200 text-dark px-5 py-3 rounded-xl font-bold hover:bg-gray-50 transition-all shadow-sm text-sm",children:[a.jsx("i",{className:"far fa-heart mr-2"})," Saved"]}),a.jsxs("button",{onClick:()=>u(l==="selling"?"browse":"selling"),className:`px-5 py-3 rounded-xl font-bold transition-all shadow-sm text-sm flex items-center gap-2 ${l==="selling"?"bg-dark text-white":"bg-white border border-gray-200 text-dark hover:bg-gray-50"}`,children:[a.jsx("i",{className:"fas fa-box-open"})," ",l==="selling"?"Browse Market":"My Listings"]}),a.jsxs("button",{onClick:()=>{G(),I(!0)},className:"bg-gradient-to-r from-primary to-primary-dark text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-primary/30 transition-all text-sm",children:[a.jsx("i",{className:"fas fa-plus mr-2"})," Sell Item"]})]})]}),a.jsx("hr",{className:"mb-6 border-gray-200"}),l==="browse"&&a.jsxs("div",{className:"mb-6 flex gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("i",{className:"fas fa-search absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search items...",className:"w-full bg-white border-none rounded-xl pl-10 pr-4 py-3 shadow-sm focus:ring-2 focus:ring-primary/20",value:p,onChange:O=>m(O.target.value)})]}),a.jsx("select",{value:d,onChange:O=>h(O.target.value),className:"bg-white font-bold text-dark px-4 py-3 rounded-xl shadow-sm outline-none appearance-none border-r-8 border-transparent cursor-pointer",children:Ie.map(O=>a.jsx("option",{value:O,children:O},O))})]}),l==="selling"&&a.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-bold text-dark",children:"Your Active Listings"}),a.jsxs("span",{className:"bg-primary/10 text-primary px-3 py-1 rounded-full text-xs font-bold",children:[pe.length," Items"]})]}),i?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading Market..."}):a.jsx(a.Fragment,{children:pe.length===0?a.jsxs("div",{className:"text-center py-20 bg-white rounded-[30px] border border-dashed border-gray-200",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-400 text-2xl",children:a.jsx("i",{className:`fas ${l==="selling"?"fa-box-open":"fa-search"}`})}),a.jsx("h3",{className:"font-bold text-gray-500 text-lg",children:l==="selling"?"You haven't listed anything yet.":"No items found."}),l==="selling"&&a.jsx("button",{onClick:()=>{G(),I(!0)},className:"mt-4 text-primary font-bold hover:underline",children:"Start Selling Now"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:pe.map(O=>{var z,se;const re=e&&e.uid===O.sellerId,Ae=v.includes(O.id);return a.jsxs("div",{className:"bg-white rounded-[24px] shadow-sm hover:shadow-xl transition-all relative group p-3 border border-gray-50",children:[a.jsxs("div",{onClick:()=>t(`/product/${O.id}`),className:"cursor-pointer",children:[a.jsxs("div",{className:"h-56 rounded-xl overflow-hidden relative mb-3",children:[((se=(z=O.media)==null?void 0:z[0])==null?void 0:se.type)==="video"?a.jsx("video",{src:O.media[0].url,className:"w-full h-full object-cover"}):a.jsx("img",{src:O.image,alt:O.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),O.sold&&a.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:a.jsx("span",{className:"text-white text-3xl font-black rotate-[-15deg] border-4 border-white px-4 py-2 rounded-lg",children:"SOLD"})}),O.boost&&a.jsx("span",{className:"absolute top-3 left-3 bg-gradient-to-r from-gold to-yellow-400 text-white text-[10px] font-black px-2 py-1 rounded uppercase tracking-wider shadow-sm",children:"Sponsored"}),a.jsxs("span",{className:"absolute bottom-3 right-3 bg-white/90 backdrop-blur-md text-dark font-black px-3 py-1 rounded-lg shadow-sm",children:[O.currency==="BDT"?"":O.currency," ",Number(O.price).toLocaleString()]})]}),a.jsx("h3",{className:"font-bold text-dark text-lg leading-tight line-clamp-1 mb-1",children:O.title}),a.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-400 mb-3",children:[a.jsxs("span",{className:"flex items-center gap-1 font-medium",children:[a.jsx("i",{className:"fas fa-map-marker-alt"})," ",O.location]}),a.jsxs("span",{className:"flex items-center gap-1 font-medium text-primary",children:[a.jsx("i",{className:"fas fa-truck"})," ",O.shippingType||"N/A"]})]}),a.jsxs("div",{className:"flex items-center gap-2 text-xs font-bold text-gray-600 pt-3 border-t border-gray-50",children:[O.sellerAvatar&&a.jsx("img",{src:O.sellerAvatar,alt:O.sellerName,className:"w-6 h-6 rounded-full object-cover"}),O.sellerName]})]}),a.jsx("div",{className:"absolute top-4 right-4 z-20",children:re?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:we=>{we.stopPropagation(),he(C===O.id?null:O.id)},className:"menu-trigger w-8 h-8 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center text-gray-500 hover:text-dark transition-all shadow-md",children:a.jsx("i",{className:"fas fa-ellipsis-v text-xs"})}),C===O.id&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl border border-gray-100 py-1 text-sm font-medium z-30 animate-fade-in",children:[a.jsxs("button",{onClick:we=>{we.stopPropagation(),X(O)},className:"flex items-center gap-2 w-full px-4 py-3 text-dark hover:bg-gray-50",children:[a.jsx("i",{className:"fas fa-edit text-blue-500 w-4"})," Edit Product"]}),a.jsxs("button",{onClick:we=>{we.stopPropagation(),ae(O)},className:"flex items-center gap-2 w-full px-4 py-3 text-dark hover:bg-gray-50",children:[a.jsx("i",{className:`fas ${O.sold?"fa-check-circle text-green-500":"fa-times-circle text-gray-500"} w-4`})," ",O.sold?"Mark Available":"Mark Sold"]}),a.jsxs("button",{onClick:we=>{we.stopPropagation(),fe(O)},className:"flex items-center gap-2 w-full px-4 py-3 text-red-600 hover:bg-red-50",children:[a.jsx("i",{className:"fas fa-trash-alt w-4"})," Delete Product"]})]})]}):a.jsx("button",{onClick:we=>q(we,O),className:"w-8 h-8 bg-white/80 backdrop-blur-md rounded-full flex items-center justify-center transition-all shadow-sm",children:a.jsx("i",{className:`${Ae?"fas text-red-500":"far text-gray-500 hover:text-red-500"} fa-heart`})})})]},O.id)})})}),j&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:y?"Edit Listing":"Sell Item"}),a.jsx("button",{onClick:()=>{I(!1),G()},children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark text-xl"})})]}),a.jsxs("form",{onSubmit:ee,className:"p-6 space-y-4",children:[a.jsx("input",{required:!0,className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"Product Title",value:N.title,onChange:O=>x({...N,title:O.target.value})}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"Product Address / Pickup Point",value:N.address,onChange:O=>x({...N,address:O.target.value})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{className:"bg-gray-50 rounded-xl px-2 font-bold text-sm",value:N.currency,onChange:O=>x({...N,currency:O.target.value}),children:[a.jsx("option",{value:"BDT",children:"BDT "}),a.jsx("option",{value:"USD",children:"USD $"}),a.jsx("option",{value:"EUR",children:"EUR "})]}),a.jsx("input",{required:!0,type:"number",min:"0",step:"0.01",className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"Price",value:N.price,onChange:O=>x({...N,price:O.target.value})})]}),a.jsx("input",{className:"bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"City/Area",value:N.location,onChange:O=>x({...N,location:O.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:N.category,onChange:O=>x({...N,category:O.target.value}),children:Ie.slice(1).map(O=>a.jsx("option",{value:O,children:O},O))}),a.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:N.condition,onChange:O=>x({...N,condition:O.target.value}),children:[a.jsx("option",{children:"New"}),a.jsx("option",{children:"Used"}),a.jsx("option",{children:"Refurbished"}),a.jsx("option",{children:"Fresh"}),a.jsx("option",{children:"Frozen"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:N.shippingType,onChange:O=>x({...N,shippingType:O.target.value}),children:Be.map(O=>a.jsx("option",{value:O,children:O},O))}),a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:N.returnPolicy,onChange:O=>x({...N,returnPolicy:O.target.value}),children:Ve.map(O=>a.jsx("option",{value:O,children:O},O))})]}),a.jsx("textarea",{required:!0,rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl text-sm",placeholder:"Detailed product description...",value:N.description,onChange:O=>x({...N,description:O.target.value})}),a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center hover:bg-gray-50 transition-colors cursor-pointer",children:[a.jsxs("label",{className:"cursor-pointer block",children:[a.jsx("i",{className:"fas fa-cloud-upload-alt text-3xl text-gray-300 mb-2"}),a.jsx("p",{className:"text-sm font-bold text-gray-500",children:"Select Photos & Videos (Max 5)"}),a.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",className:"hidden",onChange:O=>{const re=Array.from(O.target.files).slice(0,5-R.length-E.length);S(Ae=>[...Ae,...re])}})]}),a.jsxs("div",{className:"flex gap-2 overflow-x-auto mt-4 pb-2",children:[R.map((O,re)=>a.jsxs("div",{className:"w-16 h-16 flex-shrink-0 relative rounded-lg overflow-hidden border shadow-sm",children:[O.type==="video"?a.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center text-white",children:a.jsx("i",{className:"fas fa-video"})}):a.jsx("img",{src:O.url,className:"w-full h-full object-cover",alt:"preview"}),a.jsx("button",{type:"button",onClick:()=>P(R.filter((Ae,z)=>z!==re)),className:"absolute top-0 right-0 bg-red-500 text-white w-4 h-4 text-[10px] flex items-center justify-center rounded-full",children:a.jsx("i",{className:"fas fa-times"})})]},"ex"+re)),E.map((O,re)=>a.jsxs("div",{className:"w-16 h-16 flex-shrink-0 relative rounded-lg overflow-hidden border shadow-sm",children:[a.jsxs("div",{className:"w-full h-full bg-gray-100 flex flex-col items-center justify-center text-[8px] text-gray-600 break-all p-1",children:[a.jsx("i",{className:`fas ${O.type.startsWith("video")?"fa-video":"fa-image"} text-sm mb-1 text-primary`}),O.name.slice(0,10)+"..."]}),a.jsx("button",{type:"button",onClick:()=>S(E.filter((Ae,z)=>z!==re)),className:"absolute top-0 right-0 bg-red-500 text-white w-4 h-4 text-[10px] flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]},"new"+re))]})]}),a.jsx("button",{type:"submit",disabled:V,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg",children:V?`${y?"Updating":"Listing"}...`:y?"Save Changes":"Publish Listing"})]})]})})]})},b4=()=>{var fe,ae;const{id:t}=tl(),e=at(),[n,r]=w.useState(null),[s,i]=w.useState(null),[o,l]=w.useState(!0),[u,d]=w.useState(null),[h,p]=w.useState("details"),[m,v]=w.useState(!1),[T,j]=w.useState([]),[I,y]=w.useState(""),[_,b]=w.useState(5),[A,V]=w.useState(0),[M,N]=w.useState(""),[x,E]=w.useState(""),[S,R]=w.useState(null),P=async(q,oe)=>{try{const pe=We(ie(U,"marketplace"),ct("category","==",q),ct("id","!=",oe),Is(5)),re=(await Dn(pe)).docs.map(Ae=>({id:Ae.id,...Ae.data()})).filter(Ae=>Ae.id!==oe).slice(0,4);j(re)}catch(pe){console.error("Error fetching recommendations:",pe)}};w.useEffect(()=>{l(!0),d(null);const q=Tt(_e,async pe=>{if(i(pe),pe)try{const O=await _n(Y(U,"users",pe.uid));if(O.exists()){const re=O.data().savedProducts||[];v(re.includes(t))}}catch(O){console.error("Error checking saved status:",O)}else v(!1)});return(async()=>{const pe=Y(U,"marketplace",t);try{const O=await _n(pe);if(O.exists()){const re=O.data();r({id:O.id,...re}),P(re.category,O.id)}else d("Product not found.")}catch(O){console.error("Error fetching product:",O),d("Failed to load product details.")}finally{l(!1)}})(),()=>q()},[t]);const C=async(q,oe)=>{if(!n||!s)return;let pe=n.sellerId;if(n.isBusiness)try{const O=await _n(Y(U,"business_pages",n.sellerId));O.exists()&&O.data().ownerId&&(pe=O.data().ownerId)}catch(O){console.error("Failed to find business owner for notification:",O)}if(pe!==s.uid)try{await Ge(ie(U,"notifications"),{recipientId:pe,senderId:s.uid,senderName:s.displayName,senderAvatar:s.photoURL,type:q,targetId:n.id,message:oe,timestamp:ke(),isRead:!1})}catch(O){console.error("Notification creation failed:",O)}},he=()=>{if(!s)return alert("Sign in required to message the seller.");e("/messages",{state:{startChatWith:{uid:n.sellerId,displayName:n.sellerName,photoURL:n.sellerAvatar},productContext:{id:n.id,title:n.title,image:n.image}}})},Ie=async()=>{if(!s)return alert("Sign in required to save products.");const q=Y(U,"users",s.uid);try{m?(await ue(q,{savedProducts:hn(n.id)}),v(!1)):(await ue(q,{savedProducts:Et(n.id)}),v(!0))}catch(oe){console.error("Failed to update saved status:",oe),alert("Could not update saved status. Please try again.")}},Be=async()=>{if(!s)return alert("Sign in is required to report a product.");try{await Ge(ie(U,"reports"),{targetId:n.id,type:"product",reporter:s.uid,timestamp:ke()}),alert("Thank you. The product has been successfully reported for review.")}catch(q){console.error("Failed to submit report:",q),alert("Failed to submit report. Please try again.")}},Ve=async()=>{if(!I||!s)return;const q={uid:s.uid,name:s.displayName||"Anonymous User",avatar:s.photoURL,text:I,rating:_,date:new Date().toISOString()};try{await ue(Y(U,"marketplace",t),{reviews:Et(q)}),r(oe=>({...oe,reviews:[...oe.reviews||[],q]})),await C("review",`reviewed your product "${n.title}"`),y(""),b(5)}catch(oe){console.error("Review submission error:",oe),alert("Failed to post review. Please try again.")}},G=async()=>{if(!M||!s)return;const q={id:Date.now(),uid:s.uid,name:s.displayName||"Anonymous User",text:M,date:new Date().toISOString(),answer:null};try{await ue(Y(U,"marketplace",t),{questions:Et(q)}),r(oe=>({...oe,questions:[...oe.questions||[],q]})),await C("question",`asked a question on "${n.title}"`),N("")}catch(oe){console.error("Question submission error:",oe),alert("Failed to post question. Please try again.")}},ee=async q=>{if(!(!x.trim()||!s))try{const oe=Y(U,"marketplace",t),pe=await _n(oe);if(!pe.exists())return;const re=(pe.data().questions||[]).find(z=>z.id===q.id);if(!re){console.error("Target question not found in current document.");return}await ue(oe,{questions:hn(re)});const Ae={...re,answer:x,answerDate:new Date().toISOString(),answererId:s.uid};await ue(oe,{questions:Et(Ae)}),r(z=>({...z,questions:z.questions.map(se=>se.id===re.id?Ae:se)})),await C("answer",`answered a question on your product "${n.title}"`),E(""),R(null)}catch(oe){console.error("Reply submission error:",oe),alert("Failed to submit reply. Please try again.")}};if(o)return a.jsx("div",{className:"p-20 text-center text-xl font-bold text-primary",children:"Loading Product Details..."});if(u)return a.jsxs("div",{className:"p-20 text-center text-xl font-bold text-red-600",children:[" ",u]});if(!n)return a.jsx("div",{className:"p-20 text-center text-xl font-bold text-gray-500",children:"Product data unavailable."});const X=s&&s.uid===n.sellerId;return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("button",{onClick:()=>e("/marketplace"),className:"mb-4 text-gray-500 font-bold flex items-center gap-2 transition hover:text-dark",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back"]}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-2xl overflow-hidden flex flex-col lg:flex-row",children:[a.jsx("div",{className:"lg:w-1/2 bg-gray-50 p-6 flex items-center justify-center",children:a.jsx("img",{src:n.image,className:"w-full h-96 object-contain rounded-xl shadow-lg",alt:n.title})}),a.jsxs("div",{className:"lg:w-1/2 p-8 flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsx("h1",{className:"text-3xl font-black text-dark",children:n.title}),a.jsxs("h2",{className:"text-3xl font-black text-primary ml-4",children:[n.currency==="BDT"?"":n.currency," ",n.price]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 font-bold mb-6",children:[a.jsxs("span",{className:"bg-gray-100 px-3 py-1 rounded-lg",children:[a.jsx("i",{className:"fas fa-map-marker-alt mr-1"})," ",n.location]}),a.jsxs("span",{className:"bg-gray-100 px-3 py-1 rounded-lg",children:[a.jsx("i",{className:"fas fa-box mr-1"})," Stock: ",n.stock]}),a.jsxs("span",{className:`px-3 py-1 rounded-lg ${n.returnPolicy==="No Return"?"bg-red-50 text-red-500":"bg-green-50 text-green-600"}`,children:[a.jsx("i",{className:"fas fa-undo mr-1"})," ",n.returnPolicy||"N/A"]}),n.condition&&a.jsxs("span",{className:"bg-blue-50 text-blue-600 px-3 py-1 rounded-lg",children:[a.jsx("i",{className:"fas fa-tag mr-1"})," ",n.condition]})]}),a.jsx("div",{className:"flex border-b border-gray-100 mb-6",children:["details","reviews","qa"].map(q=>a.jsx("button",{onClick:()=>p(q),className:`px-6 py-3 font-bold capitalize transition-colors ${h===q?"border-b-2 border-primary text-primary":"text-gray-400 hover:text-dark"}`,children:q==="qa"?"Q&A":q},q))}),a.jsxs("div",{className:"flex-1 overflow-y-auto max-h-60 mb-6 pr-2 custom-scrollbar",children:[h==="details"&&a.jsx("div",{className:"text-gray-600 whitespace-pre-wrap text-sm leading-relaxed",children:n.description}),h==="reviews"&&a.jsxs("div",{className:"space-y-4",children:[((fe=n.reviews)==null?void 0:fe.length)>0?n.reviews.map((q,oe)=>a.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl text-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("span",{className:"font-bold text-dark",children:q.name}),a.jsxs("span",{className:"text-gold flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-star text-yellow-500"})," ",q.rating]})]}),a.jsx("p",{className:"text-gray-600",children:q.text})]},oe)):a.jsx("div",{className:"text-gray-400 text-center p-4 border border-dashed rounded-lg",children:"Be the first to leave a review!"}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("textarea",{placeholder:s?"Write a review...":"Sign in to write a review.",className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-2 outline-none border border-gray-200 focus:ring-2 focus:ring-primary/50",value:I,onChange:q=>y(q.target.value),disabled:!s}),s?a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("div",{className:"flex gap-1",onMouseLeave:()=>V(0),children:[1,2,3,4,5].map(q=>a.jsx("button",{type:"button","aria-label":`Set rating to ${q} stars`,className:"text-2xl transition-transform hover:scale-125 focus:outline-none",onClick:()=>b(q),onMouseEnter:()=>V(q),children:a.jsx("i",{className:`fas fa-star ${q<=(A||_)?"text-yellow-500":"text-gray-300"}`})},q))}),a.jsx("button",{onClick:Ve,disabled:!I,className:"bg-dark text-white px-6 py-2 rounded-xl text-xs font-bold hover:bg-primary transition-colors disabled:opacity-50",children:"Post Review"})]}):a.jsx("p",{className:"text-red-500 text-sm font-bold",children:"Sign in to review."})]})]}),h==="qa"&&a.jsxs("div",{className:"space-y-4",children:[((ae=n.questions)==null?void 0:ae.length)>0?n.questions.map((q,oe)=>a.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl text-sm border border-gray-100",children:[a.jsxs("p",{className:"font-bold text-dark",children:["Q: ",q.text]}),q.answer?a.jsxs("p",{className:"text-primary mt-1 pl-2 border-l-2 border-primary",children:["A: ",q.answer]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xs text-gray-400 italic mt-1",children:"Waiting for seller response..."}),X&&(S==null?void 0:S.id)!==q.id&&a.jsx("button",{onClick:()=>R(q),className:"text-xs text-blue-500 font-bold mt-1 hover:underline",children:"Reply"})]}),X&&(S==null?void 0:S.id)===q.id&&a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx("input",{value:x,onChange:pe=>E(pe.target.value),placeholder:"Type your answer...",className:"flex-1 bg-white border px-2 py-1 rounded text-xs focus:ring-primary/50 focus:border-primary"}),a.jsx("button",{onClick:()=>ee(q),disabled:!x.trim(),className:"bg-primary text-white px-3 py-1 rounded text-xs font-bold hover:bg-primary/90 disabled:opacity-50",children:"Send"}),a.jsx("button",{onClick:()=>R(null),className:"bg-gray-300 text-dark px-3 py-1 rounded text-xs font-bold hover:bg-gray-400",children:"Cancel"})]})]},oe)):a.jsx("div",{className:"text-gray-400 text-center p-4 border border-dashed rounded-lg",children:"No questions asked yet. Be the first!"}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("input",{placeholder:s?"Ask a question...":"Sign in to ask a question.",className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-2 outline-none border border-gray-200 focus:ring-2 focus:ring-primary/50",value:M,onChange:q=>N(q.target.value),disabled:!s}),s?a.jsx("button",{onClick:G,disabled:!M,className:"bg-dark text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-primary transition-colors disabled:opacity-50",children:"Ask"}):a.jsx("p",{className:"text-red-500 text-sm font-bold",children:"Sign in to ask."})]})]})]}),a.jsxs("div",{className:"bg-[#F8FAFD] p-4 rounded-2xl flex items-center justify-between mb-8 border border-gray-100 shadow-inner",children:[a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer transition hover:opacity-80",onClick:()=>{n.isBusiness?e(`/business/${n.sellerId}`):e(`/profile/${n.sellerId}`)},children:[n.sellerAvatar&&!n.sellerAvatar.includes("via.placeholder")&&a.jsx("img",{src:n.sellerAvatar,className:"w-12 h-12 rounded-full object-cover border border-gray-200",alt:`${n.sellerName}'s avatar`}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase",children:"Sold by"}),a.jsxs("h4",{className:"font-bold text-dark",children:[n.sellerName," ",n.isBusiness&&a.jsx("i",{className:"fas fa-certificate text-blue-500 text-xs ml-1",title:"Verified Business"})]})]})]}),a.jsxs("button",{onClick:Be,className:"text-gray-400 hover:text-red-500 text-sm transition-colors",children:[a.jsx("i",{className:"fas fa-flag mr-1"})," Report"]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("button",{onClick:he,className:"flex-1 bg-dark text-white py-4 rounded-xl font-bold hover:bg-primary transition-all shadow-lg flex items-center justify-center gap-2",children:[a.jsx("i",{className:"fas fa-comment-alt"})," Message Seller"]}),a.jsxs("button",{onClick:Ie,className:`px-6 py-4 border-2 rounded-xl font-bold transition-all flex items-center gap-2 ${m?"bg-primary border-primary text-white shadow-lg shadow-primary/30":"border-gray-200 text-gray-500 hover:border-primary hover:text-primary"}`,children:[a.jsx("i",{className:`${m?"fas":"far"} fa-heart`})," ",m?"Saved":"Save"]})]})]})]}),a.jsxs("div",{className:"mt-12 border-t pt-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-dark mb-6",children:["More from ",n.category]}),T.length>0?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:T.map(q=>a.jsxs("div",{onClick:()=>e(`/product/${q.id}`),className:"bg-white border border-gray-100 p-3 rounded-xl cursor-pointer transition-shadow hover:shadow-lg",children:[a.jsx("img",{src:q.image,className:"w-full h-32 object-cover rounded-lg mb-2",alt:q.title}),a.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:q.title}),a.jsxs("p",{className:"text-primary font-bold text-xs",children:[q.currency==="BDT"?"":q.currency," ",q.price]})]},q.id))}):a.jsx("div",{className:"text-gray-400 p-6 border border-dashed border-gray-300 rounded-xl text-center",children:a.jsx("p",{children:"No other products found in this category."})})]})]})},N4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState(!1),[l,u]=w.useState(!1),[d,h]=w.useState(null),[p,m]=w.useState(null),[v,T]=w.useState({name:"",category:"Retail & E-commerce",description:"",email:"",phone:"",website:"",address:""}),j=["Retail & E-commerce","Technology & Software","Professional Services","Food & Beverage","Health & Wellness","Education & Training","Real Estate & Construction","Arts & Entertainment","Automotive","Travel & Hospitality","Manufacturing & Industrial","Fashion & Lifestyle","Legal & Finance","Agriculture","Non-Profit"];w.useEffect(()=>{const y=Tt(_e,_=>{if(_){n(_);const b=We(ie(U,"business_pages"),ct("teamIds","array-contains",_.uid)),A=qe(b,V=>{s(V.docs.map(M=>({id:M.id,...M.data()})))});return()=>A()}else n(null),s([])});return()=>y()},[]);const I=async y=>{if(y.preventDefault(),!e)return alert("Sign in required.");if(!v.name||!d)return alert("Name and Logo are required.");o(!0);try{let _=null,b=null;if(d){const M=Tn(Sn,`business/${e.uid}/${Date.now()}_logo`);await En(M,d),_=await kn(M)}if(p){const M=Tn(Sn,`business/${e.uid}/${Date.now()}_cover`);await En(M,p),b=await kn(M)}const A={...v,ownerId:e.uid,teamIds:[e.uid],team:[{uid:e.uid,name:e.displayName,role:"Admin",avatar:e.photoURL}],logo:_,coverImage:b||"https://images.unsplash.com/photo-1497366216548-37526070297c",isVerified:!1,followers:0,rating:0,createdAt:ke()},V=await Ge(ie(U,"business_pages"),A);u(!1),t(`/business/${V.id}`)}catch(_){console.error(_),alert("Failed to create page.")}finally{o(!1)}};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm min-h-[80vh] overflow-hidden",children:[a.jsxs("div",{className:"h-60 bg-gradient-to-r from-dark to-gray-900 flex items-center justify-between p-10 text-white relative overflow-hidden",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsx("h1",{className:"text-4xl font-black mb-2",children:"Business Hub"}),a.jsx("p",{className:"text-white/70",children:"Manage your empire."})]}),a.jsxs("button",{onClick:()=>u(!0),className:"relative z-10 bg-primary hover:bg-primary-light text-white px-6 py-3 rounded-xl font-bold shadow-lg flex items-center gap-2 transition-all",children:[a.jsx("i",{className:"fas fa-plus-circle"})," Create Page"]})]}),a.jsxs("div",{className:"p-8",children:[a.jsx("h3",{className:"text-xl font-bold text-dark mb-6",children:"Your Businesses"}),r.length===0?a.jsxs("div",{className:"text-center py-20 border-2 border-dashed border-gray-200 rounded-3xl",children:[a.jsx("i",{className:"fas fa-briefcase text-4xl text-gray-300 mb-4"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"You haven't created any business pages yet."}),a.jsx("button",{onClick:()=>u(!0),className:"text-primary font-bold",children:"Create one now"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(y=>a.jsxs("div",{onClick:()=>t(`/business/${y.id}`),className:"bg-white border border-gray-100 rounded-[24px] overflow-hidden shadow-sm hover:shadow-xl transition-all group cursor-pointer",children:[a.jsxs("div",{className:"h-24 bg-gray-200 relative",children:[a.jsx("img",{src:y.coverImage,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute -bottom-8 left-6 w-16 h-16 rounded-xl bg-white p-1 shadow-md",children:a.jsx("img",{src:y.logo,className:"w-full h-full rounded-lg object-cover"})})]}),a.jsxs("div",{className:"pt-10 p-6",children:[a.jsxs("h3",{className:"font-bold text-dark text-lg mb-1 flex items-center gap-2",children:[y.name," ",y.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase mb-4",children:y.category}),a.jsx("button",{className:"w-full bg-gray-50 text-dark font-bold py-2 rounded-lg hover:bg-dark hover:text-white transition-colors text-sm",children:"Manage Page"})]})]},y.id))})]})]}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Create Business Page"}),a.jsx("button",{onClick:()=>u(!1),children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),a.jsxs("form",{onSubmit:I,className:"p-6 space-y-6 overflow-y-auto",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Business Name"}),a.jsx("input",{required:!0,className:"w-full bg-gray-50 p-3 rounded-xl font-bold outline-none",value:v.name,onChange:y=>T({...v,name:y.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Category"}),a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:v.category,onChange:y=>T({...v,category:y.target.value}),children:j.map(y=>a.jsx("option",{value:y,children:y},y))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Description"}),a.jsx("textarea",{required:!0,rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:v.description,onChange:y=>T({...v,description:y.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Email"}),a.jsx("input",{type:"email",className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:v.email,onChange:y=>T({...v,email:y.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Website"}),a.jsx("input",{type:"url",className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:v.website,onChange:y=>T({...v,website:y.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Logo"}),a.jsx("input",{type:"file",required:!0,accept:"image/*",onChange:y=>h(y.target.files[0])})]}),a.jsx("button",{type:"submit",disabled:i,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all",children:i?"Creating...":"Launch Page"})]})]})})]})},E4=({target:t,onClose:e,onBoost:n})=>{const[r,s]=w.useState(1),[i,o]=w.useState("engagement"),[l,u]=w.useState({gender:"All",ageRange:[18,65],location:""}),[d,h]=w.useState(500),[p,m]=w.useState(3),[v,T]=w.useState("card"),j=d*p,I=()=>{const y={targetId:t.id,targetType:t.type,goal:i,audience:l,budget:d,duration:p,totalCost:j,paymentMethod:v,status:"active",startDate:new Date().toISOString()};n(y)};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-black text-xl text-dark flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-rocket text-gold"})," Promote ",t.type==="page"?"Business":"Product"]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:t.name})]}),a.jsx("button",{onClick:e,children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark text-xl"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[a.jsxs("section",{children:[a.jsx("h4",{className:"text-sm font-black text-dark uppercase tracking-wider mb-4",children:"1. What is your Goal?"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[{id:"engagement",icon:"fa-heart",label:"More Engagement",desc:"Get likes & comments"},{id:"messages",icon:"fa-comment-dots",label:"More Messages",desc:"Get leads in inbox"},{id:"traffic",icon:"fa-globe",label:"Website Traffic",desc:"Drive clicks to link"}].map(y=>a.jsxs("div",{onClick:()=>o(y.id),className:`p-4 rounded-2xl border-2 cursor-pointer transition-all ${i===y.id?"border-primary bg-primary/5":"border-gray-100 hover:border-primary/30"}`,children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center mb-3 ${i===y.id?"bg-primary text-white":"bg-gray-100 text-gray-400"}`,children:a.jsx("i",{className:`fas ${y.icon}`})}),a.jsx("h5",{className:"font-bold text-dark",children:y.label}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:y.desc})]},y.id))})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-sm font-black text-dark uppercase tracking-wider mb-4",children:"2. Target Audience"}),a.jsxs("div",{className:"bg-gray-50 p-5 rounded-2xl space-y-4 border border-gray-100",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 mb-2 block",children:"Gender"}),a.jsx("div",{className:"flex bg-white rounded-xl p-1 border border-gray-200 w-fit",children:["All","Men","Women"].map(y=>a.jsx("button",{onClick:()=>u({...l,gender:y}),className:`px-4 py-2 rounded-lg text-sm font-bold transition-all ${l.gender===y?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:y},y))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 mb-2 block flex justify-between",children:[a.jsx("span",{children:"Age Range"}),a.jsxs("span",{className:"text-primary",children:[l.ageRange[0]," - ",l.ageRange[1],"+"]})]}),a.jsx("input",{type:"range",min:"13",max:"65",value:l.ageRange[1],onChange:y=>u({...l,ageRange:[l.ageRange[0],parseInt(y.target.value)]}),className:"w-full accent-primary"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 mb-2 block",children:"Location"}),a.jsxs("div",{className:"flex items-center gap-2 bg-white border border-gray-200 rounded-xl px-3 py-2",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-primary"}),a.jsx("input",{type:"text",placeholder:"e.g. Dhaka, Gulshan, Banani",value:l.location,onChange:y=>u({...l,location:y.target.value}),className:"w-full outline-none text-sm font-bold"})]})]})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-sm font-black text-dark uppercase tracking-wider mb-4",children:"3. Budget & Duration"}),a.jsxs("div",{className:"bg-white border border-gray-200 rounded-2xl p-5 shadow-sm",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("div",{children:[a.jsxs("span",{className:"text-3xl font-black text-dark",children:["",j.toLocaleString()]}),a.jsx("p",{className:"text-xs text-gray-400 font-bold",children:"Total Spend"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"text-xl font-black text-primary",children:[p," Days"]}),a.jsx("p",{className:"text-xs text-gray-400 font-bold",children:"Duration"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-xs font-bold mb-1",children:[a.jsx("span",{children:"Daily Budget"}),a.jsxs("span",{children:["",d]})]}),a.jsx("input",{type:"range",min:"100",max:"10000",step:"100",value:d,onChange:y=>h(parseInt(y.target.value)),className:"w-full accent-green-500"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-xs font-bold mb-1",children:[a.jsx("span",{children:"Duration"}),a.jsxs("span",{children:[p," Days"]})]}),a.jsx("input",{type:"range",min:"1",max:"30",value:p,onChange:y=>m(parseInt(y.target.value)),className:"w-full accent-blue-500"})]})]})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-sm font-black text-dark uppercase tracking-wider mb-4",children:"4. Payment Method"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsxs("button",{onClick:()=>T("card"),className:`flex-1 p-3 rounded-xl border flex items-center justify-center gap-2 font-bold ${v==="card"?"border-primary bg-primary/5 text-primary":"border-gray-200"}`,children:[a.jsx("i",{className:"fas fa-credit-card"})," Card"]}),a.jsxs("button",{onClick:()=>T("bkash"),className:`flex-1 p-3 rounded-xl border flex items-center justify-center gap-2 font-bold ${v==="bkash"?"border-pink-500 bg-pink-50 text-pink-600":"border-gray-200"}`,children:[a.jsx("i",{className:"fas fa-mobile-alt"})," bKash"]})]})]})]}),a.jsx("div",{className:"p-4 border-t border-gray-100 bg-white",children:a.jsxs("button",{onClick:I,className:"w-full bg-gradient-to-r from-primary to-primary-dark text-white font-bold py-4 rounded-xl shadow-lg hover:shadow-primary/30 transition-all flex justify-center items-center gap-2",children:[a.jsx("span",{children:"Launch Promotion"}),a.jsx("i",{className:"fas fa-rocket"})]})})]})})},Ka=({src:t,name:e,size:n="md",className:r=""})=>{const s=e?e.split(" ").map(l=>l[0]).join("").substring(0,2).toUpperCase():"??",i={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-14 h-14 text-base",xl:"w-32 h-32 text-4xl"},o=t&&t.includes("via.placeholder.com");return t&&!o?a.jsx("img",{src:t,className:`${i[n]} rounded-full object-cover border border-gray-200 ${r}`,alt:e}):a.jsx("div",{className:`${i[n]} rounded-full bg-gradient-to-tr from-primary to-primary-light text-white flex items-center justify-center font-bold shadow-inner ${r}`,children:s})},k4=()=>{var Gr,vi,wi,nr;const{id:t}=tl(),e=at(),[n,r]=w.useState(null),[s,i]=w.useState(null),[o,l]=w.useState(!0),[u,d]=w.useState("products"),[h,p]=w.useState(null),[m,v]=w.useState([]),[T,j]=w.useState([]),[I,y]=w.useState([]),[_,b]=w.useState(0),[A,V]=w.useState("All"),[M,N]=w.useState(!1),[x,E]=w.useState(!1),[S,R]=w.useState(null),[P,C]=w.useState(!1),[he,Ie]=w.useState({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),[Be,Ve]=w.useState([]),[G,ee]=w.useState([]),[X,fe]=w.useState(!1),[ae,q]=w.useState({}),[oe,pe]=w.useState({logo:null,cover:null}),[O,re]=w.useState(!1),[Ae,z]=w.useState(""),[se,we]=w.useState([]),[$,te]=w.useState(null),[ge,Pe]=w.useState("Support"),[pt,gt]=w.useState(!1),[Bt,F]=w.useState(null),[ce,ye]=w.useState(null),De=["Food & Beverage","Digital Products","Fashion & Apparel","Electronics & Gadgets","Home & Garden","Handmade & Crafts","Vehicles & Parts","Sports","Books","Baby & Kids","Beauty & Health","Real Estate","Services"];w.useEffect(()=>{const D=Tt(_e,Ne=>{i(Ne),t&&Se(t,Ne)}),be=Ne=>{Ne.target.closest(".menu-trigger")||Ne.target.closest(".search-results")||ye(null)};return document.addEventListener("click",be),()=>{D(),document.removeEventListener("click",be)}},[t]);const Se=(D,be)=>{const Ne=qe(Y(U,"business_pages",D),Bn=>{var $n;if(Bn.exists()){const cn=Bn.data();if(r({id:Bn.id,...cn}),q(cn),be){const _i=($n=cn.team)==null?void 0:$n.find(rr=>rr.uid===be.uid);p(_i?_i.role:cn.ownerId===be.uid?"Admin":null)}l(!1)}}),Ke=We(ie(U,"marketplace"),ct("sellerId","==",D)),At=qe(Ke,Bn=>v(Bn.docs.map($n=>({id:$n.id,...$n.data()})))),Le=We(ie(U,"conversations"),ct("participants","array-contains",D)),Nl=qe(Le,Bn=>{const cn=Bn.docs.map(rr=>({id:rr.id,...rr.data()})).filter(rr=>rr.users.some(Kr=>Kr.uid!==D));j(cn);const _i=cn.reduce((rr,Kr)=>{var Ia;return rr+(((Ia=Kr.unreadCounts)==null?void 0:Ia[D])||0)},0);b(_i)}),Os=We(ie(U,"notifications"),ct("businessId","==",D),Xt("timestamp","desc")),Ms=qe(Os,Bn=>{y(Bn.docs.map($n=>({id:$n.id,...$n.data()})))});return()=>{Ne(),At(),Nl(),Ms()}},_t=async D=>{if(z(D),te(null),D.length<2){we([]);return}const be=We(ie(U,"users"),ct("displayName",">=",""),Is(50)),Ne=await Dn(be),Ke=D.toLowerCase(),At=Ne.docs.map(Le=>({uid:Le.id,...Le.data()})).filter(Le=>Le.displayName&&Le.displayName.toLowerCase().includes(Ke)||Le.handle&&Le.handle.toLowerCase().includes(Ke)||Le.email&&Le.email.toLowerCase().includes(Ke)).slice(0,5);we(At)},Rn=async()=>{var D;if($){if((D=n.team)!=null&&D.some(be=>be.uid===$.uid)||n.ownerId===$.uid)return alert("User is already a member or owner.");await Ge(ie(U,"notifications"),{recipientId:$.uid,senderId:s.uid,senderName:n.name,senderAvatar:n.logo,type:"team_invite",pageId:t,pageName:n.name,role:ge,timestamp:ke(),isRead:!1}),alert(`Invite sent to ${$.displayName||$.email}!`),te(null),z(""),we([])}},ht=async D=>{await ue(Y(U,"notifications",D.id),{isRead:!0}),D.targetId&&e(`/product/${D.targetId}`)},Rt=async()=>{var Ne;if(!s)return alert("Please sign in.");const D=Y(U,"business_pages",t);((Ne=n.followersList)==null?void 0:Ne.includes(s.uid))?await ue(D,{followers:(n.followers||1)-1,followersList:hn(s.uid)}):(await ue(D,{followers:(n.followers||0)+1,followersList:Et(s.uid)}),n.ownerId!==s.uid&&await Ge(ie(U,"notifications"),{recipientId:n.ownerId,senderId:s.uid,senderName:s.displayName,senderAvatar:s.photoURL,type:"follow_business",targetId:t,message:`started following your business ${n.name}`,timestamp:ke(),isRead:!1}))},yi=async D=>{try{await ue(Y(U,"marketplace",D.id),{sold:!D.sold}),ye(null)}catch(be){console.error(be)}},xl=async()=>{var D;if(Be.length===0&&G.length===0)return alert("Image required.");C(!0);try{const be=await Promise.all(Be.map(async At=>{const Le=Tn(Sn,`business/${t}/products/${Date.now()}_${At.name}`);return await En(Le,At),{url:await kn(Le),type:At.type.startsWith("video")?"video":"image"}})),Ne=[...G.map(At=>typeof At=="string"?{url:At,type:"image"}:At),...be],Ke={...he,price:Number(he.price),stock:Number(he.stock),media:Ne,image:(D=Ne[0])==null?void 0:D.url,sellerId:t,sellerName:n.name,sellerAvatar:n.logo,isBusiness:!0,timestamp:ke()};x?await ue(Y(U,"marketplace",S),Ke):await Ge(ie(U,"marketplace"),{...Ke,boost:null,reviews:[],questions:[],sold:!1}),N(!1)}catch{alert("Failed.")}finally{C(!1)}},vl=async D=>{confirm("Delete?")&&(await js(Y(U,"marketplace",D.id)),ye(null))},ud=async D=>{await ue(Y(U,D.targetType==="page"?"business_pages":"marketplace",D.targetId),{boost:{...D,expiresAt:ke()}}),alert("Boosted!"),gt(!1)},Ls=()=>{E(!1),Ie({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),Ve([]),ee([]),N(!0)},wl=D=>{E(!0),R(D.id),Ie({...D}),ee(Array.isArray(D.media)?D.media:D.image?[{url:D.image,type:"image"}]:[]),Ve([]),N(!0),ye(null)},_l=async()=>{re(!0);try{let D=n.logo,be=n.coverImage;if(oe.logo){const Ne=Tn(Sn,`business/${t}/logo_${Date.now()}`);await En(Ne,oe.logo),D=await kn(Ne)}if(oe.cover){const Ne=Tn(Sn,`business/${t}/cover_${Date.now()}`);await En(Ne,oe.cover),be=await kn(Ne)}await ue(Y(U,"business_pages",t),{...ae,logo:D,coverImage:be}),alert("Updated!"),fe(!1)}catch{alert("Error")}finally{re(!1)}},Ta=async D=>{confirm(`Remove ${D.name}?`)&&await ue(Y(U,"business_pages",t),{team:hn(D),teamIds:hn(D.uid)})};if(o)return a.jsx("div",{className:"p-20 text-center",children:"Loading..."});const bl=["Admin","Editor"].includes(h),Hr=h==="Admin",wr=!!h,Sa=s&&((Gr=n.followersList)==null?void 0:Gr.includes(s.uid)),xi=m.filter(D=>A==="All"||D.category===A);return a.jsxs("div",{className:"p-0 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"bg-white md:rounded-[30px] shadow-sm mb-6 relative group overflow-hidden",children:[a.jsxs("div",{className:"h-48 md:h-72 bg-gray-200 relative group",children:[a.jsx("img",{src:n.coverImage,className:"w-full h-full object-cover",alt:"Business cover"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),Hr&&a.jsxs("button",{onClick:()=>fe(!0),className:"absolute top-4 right-4 bg-white/20 backdrop-blur-md text-white px-4 py-2 rounded-full text-sm font-bold flex items-center gap-2 transition hover:bg-white/40",children:[a.jsx("i",{className:"fas fa-pen"})," Edit Page"]})]}),a.jsxs("div",{className:"px-6 md:px-10 pb-6 -mt-16 relative z-10 flex flex-col md:flex-row items-end gap-6",children:[a.jsx("div",{className:"w-32 h-32 bg-white rounded-2xl p-1 shadow-xl flex-shrink-0",children:a.jsx("img",{src:n.logo,className:"w-full h-full rounded-xl object-cover",alt:"Business logo"})}),a.jsxs("div",{className:"flex-1 text-center md:text-left mb-2",children:[a.jsx("h1",{className:"text-3xl font-black text-dark",children:n.name}),a.jsxs("p",{className:"text-gray-500 font-bold text-sm",children:[n.category," ",a.jsxs("span",{className:"text-primary mx-2",children:[n.followers||0," Followers"]})]})]}),a.jsx("div",{className:"flex gap-3 mb-2 justify-center w-full md:w-auto",children:wr?a.jsxs(a.Fragment,{children:[Hr&&a.jsxs("button",{onClick:()=>{F({id:t,type:"page",name:n.name}),gt(!0)},className:"bg-gold text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-yellow-600 transition",children:[a.jsx("i",{className:"fas fa-rocket mr-2"})," Boost"]}),a.jsxs("button",{onClick:()=>e("/messages",{state:{asBusiness:!0,businessId:t}}),className:"bg-dark text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-gray-700 transition",children:[a.jsx("i",{className:"fas fa-inbox mr-2"})," Inbox"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:Rt,className:`px-6 py-3 rounded-xl font-bold shadow-lg transition-all ${Sa?"bg-white text-dark border hover:bg-gray-50":"bg-primary text-white hover:bg-primary-dark"}`,children:Sa?"Following":"Follow Shop"}),a.jsx("button",{onClick:()=>e("/messages",{state:{startChatWith:{uid:n.id,displayName:n.name,photoURL:n.logo,isBusiness:!0}}}),className:"bg-gray-100 text-dark px-4 py-3 rounded-xl font-bold hover:bg-gray-200 transition",children:a.jsx("i",{className:"fas fa-comment-alt"})})]})})]}),a.jsxs("div",{className:"flex border-t border-gray-100 px-6 gap-8 overflow-x-auto no-scrollbar mt-4",children:[a.jsx("button",{onClick:()=>d("products"),className:`py-4 font-bold capitalize border-b-4 transition-all ${u==="products"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:"Products"}),wr&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>d("inbox"),className:`py-4 font-bold capitalize border-b-4 transition-all flex items-center gap-2 ${u==="inbox"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Inbox ",_>0&&a.jsx("span",{className:"bg-red-500 text-white text-[10px] px-2 py-0.5 rounded-full",children:_})]}),a.jsxs("button",{onClick:()=>d("notifications"),className:`py-4 font-bold capitalize border-b-4 flex items-center gap-2 ${u==="notifications"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Notifications ",I.length>0&&a.jsx("span",{className:"bg-orange-500 text-white text-[10px] px-2 py-0.5 rounded-full",children:I.length})]}),a.jsx("button",{onClick:()=>d("team"),className:`py-4 font-bold capitalize border-b-4 ${u==="team"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:"Team"}),Hr&&a.jsxs("button",{onClick:()=>d("growth"),className:`py-4 font-bold capitalize border-b-4 flex items-center gap-2 ${u==="growth"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:[a.jsx("i",{className:"fas fa-chart-line"})," Growth"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[u==="products"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-50",children:[a.jsx("h3",{className:"font-bold text-xl mb-2 text-dark",children:"About"}),a.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap",children:n.description})]}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[a.jsxs("h3",{className:"font-bold text-xl text-dark",children:["Inventory (",xi.length,")"]}),a.jsxs("div",{className:"flex gap-3 items-center",children:[a.jsxs("select",{value:A,onChange:D=>V(D.target.value),className:"bg-gray-100 p-3 rounded-xl font-bold text-sm border border-gray-200",children:[a.jsx("option",{value:"All",children:"All"}),De.map(D=>a.jsx("option",{value:D,children:D},D))]}),bl&&a.jsxs("button",{onClick:Ls,className:"bg-dark text-white px-4 py-3 rounded-xl font-bold text-sm flex items-center gap-1 hover:bg-primary transition",children:[a.jsx("i",{className:"fas fa-plus"})," Add"]})]})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:xi.map(D=>{var be,Ne;return a.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-sm border border-gray-100 relative group",children:[a.jsxs("div",{onClick:()=>e(`/product/${D.id}`),className:"cursor-pointer",children:[a.jsxs("div",{className:"relative rounded-xl overflow-hidden mb-3 aspect-square",children:[((Ne=(be=D.media)==null?void 0:be[0])==null?void 0:Ne.type)==="video"?a.jsx("video",{src:D.media[0].url,className:"w-full h-full object-cover"}):a.jsx("img",{src:D.image,className:"w-full h-full object-cover",alt:D.title}),D.sold&&a.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-white font-black text-lg",children:"SOLD OUT"})]}),a.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:D.title}),a.jsxs("p",{className:"text-primary font-black text-sm",children:[D.currency==="BDT"?"":D.currency," ",D.price]})]}),bl&&a.jsxs("div",{className:"absolute top-3 right-3",children:[a.jsx("button",{onClick:Ke=>{Ke.stopPropagation(),ye(ce===D.id?null:D.id)},className:"menu-trigger w-8 h-8 bg-white/90 rounded-full flex items-center justify-center shadow-sm text-dark hover:bg-white transition",children:a.jsx("i",{className:"fas fa-ellipsis-v"})}),ce===D.id&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl z-50 overflow-hidden p-1 border border-gray-100",children:[a.jsx("button",{onClick:()=>wl(D),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-gray-50 rounded-lg",children:"Edit"}),a.jsxs("button",{onClick:()=>yi(D),className:`w-full text-left px-3 py-2 text-xs font-bold hover:bg-gray-50 rounded-lg flex items-center gap-2 ${D.sold?"text-green-600":"text-red-600"}`,children:[a.jsx("i",{className:`fas ${D.sold?"fa-check":"fa-times"}`})," ",D.sold?"Mark Available":"Mark Sold"]}),a.jsx("button",{onClick:()=>vl(D),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-red-50 text-red-500 rounded-lg",children:"Delete"})]})]})]},D.id)})}),xi.length===0&&a.jsx("div",{className:"p-10 text-center text-gray-400 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:a.jsxs("p",{className:"font-bold",children:["No products found in ",A==="All"?"inventory":A,"."]})})]}),u==="inbox"&&wr&&a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-lg font-bold mb-4 border-b pb-2 flex justify-between",children:["Business Inbox ",_>0&&a.jsxs("span",{className:"text-red-500 text-xs flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-envelope"})," ",_," new"]})]}),T.length===0?a.jsx("p",{className:"text-gray-400",children:"No messages yet."}):a.jsx("div",{className:"space-y-3",children:T.map(D=>{var Ke,At;const be=D.users.find(Le=>Le.uid!==n.id)||{displayName:"Customer",photoURL:null},Ne=((Ke=D.unreadCounts)==null?void 0:Ke[n.id])>0;return a.jsxs("div",{onClick:()=>e("/messages",{state:{activeConversationId:D.id,asBusiness:!0,businessId:t,businessName:n.name}}),className:`flex justify-between items-center p-4 rounded-2xl cursor-pointer border transition-all ${Ne?"bg-gradient-to-r from-[#E0F2F1] to-white border-primary/30 shadow-sm scale-[1.01]":"bg-white hover:bg-gray-50 border-gray-100"}`,children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Ka,{src:be.photoURL,name:be.displayName,size:"md"}),a.jsxs("div",{children:[a.jsx("h4",{className:`text-sm ${Ne?"font-black":"font-bold"}`,children:be.displayName}),a.jsx("p",{className:`text-xs truncate w-48 ${Ne?"font-bold text-dark":"text-gray-500"}`,children:D.lastMessage})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:"text-[10px] text-gray-400 block",children:(At=D.updatedAt)!=null&&At.seconds?new Date(D.updatedAt.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}),Ne&&a.jsx("span",{className:"inline-block bg-primary text-white text-[10px] font-bold px-2.5 py-0.5 rounded-full mt-1",children:"New"})]})]},D.id)})})]}),u==="notifications"&&wr&&a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"text-lg font-bold mb-4 text-dark",children:"Page Activity (Reviews & Questions)"}),I.length===0?a.jsx("div",{className:"text-center py-10 text-gray-400",children:"No new activity."}):a.jsx("div",{className:"space-y-3",children:I.map(D=>{var Ne;const be=m.find(Ke=>Ke.id===D.targetId);return a.jsxs("div",{onClick:()=>ht(D),className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-colors border border-gray-100",children:[a.jsx(Ka,{src:D.senderAvatar,name:D.senderName}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm text-gray-800 leading-tight",children:[a.jsx("span",{className:"font-bold",children:D.senderName}),D.type==="review"&&" wrote a review on ",D.type==="question"&&" asked a question about ",a.jsx("span",{className:"text-primary font-bold",children:(be==null?void 0:be.title)||"a product"}),":"]}),a.jsxs("p",{className:"text-gray-600 italic text-sm mt-1",children:['"',D.message,'"']}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(Ne=D.timestamp)!=null&&Ne.seconds?new Date(D.timestamp.seconds*1e3).toLocaleString():"Just now"})]}),a.jsxs("button",{className:"bg-primary text-white px-3 py-1 rounded-lg text-xs font-bold hover:bg-primary-dark transition-all flex-shrink-0",onClick:Ke=>{Ke.stopPropagation(),ht(D)},children:[a.jsx("i",{className:"fas fa-reply mr-1"})," View/Reply"]})]},D.id)})})]}),u==="team"&&wr&&a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"font-bold text-xl text-dark mb-6",children:"Team"}),a.jsxs("div",{className:"space-y-4",children:[(vi=n.team)==null?void 0:vi.map(D=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-2xl border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Ka,{src:D.avatar,name:D.name,size:"md"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:D.name}),a.jsx("p",{className:"text-xs text-gray-500",children:D.email})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`text-xs font-bold px-3 py-1 rounded-full ${D.role==="Admin"?"bg-red-100 text-red-700":D.role==="Editor"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:D.role}),n.ownerId===D.uid?a.jsx("span",{className:"text-primary font-bold text-sm ml-2",children:"Owner"}):Hr&&a.jsx("button",{onClick:()=>Ta(D),className:"text-red-500 hover:bg-red-50 p-2 rounded-full transition",children:a.jsx("i",{className:"fas fa-trash"})})]})]},D.uid)),((wi=n.team)==null?void 0:wi.length)===0&&a.jsx("p",{className:"text-gray-400 text-center py-4",children:"No team members yet."})]}),Hr&&a.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[a.jsx("h4",{className:"font-bold text-dark mb-4",children:"Invite New Member"}),a.jsxs("div",{className:"relative mb-3",children:[a.jsx("input",{placeholder:"Search (Name, @handle, Email)...",value:Ae,onChange:D=>_t(D.target.value),className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm border border-gray-200 focus:border-primary focus:ring-primary"}),se.length>0&&!$&&a.jsx("div",{className:"search-results absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-xl shadow-lg z-30 max-h-40 overflow-y-auto p-2",children:se.map(D=>a.jsxs("div",{onClick:()=>{te(D),z(D.displayName||D.email),we([])},className:"p-2 hover:bg-gray-50 rounded-lg cursor-pointer flex items-center gap-3",children:[a.jsx(Ka,{src:D.photoURL,name:D.displayName,size:"sm"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-bold text-sm",children:D.displayName}),a.jsx("p",{className:"text-xs text-gray-400",children:D.email})]})]},D.uid))})]}),a.jsxs("div",{className:"flex gap-3 items-center",children:[a.jsxs("select",{value:ge,onChange:D=>Pe(D.target.value),className:"bg-gray-50 p-3 rounded-xl font-bold text-sm border border-gray-200 flex-1",children:[a.jsx("option",{value:"Support",children:"Support"}),a.jsx("option",{value:"Editor",children:"Editor"}),a.jsx("option",{value:"Viewer",children:"Viewer"})]}),a.jsx("button",{onClick:Rn,disabled:!$,className:"bg-dark text-white px-6 py-3 rounded-xl font-bold hover:bg-primary transition disabled:opacity-50",children:"Send Invite"})]}),$&&a.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-3 rounded-xl border border-green-100 mt-3 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Ka,{src:$.photoURL,name:$.displayName,size:"sm"}),a.jsxs("span",{className:"font-bold text-green-800",children:["Selected: ",$.displayName||$.email]})]}),a.jsxs("button",{onClick:()=>te(null),className:"text-red-500 hover:text-red-700",children:[a.jsx("i",{className:"fas fa-times"})," Clear"]})]})]})]}),u==="growth"&&Hr&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Followers"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:n.followers||0})]}),a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Leads"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:T.length})]}),a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Inventory"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:m.length})]}),a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Rating"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:((nr=n.rating)==null?void 0:nr.toFixed(1))||"N/A"})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-dark to-gray-900 p-6 rounded-[24px] text-white shadow-lg",children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"Boost Sales"}),a.jsx("p",{className:"text-sm mb-4 text-gray-300",children:"Promote your business page to reach thousands of potential customers in your area."}),a.jsxs("button",{onClick:()=>{F({id:t,type:"page",name:n.name}),gt(!0)},className:"w-full bg-white text-dark font-bold py-3 rounded-xl hover:bg-gold transition-colors",children:[a.jsx("i",{className:"fas fa-rocket mr-2"})," Promote Page"]})]})]})]}),a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-50",children:[a.jsx("h3",{className:"font-bold text-dark mb-4 border-b border-gray-100 pb-2",children:"Contact & Info"}),a.jsxs("div",{className:"space-y-4 text-sm",children:[n.address&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-map-pin mr-2 text-gray-400"})," ",n.address]}),n.email&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-envelope mr-2 text-gray-400"})," ",n.email]}),n.phone&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-phone mr-2 text-gray-400"})," ",n.phone]}),n.website&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-globe mr-2 text-gray-400"})," ",a.jsx("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:n.website})]})]})]})})]}),X&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[30px] flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between",children:[a.jsx("h3",{className:"font-bold text-xl",children:"Edit Page Info"}),a.jsx("button",{onClick:()=>fe(!1),className:"text-gray-500 hover:text-red-500 text-2xl",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("label",{className:"block",children:["Logo ",a.jsx("input",{type:"file",onChange:D=>pe({...oe,logo:D.target.files[0]}),className:"block w-full text-sm text-gray-500"})]}),a.jsxs("label",{className:"block",children:["Cover ",a.jsx("input",{type:"file",onChange:D=>pe({...oe,cover:D.target.files[0]}),className:"block w-full text-sm text-gray-500"})]})]}),a.jsx("input",{value:ae.name||"",onChange:D=>q({...ae,name:D.target.value}),placeholder:"Name",className:"w-full border p-3 rounded-xl"}),a.jsx("textarea",{value:ae.description||"",onChange:D=>q({...ae,description:D.target.value}),placeholder:"Description",className:"w-full border p-3 rounded-xl h-24"}),a.jsx("input",{value:ae.address||"",onChange:D=>q({...ae,address:D.target.value}),placeholder:"Address",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:ae.website||"",onChange:D=>q({...ae,website:D.target.value}),placeholder:"Website",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:ae.email||"",onChange:D=>q({...ae,email:D.target.value}),placeholder:"Email",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:ae.phone||"",onChange:D=>q({...ae,phone:D.target.value}),placeholder:"Phone",className:"w-full border p-3 rounded-xl"})]}),a.jsx("div",{className:"p-6 border-t",children:a.jsx("button",{onClick:_l,disabled:O,className:"w-full bg-primary text-white p-3 rounded-xl font-bold hover:bg-primary-dark transition disabled:opacity-50",children:O?a.jsx("i",{className:"fas fa-spinner fa-spin"}):"Save Changes"})})]})}),M&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] p-6 max-h-[90vh] overflow-y-auto",children:[a.jsx("h3",{className:"font-bold text-xl mb-4",children:x?"Edit Product":"Add Product"}),a.jsx("input",{value:he.title,onChange:D=>Ie({...he,title:D.target.value}),placeholder:"Title",className:"w-full border p-3 rounded-xl mb-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[a.jsx("input",{value:he.price,onChange:D=>Ie({...he,price:D.target.value}),placeholder:"Price",type:"number",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:he.stock,onChange:D=>Ie({...he,stock:D.target.value}),placeholder:"Stock",type:"number",className:"w-full border p-3 rounded-xl"})]}),a.jsx("select",{value:he.category,onChange:D=>Ie({...he,category:D.target.value}),className:"w-full border p-3 rounded-xl mb-2",children:De.map(D=>a.jsx("option",{value:D,children:D},D))}),a.jsx("textarea",{value:he.description,onChange:D=>Ie({...he,description:D.target.value}),placeholder:"Description",className:"w-full border p-3 rounded-xl h-24 mb-2"}),a.jsxs("label",{className:"block mb-4",children:["Media (Images/Videos) ",a.jsx("input",{type:"file",multiple:!0,onChange:D=>Ve([...Be,...Array.from(D.target.files)]),className:"block w-full text-sm text-gray-500"})]}),a.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:[...G,...Be.map(D=>({url:URL.createObjectURL(D),file:D,isNew:!0}))].map((D,be)=>a.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border border-gray-300",children:[a.jsx("img",{src:D.url,className:"w-full h-full object-cover",alt:"product media"}),a.jsx("button",{onClick:()=>{D.isNew?Ve(Be.filter(Ne=>Ne!==D.file)):ee(G.filter((Ne,Ke)=>Ke!==be))},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-4 h-4 text-[8px] flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]},be))}),a.jsx("button",{onClick:xl,disabled:P,className:"w-full bg-primary text-white p-3 rounded-xl font-bold hover:bg-primary-dark transition disabled:opacity-50",children:P?a.jsx("i",{className:"fas fa-spinner fa-spin"}):x?"Update Product":"Publish Product"}),a.jsx("button",{onClick:()=>N(!1),className:"w-full mt-2 text-gray-500 p-2 rounded-xl border border-gray-200 hover:bg-gray-50 transition",children:"Cancel"})]})}),pt&&Bt&&a.jsx(E4,{target:Bt,onClose:()=>gt(!1),onBoost:ud})]})},T4=()=>{const t=at(),[e,n]=w.useState([]),[r,s]=w.useState([]),[i,o]=w.useState(!0),[l,u]=w.useState("products");return w.useEffect(()=>{const d=Tt(_e,async h=>{if(h){const p=await _n(Y(U,"users",h.uid));if(p.exists()){const m=p.data(),v=m.savedProducts||[],T=await Promise.all(v.map(async y=>{const _=await _n(Y(U,"marketplace",y));return _.exists()?{id:_.id,..._.data()}:null}));n(T.filter(y=>y!==null));const j=m.savedPosts||[],I=await Promise.all(j.map(async y=>{const _=await _n(Y(U,"posts",y));return _.exists()?{id:_.id,..._.data()}:null}));s(I.filter(y=>y!==null))}o(!1)}});return()=>d()},[]),a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx(an,{}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("div",{className:"w-10 h-10 bg-red-100 rounded-full flex items-center justify-center text-red-500",children:a.jsx("i",{className:"fas fa-bookmark"})}),a.jsx("h1",{className:"text-3xl font-black text-dark",children:"Saved Items"})]}),a.jsxs("div",{className:"flex gap-6 border-b border-gray-200 mb-8",children:[a.jsxs("button",{onClick:()=>u("products"),className:`pb-4 font-bold text-sm transition-all border-b-2 ${l==="products"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Products (",e.length,")"]}),a.jsxs("button",{onClick:()=>u("posts"),className:`pb-4 font-bold text-sm transition-all border-b-2 ${l==="posts"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Posts (",r.length,")"]})]}),i?a.jsx("div",{children:"Loading..."}):a.jsxs(a.Fragment,{children:[l==="products"&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.map(d=>a.jsxs("div",{onClick:()=>t(`/product/${d.id}`),className:"bg-white rounded-[24px] overflow-hidden shadow-sm cursor-pointer group hover:shadow-lg transition-all",children:[a.jsx("div",{className:"h-48 overflow-hidden",children:a.jsx("img",{src:d.image,className:"w-full h-full object-cover group-hover:scale-105 transition-transform",alt:d.title})}),a.jsxs("div",{className:"p-4",children:[a.jsx("h3",{className:"font-bold text-dark truncate",children:d.title}),a.jsxs("p",{className:"text-primary font-black text-sm mt-1",children:[d.currency==="BDT"?"":d.currency," ",d.price]})]})]},d.id)),e.length===0&&a.jsx("div",{className:"col-span-full text-center py-20 text-gray-400",children:"No saved products."})]}),l==="posts"&&a.jsxs("div",{className:"space-y-4 max-w-3xl",children:[r.map(d=>{var h;return a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-100 flex gap-4 items-start cursor-pointer hover:bg-gray-50",onClick:()=>t(`/profile/${d.uid}`),children:[d.mediaURL?a.jsx("div",{className:"w-24 h-24 rounded-xl bg-gray-100 flex-shrink-0 overflow-hidden",children:d.mediaType==="video"?a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-black text-white",children:a.jsx("i",{className:"fas fa-play"})}):a.jsx("img",{src:d.mediaURL,className:"w-full h-full object-cover",alt:"Post media"})}):a.jsx("div",{className:"w-24 h-24 rounded-xl bg-primary/5 flex-shrink-0 flex items-center justify-center text-primary text-2xl",children:a.jsx("i",{className:"fas fa-quote-right"})}),a.jsxs("div",{className:"flex-1 min-w-0 py-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx("img",{src:d.userAvatar||"https://via.placeholder.com/50",className:"w-5 h-5 rounded-full",alt:d.userName}),a.jsx("span",{className:"text-xs font-bold text-gray-500",children:d.userName}),a.jsxs("span",{className:"text-xs text-gray-300",children:[" ",(h=d.timestamp)!=null&&h.seconds?new Date(d.timestamp.seconds*1e3).toLocaleDateString():""]})]}),a.jsx("p",{className:"text-dark font-medium line-clamp-2 text-sm",children:d.text}),a.jsxs("div",{className:"mt-3 flex gap-4 text-xs font-bold text-gray-400",children:[a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-heart mr-1"})," ",d.likes||0]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-comment mr-1"})," ",d.comments||0]})]})]})]},d.id)}),r.length===0&&a.jsx("div",{className:"text-center py-20 text-gray-400",children:"No saved posts."})]})]})]})},LN=({src:t,name:e,size:n="md",className:r=""})=>{const s=e?e.split(" ").map(l=>l[0]).join("").substring(0,2).toUpperCase():"??",i={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base",xl:"w-16 h-16 text-xl"};return t&&!t.includes("via.placeholder")?a.jsx("img",{src:t,className:`${i[n]} rounded-full object-cover border border-gray-200 ${r}`,alt:e}):a.jsx("div",{className:`${i[n]} rounded-full bg-gradient-to-tr from-primary to-primary-light text-white flex items-center justify-center font-bold shadow-inner ${r}`,children:s})},S4=({postId:t,user:e})=>{const[n,r]=w.useState([]),[s,i]=w.useState("");w.useEffect(()=>{const l=We(ie(U,"posts",t,"comments"),Xt("timestamp","asc")),u=qe(l,d=>{r(d.docs.map(h=>({id:h.id,...h.data()})))});return()=>u()},[t]);const o=async()=>{!s.trim()||!e||(await Ge(ie(U,"posts",t,"comments"),{text:s,uid:e.uid,userName:e.displayName,userAvatar:e.photoURL,timestamp:ke()}),await ue(Y(U,"posts",t),{comments:xt(1)}),i(""))};return a.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl mt-4 animate-fade-in",children:[a.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-3 mb-4 pr-2 custom-scrollbar",children:[n.length===0&&a.jsx("p",{className:"text-center text-gray-400 text-sm",children:"No comments yet."}),n.map(l=>a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx(LN,{src:l.userAvatar,name:l.userName,size:"sm"}),a.jsxs("div",{className:"bg-white p-2 rounded-lg rounded-tl-none shadow-sm border border-gray-100 flex-1",children:[a.jsx("p",{className:"text-xs font-bold text-dark",children:l.userName}),a.jsx("p",{className:"text-sm text-gray-700",children:l.text})]})]},l.id))]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{value:s,onChange:l=>i(l.target.value),placeholder:"Write a comment...",className:"flex-1 bg-white border border-gray-200 rounded-full px-4 py-2 text-sm outline-none focus:border-primary",onKeyDown:l=>l.key==="Enter"&&o()}),a.jsx("button",{onClick:o,disabled:!s.trim(),className:"w-9 h-9 bg-primary text-white rounded-full flex items-center justify-center shadow-md hover:scale-105 transition-transform disabled:opacity-50",children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})},I4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState(!0),[l,u]=w.useState(null);w.useEffect(()=>{const m=Tt(_e,j=>n(j)),v=We(ie(U,"posts"),ct("mediaType","==","video"),Xt("timestamp","desc")),T=qe(v,j=>{const I=j.docs.map(y=>({id:y.id,...y.data()}));s(I),o(!1)});return()=>{m(),T()}},[]);const d=async m=>{if(!e)return alert("Please sign in to like.");const v=Y(U,"posts",m.id);m.likedBy&&m.likedBy.includes(e.uid)?await ue(v,{likes:xt(-1),likedBy:hn(e.uid)}):await ue(v,{likes:xt(1),likedBy:Et(e.uid)})},h=m=>{const v=`${window.location.origin}/post/${m.id}`;navigator.share?navigator.share({title:"Check out this video on Tukumi",text:m.text,url:v}):(navigator.clipboard.writeText(v),alert("Link copied to clipboard!"))},p=m=>{u(l===m?null:m)};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"flex items-center gap-3 mb-8",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gradient-to-br from-red-500 to-pink-600 flex items-center justify-center text-white shadow-lg shadow-red-500/30",children:a.jsx("i",{className:"fas fa-play text-xl ml-1"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-black text-dark tracking-tight",children:"Watch"}),a.jsx("p",{className:"text-gray-500 font-medium",children:"Trending videos for you"})]})]}),i?a.jsx("div",{className:"text-center py-20 text-gray-400 animate-pulse",children:"Loading Videos..."}):a.jsx("div",{className:"space-y-8",children:r.length===0?a.jsxs("div",{className:"text-center py-20 bg-white rounded-[30px] shadow-sm",children:[a.jsx("i",{className:"fas fa-video-slash text-4xl text-gray-300 mb-4"}),a.jsx("p",{className:"text-gray-500 font-bold",children:"No videos uploaded yet."}),a.jsx("p",{className:"text-sm text-gray-400",children:"Be the first to upload a video in the Feed!"})]}):r.map(m=>{var T;const v=e&&m.likedBy&&m.likedBy.includes(e.uid);return a.jsxs("div",{className:"bg-white rounded-[30px] overflow-hidden shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[a.jsxs("div",{className:"p-4 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>t(`/profile/${m.uid}`),children:[a.jsx(LN,{src:m.userAvatar,name:m.userName}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-dark text-sm",children:m.userName}),a.jsx("p",{className:"text-xs text-gray-400",children:(T=m.timestamp)!=null&&T.seconds?new Date(m.timestamp.seconds*1e3).toLocaleDateString():"Just now"})]})]}),a.jsx("button",{className:"text-gray-400 hover:text-dark",children:a.jsx("i",{className:"fas fa-ellipsis-h"})})]}),a.jsx("div",{className:"bg-black relative group",children:a.jsx("video",{src:m.mediaURL,className:"w-full max-h-[600px] object-contain mx-auto",controls:!0,loop:!0,playsInline:!0})}),m.text&&a.jsx("div",{className:"px-6 pt-4",children:a.jsx("p",{className:"text-gray-800 text-sm leading-relaxed",children:m.text})}),a.jsx("div",{className:"p-4 px-6 flex items-center justify-between border-t border-gray-50 mt-2",children:a.jsxs("div",{className:"flex gap-6",children:[a.jsxs("button",{onClick:()=>d(m),className:`flex items-center gap-2 font-bold transition-colors ${v?"text-red-500":"text-gray-500 hover:text-red-500"}`,children:[a.jsx("i",{className:`${v?"fas":"far"} fa-heart text-xl`}),a.jsx("span",{children:m.likes||0})]}),a.jsxs("button",{onClick:()=>p(m.id),className:"flex items-center gap-2 font-bold text-gray-500 hover:text-primary transition-colors",children:[a.jsx("i",{className:"far fa-comment text-xl"}),a.jsx("span",{children:m.comments||0})]}),a.jsx("button",{onClick:()=>h(m),className:"flex items-center gap-2 font-bold text-gray-500 hover:text-dark transition-colors",children:a.jsx("i",{className:"far fa-share-square text-xl"})})]})}),l===m.id&&a.jsx("div",{className:"px-4 pb-4",children:a.jsx(S4,{postId:m.id,user:e})})]},m.id)})})]})},j4=({currentFilters:t,onClose:e,onApply:n,onDeactivate:r})=>{const[s,i]=w.useState(t),o=(u,d)=>{i(h=>({...h,[u]:d}))},l=()=>{n(s),e()};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-end md:items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-[30px] md:rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#fff0f5]",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-black text-xl text-dark flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-sliders-h text-pink-500"})," Dating Filters"]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Find your perfect match"})]}),a.jsx("button",{onClick:e,children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark text-xl"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"I'm interested in"}),a.jsx("div",{className:"flex bg-gray-100 rounded-xl p-1",children:["Men","Women","Everyone"].map(u=>a.jsx("button",{onClick:()=>o("gender",u),className:`flex-1 py-3 rounded-lg text-sm font-bold transition-all ${s.gender===u?"bg-white text-pink-500 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:u},u))})]}),a.jsxs("section",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Age Range"}),a.jsxs("span",{className:"text-pink-500 font-bold text-sm",children:[s.ageRange[0]," - ",s.ageRange[1]]})]}),a.jsxs("div",{className:"px-2",children:[a.jsx("input",{type:"range",min:"18",max:"65",value:s.ageRange[1],onChange:u=>o("ageRange",[s.ageRange[0],parseInt(u.target.value)]),className:"w-full accent-pink-500 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2 font-bold",children:[a.jsx("span",{children:"18"}),a.jsx("span",{children:"65+"})]})]})]}),a.jsxs("section",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Location"}),a.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-gray-100 rounded-xl px-4 py-3",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-pink-400"}),a.jsx("input",{type:"text",placeholder:"e.g. Dhaka, Gulshan",className:"bg-transparent outline-none w-full text-sm font-bold text-dark placeholder-gray-300",value:s.location,onChange:u=>o("location",u.target.value)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Profession"}),a.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-gray-100 rounded-xl px-4 py-3",children:[a.jsx("i",{className:"fas fa-briefcase text-pink-400"}),a.jsx("input",{type:"text",placeholder:"e.g. Doctor, Engineer",className:"bg-transparent outline-none w-full text-sm font-bold text-dark placeholder-gray-300",value:s.profession,onChange:u=>o("profession",u.target.value)})]})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Relationship Goals"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"Long-term",icon:"fa-ring",label:"Long-term"},{id:"Casual",icon:"fa-glass-cheers",label:"Fun / Casual"},{id:"Friendship",icon:"fa-user-friends",label:"Friendship"},{id:"Not Sure",icon:"fa-question",label:"Figuring it out"}].map(u=>a.jsxs("button",{onClick:()=>o("goal",u.id),className:`p-3 rounded-xl border-2 text-left transition-all flex items-center gap-3 ${s.goal===u.id?"border-pink-500 bg-pink-50 text-pink-600":"border-gray-100 text-gray-500 hover:border-pink-200"}`,children:[a.jsx("i",{className:`fas ${u.icon}`}),a.jsx("span",{className:"text-sm font-bold",children:u.label})]},u.id))})]}),r&&a.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[a.jsxs("button",{onClick:r,className:"w-full py-3 rounded-xl border border-red-100 text-red-500 font-bold text-sm bg-red-50 hover:bg-red-100 transition-colors flex items-center justify-center gap-2",children:[a.jsx("i",{className:"fas fa-eye-slash"})," Turn Off Dating Mode"]}),a.jsx("p",{className:"text-[10px] text-gray-400 text-center mt-2",children:"Your dating profile will be hidden. You can turn it back on anytime."})]})]}),a.jsx("div",{className:"p-4 border-t border-gray-100 bg-white",children:a.jsx("button",{onClick:l,className:"w-full bg-gradient-to-r from-pink-500 to-red-500 text-white font-bold py-4 rounded-2xl shadow-lg shadow-pink-500/30 hover:scale-[1.02] transition-transform",children:"Apply Filters"})})]})})},C4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState(null),[i,o]=w.useState([]),[l,u]=w.useState(0),[d,h]=w.useState(!0),[p,m]=w.useState(null),[v,T]=w.useState(!1),[j,I]=w.useState({gender:"Everyone",ageRange:[18,50],location:"",profession:"",goal:"Long-term"});w.useEffect(()=>{const M=Tt(_e,async N=>{if(N){n(N);const x=Y(U,"users",N.uid),E=await _n(x);if(E.exists()){const S=E.data();if(s(S),S.isDatingActive){const R=S.gender==="Male"?"Women":S.gender==="Female"?"Men":"Everyone";I(P=>({...P,gender:R})),y(N.uid,{...j,gender:R})}else h(!1)}}});return()=>M()},[]);const y=async(M,N)=>{h(!0);try{const x=We(ie(U,"users"),ct("isDatingActive","==",!0));let S=(await Dn(x)).docs.map(R=>({id:R.id,...R.data()}));S=S.filter(R=>{if(R.id===M)return!1;if(N.gender!=="Everyone"){const C=N.gender==="Men"?"Male":"Female";if(R.gender!==C)return!1}let P=R.age||25;if(R.birthday){const C=new Date(R.birthday),he=Date.now()-C.getTime();P=Math.abs(new Date(he).getUTCFullYear()-1970)}return!(P<N.ageRange[0]||P>N.ageRange[1]||N.location&&(!R.location||!R.location.toLowerCase().includes(N.location.toLowerCase()))||N.profession&&(!R.profession||!R.profession.toLowerCase().includes(N.profession.toLowerCase())))}),o(S),u(0)}catch(x){console.error("Error loading candidates:",x)}finally{h(!1)}},_=async()=>{e&&(h(!0),await ue(Y(U,"users",e.uid),{isDatingActive:!0}),s({...r,isDatingActive:!0}),y(e.uid,j))},b=async()=>{e&&window.confirm("Are you sure? Your dating profile will be hidden from others.")&&(h(!0),await ue(Y(U,"users",e.uid),{isDatingActive:!1}),s({...r,isDatingActive:!1}),T(!1),h(!1))},A=async(M,N)=>{const x={from:e.uid,to:N.id,type:M,timestamp:ke()};if(await xu(Y(U,"dating_swipes",`${e.uid}_${N.id}`),x),M==="like"){const E=Y(U,"dating_swipes",`${N.id}_${e.uid}`),S=await _n(E);S.exists()&&S.data().type==="like"&&V(N)}u(E=>E+1)},V=async M=>{m(M);const N=[e.uid,M.id].sort().join("_");await xu(Y(U,"conversations",N),{participants:[e.uid,M.id],users:[{uid:e.uid,displayName:r.displayName,photoURL:r.photoURL},{uid:M.id,displayName:M.displayName,photoURL:M.photoURL}],lastMessage:"It's a Match! Say hello! ",updatedAt:ke(),isMatch:!0},{merge:!0})};return d?a.jsx("div",{className:"flex h-screen items-center justify-center text-pink-500 font-bold animate-pulse",children:"Updating Dating Profile..."}):r!=null&&r.isDatingActive?a.jsxs("div",{className:"p-0 md:p-6 w-full max-w-[1400px] mx-auto pb-24 relative",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"flex justify-between items-center px-6 py-4 md:px-0 mb-4",children:[a.jsxs("div",{className:"flex items-center gap-2 text-pink-600",children:[a.jsx("i",{className:"fas fa-fire text-2xl"}),a.jsx("span",{className:"font-black text-xl tracking-tight",children:"Discover"})]}),a.jsx("button",{onClick:()=>T(!0),className:"w-10 h-10 bg-white rounded-xl shadow-sm border border-gray-100 text-gray-500 flex items-center justify-center hover:text-pink-500 hover:border-pink-200 transition-all",children:a.jsx("i",{className:"fas fa-sliders-h text-lg"})})]}),a.jsxs("div",{className:"flex flex-col items-center max-w-md mx-auto min-h-[60vh] justify-center",children:[l<i.length?a.jsxs("div",{className:"w-full aspect-[3/4] bg-white rounded-[30px] shadow-2xl overflow-hidden relative group border-4 border-white animate-pop-in",children:[a.jsx("img",{src:i[l].photoURL||"https://images.unsplash.com/photo-1534528741775-53994a69daeb",className:"w-full h-full object-cover",alt:i[l].displayName}),a.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent flex flex-col justify-end p-6",children:[a.jsxs("h2",{className:"text-3xl font-black text-white flex items-center gap-2",children:[i[l].displayName,", ",a.jsx("span",{className:"text-2xl font-normal opacity-90",children:i[l].age||24})]}),a.jsxs("p",{className:"text-white/90 font-medium mt-1 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-briefcase text-pink-400"})," ",i[l].profession||"Undisclosed"]}),i[l].location&&a.jsxs("p",{className:"text-white/70 text-sm mt-1 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-map-marker-alt"})," ",i[l].location]})]})]}):a.jsxs("div",{className:"text-center p-10",children:[a.jsx("div",{className:"w-24 h-24 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300 text-4xl animate-pulse",children:a.jsx("i",{className:"fas fa-search"})}),a.jsx("h2",{className:"text-2xl font-bold text-dark",children:"No more matches"}),a.jsx("p",{className:"text-gray-500 mt-2 mb-6",children:"Try adjusting your filters to see more people."}),a.jsx("button",{onClick:()=>T(!0),className:"text-pink-500 font-bold hover:underline",children:"Change Filters"})]}),l<i.length&&a.jsxs("div",{className:"flex items-center gap-6 mt-8",children:[a.jsx("button",{onClick:()=>A("pass",i[l]),className:"w-16 h-16 rounded-full bg-white text-gray-400 shadow-lg flex items-center justify-center text-2xl transition-all hover:bg-red-50 hover:text-red-500 hover:scale-110",children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("button",{className:"w-12 h-12 rounded-full bg-white text-blue-400 shadow-md flex items-center justify-center text-lg",children:a.jsx("i",{className:"fas fa-star"})}),a.jsx("button",{onClick:()=>A("like",i[l]),className:"w-16 h-16 rounded-full bg-gradient-to-tr from-pink-500 to-red-500 text-white shadow-xl shadow-pink-500/30 flex items-center justify-center text-2xl transition-all hover:scale-110",children:a.jsx("i",{className:"fas fa-heart"})})]})]}),p&&a.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/90 backdrop-blur-xl flex flex-col items-center justify-center p-4 animate-pop-in",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-5xl font-black text-transparent bg-clip-text bg-gradient-to-r from-pink-500 to-yellow-500 mb-8 italic transform -rotate-6",children:"It's a Match!"}),a.jsxs("div",{className:"flex items-center justify-center gap-6 mb-10",children:[a.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-2xl overflow-hidden",children:a.jsx("img",{src:r.photoURL,className:"w-full h-full object-cover"})}),a.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-2xl overflow-hidden",children:a.jsx("img",{src:p.photoURL,className:"w-full h-full object-cover"})})]}),a.jsxs("p",{className:"text-white/80 text-lg mb-8",children:["You and ",p.displayName," liked each other."]}),a.jsxs("div",{className:"space-y-3 w-full max-w-xs mx-auto",children:[a.jsx("button",{onClick:()=>t("/messages",{state:{startChatWith:p}}),className:"w-full bg-white text-pink-600 font-bold py-4 rounded-xl shadow-lg hover:bg-gray-50 transition-all",children:"Message Now"}),a.jsx("button",{onClick:()=>m(null),className:"w-full bg-transparent border-2 border-white text-white font-bold py-4 rounded-xl hover:bg-white/10 transition-all",children:"Keep Swiping"})]})]})}),v&&a.jsx(j4,{currentFilters:j,onClose:()=>T(!1),onApply:M=>{I(M),y(e.uid,M)},onDeactivate:b})]}):a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"min-h-[70vh] flex flex-col items-center justify-center text-center p-8 bg-white rounded-[40px] shadow-sm border border-pink-100 relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-full bg-gradient-to-br from-pink-50 to-transparent opacity-50 pointer-events-none"}),a.jsxs("div",{className:"relative z-10 animate-fade-in max-w-lg",children:[a.jsx("div",{className:"w-24 h-24 bg-gradient-to-tr from-pink-500 to-red-500 rounded-3xl flex items-center justify-center mx-auto mb-6 shadow-xl shadow-pink-200 rotate-3",children:a.jsx("i",{className:"fas fa-heart text-5xl text-white drop-shadow-md"})}),a.jsx("h1",{className:"text-4xl font-black text-dark mb-4",children:"Tukumi Dating"}),a.jsx("p",{className:"text-gray-500 text-lg mb-8",children:"Join the exclusive circle. Activate dating to find matches."}),a.jsx("button",{onClick:_,className:"bg-gradient-to-r from-pink-500 to-red-500 text-white px-10 py-4 rounded-2xl font-bold shadow-lg hover:scale-105 transition-transform",children:"Start Dating"})]})]})]})},R4=({name:t,url:e})=>{const n=t?t.split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase():"??";return e&&!e.includes("via.placeholder")&&!e.includes("ui-avatars")?a.jsx("img",{src:e,className:"w-12 h-12 rounded-full object-cover border border-gray-200",alt:t}):a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-tr from-primary to-primary-light text-white flex items-center justify-center font-bold text-sm shadow-sm",children:n})},A4=()=>{const t=at(),[e,n]=w.useState(null),[r,s]=w.useState([]),[i,o]=w.useState(!0);w.useEffect(()=>{const m=Tt(_e,v=>{if(v){n(v);const T=We(ie(U,"notifications"),ct("recipientId","==",v.uid),Xt("timestamp","desc")),j=qe(T,I=>{const y=I.docs.map(_=>({id:_.id,..._.data()}));s(y),o(!1)});return()=>j()}else t("/")});return()=>m()},[t]);const l=async(m,v)=>{if(m.stopPropagation(),!!e)try{const T={uid:e.uid,name:e.displayName||e.email,avatar:e.photoURL,role:v.role,email:e.email};await ue(Y(U,"business_pages",v.pageId),{team:Et(T),teamIds:Et(e.uid)}),await js(Y(U,"notifications",v.id)),alert(`Joined ${v.pageName} successfully!`),t(`/business/${v.pageId}`)}catch(T){console.error("Accept error:",T),alert("Failed to accept. You might already be a member.")}},u=async(m,v)=>{m.stopPropagation();try{await js(Y(U,"notifications",v.id))}catch(T){console.error(T)}},d=async m=>{m.type!=="team_invite"&&(m.isRead||await ue(Y(U,"notifications",m.id),{isRead:!0}),m.type==="follow"||m.type==="circle_join"?t(`/profile/${m.senderId}`):m.type==="review"||m.type==="question"?t(`/product/${m.targetId}`):m.type==="follow_business"?t(`/business/${m.targetId}`):t("/"))},h=async()=>{if(!confirm("Clear all notifications?"))return;const m=Rf(U);r.forEach(v=>m.delete(Y(U,"notifications",v.id))),await m.commit()},p=async()=>{const m=Rf(U);r.forEach(v=>{v.isRead||m.update(Y(U,"notifications",v.id),{isRead:!0})}),await m.commit()};return i?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading notifications..."}):a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>t(-1),className:"md:hidden w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-dark",children:a.jsx("i",{className:"fas fa-arrow-left"})}),a.jsx("h1",{className:"text-2xl font-black text-dark",children:"Notifications"}),r.length>0&&a.jsxs("span",{className:"bg-red-500 text-white text-xs font-bold px-2 py-1 rounded-full",children:[r.filter(m=>!m.isRead).length," New"]})]}),r.length>0&&a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:p,className:"text-xs font-bold text-primary hover:bg-primary/10 px-3 py-2 rounded-lg transition-colors",children:"Mark all read"}),a.jsx("button",{onClick:h,className:"text-xs font-bold text-red-500 hover:bg-red-50 px-3 py-2 rounded-lg transition-colors",children:"Clear all"})]})]}),a.jsx("div",{className:"space-y-3",children:r.length===0?a.jsxs("div",{className:"text-center py-20 bg-white rounded-[30px] shadow-sm border border-dashed border-gray-200",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300 text-3xl",children:a.jsx("i",{className:"far fa-bell-slash"})}),a.jsx("h3",{className:"font-bold text-gray-500",children:"No notifications yet"}),a.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"When you get notifications, they'll show up here."})]}):r.map(m=>{var v;return a.jsxs("div",{onClick:()=>d(m),className:`relative group flex gap-4 p-4 rounded-2xl cursor-pointer transition-all border 
                        ${m.isRead?"bg-gray-50/50 border-transparent hover:bg-white hover:shadow-sm":"bg-white border-primary/20 shadow-sm"}`,children:[a.jsx(R4,{name:m.senderName,url:m.senderAvatar}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("p",{className:"text-sm text-gray-800 leading-snug pr-8",children:[a.jsx("span",{className:"font-bold text-dark",children:m.senderName}),a.jsxs("span",{className:"text-gray-600",children:[m.type==="team_invite"&&` invited you to join ${m.pageName} as ${m.role}.`,m.type==="review"&&` ${m.message||"reviewed your product."}`,m.type==="question"&&` ${m.message||"asked a question."}`,m.type==="follow_business"&&` ${m.message}`,m.type==="like"&&" liked your post.",m.type==="comment"&&" commented on your post.",m.type==="follow"&&" started following you.",m.type==="mention"&&" mentioned you."]})]}),a.jsx("span",{className:"text-[10px] text-gray-400 font-medium whitespace-nowrap flex-shrink-0",children:(v=m.timestamp)!=null&&v.seconds?new Date(m.timestamp.seconds*1e3).toLocaleDateString(void 0,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Just now"})]}),m.type==="team_invite"&&a.jsxs("div",{className:"flex gap-3 mt-3",children:[a.jsx("button",{onClick:T=>l(T,m),className:"bg-primary text-white px-4 py-2 rounded-xl text-xs font-bold shadow-md hover:bg-primary-dark transition-all",children:"Accept Invite"}),a.jsx("button",{onClick:T=>u(T,m),className:"bg-white border border-gray-200 text-gray-600 px-4 py-2 rounded-xl text-xs font-bold hover:bg-gray-50 transition-all",children:"Decline"})]})]}),!m.isRead&&a.jsx("div",{className:"absolute top-1/2 right-4 -translate-y-1/2 w-2.5 h-2.5 bg-primary rounded-full"})]},m.id)})})]})},P4=()=>{const{id:t}=tl(),e=at(),[n,r]=w.useState("followers"),[s,i]=w.useState([]),[o,l]=w.useState(!0),[u,d]=w.useState(null);return w.useEffect(()=>{const h=Tt(_e,p=>{p||e("/")});return()=>h()},[]),w.useEffect(()=>{t&&(async()=>{l(!0);try{const p=await _n(Y(U,"users",t));p.exists()&&d(p.data());const m=ie(U,"users",t,n),T=(await Dn(m)).docs.map(async I=>{const y=I.id,_=await _n(Y(U,"users",y));return _.exists()?_.data():null}),j=await Promise.all(T);i(j.filter(I=>I!==null))}catch(p){console.error("Error fetching connections:",p)}finally{l(!1)}})()},[t,n]),a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx("button",{onClick:()=>e(-1),className:"w-10 h-10 bg-white rounded-full shadow-sm flex items-center justify-center text-dark hover:bg-gray-50",children:a.jsx("i",{className:"fas fa-arrow-left"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-black text-dark",children:(u==null?void 0:u.displayName)||"User"}),a.jsxs("p",{className:"text-gray-500 text-sm",children:["@",(u==null?void 0:u.handle)||"username"]})]})]}),a.jsxs("div",{className:"flex bg-white rounded-2xl p-1 shadow-sm border border-gray-100 mb-6 max-w-md",children:[a.jsx("button",{onClick:()=>r("followers"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${n==="followers"?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:"Followers"}),a.jsx("button",{onClick:()=>r("following"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${n==="following"?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:"Following"})]}),a.jsx("div",{className:"bg-white rounded-[30px] shadow-sm min-h-[500px] p-6",children:o?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading..."}):s.length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300 text-2xl",children:a.jsx("i",{className:"fas fa-users-slash"})}),a.jsxs("p",{className:"text-gray-500 font-bold",children:["No ",n," found."]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(h=>a.jsxs("div",{onClick:()=>e(`/profile/${h.uid}`),className:"flex items-center gap-4 p-4 rounded-2xl border border-gray-50 hover:bg-gray-50 hover:border-gray-200 cursor-pointer transition-all group",children:[a.jsx("img",{src:h.photoURL||"https://via.placeholder.com/150",className:"w-14 h-14 rounded-xl object-cover shadow-sm",alt:h.displayName}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-dark truncate",children:h.displayName}),a.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:["@",h.handle]}),h.profession&&a.jsxs("p",{className:"text-xs text-primary mt-1 truncate",children:[a.jsx("i",{className:"fas fa-briefcase mr-1"})," ",h.profession]})]}),a.jsx("button",{className:"w-10 h-10 rounded-full bg-white border border-gray-100 text-gray-400 flex items-center justify-center group-hover:bg-primary group-hover:text-white group-hover:border-primary transition-colors shadow-sm",children:a.jsx("i",{className:"fas fa-angle-right"})})]},h.uid))})})]})},D4=()=>{const t=at(),[e,n]=w.useState([]),[r,s]=w.useState(!0),i=["from-[#FF9A9E] to-[#FECFEF]","from-[#a18cd1] to-[#fbc2eb]","from-[#84fab0] to-[#8fd3f4]","from-[#e0c3fc] to-[#8ec5fc]","from-[#ffecd2] to-[#fcb69f]","from-[#ff9a9e] to-[#fecfef]","from-[#f6d365] to-[#fda085]","from-[#a8edea] to-[#fed6e3]"];return w.useEffect(()=>{(async()=>{var l;try{const u=We(ie(U,"users"),Is(20)),d=await Dn(u),h=(l=_e.currentUser)==null?void 0:l.uid,p=d.docs.map(m=>m.data()).filter(m=>m.uid!==h);n(p)}catch(u){console.error(u)}finally{s(!1)}})()},[]),a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(an,{})}),a.jsxs("div",{className:"mb-8 text-center md:text-left",children:[a.jsx("h1",{className:"text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2 animate-pulse",children:"Explore Tukumi"}),a.jsx("p",{className:"text-gray-500 font-bold",children:"Discover interesting people & colorful souls."})]}),r?a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[1,2,3,4].map(o=>a.jsx("div",{className:"h-64 bg-gray-100 rounded-[30px] animate-pulse"},o))}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:e.map((o,l)=>{const u=i[l%i.length];return a.jsxs("div",{onClick:()=>t(`/profile/${o.uid}`),className:`relative h-80 rounded-[35px] p-6 flex flex-col items-center justify-between shadow-xl hover:shadow-2xl hover:scale-105 transition-all cursor-pointer overflow-hidden group bg-gradient-to-br ${u}`,children:[a.jsx("div",{className:"absolute top-[-20px] right-[-20px] w-24 h-24 bg-white/20 rounded-full blur-xl"}),a.jsx("div",{className:"absolute bottom-[-20px] left-[-20px] w-32 h-32 bg-white/20 rounded-full blur-xl"}),a.jsx("div",{className:"relative z-10 bg-white p-1 rounded-full shadow-lg mt-4",children:a.jsx("img",{src:o.photoURL||"https://via.placeholder.com/150",className:"w-24 h-24 rounded-full object-cover border-4 border-white",alt:o.displayName})}),a.jsxs("div",{className:"relative z-10 text-center mb-4",children:[a.jsx("h3",{className:"font-black text-dark text-xl mb-1 drop-shadow-sm",children:o.displayName}),a.jsxs("p",{className:"text-dark/60 font-bold text-sm uppercase tracking-wider",children:["@",o.handle]}),a.jsx("div",{className:"mt-3 bg-white/40 backdrop-blur-md rounded-xl px-4 py-2 text-xs font-bold text-dark/80 shadow-sm inline-block max-w-[200px] truncate",children:o.profession||"Tukumi Creator"})]}),a.jsx("button",{className:"w-full bg-white text-dark font-bold py-3 rounded-2xl shadow-lg opacity-0 group-hover:opacity-100 translate-y-4 group-hover:translate-y-0 transition-all duration-300",children:"View Profile"})]},o.uid)})}),e.length===0&&!r&&a.jsx("div",{className:"text-center py-20 text-gray-400",children:"No users found to explore."})]})};function L4(){const[t,e]=w.useState(null),[n,r]=w.useState(!0);return w.useEffect(()=>{let s;return s=Tt(_e,async i=>{if(e(i),r(!1),i){const o=Y(U,"users",i.uid);await ue(o,{isOnline:!0,lastSeen:ke()});const l=()=>ue(o,{isOnline:!1,lastSeen:ke()});return window.addEventListener("beforeunload",l),()=>window.removeEventListener("beforeunload",l)}}),()=>{s&&s()}},[]),n?a.jsx("div",{className:"min-h-screen bg-[#f0f4f8] flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center animate-pulse",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-[#008080] to-[#FFD166] rounded-2xl animate-spin shadow-2xl shadow-teal-900/20 mb-6 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 bg-white/30 rounded-md"})}),a.jsx("p",{className:"text-[#008080] font-black text-sm tracking-[0.3em] uppercase",children:"INITIALIZING TUKUMI..."})]})}):t?a.jsxs($S,{children:[a.jsx(o4,{}),a.jsxs("div",{className:"min-h-screen bg-[#f0f4f8] text-[#111827]",children:[a.jsx(i4,{}),a.jsx(a4,{}),a.jsx("div",{className:"w-full md:ml-[300px] md:w-[calc(100%-300px)] p-4 pb-28 transition-all duration-300",children:a.jsxs(vS,{children:[a.jsx(St,{path:"/",element:a.jsx(h4,{})}),a.jsx(St,{path:"/explore",element:a.jsx(D4,{})}),a.jsx(St,{path:"/profile",element:a.jsx(gv,{})}),a.jsx(St,{path:"/profile/:id",element:a.jsx(gv,{})}),a.jsx(St,{path:"/profile/:id/connections",element:a.jsx(P4,{})}),a.jsx(St,{path:"/messages",element:a.jsx(g4,{})}),a.jsx(St,{path:"/watch",element:a.jsx(I4,{})}),a.jsx(St,{path:"/dating",element:a.jsx(C4,{})}),a.jsx(St,{path:"/notifications",element:a.jsx(A4,{})}),a.jsx(St,{path:"/marketplace",element:a.jsx(_4,{})}),a.jsx(St,{path:"/product/:id",element:a.jsx(b4,{})}),a.jsx(St,{path:"/business",element:a.jsx(N4,{})}),a.jsx(St,{path:"/business/:id",element:a.jsx(k4,{})}),a.jsx(St,{path:"/circles",element:a.jsx(x4,{})}),a.jsx(St,{path:"/circles/:circleId",element:a.jsx(w4,{})}),a.jsx(St,{path:"/saved-items",element:a.jsx(T4,{})}),a.jsx(St,{path:"*",element:a.jsx(yS,{to:"/"})})]})})]})]}):a.jsx(l4,{})}class O4 extends Sv.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("React Error Boundary Caught:",e,n)}render(){var e;return this.state.hasError?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 text-red-900 p-10 text-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Something went wrong."}),a.jsx("p",{className:"mb-4",children:(e=this.state.error)==null?void 0:e.message}),a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-6 py-2 rounded-lg font-bold",children:"Reload App"})]})}):this.props.children}}dh.createRoot(document.getElementById("root")).render(a.jsx(Sv.StrictMode,{children:a.jsx(O4,{children:a.jsx(L4,{})})}));
