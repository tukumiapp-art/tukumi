function XA(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(t,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=n(r);fetch(r.href,i)}})();function JA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var zE={exports:{}},If={},qE={exports:{}},We={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ju=Symbol.for("react.element"),ZA=Symbol.for("react.portal"),eR=Symbol.for("react.fragment"),tR=Symbol.for("react.strict_mode"),nR=Symbol.for("react.profiler"),sR=Symbol.for("react.provider"),rR=Symbol.for("react.context"),iR=Symbol.for("react.forward_ref"),aR=Symbol.for("react.suspense"),oR=Symbol.for("react.memo"),lR=Symbol.for("react.lazy"),sb=Symbol.iterator;function cR(t){return t===null||typeof t!="object"?null:(t=sb&&t[sb]||t["@@iterator"],typeof t=="function"?t:null)}var WE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GE=Object.assign,HE={};function vl(t,e,n){this.props=t,this.context=e,this.refs=HE,this.updater=n||WE}vl.prototype.isReactComponent={};vl.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};vl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function KE(){}KE.prototype=vl.prototype;function Vx(t,e,n){this.props=t,this.context=e,this.refs=HE,this.updater=n||WE}var Mx=Vx.prototype=new KE;Mx.constructor=Vx;GE(Mx,vl.prototype);Mx.isPureReactComponent=!0;var rb=Array.isArray,QE=Object.prototype.hasOwnProperty,Lx={current:null},YE={key:!0,ref:!0,__self:!0,__source:!0};function XE(t,e,n){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)QE.call(e,s)&&!YE.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];r.children=c}if(t&&t.defaultProps)for(s in l=t.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:ju,type:t,key:i,ref:o,props:r,_owner:Lx.current}}function uR(t,e){return{$$typeof:ju,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Ox(t){return typeof t=="object"&&t!==null&&t.$$typeof===ju}function dR(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var ib=/\/+/g;function Cm(t,e){return typeof t=="object"&&t!==null&&t.key!=null?dR(""+t.key):e.toString(36)}function Yd(t,e,n,s,r){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case ju:case ZA:o=!0}}if(o)return o=t,r=r(o),t=s===""?"."+Cm(o,0):s,rb(r)?(n="",t!=null&&(n=t.replace(ib,"$&/")+"/"),Yd(r,e,n,"",function(u){return u})):r!=null&&(Ox(r)&&(r=uR(r,n+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(ib,"$&/")+"/")+t)),e.push(r)),1;if(o=0,s=s===""?".":s+":",rb(t))for(var l=0;l<t.length;l++){i=t[l];var c=s+Cm(i,l);o+=Yd(i,e,n,c,r)}else if(c=cR(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=s+Cm(i,l++),o+=Yd(i,e,n,c,r);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function vd(t,e,n){if(t==null)return t;var s=[],r=0;return Yd(t,s,"","",function(i){return e.call(n,i,r++)}),s}function hR(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var zn={current:null},Xd={transition:null},fR={ReactCurrentDispatcher:zn,ReactCurrentBatchConfig:Xd,ReactCurrentOwner:Lx};function JE(){throw Error("act(...) is not supported in production builds of React.")}We.Children={map:vd,forEach:function(t,e,n){vd(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return vd(t,function(){e++}),e},toArray:function(t){return vd(t,function(e){return e})||[]},only:function(t){if(!Ox(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};We.Component=vl;We.Fragment=eR;We.Profiler=nR;We.PureComponent=Vx;We.StrictMode=tR;We.Suspense=aR;We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fR;We.act=JE;We.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=GE({},t.props),r=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=Lx.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)QE.call(e,c)&&!YE.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];s.children=l}return{$$typeof:ju,type:t.type,key:r,ref:i,props:s,_owner:o}};We.createContext=function(t){return t={$$typeof:rR,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:sR,_context:t},t.Consumer=t};We.createElement=XE;We.createFactory=function(t){var e=XE.bind(null,t);return e.type=t,e};We.createRef=function(){return{current:null}};We.forwardRef=function(t){return{$$typeof:iR,render:t}};We.isValidElement=Ox;We.lazy=function(t){return{$$typeof:lR,_payload:{_status:-1,_result:t},_init:hR}};We.memo=function(t,e){return{$$typeof:oR,type:t,compare:e===void 0?null:e}};We.startTransition=function(t){var e=Xd.transition;Xd.transition={};try{t()}finally{Xd.transition=e}};We.unstable_act=JE;We.useCallback=function(t,e){return zn.current.useCallback(t,e)};We.useContext=function(t){return zn.current.useContext(t)};We.useDebugValue=function(){};We.useDeferredValue=function(t){return zn.current.useDeferredValue(t)};We.useEffect=function(t,e){return zn.current.useEffect(t,e)};We.useId=function(){return zn.current.useId()};We.useImperativeHandle=function(t,e,n){return zn.current.useImperativeHandle(t,e,n)};We.useInsertionEffect=function(t,e){return zn.current.useInsertionEffect(t,e)};We.useLayoutEffect=function(t,e){return zn.current.useLayoutEffect(t,e)};We.useMemo=function(t,e){return zn.current.useMemo(t,e)};We.useReducer=function(t,e,n){return zn.current.useReducer(t,e,n)};We.useRef=function(t){return zn.current.useRef(t)};We.useState=function(t){return zn.current.useState(t)};We.useSyncExternalStore=function(t,e,n){return zn.current.useSyncExternalStore(t,e,n)};We.useTransition=function(){return zn.current.useTransition()};We.version="18.3.1";qE.exports=We;var g=qE.exports;const Cf=JA(g),mR=XA({__proto__:null,default:Cf},[g]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pR=g,gR=Symbol.for("react.element"),xR=Symbol.for("react.fragment"),yR=Object.prototype.hasOwnProperty,vR=pR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,bR={key:!0,ref:!0,__self:!0,__source:!0};function ZE(t,e,n){var s,r={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)yR.call(e,s)&&!bR.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:gR,type:t,key:i,ref:o,props:r,_owner:vR.current}}If.Fragment=xR;If.jsx=ZE;If.jsxs=ZE;zE.exports=If;var a=zE.exports,Lp={},eT={exports:{}},xs={},tT={exports:{}},nT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(K,se){var ne=K.length;K.push(se);e:for(;0<ne;){var F=ne-1>>>1,G=K[F];if(0<r(G,se))K[F]=se,K[ne]=G,ne=F;else break e}}function n(K){return K.length===0?null:K[0]}function s(K){if(K.length===0)return null;var se=K[0],ne=K.pop();if(ne!==se){K[0]=ne;e:for(var F=0,G=K.length,J=G>>>1;F<J;){var we=2*(F+1)-1,je=K[we],U=we+1,xe=K[U];if(0>r(je,ne))U<G&&0>r(xe,je)?(K[F]=xe,K[U]=ne,F=U):(K[F]=je,K[we]=ne,F=we);else if(U<G&&0>r(xe,ne))K[F]=xe,K[U]=ne,F=U;else break e}}return se}function r(K,se){var ne=K.sortIndex-se.sortIndex;return ne!==0?ne:K.id-se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],h=1,f=null,m=3,x=!1,b=!1,N=!1,E=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,v=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function T(K){for(var se=n(u);se!==null;){if(se.callback===null)s(u);else if(se.startTime<=K)s(u),se.sortIndex=se.expirationTime,e(c,se);else break;se=n(u)}}function I(K){if(N=!1,T(K),!b)if(n(c)!==null)b=!0,Se(R);else{var se=n(u);se!==null&&fe(I,se.startTime-K)}}function R(K,se){b=!1,N&&(N=!1,w(y),y=-1),x=!0;var ne=m;try{for(T(se),f=n(c);f!==null&&(!(f.expirationTime>se)||K&&!D());){var F=f.callback;if(typeof F=="function"){f.callback=null,m=f.priorityLevel;var G=F(f.expirationTime<=se);se=t.unstable_now(),typeof G=="function"?f.callback=G:f===n(c)&&s(c),T(se)}else s(c);f=n(c)}if(f!==null)var J=!0;else{var we=n(u);we!==null&&fe(I,we.startTime-se),J=!1}return J}finally{f=null,m=ne,x=!1}}var V=!1,j=null,y=-1,k=5,S=-1;function D(){return!(t.unstable_now()-S<k)}function P(){if(j!==null){var K=t.unstable_now();S=K;var se=!0;try{se=j(!0,K)}finally{se?C():(V=!1,j=null)}}else V=!1}var C;if(typeof v=="function")C=function(){v(P)};else if(typeof MessageChannel<"u"){var q=new MessageChannel,ue=q.port2;q.port1.onmessage=P,C=function(){ue.postMessage(null)}}else C=function(){E(P,0)};function Se(K){j=K,V||(V=!0,C())}function fe(K,se){y=E(function(){K(t.unstable_now())},se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(K){K.callback=null},t.unstable_continueExecution=function(){b||x||(b=!0,Se(R))},t.unstable_forceFrameRate=function(K){0>K||125<K?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<K?Math.floor(1e3/K):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(K){switch(m){case 1:case 2:case 3:var se=3;break;default:se=m}var ne=m;m=se;try{return K()}finally{m=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(K,se){switch(K){case 1:case 2:case 3:case 4:case 5:break;default:K=3}var ne=m;m=K;try{return se()}finally{m=ne}},t.unstable_scheduleCallback=function(K,se,ne){var F=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?F+ne:F):ne=F,K){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=ne+G,K={id:h++,callback:se,priorityLevel:K,startTime:ne,expirationTime:G,sortIndex:-1},ne>F?(K.sortIndex=ne,e(u,K),n(c)===null&&K===n(u)&&(N?(w(y),y=-1):N=!0,fe(I,ne-F))):(K.sortIndex=G,e(c,K),b||x||(b=!0,Se(R))),K},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(K){var se=m;return function(){var ne=m;m=se;try{return K.apply(this,arguments)}finally{m=ne}}}})(nT);tT.exports=nT;var wR=tT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _R=g,ps=wR;function ie(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var sT=new Set,zc={};function Ga(t,e){Xo(t,e),Xo(t+"Capture",e)}function Xo(t,e){for(zc[t]=e,t=0;t<e.length;t++)sT.add(e[t])}var Pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Op=Object.prototype.hasOwnProperty,NR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ab={},ob={};function ER(t){return Op.call(ob,t)?!0:Op.call(ab,t)?!1:NR.test(t)?ob[t]=!0:(ab[t]=!0,!1)}function TR(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function SR(t,e,n,s){if(e===null||typeof e>"u"||TR(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function qn(t,e,n,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var xn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){xn[t]=new qn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];xn[e]=new qn(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){xn[t]=new qn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){xn[t]=new qn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){xn[t]=new qn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){xn[t]=new qn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){xn[t]=new qn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){xn[t]=new qn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){xn[t]=new qn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Fx=/[\-:]([a-z])/g;function Ux(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Fx,Ux);xn[e]=new qn(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Fx,Ux);xn[e]=new qn(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Fx,Ux);xn[e]=new qn(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){xn[t]=new qn(t,1,!1,t.toLowerCase(),null,!1,!1)});xn.xlinkHref=new qn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){xn[t]=new qn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Bx(t,e,n,s){var r=xn.hasOwnProperty(e)?xn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(SR(e,n,r,s)&&(n=null),s||r===null?ER(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var qr=_R.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,bd=Symbol.for("react.element"),wo=Symbol.for("react.portal"),_o=Symbol.for("react.fragment"),$x=Symbol.for("react.strict_mode"),Fp=Symbol.for("react.profiler"),rT=Symbol.for("react.provider"),iT=Symbol.for("react.context"),zx=Symbol.for("react.forward_ref"),Up=Symbol.for("react.suspense"),Bp=Symbol.for("react.suspense_list"),qx=Symbol.for("react.memo"),li=Symbol.for("react.lazy"),aT=Symbol.for("react.offscreen"),lb=Symbol.iterator;function Kl(t){return t===null||typeof t!="object"?null:(t=lb&&t[lb]||t["@@iterator"],typeof t=="function"?t:null)}var Rt=Object.assign,Am;function cc(t){if(Am===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Am=e&&e[1]||""}return`
`+Am+t}var Rm=!1;function Pm(t,e){if(!t||Rm)return"";Rm=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var s=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){s=u}t.call(e.prototype)}else{try{throw Error()}catch(u){s=u}t()}}catch(u){if(u&&s&&typeof u.stack=="string"){for(var r=u.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,l=i.length-1;1<=o&&0<=l&&r[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==i[l]){var c=`
`+r[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{Rm=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?cc(t):""}function jR(t){switch(t.tag){case 5:return cc(t.type);case 16:return cc("Lazy");case 13:return cc("Suspense");case 19:return cc("SuspenseList");case 0:case 2:case 15:return t=Pm(t.type,!1),t;case 11:return t=Pm(t.type.render,!1),t;case 1:return t=Pm(t.type,!0),t;default:return""}}function $p(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case _o:return"Fragment";case wo:return"Portal";case Fp:return"Profiler";case $x:return"StrictMode";case Up:return"Suspense";case Bp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case iT:return(t.displayName||"Context")+".Consumer";case rT:return(t._context.displayName||"Context")+".Provider";case zx:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case qx:return e=t.displayName||null,e!==null?e:$p(t.type)||"Memo";case li:e=t._payload,t=t._init;try{return $p(t(e))}catch{}}return null}function kR(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return $p(e);case 8:return e===$x?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pi(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function oT(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function IR(t){var e=oT(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function wd(t){t._valueTracker||(t._valueTracker=IR(t))}function lT(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=oT(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function Th(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function zp(t,e){var n=e.checked;return Rt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function cb(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=Pi(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function cT(t,e){e=e.checked,e!=null&&Bx(t,"checked",e,!1)}function qp(t,e){cT(t,e);var n=Pi(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wp(t,e.type,Pi(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function ub(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wp(t,e,n){(e!=="number"||Th(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var uc=Array.isArray;function Fo(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+Pi(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function Gp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ie(91));return Rt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function db(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ie(92));if(uc(n)){if(1<n.length)throw Error(ie(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Pi(n)}}function uT(t,e){var n=Pi(e.value),s=Pi(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function hb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function dT(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Hp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?dT(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var _d,hT=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(_d=_d||document.createElement("div"),_d.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=_d.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function qc(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var wc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},CR=["Webkit","ms","Moz","O"];Object.keys(wc).forEach(function(t){CR.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),wc[e]=wc[t]})});function fT(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||wc.hasOwnProperty(t)&&wc[t]?(""+e).trim():e+"px"}function mT(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=fT(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var AR=Rt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kp(t,e){if(e){if(AR[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ie(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ie(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ie(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ie(62))}}function Qp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Yp=null;function Wx(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Xp=null,Uo=null,Bo=null;function fb(t){if(t=Cu(t)){if(typeof Xp!="function")throw Error(ie(280));var e=t.stateNode;e&&(e=Vf(e),Xp(t.stateNode,t.type,e))}}function pT(t){Uo?Bo?Bo.push(t):Bo=[t]:Uo=t}function gT(){if(Uo){var t=Uo,e=Bo;if(Bo=Uo=null,fb(t),e)for(t=0;t<e.length;t++)fb(e[t])}}function xT(t,e){return t(e)}function yT(){}var Dm=!1;function vT(t,e,n){if(Dm)return t(e,n);Dm=!0;try{return xT(t,e,n)}finally{Dm=!1,(Uo!==null||Bo!==null)&&(yT(),gT())}}function Wc(t,e){var n=t.stateNode;if(n===null)return null;var s=Vf(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ie(231,e,typeof n));return n}var Jp=!1;if(Pr)try{var Ql={};Object.defineProperty(Ql,"passive",{get:function(){Jp=!0}}),window.addEventListener("test",Ql,Ql),window.removeEventListener("test",Ql,Ql)}catch{Jp=!1}function RR(t,e,n,s,r,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(h){this.onError(h)}}var _c=!1,Sh=null,jh=!1,Zp=null,PR={onError:function(t){_c=!0,Sh=t}};function DR(t,e,n,s,r,i,o,l,c){_c=!1,Sh=null,RR.apply(PR,arguments)}function VR(t,e,n,s,r,i,o,l,c){if(DR.apply(this,arguments),_c){if(_c){var u=Sh;_c=!1,Sh=null}else throw Error(ie(198));jh||(jh=!0,Zp=u)}}function Ha(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function bT(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function mb(t){if(Ha(t)!==t)throw Error(ie(188))}function MR(t){var e=t.alternate;if(!e){if(e=Ha(t),e===null)throw Error(ie(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===n)return mb(r),t;if(i===s)return mb(r),e;i=i.sibling}throw Error(ie(188))}if(n.return!==s.return)n=r,s=i;else{for(var o=!1,l=r.child;l;){if(l===n){o=!0,n=r,s=i;break}if(l===s){o=!0,s=r,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,s=r;break}if(l===s){o=!0,s=i,n=r;break}l=l.sibling}if(!o)throw Error(ie(189))}}if(n.alternate!==s)throw Error(ie(190))}if(n.tag!==3)throw Error(ie(188));return n.stateNode.current===n?t:e}function wT(t){return t=MR(t),t!==null?_T(t):null}function _T(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=_T(t);if(e!==null)return e;t=t.sibling}return null}var NT=ps.unstable_scheduleCallback,pb=ps.unstable_cancelCallback,LR=ps.unstable_shouldYield,OR=ps.unstable_requestPaint,Bt=ps.unstable_now,FR=ps.unstable_getCurrentPriorityLevel,Gx=ps.unstable_ImmediatePriority,ET=ps.unstable_UserBlockingPriority,kh=ps.unstable_NormalPriority,UR=ps.unstable_LowPriority,TT=ps.unstable_IdlePriority,Af=null,ir=null;function BR(t){if(ir&&typeof ir.onCommitFiberRoot=="function")try{ir.onCommitFiberRoot(Af,t,void 0,(t.current.flags&128)===128)}catch{}}var zs=Math.clz32?Math.clz32:qR,$R=Math.log,zR=Math.LN2;function qR(t){return t>>>=0,t===0?32:31-($R(t)/zR|0)|0}var Nd=64,Ed=4194304;function dc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ih(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~r;l!==0?s=dc(l):(i&=o,i!==0&&(s=dc(i)))}else o=n&~r,o!==0?s=dc(o):i!==0&&(s=dc(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-zs(e),r=1<<n,s|=t[n],e&=~r;return s}function WR(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function GR(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-zs(i),l=1<<o,c=r[o];c===-1?(!(l&n)||l&s)&&(r[o]=WR(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function eg(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ST(){var t=Nd;return Nd<<=1,!(Nd&4194240)&&(Nd=64),t}function Vm(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ku(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-zs(e),t[e]=n}function HR(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-zs(n),i=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~i}}function Hx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-zs(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var st=0;function jT(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var kT,Kx,IT,CT,AT,tg=!1,Td=[],wi=null,_i=null,Ni=null,Gc=new Map,Hc=new Map,ui=[],KR="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function gb(t,e){switch(t){case"focusin":case"focusout":wi=null;break;case"dragenter":case"dragleave":_i=null;break;case"mouseover":case"mouseout":Ni=null;break;case"pointerover":case"pointerout":Gc.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hc.delete(e.pointerId)}}function Yl(t,e,n,s,r,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=Cu(e),e!==null&&Kx(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function QR(t,e,n,s,r){switch(e){case"focusin":return wi=Yl(wi,t,e,n,s,r),!0;case"dragenter":return _i=Yl(_i,t,e,n,s,r),!0;case"mouseover":return Ni=Yl(Ni,t,e,n,s,r),!0;case"pointerover":var i=r.pointerId;return Gc.set(i,Yl(Gc.get(i)||null,t,e,n,s,r)),!0;case"gotpointercapture":return i=r.pointerId,Hc.set(i,Yl(Hc.get(i)||null,t,e,n,s,r)),!0}return!1}function RT(t){var e=pa(t.target);if(e!==null){var n=Ha(e);if(n!==null){if(e=n.tag,e===13){if(e=bT(n),e!==null){t.blockedOn=e,AT(t.priority,function(){IT(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Jd(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ng(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);Yp=s,n.target.dispatchEvent(s),Yp=null}else return e=Cu(n),e!==null&&Kx(e),t.blockedOn=n,!1;e.shift()}return!0}function xb(t,e,n){Jd(t)&&n.delete(e)}function YR(){tg=!1,wi!==null&&Jd(wi)&&(wi=null),_i!==null&&Jd(_i)&&(_i=null),Ni!==null&&Jd(Ni)&&(Ni=null),Gc.forEach(xb),Hc.forEach(xb)}function Xl(t,e){t.blockedOn===e&&(t.blockedOn=null,tg||(tg=!0,ps.unstable_scheduleCallback(ps.unstable_NormalPriority,YR)))}function Kc(t){function e(r){return Xl(r,t)}if(0<Td.length){Xl(Td[0],t);for(var n=1;n<Td.length;n++){var s=Td[n];s.blockedOn===t&&(s.blockedOn=null)}}for(wi!==null&&Xl(wi,t),_i!==null&&Xl(_i,t),Ni!==null&&Xl(Ni,t),Gc.forEach(e),Hc.forEach(e),n=0;n<ui.length;n++)s=ui[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<ui.length&&(n=ui[0],n.blockedOn===null);)RT(n),n.blockedOn===null&&ui.shift()}var $o=qr.ReactCurrentBatchConfig,Ch=!0;function XR(t,e,n,s){var r=st,i=$o.transition;$o.transition=null;try{st=1,Qx(t,e,n,s)}finally{st=r,$o.transition=i}}function JR(t,e,n,s){var r=st,i=$o.transition;$o.transition=null;try{st=4,Qx(t,e,n,s)}finally{st=r,$o.transition=i}}function Qx(t,e,n,s){if(Ch){var r=ng(t,e,n,s);if(r===null)Wm(t,e,s,Ah,n),gb(t,s);else if(QR(r,t,e,n,s))s.stopPropagation();else if(gb(t,s),e&4&&-1<KR.indexOf(t)){for(;r!==null;){var i=Cu(r);if(i!==null&&kT(i),i=ng(t,e,n,s),i===null&&Wm(t,e,s,Ah,n),i===r)break;r=i}r!==null&&s.stopPropagation()}else Wm(t,e,s,null,n)}}var Ah=null;function ng(t,e,n,s){if(Ah=null,t=Wx(s),t=pa(t),t!==null)if(e=Ha(t),e===null)t=null;else if(n=e.tag,n===13){if(t=bT(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ah=t,null}function PT(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(FR()){case Gx:return 1;case ET:return 4;case kh:case UR:return 16;case TT:return 536870912;default:return 16}default:return 16}}var xi=null,Yx=null,Zd=null;function DT(){if(Zd)return Zd;var t,e=Yx,n=e.length,s,r="value"in xi?xi.value:xi.textContent,i=r.length;for(t=0;t<n&&e[t]===r[t];t++);var o=n-t;for(s=1;s<=o&&e[n-s]===r[i-s];s++);return Zd=r.slice(t,1<s?1-s:void 0)}function eh(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sd(){return!0}function yb(){return!1}function ys(t){function e(n,s,r,i,o){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sd:yb,this.isPropagationStopped=yb,this}return Rt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sd)},persist:function(){},isPersistent:Sd}),e}var bl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xx=ys(bl),Iu=Rt({},bl,{view:0,detail:0}),ZR=ys(Iu),Mm,Lm,Jl,Rf=Rt({},Iu,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jx,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Jl&&(Jl&&t.type==="mousemove"?(Mm=t.screenX-Jl.screenX,Lm=t.screenY-Jl.screenY):Lm=Mm=0,Jl=t),Mm)},movementY:function(t){return"movementY"in t?t.movementY:Lm}}),vb=ys(Rf),eP=Rt({},Rf,{dataTransfer:0}),tP=ys(eP),nP=Rt({},Iu,{relatedTarget:0}),Om=ys(nP),sP=Rt({},bl,{animationName:0,elapsedTime:0,pseudoElement:0}),rP=ys(sP),iP=Rt({},bl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),aP=ys(iP),oP=Rt({},bl,{data:0}),bb=ys(oP),lP={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cP={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},uP={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function dP(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=uP[t])?!!e[t]:!1}function Jx(){return dP}var hP=Rt({},Iu,{key:function(t){if(t.key){var e=lP[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=eh(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?cP[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jx,charCode:function(t){return t.type==="keypress"?eh(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?eh(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),fP=ys(hP),mP=Rt({},Rf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),wb=ys(mP),pP=Rt({},Iu,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jx}),gP=ys(pP),xP=Rt({},bl,{propertyName:0,elapsedTime:0,pseudoElement:0}),yP=ys(xP),vP=Rt({},Rf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),bP=ys(vP),wP=[9,13,27,32],Zx=Pr&&"CompositionEvent"in window,Nc=null;Pr&&"documentMode"in document&&(Nc=document.documentMode);var _P=Pr&&"TextEvent"in window&&!Nc,VT=Pr&&(!Zx||Nc&&8<Nc&&11>=Nc),_b=" ",Nb=!1;function MT(t,e){switch(t){case"keyup":return wP.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function LT(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var No=!1;function NP(t,e){switch(t){case"compositionend":return LT(e);case"keypress":return e.which!==32?null:(Nb=!0,_b);case"textInput":return t=e.data,t===_b&&Nb?null:t;default:return null}}function EP(t,e){if(No)return t==="compositionend"||!Zx&&MT(t,e)?(t=DT(),Zd=Yx=xi=null,No=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return VT&&e.locale!=="ko"?null:e.data;default:return null}}var TP={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Eb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!TP[t.type]:e==="textarea"}function OT(t,e,n,s){pT(s),e=Rh(e,"onChange"),0<e.length&&(n=new Xx("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Ec=null,Qc=null;function SP(t){QT(t,0)}function Pf(t){var e=So(t);if(lT(e))return t}function jP(t,e){if(t==="change")return e}var FT=!1;if(Pr){var Fm;if(Pr){var Um="oninput"in document;if(!Um){var Tb=document.createElement("div");Tb.setAttribute("oninput","return;"),Um=typeof Tb.oninput=="function"}Fm=Um}else Fm=!1;FT=Fm&&(!document.documentMode||9<document.documentMode)}function Sb(){Ec&&(Ec.detachEvent("onpropertychange",UT),Qc=Ec=null)}function UT(t){if(t.propertyName==="value"&&Pf(Qc)){var e=[];OT(e,Qc,t,Wx(t)),vT(SP,e)}}function kP(t,e,n){t==="focusin"?(Sb(),Ec=e,Qc=n,Ec.attachEvent("onpropertychange",UT)):t==="focusout"&&Sb()}function IP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pf(Qc)}function CP(t,e){if(t==="click")return Pf(e)}function AP(t,e){if(t==="input"||t==="change")return Pf(e)}function RP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Ws=typeof Object.is=="function"?Object.is:RP;function Yc(t,e){if(Ws(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!Op.call(e,r)||!Ws(t[r],e[r]))return!1}return!0}function jb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function kb(t,e){var n=jb(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=jb(n)}}function BT(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?BT(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function $T(){for(var t=window,e=Th();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Th(t.document)}return e}function ey(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function PP(t){var e=$T(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&BT(n.ownerDocument.documentElement,n)){if(s!==null&&ey(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!t.extend&&i>s&&(r=s,s=i,i=r),r=kb(n,i);var o=kb(n,s);r&&o&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),i>s?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var DP=Pr&&"documentMode"in document&&11>=document.documentMode,Eo=null,sg=null,Tc=null,rg=!1;function Ib(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;rg||Eo==null||Eo!==Th(s)||(s=Eo,"selectionStart"in s&&ey(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Tc&&Yc(Tc,s)||(Tc=s,s=Rh(sg,"onSelect"),0<s.length&&(e=new Xx("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=Eo)))}function jd(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var To={animationend:jd("Animation","AnimationEnd"),animationiteration:jd("Animation","AnimationIteration"),animationstart:jd("Animation","AnimationStart"),transitionend:jd("Transition","TransitionEnd")},Bm={},zT={};Pr&&(zT=document.createElement("div").style,"AnimationEvent"in window||(delete To.animationend.animation,delete To.animationiteration.animation,delete To.animationstart.animation),"TransitionEvent"in window||delete To.transitionend.transition);function Df(t){if(Bm[t])return Bm[t];if(!To[t])return t;var e=To[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in zT)return Bm[t]=e[n];return t}var qT=Df("animationend"),WT=Df("animationiteration"),GT=Df("animationstart"),HT=Df("transitionend"),KT=new Map,Cb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ui(t,e){KT.set(t,e),Ga(e,[t])}for(var $m=0;$m<Cb.length;$m++){var zm=Cb[$m],VP=zm.toLowerCase(),MP=zm[0].toUpperCase()+zm.slice(1);Ui(VP,"on"+MP)}Ui(qT,"onAnimationEnd");Ui(WT,"onAnimationIteration");Ui(GT,"onAnimationStart");Ui("dblclick","onDoubleClick");Ui("focusin","onFocus");Ui("focusout","onBlur");Ui(HT,"onTransitionEnd");Xo("onMouseEnter",["mouseout","mouseover"]);Xo("onMouseLeave",["mouseout","mouseover"]);Xo("onPointerEnter",["pointerout","pointerover"]);Xo("onPointerLeave",["pointerout","pointerover"]);Ga("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ga("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ga("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ga("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ga("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ga("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),LP=new Set("cancel close invalid load scroll toggle".split(" ").concat(hc));function Ab(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,VR(s,e,void 0,t),t.currentTarget=null}function QT(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&r.isPropagationStopped())break e;Ab(r,l,u),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&r.isPropagationStopped())break e;Ab(r,l,u),i=c}}}if(jh)throw t=Zp,jh=!1,Zp=null,t}function ft(t,e){var n=e[cg];n===void 0&&(n=e[cg]=new Set);var s=t+"__bubble";n.has(s)||(YT(e,t,2,!1),n.add(s))}function qm(t,e,n){var s=0;e&&(s|=4),YT(n,t,s,e)}var kd="_reactListening"+Math.random().toString(36).slice(2);function Xc(t){if(!t[kd]){t[kd]=!0,sT.forEach(function(n){n!=="selectionchange"&&(LP.has(n)||qm(n,!1,t),qm(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kd]||(e[kd]=!0,qm("selectionchange",!1,e))}}function YT(t,e,n,s){switch(PT(e)){case 1:var r=XR;break;case 4:r=JR;break;default:r=Qx}n=r.bind(null,e,n,t),r=void 0,!Jp||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Wm(t,e,n,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=pa(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}vT(function(){var u=i,h=Wx(n),f=[];e:{var m=KT.get(t);if(m!==void 0){var x=Xx,b=t;switch(t){case"keypress":if(eh(n)===0)break e;case"keydown":case"keyup":x=fP;break;case"focusin":b="focus",x=Om;break;case"focusout":b="blur",x=Om;break;case"beforeblur":case"afterblur":x=Om;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":x=vb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":x=tP;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":x=gP;break;case qT:case WT:case GT:x=rP;break;case HT:x=yP;break;case"scroll":x=ZR;break;case"wheel":x=bP;break;case"copy":case"cut":case"paste":x=aP;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":x=wb}var N=(e&4)!==0,E=!N&&t==="scroll",w=N?m!==null?m+"Capture":null:m;N=[];for(var v=u,T;v!==null;){T=v;var I=T.stateNode;if(T.tag===5&&I!==null&&(T=I,w!==null&&(I=Wc(v,w),I!=null&&N.push(Jc(v,I,T)))),E)break;v=v.return}0<N.length&&(m=new x(m,b,null,n,h),f.push({event:m,listeners:N}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",x=t==="mouseout"||t==="pointerout",m&&n!==Yp&&(b=n.relatedTarget||n.fromElement)&&(pa(b)||b[Dr]))break e;if((x||m)&&(m=h.window===h?h:(m=h.ownerDocument)?m.defaultView||m.parentWindow:window,x?(b=n.relatedTarget||n.toElement,x=u,b=b?pa(b):null,b!==null&&(E=Ha(b),b!==E||b.tag!==5&&b.tag!==6)&&(b=null)):(x=null,b=u),x!==b)){if(N=vb,I="onMouseLeave",w="onMouseEnter",v="mouse",(t==="pointerout"||t==="pointerover")&&(N=wb,I="onPointerLeave",w="onPointerEnter",v="pointer"),E=x==null?m:So(x),T=b==null?m:So(b),m=new N(I,v+"leave",x,n,h),m.target=E,m.relatedTarget=T,I=null,pa(h)===u&&(N=new N(w,v+"enter",b,n,h),N.target=T,N.relatedTarget=E,I=N),E=I,x&&b)t:{for(N=x,w=b,v=0,T=N;T;T=lo(T))v++;for(T=0,I=w;I;I=lo(I))T++;for(;0<v-T;)N=lo(N),v--;for(;0<T-v;)w=lo(w),T--;for(;v--;){if(N===w||w!==null&&N===w.alternate)break t;N=lo(N),w=lo(w)}N=null}else N=null;x!==null&&Rb(f,m,x,N,!1),b!==null&&E!==null&&Rb(f,E,b,N,!0)}}e:{if(m=u?So(u):window,x=m.nodeName&&m.nodeName.toLowerCase(),x==="select"||x==="input"&&m.type==="file")var R=jP;else if(Eb(m))if(FT)R=AP;else{R=IP;var V=kP}else(x=m.nodeName)&&x.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(R=CP);if(R&&(R=R(t,u))){OT(f,R,n,h);break e}V&&V(t,m,u),t==="focusout"&&(V=m._wrapperState)&&V.controlled&&m.type==="number"&&Wp(m,"number",m.value)}switch(V=u?So(u):window,t){case"focusin":(Eb(V)||V.contentEditable==="true")&&(Eo=V,sg=u,Tc=null);break;case"focusout":Tc=sg=Eo=null;break;case"mousedown":rg=!0;break;case"contextmenu":case"mouseup":case"dragend":rg=!1,Ib(f,n,h);break;case"selectionchange":if(DP)break;case"keydown":case"keyup":Ib(f,n,h)}var j;if(Zx)e:{switch(t){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else No?MT(t,n)&&(y="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(y="onCompositionStart");y&&(VT&&n.locale!=="ko"&&(No||y!=="onCompositionStart"?y==="onCompositionEnd"&&No&&(j=DT()):(xi=h,Yx="value"in xi?xi.value:xi.textContent,No=!0)),V=Rh(u,y),0<V.length&&(y=new bb(y,t,null,n,h),f.push({event:y,listeners:V}),j?y.data=j:(j=LT(n),j!==null&&(y.data=j)))),(j=_P?NP(t,n):EP(t,n))&&(u=Rh(u,"onBeforeInput"),0<u.length&&(h=new bb("onBeforeInput","beforeinput",null,n,h),f.push({event:h,listeners:u}),h.data=j))}QT(f,e)})}function Jc(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Rh(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Wc(t,n),i!=null&&s.unshift(Jc(t,i,r)),i=Wc(t,e),i!=null&&s.push(Jc(t,i,r))),t=t.return}return s}function lo(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Rb(t,e,n,s,r){for(var i=e._reactName,o=[];n!==null&&n!==s;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&u!==null&&(l=u,r?(c=Wc(n,i),c!=null&&o.unshift(Jc(n,c,l))):r||(c=Wc(n,i),c!=null&&o.push(Jc(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var OP=/\r\n?/g,FP=/\u0000|\uFFFD/g;function Pb(t){return(typeof t=="string"?t:""+t).replace(OP,`
`).replace(FP,"")}function Id(t,e,n){if(e=Pb(e),Pb(t)!==e&&n)throw Error(ie(425))}function Ph(){}var ig=null,ag=null;function og(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lg=typeof setTimeout=="function"?setTimeout:void 0,UP=typeof clearTimeout=="function"?clearTimeout:void 0,Db=typeof Promise=="function"?Promise:void 0,BP=typeof queueMicrotask=="function"?queueMicrotask:typeof Db<"u"?function(t){return Db.resolve(null).then(t).catch($P)}:lg;function $P(t){setTimeout(function(){throw t})}function Gm(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),Kc(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);Kc(e)}function Ei(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Vb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var wl=Math.random().toString(36).slice(2),er="__reactFiber$"+wl,Zc="__reactProps$"+wl,Dr="__reactContainer$"+wl,cg="__reactEvents$"+wl,zP="__reactListeners$"+wl,qP="__reactHandles$"+wl;function pa(t){var e=t[er];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Dr]||n[er]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Vb(t);t!==null;){if(n=t[er])return n;t=Vb(t)}return e}t=n,n=t.parentNode}return null}function Cu(t){return t=t[er]||t[Dr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function So(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ie(33))}function Vf(t){return t[Zc]||null}var ug=[],jo=-1;function Bi(t){return{current:t}}function gt(t){0>jo||(t.current=ug[jo],ug[jo]=null,jo--)}function ct(t,e){jo++,ug[jo]=t.current,t.current=e}var Di={},Rn=Bi(Di),ts=Bi(!1),ka=Di;function Jo(t,e){var n=t.type.contextTypes;if(!n)return Di;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in n)r[i]=e[i];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function ns(t){return t=t.childContextTypes,t!=null}function Dh(){gt(ts),gt(Rn)}function Mb(t,e,n){if(Rn.current!==Di)throw Error(ie(168));ct(Rn,e),ct(ts,n)}function XT(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ie(108,kR(t)||"Unknown",r));return Rt({},n,s)}function Vh(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Di,ka=Rn.current,ct(Rn,t),ct(ts,ts.current),!0}function Lb(t,e,n){var s=t.stateNode;if(!s)throw Error(ie(169));n?(t=XT(t,e,ka),s.__reactInternalMemoizedMergedChildContext=t,gt(ts),gt(Rn),ct(Rn,t)):gt(ts),ct(ts,n)}var wr=null,Mf=!1,Hm=!1;function JT(t){wr===null?wr=[t]:wr.push(t)}function WP(t){Mf=!0,JT(t)}function $i(){if(!Hm&&wr!==null){Hm=!0;var t=0,e=st;try{var n=wr;for(st=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}wr=null,Mf=!1}catch(r){throw wr!==null&&(wr=wr.slice(t+1)),NT(Gx,$i),r}finally{st=e,Hm=!1}}return null}var ko=[],Io=0,Mh=null,Lh=0,Es=[],Ts=0,Ia=null,Nr=1,Er="";function ra(t,e){ko[Io++]=Lh,ko[Io++]=Mh,Mh=t,Lh=e}function ZT(t,e,n){Es[Ts++]=Nr,Es[Ts++]=Er,Es[Ts++]=Ia,Ia=t;var s=Nr;t=Er;var r=32-zs(s)-1;s&=~(1<<r),n+=1;var i=32-zs(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Nr=1<<32-zs(e)+r|n<<r|s,Er=i+t}else Nr=1<<i|n<<r|s,Er=t}function ty(t){t.return!==null&&(ra(t,1),ZT(t,1,0))}function ny(t){for(;t===Mh;)Mh=ko[--Io],ko[Io]=null,Lh=ko[--Io],ko[Io]=null;for(;t===Ia;)Ia=Es[--Ts],Es[Ts]=null,Er=Es[--Ts],Es[Ts]=null,Nr=Es[--Ts],Es[Ts]=null}var fs=null,us=null,wt=!1,$s=null;function eS(t,e){var n=Ss(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Ob(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fs=t,us=Ei(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fs=t,us=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ia!==null?{id:Nr,overflow:Er}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Ss(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fs=t,us=null,!0):!1;default:return!1}}function dg(t){return(t.mode&1)!==0&&(t.flags&128)===0}function hg(t){if(wt){var e=us;if(e){var n=e;if(!Ob(t,e)){if(dg(t))throw Error(ie(418));e=Ei(n.nextSibling);var s=fs;e&&Ob(t,e)?eS(s,n):(t.flags=t.flags&-4097|2,wt=!1,fs=t)}}else{if(dg(t))throw Error(ie(418));t.flags=t.flags&-4097|2,wt=!1,fs=t}}}function Fb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fs=t}function Cd(t){if(t!==fs)return!1;if(!wt)return Fb(t),wt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!og(t.type,t.memoizedProps)),e&&(e=us)){if(dg(t))throw tS(),Error(ie(418));for(;e;)eS(t,e),e=Ei(e.nextSibling)}if(Fb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ie(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){us=Ei(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}us=null}}else us=fs?Ei(t.stateNode.nextSibling):null;return!0}function tS(){for(var t=us;t;)t=Ei(t.nextSibling)}function Zo(){us=fs=null,wt=!1}function sy(t){$s===null?$s=[t]:$s.push(t)}var GP=qr.ReactCurrentBatchConfig;function Zl(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ie(309));var s=n.stateNode}if(!s)throw Error(ie(147,t));var r=s,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=r.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(ie(284));if(!n._owner)throw Error(ie(290,t))}return t}function Ad(t,e){throw t=Object.prototype.toString.call(e),Error(ie(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Ub(t){var e=t._init;return e(t._payload)}function nS(t){function e(w,v){if(t){var T=w.deletions;T===null?(w.deletions=[v],w.flags|=16):T.push(v)}}function n(w,v){if(!t)return null;for(;v!==null;)e(w,v),v=v.sibling;return null}function s(w,v){for(w=new Map;v!==null;)v.key!==null?w.set(v.key,v):w.set(v.index,v),v=v.sibling;return w}function r(w,v){return w=ki(w,v),w.index=0,w.sibling=null,w}function i(w,v,T){return w.index=T,t?(T=w.alternate,T!==null?(T=T.index,T<v?(w.flags|=2,v):T):(w.flags|=2,v)):(w.flags|=1048576,v)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,v,T,I){return v===null||v.tag!==6?(v=ep(T,w.mode,I),v.return=w,v):(v=r(v,T),v.return=w,v)}function c(w,v,T,I){var R=T.type;return R===_o?h(w,v,T.props.children,I,T.key):v!==null&&(v.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===li&&Ub(R)===v.type)?(I=r(v,T.props),I.ref=Zl(w,v,T),I.return=w,I):(I=oh(T.type,T.key,T.props,null,w.mode,I),I.ref=Zl(w,v,T),I.return=w,I)}function u(w,v,T,I){return v===null||v.tag!==4||v.stateNode.containerInfo!==T.containerInfo||v.stateNode.implementation!==T.implementation?(v=tp(T,w.mode,I),v.return=w,v):(v=r(v,T.children||[]),v.return=w,v)}function h(w,v,T,I,R){return v===null||v.tag!==7?(v=wa(T,w.mode,I,R),v.return=w,v):(v=r(v,T),v.return=w,v)}function f(w,v,T){if(typeof v=="string"&&v!==""||typeof v=="number")return v=ep(""+v,w.mode,T),v.return=w,v;if(typeof v=="object"&&v!==null){switch(v.$$typeof){case bd:return T=oh(v.type,v.key,v.props,null,w.mode,T),T.ref=Zl(w,null,v),T.return=w,T;case wo:return v=tp(v,w.mode,T),v.return=w,v;case li:var I=v._init;return f(w,I(v._payload),T)}if(uc(v)||Kl(v))return v=wa(v,w.mode,T,null),v.return=w,v;Ad(w,v)}return null}function m(w,v,T,I){var R=v!==null?v.key:null;if(typeof T=="string"&&T!==""||typeof T=="number")return R!==null?null:l(w,v,""+T,I);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case bd:return T.key===R?c(w,v,T,I):null;case wo:return T.key===R?u(w,v,T,I):null;case li:return R=T._init,m(w,v,R(T._payload),I)}if(uc(T)||Kl(T))return R!==null?null:h(w,v,T,I,null);Ad(w,T)}return null}function x(w,v,T,I,R){if(typeof I=="string"&&I!==""||typeof I=="number")return w=w.get(T)||null,l(v,w,""+I,R);if(typeof I=="object"&&I!==null){switch(I.$$typeof){case bd:return w=w.get(I.key===null?T:I.key)||null,c(v,w,I,R);case wo:return w=w.get(I.key===null?T:I.key)||null,u(v,w,I,R);case li:var V=I._init;return x(w,v,T,V(I._payload),R)}if(uc(I)||Kl(I))return w=w.get(T)||null,h(v,w,I,R,null);Ad(v,I)}return null}function b(w,v,T,I){for(var R=null,V=null,j=v,y=v=0,k=null;j!==null&&y<T.length;y++){j.index>y?(k=j,j=null):k=j.sibling;var S=m(w,j,T[y],I);if(S===null){j===null&&(j=k);break}t&&j&&S.alternate===null&&e(w,j),v=i(S,v,y),V===null?R=S:V.sibling=S,V=S,j=k}if(y===T.length)return n(w,j),wt&&ra(w,y),R;if(j===null){for(;y<T.length;y++)j=f(w,T[y],I),j!==null&&(v=i(j,v,y),V===null?R=j:V.sibling=j,V=j);return wt&&ra(w,y),R}for(j=s(w,j);y<T.length;y++)k=x(j,w,y,T[y],I),k!==null&&(t&&k.alternate!==null&&j.delete(k.key===null?y:k.key),v=i(k,v,y),V===null?R=k:V.sibling=k,V=k);return t&&j.forEach(function(D){return e(w,D)}),wt&&ra(w,y),R}function N(w,v,T,I){var R=Kl(T);if(typeof R!="function")throw Error(ie(150));if(T=R.call(T),T==null)throw Error(ie(151));for(var V=R=null,j=v,y=v=0,k=null,S=T.next();j!==null&&!S.done;y++,S=T.next()){j.index>y?(k=j,j=null):k=j.sibling;var D=m(w,j,S.value,I);if(D===null){j===null&&(j=k);break}t&&j&&D.alternate===null&&e(w,j),v=i(D,v,y),V===null?R=D:V.sibling=D,V=D,j=k}if(S.done)return n(w,j),wt&&ra(w,y),R;if(j===null){for(;!S.done;y++,S=T.next())S=f(w,S.value,I),S!==null&&(v=i(S,v,y),V===null?R=S:V.sibling=S,V=S);return wt&&ra(w,y),R}for(j=s(w,j);!S.done;y++,S=T.next())S=x(j,w,y,S.value,I),S!==null&&(t&&S.alternate!==null&&j.delete(S.key===null?y:S.key),v=i(S,v,y),V===null?R=S:V.sibling=S,V=S);return t&&j.forEach(function(P){return e(w,P)}),wt&&ra(w,y),R}function E(w,v,T,I){if(typeof T=="object"&&T!==null&&T.type===_o&&T.key===null&&(T=T.props.children),typeof T=="object"&&T!==null){switch(T.$$typeof){case bd:e:{for(var R=T.key,V=v;V!==null;){if(V.key===R){if(R=T.type,R===_o){if(V.tag===7){n(w,V.sibling),v=r(V,T.props.children),v.return=w,w=v;break e}}else if(V.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===li&&Ub(R)===V.type){n(w,V.sibling),v=r(V,T.props),v.ref=Zl(w,V,T),v.return=w,w=v;break e}n(w,V);break}else e(w,V);V=V.sibling}T.type===_o?(v=wa(T.props.children,w.mode,I,T.key),v.return=w,w=v):(I=oh(T.type,T.key,T.props,null,w.mode,I),I.ref=Zl(w,v,T),I.return=w,w=I)}return o(w);case wo:e:{for(V=T.key;v!==null;){if(v.key===V)if(v.tag===4&&v.stateNode.containerInfo===T.containerInfo&&v.stateNode.implementation===T.implementation){n(w,v.sibling),v=r(v,T.children||[]),v.return=w,w=v;break e}else{n(w,v);break}else e(w,v);v=v.sibling}v=tp(T,w.mode,I),v.return=w,w=v}return o(w);case li:return V=T._init,E(w,v,V(T._payload),I)}if(uc(T))return b(w,v,T,I);if(Kl(T))return N(w,v,T,I);Ad(w,T)}return typeof T=="string"&&T!==""||typeof T=="number"?(T=""+T,v!==null&&v.tag===6?(n(w,v.sibling),v=r(v,T),v.return=w,w=v):(n(w,v),v=ep(T,w.mode,I),v.return=w,w=v),o(w)):n(w,v)}return E}var el=nS(!0),sS=nS(!1),Oh=Bi(null),Fh=null,Co=null,ry=null;function iy(){ry=Co=Fh=null}function ay(t){var e=Oh.current;gt(Oh),t._currentValue=e}function fg(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function zo(t,e){Fh=t,ry=Co=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Xn=!0),t.firstContext=null)}function As(t){var e=t._currentValue;if(ry!==t)if(t={context:t,memoizedValue:e,next:null},Co===null){if(Fh===null)throw Error(ie(308));Co=t,Fh.dependencies={lanes:0,firstContext:t}}else Co=Co.next=t;return e}var ga=null;function oy(t){ga===null?ga=[t]:ga.push(t)}function rS(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,oy(e)):(n.next=r.next,r.next=n),e.interleaved=n,Vr(t,s)}function Vr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var ci=!1;function ly(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function iS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Cr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Ti(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,Xe&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,Vr(t,n)}return r=s.interleaved,r===null?(e.next=e,oy(s)):(e.next=r.next,r.next=e),s.interleaved=e,Vr(t,n)}function th(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Hx(t,n)}}function Bb(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?r=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?r=i=e:i=i.next=e}else r=i=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Uh(t,e,n,s){var r=t.updateQueue;ci=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var h=t.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=u:l.next=u,h.lastBaseUpdate=c))}if(i!==null){var f=r.baseState;o=0,h=u=c=null,l=i;do{var m=l.lane,x=l.eventTime;if((s&m)===m){h!==null&&(h=h.next={eventTime:x,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=t,N=l;switch(m=e,x=n,N.tag){case 1:if(b=N.payload,typeof b=="function"){f=b.call(x,f,m);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=N.payload,m=typeof b=="function"?b.call(x,f,m):b,m==null)break e;f=Rt({},f,m);break e;case 2:ci=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,m=r.effects,m===null?r.effects=[l]:m.push(l))}else x={eventTime:x,lane:m,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(u=h=x,c=f):h=h.next=x,o|=m;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;m=l,l=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(!0);if(h===null&&(c=f),r.baseState=c,r.firstBaseUpdate=u,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);Aa|=o,t.lanes=o,t.memoizedState=f}}function $b(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(ie(191,r));r.call(s)}}}var Au={},ar=Bi(Au),eu=Bi(Au),tu=Bi(Au);function xa(t){if(t===Au)throw Error(ie(174));return t}function cy(t,e){switch(ct(tu,e),ct(eu,t),ct(ar,Au),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Hp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Hp(e,t)}gt(ar),ct(ar,e)}function tl(){gt(ar),gt(eu),gt(tu)}function aS(t){xa(tu.current);var e=xa(ar.current),n=Hp(e,t.type);e!==n&&(ct(eu,t),ct(ar,n))}function uy(t){eu.current===t&&(gt(ar),gt(eu))}var Tt=Bi(0);function Bh(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Km=[];function dy(){for(var t=0;t<Km.length;t++)Km[t]._workInProgressVersionPrimary=null;Km.length=0}var nh=qr.ReactCurrentDispatcher,Qm=qr.ReactCurrentBatchConfig,Ca=0,Ct=null,Jt=null,ln=null,$h=!1,Sc=!1,nu=0,HP=0;function Nn(){throw Error(ie(321))}function hy(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Ws(t[n],e[n]))return!1;return!0}function fy(t,e,n,s,r,i){if(Ca=i,Ct=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,nh.current=t===null||t.memoizedState===null?XP:JP,t=n(s,r),Sc){i=0;do{if(Sc=!1,nu=0,25<=i)throw Error(ie(301));i+=1,ln=Jt=null,e.updateQueue=null,nh.current=ZP,t=n(s,r)}while(Sc)}if(nh.current=zh,e=Jt!==null&&Jt.next!==null,Ca=0,ln=Jt=Ct=null,$h=!1,e)throw Error(ie(300));return t}function my(){var t=nu!==0;return nu=0,t}function Zs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ln===null?Ct.memoizedState=ln=t:ln=ln.next=t,ln}function Rs(){if(Jt===null){var t=Ct.alternate;t=t!==null?t.memoizedState:null}else t=Jt.next;var e=ln===null?Ct.memoizedState:ln.next;if(e!==null)ln=e,Jt=t;else{if(t===null)throw Error(ie(310));Jt=t,t={memoizedState:Jt.memoizedState,baseState:Jt.baseState,baseQueue:Jt.baseQueue,queue:Jt.queue,next:null},ln===null?Ct.memoizedState=ln=t:ln=ln.next=t}return ln}function su(t,e){return typeof e=="function"?e(t):e}function Ym(t){var e=Rs(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var s=Jt,r=s.baseQueue,i=n.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,n.pending=null}if(r!==null){i=r.next,s=s.baseState;var l=o=null,c=null,u=i;do{var h=u.lane;if((Ca&h)===h)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),s=u.hasEagerState?u.eagerState:t(s,u.action);else{var f={lane:h,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=f,o=s):c=c.next=f,Ct.lanes|=h,Aa|=h}u=u.next}while(u!==null&&u!==i);c===null?o=s:c.next=l,Ws(s,e.memoizedState)||(Xn=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do i=r.lane,Ct.lanes|=i,Aa|=i,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Xm(t){var e=Rs(),n=e.queue;if(n===null)throw Error(ie(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,i=e.memoizedState;if(r!==null){n.pending=null;var o=r=r.next;do i=t(i,o.action),o=o.next;while(o!==r);Ws(i,e.memoizedState)||(Xn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,s]}function oS(){}function lS(t,e){var n=Ct,s=Rs(),r=e(),i=!Ws(s.memoizedState,r);if(i&&(s.memoizedState=r,Xn=!0),s=s.queue,py(dS.bind(null,n,s,t),[t]),s.getSnapshot!==e||i||ln!==null&&ln.memoizedState.tag&1){if(n.flags|=2048,ru(9,uS.bind(null,n,s,r,e),void 0,null),cn===null)throw Error(ie(349));Ca&30||cS(n,e,r)}return r}function cS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ct.updateQueue,e===null?(e={lastEffect:null,stores:null},Ct.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function uS(t,e,n,s){e.value=n,e.getSnapshot=s,hS(e)&&fS(t)}function dS(t,e,n){return n(function(){hS(e)&&fS(t)})}function hS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Ws(t,n)}catch{return!0}}function fS(t){var e=Vr(t,1);e!==null&&qs(e,t,1,-1)}function zb(t){var e=Zs();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:su,lastRenderedState:t},e.queue=t,t=t.dispatch=YP.bind(null,Ct,t),[e.memoizedState,t]}function ru(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Ct.updateQueue,e===null?(e={lastEffect:null,stores:null},Ct.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function mS(){return Rs().memoizedState}function sh(t,e,n,s){var r=Zs();Ct.flags|=t,r.memoizedState=ru(1|e,n,void 0,s===void 0?null:s)}function Lf(t,e,n,s){var r=Rs();s=s===void 0?null:s;var i=void 0;if(Jt!==null){var o=Jt.memoizedState;if(i=o.destroy,s!==null&&hy(s,o.deps)){r.memoizedState=ru(e,n,i,s);return}}Ct.flags|=t,r.memoizedState=ru(1|e,n,i,s)}function qb(t,e){return sh(8390656,8,t,e)}function py(t,e){return Lf(2048,8,t,e)}function pS(t,e){return Lf(4,2,t,e)}function gS(t,e){return Lf(4,4,t,e)}function xS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function yS(t,e,n){return n=n!=null?n.concat([t]):null,Lf(4,4,xS.bind(null,e,t),n)}function gy(){}function vS(t,e){var n=Rs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&hy(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function bS(t,e){var n=Rs();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&hy(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function wS(t,e,n){return Ca&21?(Ws(n,e)||(n=ST(),Ct.lanes|=n,Aa|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Xn=!0),t.memoizedState=n)}function KP(t,e){var n=st;st=n!==0&&4>n?n:4,t(!0);var s=Qm.transition;Qm.transition={};try{t(!1),e()}finally{st=n,Qm.transition=s}}function _S(){return Rs().memoizedState}function QP(t,e,n){var s=ji(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},NS(t))ES(e,n);else if(n=rS(t,e,n,s),n!==null){var r=Fn();qs(n,t,s,r),TS(n,e,s)}}function YP(t,e,n){var s=ji(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(NS(t))ES(e,r);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(r.hasEagerState=!0,r.eagerState=l,Ws(l,o)){var c=e.interleaved;c===null?(r.next=r,oy(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}n=rS(t,e,r,s),n!==null&&(r=Fn(),qs(n,t,s,r),TS(n,e,s))}}function NS(t){var e=t.alternate;return t===Ct||e!==null&&e===Ct}function ES(t,e){Sc=$h=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function TS(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Hx(t,n)}}var zh={readContext:As,useCallback:Nn,useContext:Nn,useEffect:Nn,useImperativeHandle:Nn,useInsertionEffect:Nn,useLayoutEffect:Nn,useMemo:Nn,useReducer:Nn,useRef:Nn,useState:Nn,useDebugValue:Nn,useDeferredValue:Nn,useTransition:Nn,useMutableSource:Nn,useSyncExternalStore:Nn,useId:Nn,unstable_isNewReconciler:!1},XP={readContext:As,useCallback:function(t,e){return Zs().memoizedState=[t,e===void 0?null:e],t},useContext:As,useEffect:qb,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,sh(4194308,4,xS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return sh(4194308,4,t,e)},useInsertionEffect:function(t,e){return sh(4,2,t,e)},useMemo:function(t,e){var n=Zs();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=Zs();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=QP.bind(null,Ct,t),[s.memoizedState,t]},useRef:function(t){var e=Zs();return t={current:t},e.memoizedState=t},useState:zb,useDebugValue:gy,useDeferredValue:function(t){return Zs().memoizedState=t},useTransition:function(){var t=zb(!1),e=t[0];return t=KP.bind(null,t[1]),Zs().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Ct,r=Zs();if(wt){if(n===void 0)throw Error(ie(407));n=n()}else{if(n=e(),cn===null)throw Error(ie(349));Ca&30||cS(s,e,n)}r.memoizedState=n;var i={value:n,getSnapshot:e};return r.queue=i,qb(dS.bind(null,s,i,t),[t]),s.flags|=2048,ru(9,uS.bind(null,s,i,n,e),void 0,null),n},useId:function(){var t=Zs(),e=cn.identifierPrefix;if(wt){var n=Er,s=Nr;n=(s&~(1<<32-zs(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=nu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=HP++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},JP={readContext:As,useCallback:vS,useContext:As,useEffect:py,useImperativeHandle:yS,useInsertionEffect:pS,useLayoutEffect:gS,useMemo:bS,useReducer:Ym,useRef:mS,useState:function(){return Ym(su)},useDebugValue:gy,useDeferredValue:function(t){var e=Rs();return wS(e,Jt.memoizedState,t)},useTransition:function(){var t=Ym(su)[0],e=Rs().memoizedState;return[t,e]},useMutableSource:oS,useSyncExternalStore:lS,useId:_S,unstable_isNewReconciler:!1},ZP={readContext:As,useCallback:vS,useContext:As,useEffect:py,useImperativeHandle:yS,useInsertionEffect:pS,useLayoutEffect:gS,useMemo:bS,useReducer:Xm,useRef:mS,useState:function(){return Xm(su)},useDebugValue:gy,useDeferredValue:function(t){var e=Rs();return Jt===null?e.memoizedState=t:wS(e,Jt.memoizedState,t)},useTransition:function(){var t=Xm(su)[0],e=Rs().memoizedState;return[t,e]},useMutableSource:oS,useSyncExternalStore:lS,useId:_S,unstable_isNewReconciler:!1};function Us(t,e){if(t&&t.defaultProps){e=Rt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function mg(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Rt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Of={isMounted:function(t){return(t=t._reactInternals)?Ha(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=Fn(),r=ji(t),i=Cr(s,r);i.payload=e,n!=null&&(i.callback=n),e=Ti(t,i,r),e!==null&&(qs(e,t,r,s),th(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=Fn(),r=ji(t),i=Cr(s,r);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=Ti(t,i,r),e!==null&&(qs(e,t,r,s),th(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Fn(),s=ji(t),r=Cr(n,s);r.tag=2,e!=null&&(r.callback=e),e=Ti(t,r,s),e!==null&&(qs(e,t,s,n),th(e,t,s))}};function Wb(t,e,n,s,r,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Yc(n,s)||!Yc(r,i):!0}function SS(t,e,n){var s=!1,r=Di,i=e.contextType;return typeof i=="object"&&i!==null?i=As(i):(r=ns(e)?ka:Rn.current,s=e.contextTypes,i=(s=s!=null)?Jo(t,r):Di),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Of,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=i),e}function Gb(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&Of.enqueueReplaceState(e,e.state,null)}function pg(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},ly(t);var i=e.contextType;typeof i=="object"&&i!==null?r.context=As(i):(i=ns(e)?ka:Rn.current,r.context=Jo(t,i)),r.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(mg(t,e,i,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Of.enqueueReplaceState(r,r.state,null),Uh(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function nl(t,e){try{var n="",s=e;do n+=jR(s),s=s.return;while(s);var r=n}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:r,digest:null}}function Jm(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function gg(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var e2=typeof WeakMap=="function"?WeakMap:Map;function jS(t,e,n){n=Cr(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){Wh||(Wh=!0,Sg=s),gg(t,e)},n}function kS(t,e,n){n=Cr(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){gg(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){gg(t,e),typeof s!="function"&&(Si===null?Si=new Set([this]):Si.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function Hb(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new e2;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=m2.bind(null,t,e,n),e.then(t,t))}function Kb(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Qb(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Cr(-1,1),e.tag=2,Ti(n,e,1))),n.lanes|=1),t)}var t2=qr.ReactCurrentOwner,Xn=!1;function Ln(t,e,n,s){e.child=t===null?sS(e,null,n,s):el(e,t.child,n,s)}function Yb(t,e,n,s,r){n=n.render;var i=e.ref;return zo(e,r),s=fy(t,e,n,s,i,r),n=my(),t!==null&&!Xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Mr(t,e,r)):(wt&&n&&ty(e),e.flags|=1,Ln(t,e,s,r),e.child)}function Xb(t,e,n,s,r){if(t===null){var i=n.type;return typeof i=="function"&&!Ey(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,IS(t,e,i,s,r)):(t=oh(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&r)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:Yc,n(o,s)&&t.ref===e.ref)return Mr(t,e,r)}return e.flags|=1,t=ki(i,s),t.ref=e.ref,t.return=e,e.child=t}function IS(t,e,n,s,r){if(t!==null){var i=t.memoizedProps;if(Yc(i,s)&&t.ref===e.ref)if(Xn=!1,e.pendingProps=s=i,(t.lanes&r)!==0)t.flags&131072&&(Xn=!0);else return e.lanes=t.lanes,Mr(t,e,r)}return xg(t,e,n,s,r)}function CS(t,e,n){var s=e.pendingProps,r=s.children,i=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},ct(Ro,cs),cs|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,ct(Ro,cs),cs|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:n,ct(Ro,cs),cs|=s}else i!==null?(s=i.baseLanes|n,e.memoizedState=null):s=n,ct(Ro,cs),cs|=s;return Ln(t,e,r,n),e.child}function AS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function xg(t,e,n,s,r){var i=ns(n)?ka:Rn.current;return i=Jo(e,i),zo(e,r),n=fy(t,e,n,s,i,r),s=my(),t!==null&&!Xn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,Mr(t,e,r)):(wt&&s&&ty(e),e.flags|=1,Ln(t,e,n,r),e.child)}function Jb(t,e,n,s,r){if(ns(n)){var i=!0;Vh(e)}else i=!1;if(zo(e,r),e.stateNode===null)rh(t,e),SS(e,n,s),pg(e,n,s,r),s=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=As(u):(u=ns(n)?ka:Rn.current,u=Jo(e,u));var h=n.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==u)&&Gb(e,o,s,u),ci=!1;var m=e.memoizedState;o.state=m,Uh(e,s,o,r),c=e.memoizedState,l!==s||m!==c||ts.current||ci?(typeof h=="function"&&(mg(e,n,h,s),c=e.memoizedState),(l=ci||Wb(e,n,l,s,m,c,u))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=u,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,iS(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:Us(e.type,l),o.props=u,f=e.pendingProps,m=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=As(c):(c=ns(n)?ka:Rn.current,c=Jo(e,c));var x=n.getDerivedStateFromProps;(h=typeof x=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||m!==c)&&Gb(e,o,s,c),ci=!1,m=e.memoizedState,o.state=m,Uh(e,s,o,r);var b=e.memoizedState;l!==f||m!==b||ts.current||ci?(typeof x=="function"&&(mg(e,n,x,s),b=e.memoizedState),(u=ci||Wb(e,n,u,s,m,b,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=b),o.props=s,o.state=b,o.context=c,s=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),s=!1)}return yg(t,e,n,s,i,r)}function yg(t,e,n,s,r,i){AS(t,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&Lb(e,n,!1),Mr(t,e,i);s=e.stateNode,t2.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&o?(e.child=el(e,t.child,null,i),e.child=el(e,null,l,i)):Ln(t,e,l,i),e.memoizedState=s.state,r&&Lb(e,n,!0),e.child}function RS(t){var e=t.stateNode;e.pendingContext?Mb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Mb(t,e.context,!1),cy(t,e.containerInfo)}function Zb(t,e,n,s,r){return Zo(),sy(r),e.flags|=256,Ln(t,e,n,s),e.child}var vg={dehydrated:null,treeContext:null,retryLane:0};function bg(t){return{baseLanes:t,cachePool:null,transitions:null}}function PS(t,e,n){var s=e.pendingProps,r=Tt.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(r&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),ct(Tt,r&1),t===null)return hg(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,t=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Bf(o,s,0,null),t=wa(t,s,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=bg(n),e.memoizedState=vg,t):xy(e,o));if(r=t.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return n2(t,e,o,s,l,r,n);if(i){i=s.fallback,o=e.mode,r=t.child,l=r.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=ki(r,c),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?i=ki(l,i):(i=wa(i,o,n,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=t.child.memoizedState,o=o===null?bg(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=vg,s}return i=t.child,t=i.sibling,s=ki(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function xy(t,e){return e=Bf({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Rd(t,e,n,s){return s!==null&&sy(s),el(e,t.child,null,n),t=xy(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function n2(t,e,n,s,r,i,o){if(n)return e.flags&256?(e.flags&=-257,s=Jm(Error(ie(422))),Rd(t,e,o,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=Bf({mode:"visible",children:s.children},r,0,null),i=wa(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&el(e,t.child,null,o),e.child.memoizedState=bg(o),e.memoizedState=vg,i);if(!(e.mode&1))return Rd(t,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(ie(419)),s=Jm(i,s,void 0),Rd(t,e,o,s)}if(l=(o&t.childLanes)!==0,Xn||l){if(s=cn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,Vr(t,r),qs(s,t,r,-1))}return Ny(),s=Jm(Error(ie(421))),Rd(t,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=p2.bind(null,t),r._reactRetry=e,null):(t=i.treeContext,us=Ei(r.nextSibling),fs=e,wt=!0,$s=null,t!==null&&(Es[Ts++]=Nr,Es[Ts++]=Er,Es[Ts++]=Ia,Nr=t.id,Er=t.overflow,Ia=e),e=xy(e,s.children),e.flags|=4096,e)}function ew(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),fg(t.return,e,n)}function Zm(t,e,n,s,r){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=n,i.tailMode=r)}function DS(t,e,n){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(Ln(t,e,s.children,n),s=Tt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&ew(t,n,e);else if(t.tag===19)ew(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(ct(Tt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&Bh(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Zm(e,!1,r,n,i);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&Bh(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Zm(e,!0,n,null,i);break;case"together":Zm(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function rh(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function Mr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Aa|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ie(153));if(e.child!==null){for(t=e.child,n=ki(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ki(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function s2(t,e,n){switch(e.tag){case 3:RS(e),Zo();break;case 5:aS(e);break;case 1:ns(e.type)&&Vh(e);break;case 4:cy(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;ct(Oh,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(ct(Tt,Tt.current&1),e.flags|=128,null):n&e.child.childLanes?PS(t,e,n):(ct(Tt,Tt.current&1),t=Mr(t,e,n),t!==null?t.sibling:null);ct(Tt,Tt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return DS(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),ct(Tt,Tt.current),s)break;return null;case 22:case 23:return e.lanes=0,CS(t,e,n)}return Mr(t,e,n)}var VS,wg,MS,LS;VS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};wg=function(){};MS=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,xa(ar.current);var i=null;switch(n){case"input":r=zp(t,r),s=zp(t,s),i=[];break;case"select":r=Rt({},r,{value:void 0}),s=Rt({},s,{value:void 0}),i=[];break;case"textarea":r=Gp(t,r),s=Gp(t,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=Ph)}Kp(n,s);var o;n=null;for(u in r)if(!s.hasOwnProperty(u)&&r.hasOwnProperty(u)&&r[u]!=null)if(u==="style"){var l=r[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(zc.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in s){var c=s[u];if(l=r!=null?r[u]:void 0,s.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(zc.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&ft("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};LS=function(t,e,n,s){n!==s&&(e.flags|=4)};function ec(t,e){if(!wt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function En(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function r2(t,e,n){var s=e.pendingProps;switch(ny(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return En(e),null;case 1:return ns(e.type)&&Dh(),En(e),null;case 3:return s=e.stateNode,tl(),gt(ts),gt(Rn),dy(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Cd(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,$s!==null&&(Ig($s),$s=null))),wg(t,e),En(e),null;case 5:uy(e);var r=xa(tu.current);if(n=e.type,t!==null&&e.stateNode!=null)MS(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ie(166));return En(e),null}if(t=xa(ar.current),Cd(e)){s=e.stateNode,n=e.type;var i=e.memoizedProps;switch(s[er]=e,s[Zc]=i,t=(e.mode&1)!==0,n){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(r=0;r<hc.length;r++)ft(hc[r],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":cb(s,i),ft("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},ft("invalid",s);break;case"textarea":db(s,i),ft("invalid",s)}Kp(n,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&Id(s.textContent,l,t),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Id(s.textContent,l,t),r=["children",""+l]):zc.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&ft("scroll",s)}switch(n){case"input":wd(s),ub(s,i,!0);break;case"textarea":wd(s),hb(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Ph)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=dT(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=o.createElement(n,{is:s.is}):(t=o.createElement(n),n==="select"&&(o=t,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):t=o.createElementNS(t,n),t[er]=e,t[Zc]=s,VS(t,e,!1,!1),e.stateNode=t;e:{switch(o=Qp(n,s),n){case"dialog":ft("cancel",t),ft("close",t),r=s;break;case"iframe":case"object":case"embed":ft("load",t),r=s;break;case"video":case"audio":for(r=0;r<hc.length;r++)ft(hc[r],t);r=s;break;case"source":ft("error",t),r=s;break;case"img":case"image":case"link":ft("error",t),ft("load",t),r=s;break;case"details":ft("toggle",t),r=s;break;case"input":cb(t,s),r=zp(t,s),ft("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Rt({},s,{value:void 0}),ft("invalid",t);break;case"textarea":db(t,s),r=Gp(t,s),ft("invalid",t);break;default:r=s}Kp(n,r),l=r;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?mT(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&hT(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&qc(t,c):typeof c=="number"&&qc(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(zc.hasOwnProperty(i)?c!=null&&i==="onScroll"&&ft("scroll",t):c!=null&&Bx(t,i,c,o))}switch(n){case"input":wd(t),ub(t,s,!1);break;case"textarea":wd(t),hb(t);break;case"option":s.value!=null&&t.setAttribute("value",""+Pi(s.value));break;case"select":t.multiple=!!s.multiple,i=s.value,i!=null?Fo(t,!!s.multiple,i,!1):s.defaultValue!=null&&Fo(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=Ph)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return En(e),null;case 6:if(t&&e.stateNode!=null)LS(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ie(166));if(n=xa(tu.current),xa(ar.current),Cd(e)){if(s=e.stateNode,n=e.memoizedProps,s[er]=e,(i=s.nodeValue!==n)&&(t=fs,t!==null))switch(t.tag){case 3:Id(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Id(s.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[er]=e,e.stateNode=s}return En(e),null;case 13:if(gt(Tt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(wt&&us!==null&&e.mode&1&&!(e.flags&128))tS(),Zo(),e.flags|=98560,i=!1;else if(i=Cd(e),s!==null&&s.dehydrated!==null){if(t===null){if(!i)throw Error(ie(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ie(317));i[er]=e}else Zo(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;En(e),i=!1}else $s!==null&&(Ig($s),$s=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Tt.current&1?en===0&&(en=3):Ny())),e.updateQueue!==null&&(e.flags|=4),En(e),null);case 4:return tl(),wg(t,e),t===null&&Xc(e.stateNode.containerInfo),En(e),null;case 10:return ay(e.type._context),En(e),null;case 17:return ns(e.type)&&Dh(),En(e),null;case 19:if(gt(Tt),i=e.memoizedState,i===null)return En(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)ec(i,!1);else{if(en!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Bh(t),o!==null){for(e.flags|=128,ec(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)i=n,t=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return ct(Tt,Tt.current&1|2),e.child}t=t.sibling}i.tail!==null&&Bt()>sl&&(e.flags|=128,s=!0,ec(i,!1),e.lanes=4194304)}else{if(!s)if(t=Bh(o),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),ec(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!wt)return En(e),null}else 2*Bt()-i.renderingStartTime>sl&&n!==1073741824&&(e.flags|=128,s=!0,ec(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Bt(),e.sibling=null,n=Tt.current,ct(Tt,s?n&1|2:n&1),e):(En(e),null);case 22:case 23:return _y(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?cs&1073741824&&(En(e),e.subtreeFlags&6&&(e.flags|=8192)):En(e),null;case 24:return null;case 25:return null}throw Error(ie(156,e.tag))}function i2(t,e){switch(ny(e),e.tag){case 1:return ns(e.type)&&Dh(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return tl(),gt(ts),gt(Rn),dy(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return uy(e),null;case 13:if(gt(Tt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ie(340));Zo()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return gt(Tt),null;case 4:return tl(),null;case 10:return ay(e.type._context),null;case 22:case 23:return _y(),null;case 24:return null;default:return null}}var Pd=!1,jn=!1,a2=typeof WeakSet=="function"?WeakSet:Set,ve=null;function Ao(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Ft(t,e,s)}else n.current=null}function _g(t,e,n){try{n()}catch(s){Ft(t,e,s)}}var tw=!1;function o2(t,e){if(ig=Ch,t=$T(),ey(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,h=0,f=t,m=null;t:for(;;){for(var x;f!==n||r!==0&&f.nodeType!==3||(l=o+r),f!==i||s!==0&&f.nodeType!==3||(c=o+s),f.nodeType===3&&(o+=f.nodeValue.length),(x=f.firstChild)!==null;)m=f,f=x;for(;;){if(f===t)break t;if(m===n&&++u===r&&(l=o),m===i&&++h===s&&(c=o),(x=f.nextSibling)!==null)break;f=m,m=f.parentNode}f=x}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(ag={focusedElem:t,selectionRange:n},Ch=!1,ve=e;ve!==null;)if(e=ve,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ve=t;else for(;ve!==null;){e=ve;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var N=b.memoizedProps,E=b.memoizedState,w=e.stateNode,v=w.getSnapshotBeforeUpdate(e.elementType===e.type?N:Us(e.type,N),E);w.__reactInternalSnapshotBeforeUpdate=v}break;case 3:var T=e.stateNode.containerInfo;T.nodeType===1?T.textContent="":T.nodeType===9&&T.documentElement&&T.removeChild(T.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ie(163))}}catch(I){Ft(e,e.return,I)}if(t=e.sibling,t!==null){t.return=e.return,ve=t;break}ve=e.return}return b=tw,tw=!1,b}function jc(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var i=r.destroy;r.destroy=void 0,i!==void 0&&_g(e,n,i)}r=r.next}while(r!==s)}}function Ff(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function Ng(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function OS(t){var e=t.alternate;e!==null&&(t.alternate=null,OS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[er],delete e[Zc],delete e[cg],delete e[zP],delete e[qP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function FS(t){return t.tag===5||t.tag===3||t.tag===4}function nw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||FS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function Eg(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Ph));else if(s!==4&&(t=t.child,t!==null))for(Eg(t,e,n),t=t.sibling;t!==null;)Eg(t,e,n),t=t.sibling}function Tg(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(Tg(t,e,n),t=t.sibling;t!==null;)Tg(t,e,n),t=t.sibling}var fn=null,Bs=!1;function si(t,e,n){for(n=n.child;n!==null;)US(t,e,n),n=n.sibling}function US(t,e,n){if(ir&&typeof ir.onCommitFiberUnmount=="function")try{ir.onCommitFiberUnmount(Af,n)}catch{}switch(n.tag){case 5:jn||Ao(n,e);case 6:var s=fn,r=Bs;fn=null,si(t,e,n),fn=s,Bs=r,fn!==null&&(Bs?(t=fn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):fn.removeChild(n.stateNode));break;case 18:fn!==null&&(Bs?(t=fn,n=n.stateNode,t.nodeType===8?Gm(t.parentNode,n):t.nodeType===1&&Gm(t,n),Kc(t)):Gm(fn,n.stateNode));break;case 4:s=fn,r=Bs,fn=n.stateNode.containerInfo,Bs=!0,si(t,e,n),fn=s,Bs=r;break;case 0:case 11:case 14:case 15:if(!jn&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&_g(n,e,o),r=r.next}while(r!==s)}si(t,e,n);break;case 1:if(!jn&&(Ao(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(l){Ft(n,e,l)}si(t,e,n);break;case 21:si(t,e,n);break;case 22:n.mode&1?(jn=(s=jn)||n.memoizedState!==null,si(t,e,n),jn=s):si(t,e,n);break;default:si(t,e,n)}}function sw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new a2),e.forEach(function(s){var r=g2.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Ls(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:fn=l.stateNode,Bs=!1;break e;case 3:fn=l.stateNode.containerInfo,Bs=!0;break e;case 4:fn=l.stateNode.containerInfo,Bs=!0;break e}l=l.return}if(fn===null)throw Error(ie(160));US(i,o,r),fn=null,Bs=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(u){Ft(r,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)BS(e,t),e=e.sibling}function BS(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Ls(e,t),Js(t),s&4){try{jc(3,t,t.return),Ff(3,t)}catch(N){Ft(t,t.return,N)}try{jc(5,t,t.return)}catch(N){Ft(t,t.return,N)}}break;case 1:Ls(e,t),Js(t),s&512&&n!==null&&Ao(n,n.return);break;case 5:if(Ls(e,t),Js(t),s&512&&n!==null&&Ao(n,n.return),t.flags&32){var r=t.stateNode;try{qc(r,"")}catch(N){Ft(t,t.return,N)}}if(s&4&&(r=t.stateNode,r!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&cT(r,i),Qp(l,o);var u=Qp(l,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?mT(r,f):h==="dangerouslySetInnerHTML"?hT(r,f):h==="children"?qc(r,f):Bx(r,h,f,u)}switch(l){case"input":qp(r,i);break;case"textarea":uT(r,i);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var x=i.value;x!=null?Fo(r,!!i.multiple,x,!1):m!==!!i.multiple&&(i.defaultValue!=null?Fo(r,!!i.multiple,i.defaultValue,!0):Fo(r,!!i.multiple,i.multiple?[]:"",!1))}r[Zc]=i}catch(N){Ft(t,t.return,N)}}break;case 6:if(Ls(e,t),Js(t),s&4){if(t.stateNode===null)throw Error(ie(162));r=t.stateNode,i=t.memoizedProps;try{r.nodeValue=i}catch(N){Ft(t,t.return,N)}}break;case 3:if(Ls(e,t),Js(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{Kc(e.containerInfo)}catch(N){Ft(t,t.return,N)}break;case 4:Ls(e,t),Js(t);break;case 13:Ls(e,t),Js(t),r=t.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(by=Bt())),s&4&&sw(t);break;case 22:if(h=n!==null&&n.memoizedState!==null,t.mode&1?(jn=(u=jn)||h,Ls(e,t),jn=u):Ls(e,t),Js(t),s&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!h&&t.mode&1)for(ve=t,h=t.child;h!==null;){for(f=ve=h;ve!==null;){switch(m=ve,x=m.child,m.tag){case 0:case 11:case 14:case 15:jc(4,m,m.return);break;case 1:Ao(m,m.return);var b=m.stateNode;if(typeof b.componentWillUnmount=="function"){s=m,n=m.return;try{e=s,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(N){Ft(s,n,N)}}break;case 5:Ao(m,m.return);break;case 22:if(m.memoizedState!==null){iw(f);continue}}x!==null?(x.return=m,ve=x):iw(f)}h=h.sibling}e:for(h=null,f=t;;){if(f.tag===5){if(h===null){h=f;try{r=f.stateNode,u?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=fT("display",o))}catch(N){Ft(t,t.return,N)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=u?"":f.memoizedProps}catch(N){Ft(t,t.return,N)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===t)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===t)break e;for(;f.sibling===null;){if(f.return===null||f.return===t)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Ls(e,t),Js(t),s&4&&sw(t);break;case 21:break;default:Ls(e,t),Js(t)}}function Js(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(FS(n)){var s=n;break e}n=n.return}throw Error(ie(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(qc(r,""),s.flags&=-33);var i=nw(t);Tg(t,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,l=nw(t);Eg(t,l,o);break;default:throw Error(ie(161))}}catch(c){Ft(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function l2(t,e,n){ve=t,$S(t)}function $S(t,e,n){for(var s=(t.mode&1)!==0;ve!==null;){var r=ve,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||Pd;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||jn;l=Pd;var u=jn;if(Pd=o,(jn=c)&&!u)for(ve=r;ve!==null;)o=ve,c=o.child,o.tag===22&&o.memoizedState!==null?aw(r):c!==null?(c.return=o,ve=c):aw(r);for(;i!==null;)ve=i,$S(i),i=i.sibling;ve=r,Pd=l,jn=u}rw(t)}else r.subtreeFlags&8772&&i!==null?(i.return=r,ve=i):rw(t)}}function rw(t){for(;ve!==null;){var e=ve;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:jn||Ff(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!jn)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Us(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&$b(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}$b(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var h=u.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Kc(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ie(163))}jn||e.flags&512&&Ng(e)}catch(m){Ft(e,e.return,m)}}if(e===t){ve=null;break}if(n=e.sibling,n!==null){n.return=e.return,ve=n;break}ve=e.return}}function iw(t){for(;ve!==null;){var e=ve;if(e===t){ve=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ve=n;break}ve=e.return}}function aw(t){for(;ve!==null;){var e=ve;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Ff(4,e)}catch(c){Ft(e,n,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(c){Ft(e,r,c)}}var i=e.return;try{Ng(e)}catch(c){Ft(e,i,c)}break;case 5:var o=e.return;try{Ng(e)}catch(c){Ft(e,o,c)}}}catch(c){Ft(e,e.return,c)}if(e===t){ve=null;break}var l=e.sibling;if(l!==null){l.return=e.return,ve=l;break}ve=e.return}}var c2=Math.ceil,qh=qr.ReactCurrentDispatcher,yy=qr.ReactCurrentOwner,ks=qr.ReactCurrentBatchConfig,Xe=0,cn=null,Kt=null,gn=0,cs=0,Ro=Bi(0),en=0,iu=null,Aa=0,Uf=0,vy=0,kc=null,Yn=null,by=0,sl=1/0,br=null,Wh=!1,Sg=null,Si=null,Dd=!1,yi=null,Gh=0,Ic=0,jg=null,ih=-1,ah=0;function Fn(){return Xe&6?Bt():ih!==-1?ih:ih=Bt()}function ji(t){return t.mode&1?Xe&2&&gn!==0?gn&-gn:GP.transition!==null?(ah===0&&(ah=ST()),ah):(t=st,t!==0||(t=window.event,t=t===void 0?16:PT(t.type)),t):1}function qs(t,e,n,s){if(50<Ic)throw Ic=0,jg=null,Error(ie(185));ku(t,n,s),(!(Xe&2)||t!==cn)&&(t===cn&&(!(Xe&2)&&(Uf|=n),en===4&&di(t,gn)),ss(t,s),n===1&&Xe===0&&!(e.mode&1)&&(sl=Bt()+500,Mf&&$i()))}function ss(t,e){var n=t.callbackNode;GR(t,e);var s=Ih(t,t===cn?gn:0);if(s===0)n!==null&&pb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&pb(n),e===1)t.tag===0?WP(ow.bind(null,t)):JT(ow.bind(null,t)),BP(function(){!(Xe&6)&&$i()}),n=null;else{switch(jT(s)){case 1:n=Gx;break;case 4:n=ET;break;case 16:n=kh;break;case 536870912:n=TT;break;default:n=kh}n=YS(n,zS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function zS(t,e){if(ih=-1,ah=0,Xe&6)throw Error(ie(327));var n=t.callbackNode;if(qo()&&t.callbackNode!==n)return null;var s=Ih(t,t===cn?gn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=Hh(t,s);else{e=s;var r=Xe;Xe|=2;var i=WS();(cn!==t||gn!==e)&&(br=null,sl=Bt()+500,ba(t,e));do try{h2();break}catch(l){qS(t,l)}while(!0);iy(),qh.current=i,Xe=r,Kt!==null?e=0:(cn=null,gn=0,e=en)}if(e!==0){if(e===2&&(r=eg(t),r!==0&&(s=r,e=kg(t,r))),e===1)throw n=iu,ba(t,0),di(t,s),ss(t,Bt()),n;if(e===6)di(t,s);else{if(r=t.current.alternate,!(s&30)&&!u2(r)&&(e=Hh(t,s),e===2&&(i=eg(t),i!==0&&(s=i,e=kg(t,i))),e===1))throw n=iu,ba(t,0),di(t,s),ss(t,Bt()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(ie(345));case 2:ia(t,Yn,br);break;case 3:if(di(t,s),(s&130023424)===s&&(e=by+500-Bt(),10<e)){if(Ih(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){Fn(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=lg(ia.bind(null,t,Yn,br),e);break}ia(t,Yn,br);break;case 4:if(di(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var o=31-zs(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=Bt()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*c2(s/1960))-s,10<s){t.timeoutHandle=lg(ia.bind(null,t,Yn,br),s);break}ia(t,Yn,br);break;case 5:ia(t,Yn,br);break;default:throw Error(ie(329))}}}return ss(t,Bt()),t.callbackNode===n?zS.bind(null,t):null}function kg(t,e){var n=kc;return t.current.memoizedState.isDehydrated&&(ba(t,e).flags|=256),t=Hh(t,e),t!==2&&(e=Yn,Yn=n,e!==null&&Ig(e)),t}function Ig(t){Yn===null?Yn=t:Yn.push.apply(Yn,t)}function u2(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],i=r.getSnapshot;r=r.value;try{if(!Ws(i(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function di(t,e){for(e&=~vy,e&=~Uf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-zs(e),s=1<<n;t[n]=-1,e&=~s}}function ow(t){if(Xe&6)throw Error(ie(327));qo();var e=Ih(t,0);if(!(e&1))return ss(t,Bt()),null;var n=Hh(t,e);if(t.tag!==0&&n===2){var s=eg(t);s!==0&&(e=s,n=kg(t,s))}if(n===1)throw n=iu,ba(t,0),di(t,e),ss(t,Bt()),n;if(n===6)throw Error(ie(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ia(t,Yn,br),ss(t,Bt()),null}function wy(t,e){var n=Xe;Xe|=1;try{return t(e)}finally{Xe=n,Xe===0&&(sl=Bt()+500,Mf&&$i())}}function Ra(t){yi!==null&&yi.tag===0&&!(Xe&6)&&qo();var e=Xe;Xe|=1;var n=ks.transition,s=st;try{if(ks.transition=null,st=1,t)return t()}finally{st=s,ks.transition=n,Xe=e,!(Xe&6)&&$i()}}function _y(){cs=Ro.current,gt(Ro)}function ba(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,UP(n)),Kt!==null)for(n=Kt.return;n!==null;){var s=n;switch(ny(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Dh();break;case 3:tl(),gt(ts),gt(Rn),dy();break;case 5:uy(s);break;case 4:tl();break;case 13:gt(Tt);break;case 19:gt(Tt);break;case 10:ay(s.type._context);break;case 22:case 23:_y()}n=n.return}if(cn=t,Kt=t=ki(t.current,null),gn=cs=e,en=0,iu=null,vy=Uf=Aa=0,Yn=kc=null,ga!==null){for(e=0;e<ga.length;e++)if(n=ga[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,i=n.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}n.pending=s}ga=null}return t}function qS(t,e){do{var n=Kt;try{if(iy(),nh.current=zh,$h){for(var s=Ct.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}$h=!1}if(Ca=0,ln=Jt=Ct=null,Sc=!1,nu=0,yy.current=null,n===null||n.return===null){en=1,iu=e,Kt=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=gn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var m=h.alternate;m?(h.updateQueue=m.updateQueue,h.memoizedState=m.memoizedState,h.lanes=m.lanes):(h.updateQueue=null,h.memoizedState=null)}var x=Kb(o);if(x!==null){x.flags&=-257,Qb(x,o,l,i,e),x.mode&1&&Hb(i,u,e),e=x,c=u;var b=e.updateQueue;if(b===null){var N=new Set;N.add(c),e.updateQueue=N}else b.add(c);break e}else{if(!(e&1)){Hb(i,u,e),Ny();break e}c=Error(ie(426))}}else if(wt&&l.mode&1){var E=Kb(o);if(E!==null){!(E.flags&65536)&&(E.flags|=256),Qb(E,o,l,i,e),sy(nl(c,l));break e}}i=c=nl(c,l),en!==4&&(en=2),kc===null?kc=[i]:kc.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=jS(i,c,e);Bb(i,w);break e;case 1:l=c;var v=i.type,T=i.stateNode;if(!(i.flags&128)&&(typeof v.getDerivedStateFromError=="function"||T!==null&&typeof T.componentDidCatch=="function"&&(Si===null||!Si.has(T)))){i.flags|=65536,e&=-e,i.lanes|=e;var I=kS(i,l,e);Bb(i,I);break e}}i=i.return}while(i!==null)}HS(n)}catch(R){e=R,Kt===n&&n!==null&&(Kt=n=n.return);continue}break}while(!0)}function WS(){var t=qh.current;return qh.current=zh,t===null?zh:t}function Ny(){(en===0||en===3||en===2)&&(en=4),cn===null||!(Aa&268435455)&&!(Uf&268435455)||di(cn,gn)}function Hh(t,e){var n=Xe;Xe|=2;var s=WS();(cn!==t||gn!==e)&&(br=null,ba(t,e));do try{d2();break}catch(r){qS(t,r)}while(!0);if(iy(),Xe=n,qh.current=s,Kt!==null)throw Error(ie(261));return cn=null,gn=0,en}function d2(){for(;Kt!==null;)GS(Kt)}function h2(){for(;Kt!==null&&!LR();)GS(Kt)}function GS(t){var e=QS(t.alternate,t,cs);t.memoizedProps=t.pendingProps,e===null?HS(t):Kt=e,yy.current=null}function HS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=i2(n,e),n!==null){n.flags&=32767,Kt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{en=6,Kt=null;return}}else if(n=r2(n,e,cs),n!==null){Kt=n;return}if(e=e.sibling,e!==null){Kt=e;return}Kt=e=t}while(e!==null);en===0&&(en=5)}function ia(t,e,n){var s=st,r=ks.transition;try{ks.transition=null,st=1,f2(t,e,n,s)}finally{ks.transition=r,st=s}return null}function f2(t,e,n,s){do qo();while(yi!==null);if(Xe&6)throw Error(ie(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ie(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(HR(t,i),t===cn&&(Kt=cn=null,gn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Dd||(Dd=!0,YS(kh,function(){return qo(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ks.transition,ks.transition=null;var o=st;st=1;var l=Xe;Xe|=4,yy.current=null,o2(t,n),BS(n,t),PP(ag),Ch=!!ig,ag=ig=null,t.current=n,l2(n),OR(),Xe=l,st=o,ks.transition=i}else t.current=n;if(Dd&&(Dd=!1,yi=t,Gh=r),i=t.pendingLanes,i===0&&(Si=null),BR(n.stateNode),ss(t,Bt()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(Wh)throw Wh=!1,t=Sg,Sg=null,t;return Gh&1&&t.tag!==0&&qo(),i=t.pendingLanes,i&1?t===jg?Ic++:(Ic=0,jg=t):Ic=0,$i(),null}function qo(){if(yi!==null){var t=jT(Gh),e=ks.transition,n=st;try{if(ks.transition=null,st=16>t?16:t,yi===null)var s=!1;else{if(t=yi,yi=null,Gh=0,Xe&6)throw Error(ie(331));var r=Xe;for(Xe|=4,ve=t.current;ve!==null;){var i=ve,o=i.child;if(ve.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(ve=u;ve!==null;){var h=ve;switch(h.tag){case 0:case 11:case 15:jc(8,h,i)}var f=h.child;if(f!==null)f.return=h,ve=f;else for(;ve!==null;){h=ve;var m=h.sibling,x=h.return;if(OS(h),h===u){ve=null;break}if(m!==null){m.return=x,ve=m;break}ve=x}}}var b=i.alternate;if(b!==null){var N=b.child;if(N!==null){b.child=null;do{var E=N.sibling;N.sibling=null,N=E}while(N!==null)}}ve=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,ve=o;else e:for(;ve!==null;){if(i=ve,i.flags&2048)switch(i.tag){case 0:case 11:case 15:jc(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,ve=w;break e}ve=i.return}}var v=t.current;for(ve=v;ve!==null;){o=ve;var T=o.child;if(o.subtreeFlags&2064&&T!==null)T.return=o,ve=T;else e:for(o=v;ve!==null;){if(l=ve,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:Ff(9,l)}}catch(R){Ft(l,l.return,R)}if(l===o){ve=null;break e}var I=l.sibling;if(I!==null){I.return=l.return,ve=I;break e}ve=l.return}}if(Xe=r,$i(),ir&&typeof ir.onPostCommitFiberRoot=="function")try{ir.onPostCommitFiberRoot(Af,t)}catch{}s=!0}return s}finally{st=n,ks.transition=e}}return!1}function lw(t,e,n){e=nl(n,e),e=jS(t,e,1),t=Ti(t,e,1),e=Fn(),t!==null&&(ku(t,1,e),ss(t,e))}function Ft(t,e,n){if(t.tag===3)lw(t,t,n);else for(;e!==null;){if(e.tag===3){lw(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Si===null||!Si.has(s))){t=nl(n,t),t=kS(e,t,1),e=Ti(e,t,1),t=Fn(),e!==null&&(ku(e,1,t),ss(e,t));break}}e=e.return}}function m2(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=Fn(),t.pingedLanes|=t.suspendedLanes&n,cn===t&&(gn&n)===n&&(en===4||en===3&&(gn&130023424)===gn&&500>Bt()-by?ba(t,0):vy|=n),ss(t,e)}function KS(t,e){e===0&&(t.mode&1?(e=Ed,Ed<<=1,!(Ed&130023424)&&(Ed=4194304)):e=1);var n=Fn();t=Vr(t,e),t!==null&&(ku(t,e,n),ss(t,n))}function p2(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),KS(t,n)}function g2(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ie(314))}s!==null&&s.delete(e),KS(t,n)}var QS;QS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||ts.current)Xn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Xn=!1,s2(t,e,n);Xn=!!(t.flags&131072)}else Xn=!1,wt&&e.flags&1048576&&ZT(e,Lh,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;rh(t,e),t=e.pendingProps;var r=Jo(e,Rn.current);zo(e,n),r=fy(null,e,s,t,r,n);var i=my();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,ns(s)?(i=!0,Vh(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ly(e),r.updater=Of,e.stateNode=r,r._reactInternals=e,pg(e,s,t,n),e=yg(null,e,s,!0,i,n)):(e.tag=0,wt&&i&&ty(e),Ln(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(rh(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=y2(s),t=Us(s,t),r){case 0:e=xg(null,e,s,t,n);break e;case 1:e=Jb(null,e,s,t,n);break e;case 11:e=Yb(null,e,s,t,n);break e;case 14:e=Xb(null,e,s,Us(s.type,t),n);break e}throw Error(ie(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Us(s,r),xg(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Us(s,r),Jb(t,e,s,r,n);case 3:e:{if(RS(e),t===null)throw Error(ie(387));s=e.pendingProps,i=e.memoizedState,r=i.element,iS(t,e),Uh(e,s,null,n);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=nl(Error(ie(423)),e),e=Zb(t,e,s,n,r);break e}else if(s!==r){r=nl(Error(ie(424)),e),e=Zb(t,e,s,n,r);break e}else for(us=Ei(e.stateNode.containerInfo.firstChild),fs=e,wt=!0,$s=null,n=sS(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Zo(),s===r){e=Mr(t,e,n);break e}Ln(t,e,s,n)}e=e.child}return e;case 5:return aS(e),t===null&&hg(e),s=e.type,r=e.pendingProps,i=t!==null?t.memoizedProps:null,o=r.children,og(s,r)?o=null:i!==null&&og(s,i)&&(e.flags|=32),AS(t,e),Ln(t,e,o,n),e.child;case 6:return t===null&&hg(e),null;case 13:return PS(t,e,n);case 4:return cy(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=el(e,null,s,n):Ln(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Us(s,r),Yb(t,e,s,r,n);case 7:return Ln(t,e,e.pendingProps,n),e.child;case 8:return Ln(t,e,e.pendingProps.children,n),e.child;case 12:return Ln(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,ct(Oh,s._currentValue),s._currentValue=o,i!==null)if(Ws(i.value,o)){if(i.children===r.children&&!ts.current){e=Mr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Cr(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var h=u.pending;h===null?c.next=c:(c.next=h.next,h.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),fg(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ie(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),fg(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Ln(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,zo(e,n),r=As(r),s=s(r),e.flags|=1,Ln(t,e,s,n),e.child;case 14:return s=e.type,r=Us(s,e.pendingProps),r=Us(s.type,r),Xb(t,e,s,r,n);case 15:return IS(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Us(s,r),rh(t,e),e.tag=1,ns(s)?(t=!0,Vh(e)):t=!1,zo(e,n),SS(e,s,r),pg(e,s,r,n),yg(null,e,s,!0,t,n);case 19:return DS(t,e,n);case 22:return CS(t,e,n)}throw Error(ie(156,e.tag))};function YS(t,e){return NT(t,e)}function x2(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ss(t,e,n,s){return new x2(t,e,n,s)}function Ey(t){return t=t.prototype,!(!t||!t.isReactComponent)}function y2(t){if(typeof t=="function")return Ey(t)?1:0;if(t!=null){if(t=t.$$typeof,t===zx)return 11;if(t===qx)return 14}return 2}function ki(t,e){var n=t.alternate;return n===null?(n=Ss(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function oh(t,e,n,s,r,i){var o=2;if(s=t,typeof t=="function")Ey(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case _o:return wa(n.children,r,i,e);case $x:o=8,r|=8;break;case Fp:return t=Ss(12,n,e,r|2),t.elementType=Fp,t.lanes=i,t;case Up:return t=Ss(13,n,e,r),t.elementType=Up,t.lanes=i,t;case Bp:return t=Ss(19,n,e,r),t.elementType=Bp,t.lanes=i,t;case aT:return Bf(n,r,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case rT:o=10;break e;case iT:o=9;break e;case zx:o=11;break e;case qx:o=14;break e;case li:o=16,s=null;break e}throw Error(ie(130,t==null?t:typeof t,""))}return e=Ss(o,n,e,r),e.elementType=t,e.type=s,e.lanes=i,e}function wa(t,e,n,s){return t=Ss(7,t,s,e),t.lanes=n,t}function Bf(t,e,n,s){return t=Ss(22,t,s,e),t.elementType=aT,t.lanes=n,t.stateNode={isHidden:!1},t}function ep(t,e,n){return t=Ss(6,t,null,e),t.lanes=n,t}function tp(t,e,n){return e=Ss(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function v2(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Vm(0),this.expirationTimes=Vm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vm(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ty(t,e,n,s,r,i,o,l,c){return t=new v2(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Ss(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ly(i),t}function b2(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wo,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function XS(t){if(!t)return Di;t=t._reactInternals;e:{if(Ha(t)!==t||t.tag!==1)throw Error(ie(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(ns(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ie(171))}if(t.tag===1){var n=t.type;if(ns(n))return XT(t,n,e)}return e}function JS(t,e,n,s,r,i,o,l,c){return t=Ty(n,s,!0,t,r,i,o,l,c),t.context=XS(null),n=t.current,s=Fn(),r=ji(n),i=Cr(s,r),i.callback=e??null,Ti(n,i,r),t.current.lanes=r,ku(t,r,s),ss(t,s),t}function $f(t,e,n,s){var r=e.current,i=Fn(),o=ji(r);return n=XS(n),e.context===null?e.context=n:e.pendingContext=n,e=Cr(i,o),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Ti(r,e,o),t!==null&&(qs(t,r,o,i),th(t,r,o)),o}function Kh(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function cw(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Sy(t,e){cw(t,e),(t=t.alternate)&&cw(t,e)}function w2(){return null}var ZS=typeof reportError=="function"?reportError:function(t){console.error(t)};function jy(t){this._internalRoot=t}zf.prototype.render=jy.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ie(409));$f(t,e,null,null)};zf.prototype.unmount=jy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Ra(function(){$f(null,t,null,null)}),e[Dr]=null}};function zf(t){this._internalRoot=t}zf.prototype.unstable_scheduleHydration=function(t){if(t){var e=CT();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ui.length&&e!==0&&e<ui[n].priority;n++);ui.splice(n,0,t),n===0&&RT(t)}};function ky(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function qf(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function uw(){}function _2(t,e,n,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var u=Kh(o);i.call(u)}}var o=JS(e,s,t,0,null,!1,!1,"",uw);return t._reactRootContainer=o,t[Dr]=o.current,Xc(t.nodeType===8?t.parentNode:t),Ra(),o}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var u=Kh(c);l.call(u)}}var c=Ty(t,0,!1,null,null,!1,!1,"",uw);return t._reactRootContainer=c,t[Dr]=c.current,Xc(t.nodeType===8?t.parentNode:t),Ra(function(){$f(e,c,n,s)}),c}function Wf(t,e,n,s,r){var i=n._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var l=r;r=function(){var c=Kh(o);l.call(c)}}$f(e,o,t,r)}else o=_2(n,e,t,r,s);return Kh(o)}kT=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=dc(e.pendingLanes);n!==0&&(Hx(e,n|1),ss(e,Bt()),!(Xe&6)&&(sl=Bt()+500,$i()))}break;case 13:Ra(function(){var s=Vr(t,1);if(s!==null){var r=Fn();qs(s,t,1,r)}}),Sy(t,1)}};Kx=function(t){if(t.tag===13){var e=Vr(t,134217728);if(e!==null){var n=Fn();qs(e,t,134217728,n)}Sy(t,134217728)}};IT=function(t){if(t.tag===13){var e=ji(t),n=Vr(t,e);if(n!==null){var s=Fn();qs(n,t,e,s)}Sy(t,e)}};CT=function(){return st};AT=function(t,e){var n=st;try{return st=t,e()}finally{st=n}};Xp=function(t,e,n){switch(e){case"input":if(qp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=Vf(s);if(!r)throw Error(ie(90));lT(s),qp(s,r)}}}break;case"textarea":uT(t,n);break;case"select":e=n.value,e!=null&&Fo(t,!!n.multiple,e,!1)}};xT=wy;yT=Ra;var N2={usingClientEntryPoint:!1,Events:[Cu,So,Vf,pT,gT,wy]},tc={findFiberByHostInstance:pa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},E2={bundleType:tc.bundleType,version:tc.version,rendererPackageName:tc.rendererPackageName,rendererConfig:tc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:qr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wT(t),t===null?null:t.stateNode},findFiberByHostInstance:tc.findFiberByHostInstance||w2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Vd.isDisabled&&Vd.supportsFiber)try{Af=Vd.inject(E2),ir=Vd}catch{}}xs.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=N2;xs.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!ky(e))throw Error(ie(200));return b2(t,e,null,n)};xs.createRoot=function(t,e){if(!ky(t))throw Error(ie(299));var n=!1,s="",r=ZS;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Ty(t,1,!1,null,null,n,!1,s,r),t[Dr]=e.current,Xc(t.nodeType===8?t.parentNode:t),new jy(e)};xs.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ie(188)):(t=Object.keys(t).join(","),Error(ie(268,t)));return t=wT(e),t=t===null?null:t.stateNode,t};xs.flushSync=function(t){return Ra(t)};xs.hydrate=function(t,e,n){if(!qf(e))throw Error(ie(200));return Wf(null,t,e,!0,n)};xs.hydrateRoot=function(t,e,n){if(!ky(t))throw Error(ie(405));var s=n!=null&&n.hydratedSources||null,r=!1,i="",o=ZS;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=JS(e,null,t,1,n??null,r,!1,i,o),t[Dr]=e.current,Xc(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new zf(e)};xs.render=function(t,e,n){if(!qf(e))throw Error(ie(200));return Wf(null,t,e,!1,n)};xs.unmountComponentAtNode=function(t){if(!qf(t))throw Error(ie(40));return t._reactRootContainer?(Ra(function(){Wf(null,null,t,!1,function(){t._reactRootContainer=null,t[Dr]=null})}),!0):!1};xs.unstable_batchedUpdates=wy;xs.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!qf(n))throw Error(ie(200));if(t==null||t._reactInternals===void 0)throw Error(ie(38));return Wf(t,e,n,!1,s)};xs.version="18.3.1-next-f1338f8080-20240426";function ej(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ej)}catch(t){console.error(t)}}ej(),eT.exports=xs;var T2=eT.exports,dw=T2;Lp.createRoot=dw.createRoot,Lp.hydrateRoot=dw.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function au(){return au=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},au.apply(this,arguments)}var vi;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(vi||(vi={}));const hw="popstate";function S2(t){t===void 0&&(t={});function e(s,r){let{pathname:i,search:o,hash:l}=s.location;return Cg("",{pathname:i,search:o,hash:l},r.state&&r.state.usr||null,r.state&&r.state.key||"default")}function n(s,r){return typeof r=="string"?r:tj(r)}return k2(e,n,null,t)}function Qt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Iy(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function j2(){return Math.random().toString(36).substr(2,8)}function fw(t,e){return{usr:t.state,key:t.key,idx:e}}function Cg(t,e,n,s){return n===void 0&&(n=null),au({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?_l(e):e,{state:n,key:e&&e.key||s||j2()})}function tj(t){let{pathname:e="/",search:n="",hash:s=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function _l(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let s=t.indexOf("?");s>=0&&(e.search=t.substr(s),t=t.substr(0,s)),t&&(e.pathname=t)}return e}function k2(t,e,n,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,l=vi.Pop,c=null,u=h();u==null&&(u=0,o.replaceState(au({},o.state,{idx:u}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=vi.Pop;let E=h(),w=E==null?null:E-u;u=E,c&&c({action:l,location:N.location,delta:w})}function m(E,w){l=vi.Push;let v=Cg(N.location,E,w);u=h()+1;let T=fw(v,u),I=N.createHref(v);try{o.pushState(T,"",I)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;r.location.assign(I)}i&&c&&c({action:l,location:N.location,delta:1})}function x(E,w){l=vi.Replace;let v=Cg(N.location,E,w);u=h();let T=fw(v,u),I=N.createHref(v);o.replaceState(T,"",I),i&&c&&c({action:l,location:N.location,delta:0})}function b(E){let w=r.location.origin!=="null"?r.location.origin:r.location.href,v=typeof E=="string"?E:tj(E);return v=v.replace(/ $/,"%20"),Qt(w,"No window.location.(origin|href) available to create URL for href: "+v),new URL(v,w)}let N={get action(){return l},get location(){return t(r,o)},listen(E){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(hw,f),c=E,()=>{r.removeEventListener(hw,f),c=null}},createHref(E){return e(r,E)},createURL:b,encodeLocation(E){let w=b(E);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:m,replace:x,go(E){return o.go(E)}};return N}var mw;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(mw||(mw={}));function I2(t,e,n){return n===void 0&&(n="/"),C2(t,e,n)}function C2(t,e,n,s){let r=typeof e=="string"?_l(e):e,i=rj(r.pathname||"/",n);if(i==null)return null;let o=nj(t);A2(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=z2(i);l=U2(o[c],u)}return l}function nj(t,e,n,s){e===void 0&&(e=[]),n===void 0&&(n=[]),s===void 0&&(s="");let r=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Qt(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let u=_a([s,c.relativePath]),h=n.concat(c);i.children&&i.children.length>0&&(Qt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),nj(i.children,e,h,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:O2(u,i.index),routesMeta:h})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))r(i,o);else for(let c of sj(i.path))r(i,o,c)}),e}function sj(t){let e=t.split("/");if(e.length===0)return[];let[n,...s]=e,r=n.endsWith("?"),i=n.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=sj(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),r&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function A2(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:F2(e.routesMeta.map(s=>s.childrenIndex),n.routesMeta.map(s=>s.childrenIndex)))}const R2=/^:[\w-]+$/,P2=3,D2=2,V2=1,M2=10,L2=-2,pw=t=>t==="*";function O2(t,e){let n=t.split("/"),s=n.length;return n.some(pw)&&(s+=L2),e&&(s+=D2),n.filter(r=>!pw(r)).reduce((r,i)=>r+(R2.test(i)?P2:i===""?V2:M2),s)}function F2(t,e){return t.length===e.length&&t.slice(0,-1).every((s,r)=>s===e[r])?t[t.length-1]-e[e.length-1]:0}function U2(t,e,n){let{routesMeta:s}=t,r={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],u=l===s.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=B2({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},h),m=c.route;if(!f)return null;Object.assign(r,f.params),o.push({params:r,pathname:_a([i,f.pathname]),pathnameBase:K2(_a([i,f.pathnameBase])),route:m}),f.pathnameBase!=="/"&&(i=_a([i,f.pathnameBase]))}return o}function B2(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,s]=$2(t.path,t.caseSensitive,t.end),r=e.match(n);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((u,h,f)=>{let{paramName:m,isOptional:x}=h;if(m==="*"){let N=l[f]||"";o=i.slice(0,i.length-N.length).replace(/(.)\/+$/,"$1")}const b=l[f];return x&&!b?u[m]=void 0:u[m]=(b||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function $2(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Iy(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let s=[],r="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(s.push({paramName:"*"}),r+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?r+="\\/*$":t!==""&&t!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function z2(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Iy(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function rj(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,s=t.charAt(n);return s&&s!=="/"?null:t.slice(n)||"/"}const q2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,W2=t=>q2.test(t);function G2(t,e){e===void 0&&(e="/");let{pathname:n,search:s="",hash:r=""}=typeof t=="string"?_l(t):t,i;if(n)if(W2(n))i=n;else{if(n.includes("//")){let o=n;n=n.replace(/\/\/+/g,"/"),Iy(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+n))}n.startsWith("/")?i=gw(n.substring(1),"/"):i=gw(n,e)}else i=e;return{pathname:i,search:Q2(s),hash:Y2(r)}}function gw(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(r=>{r===".."?n.length>1&&n.pop():r!=="."&&n.push(r)}),n.length>1?n.join("/"):"/"}function np(t,e,n,s){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function H2(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function ij(t,e){let n=H2(t);return e?n.map((s,r)=>r===n.length-1?s.pathname:s.pathnameBase):n.map(s=>s.pathnameBase)}function aj(t,e,n,s){s===void 0&&(s=!1);let r;typeof t=="string"?r=_l(t):(r=au({},t),Qt(!r.pathname||!r.pathname.includes("?"),np("?","pathname","search",r)),Qt(!r.pathname||!r.pathname.includes("#"),np("#","pathname","hash",r)),Qt(!r.search||!r.search.includes("#"),np("#","search","hash",r)));let i=t===""||r.pathname==="",o=i?"/":r.pathname,l;if(o==null)l=n;else{let f=e.length-1;if(!s&&o.startsWith("..")){let m=o.split("/");for(;m[0]==="..";)m.shift(),f-=1;r.pathname=m.join("/")}l=f>=0?e[f]:"/"}let c=G2(r,l),u=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||h)&&(c.pathname+="/"),c}const _a=t=>t.join("/").replace(/\/\/+/g,"/"),K2=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Q2=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Y2=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function X2(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const oj=["post","put","patch","delete"];new Set(oj);const J2=["get",...oj];new Set(J2);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ou(){return ou=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},ou.apply(this,arguments)}const Cy=g.createContext(null),Z2=g.createContext(null),Ru=g.createContext(null),Gf=g.createContext(null),zi=g.createContext({outlet:null,matches:[],isDataRoute:!1}),lj=g.createContext(null);function Pu(){return g.useContext(Gf)!=null}function Hs(){return Pu()||Qt(!1),g.useContext(Gf).location}function cj(t){g.useContext(Ru).static||g.useLayoutEffect(t)}function tt(){let{isDataRoute:t}=g.useContext(zi);return t?hD():eD()}function eD(){Pu()||Qt(!1);let t=g.useContext(Cy),{basename:e,future:n,navigator:s}=g.useContext(Ru),{matches:r}=g.useContext(zi),{pathname:i}=Hs(),o=JSON.stringify(ij(r,n.v7_relativeSplatPath)),l=g.useRef(!1);return cj(()=>{l.current=!0}),g.useCallback(function(u,h){if(h===void 0&&(h={}),!l.current)return;if(typeof u=="number"){s.go(u);return}let f=aj(u,JSON.parse(o),i,h.relative==="path");t==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:_a([e,f.pathname])),(h.replace?s.replace:s.push)(f,h.state,h)},[e,s,o,i,t])}function Nl(){let{matches:t}=g.useContext(zi),e=t[t.length-1];return e?e.params:{}}function tD(t,e){return nD(t,e)}function nD(t,e,n,s){Pu()||Qt(!1);let{navigator:r}=g.useContext(Ru),{matches:i}=g.useContext(zi),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=Hs(),h;if(e){var f;let E=typeof e=="string"?_l(e):e;c==="/"||(f=E.pathname)!=null&&f.startsWith(c)||Qt(!1),h=E}else h=u;let m=h.pathname||"/",x=m;if(c!=="/"){let E=c.replace(/^\//,"").split("/");x="/"+m.replace(/^\//,"").split("/").slice(E.length).join("/")}let b=I2(t,{pathname:x}),N=oD(b&&b.map(E=>Object.assign({},E,{params:Object.assign({},l,E.params),pathname:_a([c,r.encodeLocation?r.encodeLocation(E.pathname).pathname:E.pathname]),pathnameBase:E.pathnameBase==="/"?c:_a([c,r.encodeLocation?r.encodeLocation(E.pathnameBase).pathname:E.pathnameBase])})),i,n,s);return e&&N?g.createElement(Gf.Provider,{value:{location:ou({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:vi.Pop}},N):N}function sD(){let t=dD(),e=X2(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return g.createElement(g.Fragment,null,g.createElement("h2",null,"Unexpected Application Error!"),g.createElement("h3",{style:{fontStyle:"italic"}},e),n?g.createElement("pre",{style:r},n):null,null)}const rD=g.createElement(sD,null);class iD extends g.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?g.createElement(zi.Provider,{value:this.props.routeContext},g.createElement(lj.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aD(t){let{routeContext:e,match:n,children:s}=t,r=g.useContext(Cy);return r&&r.static&&r.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=n.route.id),g.createElement(zi.Provider,{value:e},s)}function oD(t,e,n,s){var r;if(e===void 0&&(e=[]),n===void 0&&(n=null),s===void 0&&(s=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(r=n)==null?void 0:r.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||Qt(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,u=-1;if(n&&s&&s.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(u=h),f.route.id){let{loaderData:m,errors:x}=n,b=f.route.loader&&m[f.route.id]===void 0&&(!x||x[f.route.id]===void 0);if(f.route.lazy||b){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((h,f,m)=>{let x,b=!1,N=null,E=null;n&&(x=l&&f.route.id?l[f.route.id]:void 0,N=f.route.errorElement||rD,c&&(u<0&&m===0?(fD("route-fallback"),b=!0,E=null):u===m&&(b=!0,E=f.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,m+1)),v=()=>{let T;return x?T=N:b?T=E:f.route.Component?T=g.createElement(f.route.Component,null):f.route.element?T=f.route.element:T=h,g.createElement(aD,{match:f,routeContext:{outlet:h,matches:w,isDataRoute:n!=null},children:T})};return n&&(f.route.ErrorBoundary||f.route.errorElement||m===0)?g.createElement(iD,{location:n.location,revalidation:n.revalidation,component:N,error:x,children:v(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):v()},null)}var uj=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(uj||{}),dj=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(dj||{});function lD(t){let e=g.useContext(Cy);return e||Qt(!1),e}function cD(t){let e=g.useContext(Z2);return e||Qt(!1),e}function uD(t){let e=g.useContext(zi);return e||Qt(!1),e}function hj(t){let e=uD(),n=e.matches[e.matches.length-1];return n.route.id||Qt(!1),n.route.id}function dD(){var t;let e=g.useContext(lj),n=cD(),s=hj();return e!==void 0?e:(t=n.errors)==null?void 0:t[s]}function hD(){let{router:t}=lD(uj.UseNavigateStable),e=hj(dj.UseNavigateStable),n=g.useRef(!1);return cj(()=>{n.current=!0}),g.useCallback(function(r,i){i===void 0&&(i={}),n.current&&(typeof r=="number"?t.navigate(r):t.navigate(r,ou({fromRouteId:e},i)))},[t,e])}const xw={};function fD(t,e,n){xw[t]||(xw[t]=!0)}function mD(t,e){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function pD(t){let{to:e,replace:n,state:s,relative:r}=t;Pu()||Qt(!1);let{future:i,static:o}=g.useContext(Ru),{matches:l}=g.useContext(zi),{pathname:c}=Hs(),u=tt(),h=aj(e,ij(l,i.v7_relativeSplatPath),c,r==="path"),f=JSON.stringify(h);return g.useEffect(()=>u(JSON.parse(f),{replace:n,state:s,relative:r}),[u,f,r,n,s]),null}function Lt(t){Qt(!1)}function gD(t){let{basename:e="/",children:n=null,location:s,navigationType:r=vi.Pop,navigator:i,static:o=!1,future:l}=t;Pu()&&Qt(!1);let c=e.replace(/^\/*/,"/"),u=g.useMemo(()=>({basename:c,navigator:i,static:o,future:ou({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof s=="string"&&(s=_l(s));let{pathname:h="/",search:f="",hash:m="",state:x=null,key:b="default"}=s,N=g.useMemo(()=>{let E=rj(h,c);return E==null?null:{location:{pathname:E,search:f,hash:m,state:x,key:b},navigationType:r}},[c,h,f,m,x,b,r]);return N==null?null:g.createElement(Ru.Provider,{value:u},g.createElement(Gf.Provider,{children:n,value:N}))}function xD(t){let{children:e,location:n}=t;return tD(Ag(e),n)}new Promise(()=>{});function Ag(t,e){e===void 0&&(e=[]);let n=[];return g.Children.forEach(t,(s,r)=>{if(!g.isValidElement(s))return;let i=[...e,r];if(s.type===g.Fragment){n.push.apply(n,Ag(s.props.children,i));return}s.type!==Lt&&Qt(!1),!s.props.index||!s.props.children||Qt(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Ag(s.props.children,i)),n.push(o)}),n}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Rg(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let s=t[n];return e.concat(Array.isArray(s)?s.map(r=>[n,r]):[[n,s]])},[]))}function yD(t,e){let n=Rg(t);return e&&e.forEach((s,r)=>{n.has(r)||e.getAll(r).forEach(i=>{n.append(r,i)})}),n}const vD="6";try{window.__reactRouterVersion=vD}catch{}const bD="startTransition",yw=mR[bD];function wD(t){let{basename:e,children:n,future:s,window:r}=t,i=g.useRef();i.current==null&&(i.current=S2({window:r,v5Compat:!0}));let o=i.current,[l,c]=g.useState({action:o.action,location:o.location}),{v7_startTransition:u}=s||{},h=g.useCallback(f=>{u&&yw?yw(()=>c(f)):c(f)},[c,u]);return g.useLayoutEffect(()=>o.listen(h),[o,h]),g.useEffect(()=>mD(s),[s]),g.createElement(gD,{basename:e,children:n,location:l.location,navigationType:l.action,navigator:o,future:s})}var vw;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(vw||(vw={}));var bw;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(bw||(bw={}));function _D(t){let e=g.useRef(Rg(t)),n=g.useRef(!1),s=Hs(),r=g.useMemo(()=>yD(s.search,n.current?null:e.current),[s.search]),i=tt(),o=g.useCallback((l,c)=>{const u=Rg(typeof l=="function"?l(r):l);n.current=!0,i("?"+u,c)},[i,r]);return[r,o]}var ww={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},ND=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],l=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},mj={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,l=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,x=u&63;c||(x=64,o||(m=64)),s.push(n[h],n[f],n[m],n[x])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(fj(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):ND(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const f=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||l==null||u==null||f==null)throw new ED;const m=i<<2|l>>4;if(s.push(m),u!==64){const x=l<<4&240|u>>2;if(s.push(x),f!==64){const b=u<<6&192|f;s.push(b)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let ED=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const TD=function(t){const e=fj(t);return mj.encodeByteArray(e,!0)},pj=function(t){return TD(t).replace(/\./g,"")},SD=function(t){try{return mj.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jD(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kD=()=>jD().__FIREBASE_DEFAULTS__,ID=()=>{if(typeof process>"u"||typeof ww>"u")return;const t=ww.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},CD=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&SD(t[1]);return e&&JSON.parse(e)},AD=()=>{try{return kD()||ID()||CD()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},gj=()=>{var t;return(t=AD())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RD{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,s)=>{n?this.reject(n):this.resolve(s),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,s))}}}function PD(){try{return typeof indexedDB=="object"}catch{return!1}}function DD(){return new Promise((t,e)=>{try{let n=!0;const s="validate-browser-context-for-indexeddb-analytics-module",r=self.indexedDB.open(s);r.onsuccess=()=>{r.result.close(),n||self.indexedDB.deleteDatabase(s),t(!0)},r.onupgradeneeded=()=>{n=!1},r.onerror=()=>{var i;e(((i=r.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VD="FirebaseError";let Ay=class xj extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=VD,Object.setPrototypeOf(this,xj.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,yj.prototype.create)}},yj=class{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?MD(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new Ay(r,l,s)}};function MD(t,e){return t.replace(LD,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const LD=/\{\$([^}]+)}/g;function Pg(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(_w(i)&&_w(o)){if(!Pg(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function _w(t){return t!==null&&typeof t=="object"}let Qh=class{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aa="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OD{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const s=new RD;if(this.instancesDeferred.set(n,s),this.isInitialized(n)||this.shouldAutoInitialize())try{const r=this.getOrInitializeService({instanceIdentifier:n});r&&s.resolve(r)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const s=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),r=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(s)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:s})}catch(i){if(r)return null;throw i}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(UD(e))try{this.getOrInitializeService({instanceIdentifier:aa})}catch{}for(const[n,s]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:r});s.resolve(i)}catch{}}}}clearInstance(e=aa){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=aa){return this.instances.has(e)}getOptions(e=aa){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,s=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(s))throw Error(`${this.name}(${s}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:s,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);s===l&&o.resolve(r)}return r}onInit(e,n){var s;const r=this.normalizeInstanceIdentifier(n),i=(s=this.onInitCallbacks.get(r))!==null&&s!==void 0?s:new Set;i.add(e),this.onInitCallbacks.set(r,i);const o=this.instances.get(r);return o&&e(o,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const s=this.onInitCallbacks.get(n);if(s)for(const r of s)try{r(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let s=this.instances.get(e);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:FD(e),options:n}),this.instances.set(e,s),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(s,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,s)}catch{}return s||null}normalizeInstanceIdentifier(e=aa){return this.component?this.component.multipleInstances?e:aa:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function FD(t){return t===aa?void 0:t}function UD(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new OD(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(mt||(mt={}));const $D={debug:mt.DEBUG,verbose:mt.VERBOSE,info:mt.INFO,warn:mt.WARN,error:mt.ERROR,silent:mt.SILENT},zD=mt.INFO,qD={[mt.DEBUG]:"log",[mt.VERBOSE]:"log",[mt.INFO]:"info",[mt.WARN]:"warn",[mt.ERROR]:"error"},WD=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=qD[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let GD=class{constructor(e){this.name=e,this._logLevel=zD,this._logHandler=WD,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in mt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?$D[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,mt.DEBUG,...e),this._logHandler(this,mt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,mt.VERBOSE,...e),this._logHandler(this,mt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,mt.INFO,...e),this._logHandler(this,mt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,mt.WARN,...e),this._logHandler(this,mt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,mt.ERROR,...e),this._logHandler(this,mt.ERROR,...e)}};const HD=(t,e)=>e.some(n=>t instanceof n);let Nw,Ew;function KD(){return Nw||(Nw=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function QD(){return Ew||(Ew=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const vj=new WeakMap,Dg=new WeakMap,bj=new WeakMap,sp=new WeakMap,Ry=new WeakMap;function YD(t){const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Ii(t.result)),r()},o=()=>{s(t.error),r()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&vj.set(n,t)}).catch(()=>{}),Ry.set(e,t),e}function XD(t){if(Dg.has(t))return;const e=new Promise((n,s)=>{const r=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),r()},o=()=>{s(t.error||new DOMException("AbortError","AbortError")),r()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});Dg.set(t,e)}let Vg={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Dg.get(t);if(e==="objectStoreNames")return t.objectStoreNames||bj.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Ii(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function JD(t){Vg=t(Vg)}function ZD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const s=t.call(rp(this),e,...n);return bj.set(s,e.sort?e.sort():[e]),Ii(s)}:QD().includes(t)?function(...e){return t.apply(rp(this),e),Ii(vj.get(this))}:function(...e){return Ii(t.apply(rp(this),e))}}function eV(t){return typeof t=="function"?ZD(t):(t instanceof IDBTransaction&&XD(t),HD(t,KD())?new Proxy(t,Vg):t)}function Ii(t){if(t instanceof IDBRequest)return YD(t);if(sp.has(t))return sp.get(t);const e=eV(t);return e!==t&&(sp.set(t,e),Ry.set(e,t)),e}const rp=t=>Ry.get(t);function tV(t,e,{blocked:n,upgrade:s,blocking:r,terminated:i}={}){const o=indexedDB.open(t,e),l=Ii(o);return s&&o.addEventListener("upgradeneeded",c=>{s(Ii(o.result),c.oldVersion,c.newVersion,Ii(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),r&&c.addEventListener("versionchange",u=>r(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const nV=["get","getKey","getAll","getAllKeys","count"],sV=["put","add","delete","clear"],ip=new Map;function Tw(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(ip.get(e))return ip.get(e);const n=e.replace(/FromIndex$/,""),s=e!==n,r=sV.includes(n);if(!(n in(s?IDBIndex:IDBObjectStore).prototype)||!(r||nV.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,r?"readwrite":"readonly");let u=c.store;return s&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),r&&c.done]))[0]};return ip.set(e,i),i}JD(t=>({...t,get:(e,n,s)=>Tw(e,n)||t.get(e,n,s),has:(e,n)=>!!Tw(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rV{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(iV(n)){const s=n.getImmediate();return`${s.library}/${s.version}`}else return null}).filter(n=>n).join(" ")}}function iV(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Mg="@firebase/app",Sw="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lr=new GD("@firebase/app"),aV="@firebase/app-compat",oV="@firebase/analytics-compat",lV="@firebase/analytics",cV="@firebase/app-check-compat",uV="@firebase/app-check",dV="@firebase/auth",hV="@firebase/auth-compat",fV="@firebase/database",mV="@firebase/data-connect",pV="@firebase/database-compat",gV="@firebase/functions",xV="@firebase/functions-compat",yV="@firebase/installations",vV="@firebase/installations-compat",bV="@firebase/messaging",wV="@firebase/messaging-compat",_V="@firebase/performance",NV="@firebase/performance-compat",EV="@firebase/remote-config",TV="@firebase/remote-config-compat",SV="@firebase/storage",jV="@firebase/storage-compat",kV="@firebase/firestore",IV="@firebase/vertexai-preview",CV="@firebase/firestore-compat",AV="firebase",RV="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lg="[DEFAULT]",PV={[Mg]:"fire-core",[aV]:"fire-core-compat",[lV]:"fire-analytics",[oV]:"fire-analytics-compat",[uV]:"fire-app-check",[cV]:"fire-app-check-compat",[dV]:"fire-auth",[hV]:"fire-auth-compat",[fV]:"fire-rtdb",[mV]:"fire-data-connect",[pV]:"fire-rtdb-compat",[gV]:"fire-fn",[xV]:"fire-fn-compat",[yV]:"fire-iid",[vV]:"fire-iid-compat",[bV]:"fire-fcm",[wV]:"fire-fcm-compat",[_V]:"fire-perf",[NV]:"fire-perf-compat",[EV]:"fire-rc",[TV]:"fire-rc-compat",[SV]:"fire-gcs",[jV]:"fire-gcs-compat",[kV]:"fire-fst",[CV]:"fire-fst-compat",[IV]:"fire-vertex","fire-js":"fire-js",[AV]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=new Map,DV=new Map,Og=new Map;function jw(t,e){try{t.container.addComponent(e)}catch(n){Lr.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Vi(t){const e=t.name;if(Og.has(e))return Lr.debug(`There were multiple attempts to register component ${e}.`),!1;Og.set(e,t);for(const n of Yh.values())jw(n,t);for(const n of DV.values())jw(n,t);return!0}function Du(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function tr(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VV={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ci=new yj("app","Firebase",VV);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MV{constructor(e,n,s){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=s,this.container.addComponent(new Qh("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ci.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ka=RV;function wj(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const s=Object.assign({name:Lg,automaticDataCollectionEnabled:!1},e),r=s.name;if(typeof r!="string"||!r)throw Ci.create("bad-app-name",{appName:String(r)});if(n||(n=gj()),!n)throw Ci.create("no-options");const i=Yh.get(r);if(i){if(Pg(n,i.options)&&Pg(s,i.config))return i;throw Ci.create("duplicate-app",{appName:r})}const o=new BD(r);for(const c of Og.values())o.addComponent(c);const l=new MV(n,s,o);return Yh.set(r,l),l}function Py(t=Lg){const e=Yh.get(t);if(!e&&t===Lg&&gj())return wj();if(!e)throw Ci.create("no-app",{appName:t});return e}function Is(t,e,n){var s;let r=(s=PV[t])!==null&&s!==void 0?s:t;n&&(r+=`-${n}`);const i=r.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${r}" with version "${e}":`];i&&l.push(`library name "${r}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Lr.warn(l.join(" "));return}Vi(new Qh(`${r}-version`,()=>({library:r,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LV="firebase-heartbeat-database",OV=1,lu="firebase-heartbeat-store";let ap=null;function _j(){return ap||(ap=tV(LV,OV,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(lu)}catch(n){console.warn(n)}}}}).catch(t=>{throw Ci.create("idb-open",{originalErrorMessage:t.message})})),ap}async function FV(t){try{const n=(await _j()).transaction(lu),s=await n.objectStore(lu).get(Nj(t));return await n.done,s}catch(e){if(e instanceof Ay)Lr.warn(e.message);else{const n=Ci.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Lr.warn(n.message)}}}async function kw(t,e){try{const s=(await _j()).transaction(lu,"readwrite");await s.objectStore(lu).put(e,Nj(t)),await s.done}catch(n){if(n instanceof Ay)Lr.warn(n.message);else{const s=Ci.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Lr.warn(s.message)}}}function Nj(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UV=1024,BV=30*24*60*60*1e3;class $V{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new qV(n),this._heartbeatsCachePromise=this._storage.read().then(s=>(this._heartbeatsCache=s,s))}async triggerHeartbeat(){var e,n;try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Iw();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:r}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(o=>{const l=new Date(o.date).valueOf();return Date.now()-l<=BV}),this._storage.overwrite(this._heartbeatsCache))}catch(s){Lr.warn(s)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Iw(),{heartbeatsToSend:s,unsentEntries:r}=zV(this._heartbeatsCache.heartbeats),i=pj(JSON.stringify({version:2,heartbeats:s}));return this._heartbeatsCache.lastSentHeartbeatDate=n,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Lr.warn(n),""}}}function Iw(){return new Date().toISOString().substring(0,10)}function zV(t,e=UV){const n=[];let s=t.slice();for(const r of t){const i=n.find(o=>o.agent===r.agent);if(i){if(i.dates.push(r.date),Cw(n)>e){i.dates.pop();break}}else if(n.push({agent:r.agent,dates:[r.date]}),Cw(n)>e){n.pop();break}s=s.slice(1)}return{heartbeatsToSend:n,unsentEntries:s}}class qV{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return PD()?DD().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await FV(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return kw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const r=await this.read();return kw(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:r.lastSentHeartbeatDate,heartbeats:[...r.heartbeats,...e.heartbeats]})}else return}}function Cw(t){return pj(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WV(t){Vi(new Qh("platform-logger",e=>new rV(e),"PRIVATE")),Vi(new Qh("heartbeat",e=>new $V(e),"PRIVATE")),Is(Mg,Sw,t),Is(Mg,Sw,"esm2017"),Is("fire-js","")}WV("");var Aw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GV=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},HV=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],l=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},KV={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,l=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,x=u&63;c||(x=64,o||(m=64)),s.push(n[h],n[f],n[m],n[x])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(GV(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HV(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const f=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||l==null||u==null||f==null)throw new QV;const m=i<<2|l>>4;if(s.push(m),u!==64){const x=l<<4&240|u>>2;if(s.push(x),f!==64){const b=u<<6&192|f;s.push(b)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let QV=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const Ej=function(t){try{return KV.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YV(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XV=()=>YV().__FIREBASE_DEFAULTS__,JV=()=>{if(typeof process>"u"||typeof Aw>"u")return;const t=Aw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ZV=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&Ej(t[1]);return e&&JSON.parse(e)},Tj=()=>{try{return XV()||JV()||ZV()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},e4=t=>{var e,n;return(n=(e=Tj())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Sj=t=>{var e;return(e=Tj())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $n(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function t4(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test($n())}function n4(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function s4(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function r4(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function i4(){const t=$n();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a4="FirebaseError";let Hf=class jj extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=a4,Object.setPrototypeOf(this,jj.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Kf.prototype.create)}},Kf=class{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?o4(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new Hf(r,l,s)}};function o4(t,e){return t.replace(l4,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const l4=/\{\$([^}]+)}/g;function c4(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function kj(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(Rw(i)&&Rw(o)){if(!kj(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function Rw(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vu(t){const e=[];for(const[n,s]of Object.entries(t))Array.isArray(s)?s.forEach(r=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(r))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(s));return e.length?"&"+e.join("&"):""}function fc(t){const e={};return t.replace(/^\?/,"").split("&").forEach(s=>{if(s){const[r,i]=s.split("=");e[decodeURIComponent(r)]=decodeURIComponent(i)}}),e}function mc(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function u4(t,e){const n=new d4(t,e);return n.subscribe.bind(n)}class d4{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(s=>{this.error(s)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,s){let r;if(e===void 0&&n===void 0&&s===void 0)throw new Error("Missing Observer.");h4(e,["next","error","complete"])?r=e:r={next:e,error:n,complete:s},r.next===void 0&&(r.next=op),r.error===void 0&&(r.error=op),r.complete===void 0&&(r.complete=op);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch{}}),this.observers.push(r),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(s){typeof console<"u"&&console.error&&console.error(s)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function h4(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function op(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vs(t){return t&&t._delegate?t._delegate:t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(lt||(lt={}));const f4={debug:lt.DEBUG,verbose:lt.VERBOSE,info:lt.INFO,warn:lt.WARN,error:lt.ERROR,silent:lt.SILENT},m4=lt.INFO,p4={[lt.DEBUG]:"log",[lt.VERBOSE]:"log",[lt.INFO]:"info",[lt.WARN]:"warn",[lt.ERROR]:"error"},g4=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=p4[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let x4=class{constructor(e){this.name=e,this._logLevel=m4,this._logHandler=g4,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in lt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?f4[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,lt.DEBUG,...e),this._logHandler(this,lt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,lt.VERBOSE,...e),this._logHandler(this,lt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,lt.INFO,...e),this._logHandler(this,lt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,lt.WARN,...e),this._logHandler(this,lt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,lt.ERROR,...e),this._logHandler(this,lt.ERROR,...e)}};function Dy(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n}let Pw=class{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};function Ij(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const y4=Ij,Cj=new Kf("auth","Firebase",Ij());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xh=new x4("@firebase/auth");function v4(t,...e){Xh.logLevel<=lt.WARN&&Xh.warn(`Auth (${Ka}): ${t}`,...e)}function lh(t,...e){Xh.logLevel<=lt.ERROR&&Xh.error(`Auth (${Ka}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gs(t,...e){throw Vy(t,...e)}function or(t,...e){return Vy(t,...e)}function Aj(t,e,n){const s=Object.assign(Object.assign({},y4()),{[e]:n});return new Kf("auth","Firebase",s).create(e,{appName:t.name})}function Ar(t){return Aj(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Vy(t,...e){if(typeof t!="string"){const n=e[0],s=[...e.slice(1)];return s[0]&&(s[0].appName=t.name),t._errorFactory.create(n,...s)}return Cj.create(t,...e)}function De(t,e,...n){if(!t)throw Vy(e,...n)}function Tr(t){const e="INTERNAL ASSERTION FAILED: "+t;throw lh(e),new Error(e)}function Or(t,e){t||Tr(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function b4(){return Dw()==="http:"||Dw()==="https:"}function Dw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(b4()||s4()||"connection"in navigator)?navigator.onLine:!0}function _4(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mu{constructor(e,n){this.shortDelay=e,this.longDelay=n,Or(n>e,"Short delay should be less than long delay!"),this.isMobile=t4()||r4()}get(){return w4()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function My(t,e){Or(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rj{static initialize(e,n,s){this.fetchImpl=e,n&&(this.headersImpl=n),s&&(this.responseImpl=s)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Tr("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Tr("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Tr("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E4=new Mu(3e4,6e4);function Wr(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function mr(t,e,n,s,r={}){return Pj(t,r,async()=>{let i={},o={};s&&(e==="GET"?o=s:i={body:JSON.stringify(s)});const l=Vu(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return n4()||(u.referrerPolicy="no-referrer"),Rj.fetch()(Dj(t,t.config.apiHost,n,l),u)})}async function Pj(t,e,n){t._canInitEmulator=!1;const s=Object.assign(Object.assign({},N4),e);try{const r=new S4(t),i=await Promise.race([n(),r.promise]);r.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Md(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Md(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Md(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Md(t,"user-disabled",o);const h=s[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw Aj(t,h,u);Gs(t,h)}}catch(r){if(r instanceof Hf)throw r;Gs(t,"network-request-failed",{message:String(r)})}}async function Lu(t,e,n,s,r={}){const i=await mr(t,e,n,s,r);return"mfaPendingCredential"in i&&Gs(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Dj(t,e,n,s){const r=`${e}${n}?${s}`;return t.config.emulator?My(t.config,r):`${t.config.apiScheme}://${r}`}function T4(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class S4{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,s)=>{this.timer=setTimeout(()=>s(or(this.auth,"network-request-failed")),E4.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function Md(t,e,n){const s={appName:t.name};n.email&&(s.email=n.email),n.phoneNumber&&(s.phoneNumber=n.phoneNumber);const r=or(t,e,s);return r.customData._tokenResponse=n,r}function Vw(t){return t!==void 0&&t.enterprise!==void 0}class j4{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return T4(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function k4(t,e){return mr(t,"GET","/v2/recaptchaConfig",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I4(t,e){return mr(t,"POST","/v1/accounts:delete",e)}async function Vj(t,e){return mr(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cc(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function C4(t,e=!1){const n=vs(t),s=await n.getIdToken(e),r=Ly(s);De(r&&r.exp&&r.auth_time&&r.iat,n.auth,"internal-error");const i=typeof r.firebase=="object"?r.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:r,token:s,authTime:Cc(lp(r.auth_time)),issuedAtTime:Cc(lp(r.iat)),expirationTime:Cc(lp(r.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function lp(t){return Number(t)*1e3}function Ly(t){const[e,n,s]=t.split(".");if(e===void 0||n===void 0||s===void 0)return lh("JWT malformed, contained fewer than 3 sections"),null;try{const r=Ej(n);return r?JSON.parse(r):(lh("Failed to decode base64 JWT payload"),null)}catch(r){return lh("Caught error parsing JWT payload as JSON",r==null?void 0:r.toString()),null}}function Mw(t){const e=Ly(t);return De(e,"internal-error"),De(typeof e.exp<"u","internal-error"),De(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rl(t,e,n=!1){if(n)return e;try{return await e}catch(s){throw s instanceof Hf&&A4(s)&&t.auth.currentUser===t&&await t.auth.signOut(),s}}function A4({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R4{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const s=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),s}else{this.errorBackoff=3e4;const r=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,r)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ug{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Cc(this.lastLoginAt),this.creationTime=Cc(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jh(t){var e;const n=t.auth,s=await t.getIdToken(),r=await rl(t,Vj(n,{idToken:s}));De(r==null?void 0:r.users.length,n,"internal-error");const i=r.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Mj(i.providerUserInfo):[],l=D4(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),h=c?u:!1,f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new Ug(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(t,f)}async function P4(t){const e=vs(t);await Jh(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function D4(t,e){return[...t.filter(s=>!e.some(r=>r.providerId===s.providerId)),...e]}function Mj(t){return t.map(e=>{var{providerId:n}=e,s=Dy(e,["providerId"]);return{providerId:n,uid:s.rawId||"",displayName:s.displayName||null,email:s.email||null,phoneNumber:s.phoneNumber||null,photoURL:s.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V4(t,e){const n=await Pj(t,{},async()=>{const s=Vu({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:r,apiKey:i}=t.config,o=Dj(t,r,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",Rj.fetch()(o,{method:"POST",headers:l,body:s})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function M4(t,e){return mr(t,"POST","/v2/accounts:revokeToken",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wo{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){De(e.idToken,"internal-error"),De(typeof e.idToken<"u","internal-error"),De(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Mw(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){De(e.length!==0,"internal-error");const n=Mw(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(De(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:s,refreshToken:r,expiresIn:i}=await V4(e,n);this.updateTokensAndExpiration(s,r,Number(i))}updateTokensAndExpiration(e,n,s){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+s*1e3}static fromJSON(e,n){const{refreshToken:s,accessToken:r,expirationTime:i}=n,o=new Wo;return s&&(De(typeof s=="string","internal-error",{appName:e}),o.refreshToken=s),r&&(De(typeof r=="string","internal-error",{appName:e}),o.accessToken=r),i&&(De(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Wo,this.toJSON())}_performRefresh(){return Tr("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(t,e){De(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Sr{constructor(e){var{uid:n,auth:s,stsTokenManager:r}=e,i=Dy(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new R4(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=s,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ug(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await rl(this,this.stsTokenManager.getToken(this.auth,e));return De(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return C4(this,e)}reload(){return P4(this)}_assign(e){this!==e&&(De(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Sr(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){De(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let s=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),s=!0),n&&await Jh(this),await this.auth._persistUserIfCurrent(this),s&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(tr(this.auth.app))return Promise.reject(Ar(this.auth));const e=await this.getIdToken();return await rl(this,I4(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var s,r,i,o,l,c,u,h;const f=(s=n.displayName)!==null&&s!==void 0?s:void 0,m=(r=n.email)!==null&&r!==void 0?r:void 0,x=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,b=(o=n.photoURL)!==null&&o!==void 0?o:void 0,N=(l=n.tenantId)!==null&&l!==void 0?l:void 0,E=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,v=(h=n.lastLoginAt)!==null&&h!==void 0?h:void 0,{uid:T,emailVerified:I,isAnonymous:R,providerData:V,stsTokenManager:j}=n;De(T&&j,e,"internal-error");const y=Wo.fromJSON(this.name,j);De(typeof T=="string",e,"internal-error"),ri(f,e.name),ri(m,e.name),De(typeof I=="boolean",e,"internal-error"),De(typeof R=="boolean",e,"internal-error"),ri(x,e.name),ri(b,e.name),ri(N,e.name),ri(E,e.name),ri(w,e.name),ri(v,e.name);const k=new Sr({uid:T,auth:e,email:m,emailVerified:I,displayName:f,isAnonymous:R,photoURL:b,phoneNumber:x,tenantId:N,stsTokenManager:y,createdAt:w,lastLoginAt:v});return V&&Array.isArray(V)&&(k.providerData=V.map(S=>Object.assign({},S))),E&&(k._redirectEventId=E),k}static async _fromIdTokenResponse(e,n,s=!1){const r=new Wo;r.updateFromServerResponse(n);const i=new Sr({uid:n.localId,auth:e,stsTokenManager:r,isAnonymous:s});return await Jh(i),i}static async _fromGetAccountInfoResponse(e,n,s){const r=n.users[0];De(r.localId!==void 0,"internal-error");const i=r.providerUserInfo!==void 0?Mj(r.providerUserInfo):[],o=!(r.email&&r.passwordHash)&&!(i!=null&&i.length),l=new Wo;l.updateFromIdToken(s);const c=new Sr({uid:r.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new Ug(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lw=new Map;function jr(t){Or(t instanceof Function,"Expected a class definition");let e=Lw.get(t);return e?(Or(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Lw.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Lj.type="NONE";const Ow=Lj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ch(t,e,n){return`firebase:${t}:${e}:${n}`}class Go{constructor(e,n,s){this.persistence=e,this.auth=n,this.userKey=s;const{config:r,name:i}=this.auth;this.fullUserKey=ch(this.userKey,r.apiKey,i),this.fullPersistenceKey=ch("persistence",r.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?Sr._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,s="authUser"){if(!n.length)return new Go(jr(Ow),e,s);const r=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=r[0]||jr(Ow);const o=ch(s,e.config.apiKey,e.name);let l=null;for(const u of n)try{const h=await u._get(o);if(h){const f=Sr._fromJSON(e,h);u!==i&&(l=f),i=u;break}}catch{}const c=r.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Go(i,e,s):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Go(i,e,s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fw(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Bj(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Oj(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(zj(e))return"Blackberry";if(qj(e))return"Webos";if(Fj(e))return"Safari";if((e.includes("chrome/")||Uj(e))&&!e.includes("edge/"))return"Chrome";if($j(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,s=t.match(n);if((s==null?void 0:s.length)===2)return s[1]}return"Other"}function Oj(t=$n()){return/firefox\//i.test(t)}function Fj(t=$n()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Uj(t=$n()){return/crios\//i.test(t)}function Bj(t=$n()){return/iemobile/i.test(t)}function $j(t=$n()){return/android/i.test(t)}function zj(t=$n()){return/blackberry/i.test(t)}function qj(t=$n()){return/webos/i.test(t)}function Oy(t=$n()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function L4(t=$n()){var e;return Oy(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function O4(){return i4()&&document.documentMode===10}function Wj(t=$n()){return Oy(t)||$j(t)||qj(t)||zj(t)||/windows phone/i.test(t)||Bj(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gj(t,e=[]){let n;switch(t){case"Browser":n=Fw($n());break;case"Worker":n=`${Fw($n())}-${t}`;break;default:n=t}const s=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${Ka}/${s}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const s=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});s.onAbort=n,this.queue.push(s);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const s of this.queue)await s(e),s.onAbort&&n.push(s.onAbort)}catch(s){n.reverse();for(const r of n)try{r()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:s==null?void 0:s.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U4(t,e={}){return mr(t,"GET","/v2/passwordPolicy",Wr(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4=6;class $4{constructor(e){var n,s,r,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:B4,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(r=(s=e.allowedNonAlphanumericCharacters)===null||s===void 0?void 0:s.join(""))!==null&&r!==void 0?r:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,s,r,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(s=c.meetsMaxPasswordLength)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(r=c.containsLowercaseLetter)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const s=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;s&&(n.meetsMinPasswordLength=e.length>=s),r&&(n.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let s;for(let r=0;r<e.length;r++)s=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(n,s>="a"&&s<="z",s>="A"&&s<="Z",s>="0"&&s<="9",this.allowedNonAlphanumericCharacters.includes(s))}updatePasswordCharacterOptionsStatuses(e,n,s,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=s)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z4{constructor(e,n,s,r){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=s,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Uw(this),this.idTokenSubscription=new Uw(this),this.beforeStateQueue=new F4(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Cj,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=jr(n)),this._initializationPromise=this.queue(async()=>{var s,r;if(!this._deleted&&(this.persistenceManager=await Go.create(this,e),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((r=this.currentUser)===null||r===void 0?void 0:r.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Vj(this,{idToken:e}),s=await Sr._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(s)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(tr(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const s=await this.assertedPersistence.getCurrentUser();let r=s,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=r==null?void 0:r._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(r=c.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(o){r=s,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return De(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Jh(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=_4()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(tr(this.app))return Promise.reject(Ar(this));const n=e?vs(e):null;return n&&De(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&De(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return tr(this.app)?Promise.reject(Ar(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return tr(this.app)?Promise.reject(Ar(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(jr(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await U4(this),n=new $4(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new Kf("auth","Firebase",e())}onAuthStateChanged(e,n,s){return this.registerStateListener(this.authStateSubscription,e,n,s)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,s){return this.registerStateListener(this.idTokenSubscription,e,n,s)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const s=this.onAuthStateChanged(()=>{s(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),s={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(s.tenantId=this.tenantId),await M4(this,s)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const s=await this.getOrInitRedirectPersistenceManager(n);return e===null?s.removeCurrentUser():s.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&jr(e)||this._popupRedirectResolver;De(n,this,"argument-error"),this.redirectPersistenceManager=await Go.create(this,[jr(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,s;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((s=this.redirectUser)===null||s===void 0?void 0:s._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const s=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==s&&(this.lastNotifiedUid=s,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,s,r){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(De(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,s,r);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return De(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Gj(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const s=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());s&&(n["X-Firebase-Client"]=s);const r=await this._getAppCheckToken();return r&&(n["X-Firebase-AppCheck"]=r),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&v4(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function qi(t){return vs(t)}class Uw{constructor(e){this.auth=e,this.observer=null,this.addObserver=u4(n=>this.observer=n)}get next(){return De(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qf={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function q4(t){Qf=t}function Hj(t){return Qf.loadJS(t)}function W4(){return Qf.recaptchaEnterpriseScript}function G4(){return Qf.gapiScript}function H4(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const K4="recaptcha-enterprise",Q4="NO_RECAPTCHA";class Y4{constructor(e){this.type=K4,this.auth=qi(e)}async verify(e="verify",n=!1){async function s(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{k4(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new j4(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function r(i,o,l){const c=window.grecaptcha;Vw(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(Q4)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,o)=>{s(this.auth).then(l=>{if(!n&&Vw(window.grecaptcha))r(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=W4();c.length!==0&&(c+=l),Hj(c).then(()=>{r(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function Bw(t,e,n,s=!1){const r=new Y4(t);let i;try{i=await r.verify(n)}catch{i=await r.verify(n,!0)}const o=Object.assign({},e);return s?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Zh(t,e,n,s){var r;if(!((r=t._getRecaptchaConfig())===null||r===void 0)&&r.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Bw(t,e,n,n==="getOobCode");return s(t,i)}else return s(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const o=await Bw(t,e,n,n==="getOobCode");return s(t,o)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X4(t,e){const n=Du(t,"auth");if(n.isInitialized()){const r=n.getImmediate(),i=n.getOptions();if(kj(i,e??{}))return r;Gs(r,"already-initialized")}return n.initialize({options:e})}function J4(t,e){const n=(e==null?void 0:e.persistence)||[],s=(Array.isArray(n)?n:[n]).map(jr);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(s,e==null?void 0:e.popupRedirectResolver)}function Z4(t,e,n){const s=qi(t);De(s._canInitEmulator,s,"emulator-config-failed"),De(/^https?:\/\//.test(e),s,"invalid-emulator-scheme");const r=!1,i=Kj(e),{host:o,port:l}=eM(e),c=l===null?"":`:${l}`;s.config.emulator={url:`${i}//${o}${c}/`},s.settings.appVerificationDisabledForTesting=!0,s.emulatorConfig=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:r})}),tM()}function Kj(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function eM(t){const e=Kj(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const s=n[2].split("@").pop()||"",r=/^(\[[^\]]+\])(:|$)/.exec(s);if(r){const i=r[1];return{host:i,port:$w(s.substr(i.length+1))}}else{const[i,o]=s.split(":");return{host:i,port:$w(o)}}}function $w(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function tM(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Tr("not implemented")}_getIdTokenResponse(e){return Tr("not implemented")}_linkToIdToken(e,n){return Tr("not implemented")}_getReauthenticationResolver(e){return Tr("not implemented")}}async function nM(t,e){return mr(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sM(t,e){return Lu(t,"POST","/v1/accounts:signInWithPassword",Wr(t,e))}async function Qj(t,e){return mr(t,"POST","/v1/accounts:sendOobCode",Wr(t,e))}async function rM(t,e){return Qj(t,e)}async function iM(t,e){return Qj(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aM(t,e){return Lu(t,"POST","/v1/accounts:signInWithEmailLink",Wr(t,e))}async function oM(t,e){return Lu(t,"POST","/v1/accounts:signInWithEmailLink",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu extends Fy{constructor(e,n,s,r=null){super("password",s),this._email=e,this._password=n,this._tenantId=r}static _fromEmailAndPassword(e,n){return new cu(e,n,"password")}static _fromEmailAndCode(e,n,s=null){return new cu(e,n,"emailLink",s)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zh(e,n,"signInWithPassword",sM);case"emailLink":return aM(e,{email:this._email,oobCode:this._password});default:Gs(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const s={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Zh(e,s,"signUpPassword",nM);case"emailLink":return oM(e,{idToken:n,email:this._email,oobCode:this._password});default:Gs(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ho(t,e){return Lu(t,"POST","/v1/accounts:signInWithIdp",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lM="http://localhost";class Pa extends Fy{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Pa(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Gs("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:s,signInMethod:r}=n,i=Dy(n,["providerId","signInMethod"]);if(!s||!r)return null;const o=new Pa(s,r);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ho(e,n)}_linkToIdToken(e,n){const s=this.buildRequest();return s.idToken=n,Ho(e,s)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ho(e,n)}buildRequest(){const e={requestUri:lM,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Vu(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cM(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function uM(t){const e=fc(mc(t)).link,n=e?fc(mc(e)).deep_link_id:null,s=fc(mc(t)).deep_link_id;return(s?fc(mc(s)).link:null)||s||n||e||t}class Uy{constructor(e){var n,s,r,i,o,l;const c=fc(mc(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,h=(s=c.oobCode)!==null&&s!==void 0?s:null,f=cM((r=c.mode)!==null&&r!==void 0?r:null);De(u&&h&&f,"argument-error"),this.apiKey=u,this.operation=f,this.code=h,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.languageCode)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=uM(e);try{return new Uy(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class El{constructor(){this.providerId=El.PROVIDER_ID}static credential(e,n){return cu._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const s=Uy.parseLink(n);return De(s,"argument-error"),cu._fromEmailAndCode(e,s.code,s.tenantId)}}El.PROVIDER_ID="password";El.EMAIL_PASSWORD_SIGN_IN_METHOD="password";El.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yj{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ou extends Yj{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi extends Ou{constructor(){super("facebook.com")}static credential(e){return Pa._fromParams({providerId:hi.PROVIDER_ID,signInMethod:hi.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return hi.credentialFromTaggedObject(e)}static credentialFromError(e){return hi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return hi.credential(e.oauthAccessToken)}catch{return null}}}hi.FACEBOOK_SIGN_IN_METHOD="facebook.com";hi.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fi extends Ou{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Pa._fromParams({providerId:fi.PROVIDER_ID,signInMethod:fi.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return fi.credentialFromTaggedObject(e)}static credentialFromError(e){return fi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:s}=e;if(!n&&!s)return null;try{return fi.credential(n,s)}catch{return null}}}fi.GOOGLE_SIGN_IN_METHOD="google.com";fi.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi extends Ou{constructor(){super("github.com")}static credential(e){return Pa._fromParams({providerId:mi.PROVIDER_ID,signInMethod:mi.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return mi.credentialFromTaggedObject(e)}static credentialFromError(e){return mi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return mi.credential(e.oauthAccessToken)}catch{return null}}}mi.GITHUB_SIGN_IN_METHOD="github.com";mi.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pi extends Ou{constructor(){super("twitter.com")}static credential(e,n){return Pa._fromParams({providerId:pi.PROVIDER_ID,signInMethod:pi.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return pi.credentialFromTaggedObject(e)}static credentialFromError(e){return pi.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:s}=e;if(!n||!s)return null;try{return pi.credential(n,s)}catch{return null}}}pi.TWITTER_SIGN_IN_METHOD="twitter.com";pi.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dM(t,e){return Lu(t,"POST","/v1/accounts:signUp",Wr(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,s,r=!1){const i=await Sr._fromIdTokenResponse(e,s,r),o=zw(s);return new Da({user:i,providerId:o,_tokenResponse:s,operationType:n})}static async _forOperation(e,n,s){await e._updateTokensIfNecessary(s,!0);const r=zw(s);return new Da({user:e,providerId:r,_tokenResponse:s,operationType:n})}}function zw(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ef extends Hf{constructor(e,n,s,r){var i;super(n.code,n.message),this.operationType=s,this.user=r,Object.setPrototypeOf(this,ef.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:s}}static _fromErrorAndOperation(e,n,s,r){return new ef(e,n,s,r)}}function Xj(t,e,n,s){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?ef._fromErrorAndOperation(t,i,e,s):i})}async function hM(t,e,n=!1){const s=await rl(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Da._forOperation(t,"link",s)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fM(t,e,n=!1){const{auth:s}=t;if(tr(s.app))return Promise.reject(Ar(s));const r="reauthenticate";try{const i=await rl(t,Xj(s,r,e,t),n);De(i.idToken,s,"internal-error");const o=Ly(i.idToken);De(o,s,"internal-error");const{sub:l}=o;return De(t.uid===l,s,"user-mismatch"),Da._forOperation(t,r,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Gs(s,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Jj(t,e,n=!1){if(tr(t.app))return Promise.reject(Ar(t));const s="signIn",r=await Xj(t,s,e),i=await Da._fromIdTokenResponse(t,s,r);return n||await t._updateCurrentUser(i.user),i}async function mM(t,e){return Jj(qi(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zj(t){const e=qi(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function e1(t,e,n){const s=qi(t);await Zh(s,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",iM)}async function pM(t,e,n){if(tr(t.app))return Promise.reject(Ar(t));const s=qi(t),o=await Zh(s,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",dM).catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Zj(t),c}),l=await Da._fromIdTokenResponse(s,"signIn",o);return await s._updateCurrentUser(l.user),l}function gM(t,e,n){return tr(t.app)?Promise.reject(Ar(t)):mM(vs(t),El.credential(e,n)).catch(async s=>{throw s.code==="auth/password-does-not-meet-requirements"&&Zj(t),s})}async function t1(t,e){const n=vs(t),r={requestType:"VERIFY_EMAIL",idToken:await t.getIdToken()},{email:i}=await rM(n.auth,r);i!==t.email&&await t.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xM(t,e){return mr(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yM(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const s=vs(t),i={idToken:await s.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},o=await rl(s,xM(s.auth,i));s.displayName=o.displayName||null,s.photoURL=o.photoUrl||null;const l=s.providerData.find(({providerId:c})=>c==="password");l&&(l.displayName=s.displayName,l.photoURL=s.photoURL),await s._updateTokensIfNecessary(o)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vM(t,e){return vs(t).setPersistence(e)}function bM(t,e,n,s){return vs(t).onIdTokenChanged(e,n,s)}function wM(t,e,n){return vs(t).beforeAuthStateChanged(e,n)}function Pt(t,e,n,s){return vs(t).onAuthStateChanged(e,n,s)}function Fu(t){return vs(t).signOut()}async function _M(t){return vs(t).delete()}const tf="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n1{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(tf,"1"),this.storage.removeItem(tf),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const NM=1e3,EM=10;class s1 extends n1{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Wj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const s=this.storage.getItem(n),r=this.localCache[n];s!==r&&e(n,r,s)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const s=e.key;n?this.detachListener():this.stopPolling();const r=()=>{const o=this.storage.getItem(s);!n&&this.localCache[s]===o||this.notifyListeners(s,o)},i=this.storage.getItem(s);O4()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,EM):r()}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,s)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:s}),!0)})},NM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}s1.type="LOCAL";const r1=s1;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i1 extends n1{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}i1.type="SESSION";const a1=i1;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yf{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(r=>r.isListeningto(e));if(n)return n;const s=new Yf(e);return this.receivers.push(s),s}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:s,eventType:r,data:i}=n.data,o=this.handlersMap[r];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:s,eventType:r});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await TM(l);n.ports[0].postMessage({status:"done",eventId:s,eventType:r,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Yf.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(t="",e=10){let n="";for(let s=0;s<e;s++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SM{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,s=50){const r=typeof MessageChannel<"u"?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=By("",20);r.port1.start();const h=setTimeout(()=>{c(new Error("unsupported_event"))},s);o={messageChannel:r,onMessage(f){const m=f;if(m.data.eventId===u)switch(m.data.status){case"ack":clearTimeout(h),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(m.data.response);break;default:clearTimeout(h),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),r.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[r.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lr(){return window}function jM(t){lr().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o1(){return typeof lr().WorkerGlobalScope<"u"&&typeof lr().importScripts=="function"}async function kM(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function IM(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function CM(){return o1()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l1="firebaseLocalStorageDb",AM=1,nf="firebaseLocalStorage",c1="fbase_key";class Uu{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function Xf(t,e){return t.transaction([nf],e?"readwrite":"readonly").objectStore(nf)}function RM(){const t=indexedDB.deleteDatabase(l1);return new Uu(t).toPromise()}function Bg(){const t=indexedDB.open(l1,AM);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const s=t.result;try{s.createObjectStore(nf,{keyPath:c1})}catch(r){n(r)}}),t.addEventListener("success",async()=>{const s=t.result;s.objectStoreNames.contains(nf)?e(s):(s.close(),await RM(),e(await Bg()))})})}async function qw(t,e,n){const s=Xf(t,!0).put({[c1]:e,value:n});return new Uu(s).toPromise()}async function PM(t,e){const n=Xf(t,!1).get(e),s=await new Uu(n).toPromise();return s===void 0?null:s.value}function Ww(t,e){const n=Xf(t,!0).delete(e);return new Uu(n).toPromise()}const DM=800,VM=3;class u1{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Bg(),this.db)}async _withRetries(e){let n=0;for(;;)try{const s=await this._openDb();return await e(s)}catch(s){if(n++>VM)throw s;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return o1()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Yf._getInstance(CM()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await kM(),!this.activeServiceWorker)return;this.sender=new SM(this.activeServiceWorker);const s=await this.sender._send("ping",{},800);s&&!((e=s[0])===null||e===void 0)&&e.fulfilled&&!((n=s[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||IM()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Bg();return await qw(e,tf,"1"),await Ww(e,tf),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(s=>qw(s,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(s=>PM(s,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>Ww(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(r=>{const i=Xf(r,!1).getAll();return new Uu(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],s=new Set;if(e.length!==0)for(const{fbase_key:r,value:i}of e)s.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),n.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!s.has(r)&&(this.notifyListeners(r,null),n.push(r));return n}notifyListeners(e,n){this.localCache[e]=n;const s=this.listeners[e];if(s)for(const r of Array.from(s))r(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),DM)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}u1.type="LOCAL";const MM=u1;new Mu(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LM(t,e){return e?jr(e):(De(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $y extends Fy{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ho(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ho(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ho(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function OM(t){return Jj(t.auth,new $y(t),t.bypassAuthState)}function FM(t){const{auth:e,user:n}=t;return De(n,e,"internal-error"),fM(n,new $y(t),t.bypassAuthState)}async function UM(t){const{auth:e,user:n}=t;return De(n,e,"internal-error"),hM(n,new $y(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d1{constructor(e,n,s,r,i=!1){this.auth=e,this.resolver=s,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(s){this.reject(s)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:s,postBody:r,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:s,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OM;case"linkViaPopup":case"linkViaRedirect":return UM;case"reauthViaPopup":case"reauthViaRedirect":return FM;default:Gs(this.auth,"internal-error")}}resolve(e){Or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Or(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BM=new Mu(2e3,1e4);class Po extends d1{constructor(e,n,s,r,i){super(e,n,r,i),this.provider=s,this.authWindow=null,this.pollId=null,Po.currentPopupAction&&Po.currentPopupAction.cancel(),Po.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return De(e,this.auth,"internal-error"),e}async onExecution(){Or(this.filter.length===1,"Popup operations only handle one event");const e=By();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(or(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(or(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Po.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,s;if(!((s=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||s===void 0)&&s.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(or(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,BM.get())};e()}}Po.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $M="pendingRedirect",uh=new Map;class zM extends d1{constructor(e,n,s=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,s),this.eventId=null}async execute(){let e=uh.get(this.auth._key());if(!e){try{const s=await qM(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(s)}catch(n){e=()=>Promise.reject(n)}uh.set(this.auth._key(),e)}return this.bypassAuthState||uh.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function qM(t,e){const n=HM(e),s=GM(t);if(!await s._isAvailable())return!1;const r=await s._get(n)==="true";return await s._remove(n),r}function WM(t,e){uh.set(t._key(),e)}function GM(t){return jr(t._redirectPersistence)}function HM(t){return ch($M,t.config.apiKey,t.name)}async function KM(t,e,n=!1){if(tr(t.app))return Promise.reject(Ar(t));const s=qi(t),r=LM(s,e),o=await new zM(s,r,n).execute();return o&&!n&&(delete o.user._redirectEventId,await s._persistUserIfCurrent(o.user),await s._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QM=10*60*1e3;class YM{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(s=>{this.isEventForConsumer(e,s)&&(n=!0,this.sendToConsumer(e,s),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!XM(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var s;if(e.error&&!h1(e)){const r=((s=e.error.code)===null||s===void 0?void 0:s.split("auth/")[1])||"internal-error";n.onError(or(this.auth,r))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const s=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&s}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=QM&&this.cachedEventUids.clear(),this.cachedEventUids.has(Gw(e))}saveEventToCache(e){this.cachedEventUids.add(Gw(e)),this.lastProcessedEventTime=Date.now()}}function Gw(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function h1({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function XM(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return h1(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function JM(t,e={}){return mr(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZM=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,eL=/^https?/;async function tL(t){if(t.config.emulator)return;const{authorizedDomains:e}=await JM(t);for(const n of e)try{if(nL(n))return}catch{}Gs(t,"unauthorized-domain")}function nL(t){const e=Fg(),{protocol:n,hostname:s}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&s===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===s}if(!eL.test(n))return!1;if(ZM.test(t))return s===t;const r=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+r+"|"+r+")$","i").test(s)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sL=new Mu(3e4,6e4);function Hw(){const t=lr().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function rL(t){return new Promise((e,n)=>{var s,r,i;function o(){Hw(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Hw(),n(or(t,"network-request-failed"))},timeout:sL.get()})}if(!((r=(s=lr().gapi)===null||s===void 0?void 0:s.iframes)===null||r===void 0)&&r.Iframe)e(gapi.iframes.getContext());else if(!((i=lr().gapi)===null||i===void 0)&&i.load)o();else{const l=H4("iframefcb");return lr()[l]=()=>{gapi.load?o():n(or(t,"network-request-failed"))},Hj(`${G4()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw dh=null,e})}let dh=null;function iL(t){return dh=dh||rL(t),dh}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aL=new Mu(5e3,15e3),oL="__/auth/iframe",lL="emulator/auth/iframe",cL={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},uL=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function dL(t){const e=t.config;De(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?My(e,lL):`https://${t.config.authDomain}/${oL}`,s={apiKey:e.apiKey,appName:t.name,v:Ka},r=uL.get(t.config.apiHost);r&&(s.eid=r);const i=t._getFrameworks();return i.length&&(s.fw=i.join(",")),`${n}?${Vu(s).slice(1)}`}async function hL(t){const e=await iL(t),n=lr().gapi;return De(n,t,"internal-error"),e.open({where:document.body,url:dL(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:cL,dontclear:!0},s=>new Promise(async(r,i)=>{await s.restyle({setHideOnLeave:!1});const o=or(t,"network-request-failed"),l=lr().setTimeout(()=>{i(o)},aL.get());function c(){lr().clearTimeout(l),r(s)}s.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fL={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},mL=500,pL=600,gL="_blank",xL="http://localhost";class Kw{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function yL(t,e,n,s=mL,r=pL){const i=Math.max((window.screen.availHeight-r)/2,0).toString(),o=Math.max((window.screen.availWidth-s)/2,0).toString();let l="";const c=Object.assign(Object.assign({},fL),{width:s.toString(),height:r.toString(),top:i,left:o}),u=$n().toLowerCase();n&&(l=Uj(u)?gL:n),Oj(u)&&(e=e||xL,c.scrollbars="yes");const h=Object.entries(c).reduce((m,[x,b])=>`${m}${x}=${b},`,"");if(L4(u)&&l!=="_self")return vL(e||"",l),new Kw(null);const f=window.open(e||"",l,h);De(f,t,"popup-blocked");try{f.focus()}catch{}return new Kw(f)}function vL(t,e){const n=document.createElement("a");n.href=t,n.target=e;const s=document.createEvent("MouseEvent");s.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(s)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL="__/auth/handler",wL="emulator/auth/handler",_L=encodeURIComponent("fac");async function Qw(t,e,n,s,r,i){De(t.config.authDomain,t,"auth-domain-config-required"),De(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:s,v:Ka,eventId:r};if(e instanceof Yj){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",c4(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[h,f]of Object.entries({}))o[h]=f}if(e instanceof Ou){const h=e.getScopes().filter(f=>f!=="");h.length>0&&(o.scopes=h.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const h of Object.keys(l))l[h]===void 0&&delete l[h];const c=await t._getAppCheckToken(),u=c?`#${_L}=${encodeURIComponent(c)}`:"";return`${NL(t)}?${Vu(l).slice(1)}${u}`}function NL({config:t}){return t.emulator?My(t,wL):`https://${t.authDomain}/${bL}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="webStorageSupport";class EL{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=a1,this._completeRedirectFn=KM,this._overrideRedirectResult=WM}async _openPopup(e,n,s,r){var i;Or((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await Qw(e,n,s,Fg(),r);return yL(e,o,By())}async _openRedirect(e,n,s,r){await this._originValidation(e);const i=await Qw(e,n,s,Fg(),r);return jM(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:r,promise:i}=this.eventManagers[n];return r?Promise.resolve(r):(Or(i,"If manager is not set, promise should be"),i)}const s=this.initAndGetManager(e);return this.eventManagers[n]={promise:s},s.catch(()=>{delete this.eventManagers[n]}),s}async initAndGetManager(e){const n=await hL(e),s=new YM(e);return n.register("authEvent",r=>(De(r==null?void 0:r.authEvent,e,"invalid-auth-event"),{status:s.onEvent(r.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:s},this.iframes[e._key()]=n,s}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(cp,{type:cp},r=>{var i;const o=(i=r==null?void 0:r[0])===null||i===void 0?void 0:i[cp];o!==void 0&&n(!!o),Gs(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=tL(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Wj()||Fj()||Oy()}}const TL=EL;var Yw="@firebase/auth",Xw="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SL{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(s=>{e((s==null?void 0:s.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){De(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jL(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function kL(t){Vi(new Pw("auth",(e,{options:n})=>{const s=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=s.options;De(o&&!o.includes(":"),"invalid-api-key",{appName:s.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Gj(t)},u=new z4(s,r,i,c);return J4(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,s)=>{e.getProvider("auth-internal").initialize()})),Vi(new Pw("auth-internal",e=>{const n=qi(e.getProvider("auth").getImmediate());return(s=>new SL(s))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),Is(Yw,Xw,jL(t)),Is(Yw,Xw,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IL=5*60,CL=Sj("authIdTokenMaxAge")||IL;let Jw=null;const AL=t=>async e=>{const n=e&&await e.getIdTokenResult(),s=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(s&&s>CL)return;const r=n==null?void 0:n.token;Jw!==r&&(Jw=r,await fetch(t,{method:r?"POST":"DELETE",headers:r?{Authorization:`Bearer ${r}`}:{}}))};function RL(t=Py()){const e=Du(t,"auth");if(e.isInitialized())return e.getImmediate();const n=X4(t,{popupRedirectResolver:TL,persistence:[MM,r1,a1]}),s=Sj("authTokenSyncURL");if(s&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(s,location.origin);if(location.origin===i.origin){const o=AL(i.toString());wM(n,o,()=>o(n.currentUser)),bM(n,l=>o(l))}}const r=e4("auth");return r&&Z4(n,`http://${r}`),n}function PL(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}q4({loadJS(t){return new Promise((e,n)=>{const s=document.createElement("script");s.setAttribute("src",t),s.onload=e,s.onerror=r=>{const i=or("internal-error");i.customData=r,n(i)},s.type="text/javascript",s.charset="UTF-8",PL().appendChild(s)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});kL("Browser");var DL="firebase",VL="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Is(DL,VL,"app");var Zw={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},LL=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],l=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},OL={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,l=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,x=u&63;c||(x=64,o||(m=64)),s.push(n[h],n[f],n[m],n[x])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(ML(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):LL(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const f=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||l==null||u==null||f==null)throw new FL;const m=i<<2|l>>4;if(s.push(m),u!==64){const x=l<<4&240|u>>2;if(s.push(x),f!==64){const b=u<<6&192|f;s.push(b)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let FL=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const UL=function(t){try{return OL.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BL(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $L=()=>BL().__FIREBASE_DEFAULTS__,zL=()=>{if(typeof process>"u"||typeof Zw>"u")return;const t=Zw.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},qL=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UL(t[1]);return e&&JSON.parse(e)},WL=()=>{try{return $L()||zL()||qL()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sf(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function GL(){var t;const e=(t=WL())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function f1(){return!GL()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function HL(){try{return typeof indexedDB=="object"}catch{return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KL="FirebaseError";let m1=class p1 extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=KL,Object.setPrototypeOf(this,p1.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,QL.prototype.create)}},QL=class{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?YL(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new m1(r,l,s)}};function YL(t,e){return t.replace(XL,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const XL=/\{\$([^}]+)}/g;function Jf(t,e){if(t===e)return!0;const n=Object.keys(t),s=Object.keys(e);for(const r of n){if(!s.includes(r))return!1;const i=t[r],o=e[r];if(e_(i)&&e_(o)){if(!Jf(i,o))return!1}else if(i!==o)return!1}for(const r of s)if(!n.includes(r))return!1;return!0}function e_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ps(t){return t&&t._delegate?t._delegate:t}let JL=class{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ye;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Ye||(Ye={}));const ZL={debug:Ye.DEBUG,verbose:Ye.VERBOSE,info:Ye.INFO,warn:Ye.WARN,error:Ye.ERROR,silent:Ye.SILENT},eO=Ye.INFO,tO={[Ye.DEBUG]:"log",[Ye.VERBOSE]:"log",[Ye.INFO]:"info",[Ye.WARN]:"warn",[Ye.ERROR]:"error"},nO=(t,e,...n)=>{if(e<t.logLevel)return;const s=new Date().toISOString(),r=tO[e];if(r)console[r](`[${s}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sO{constructor(e){this.name=e,this._logLevel=eO,this._logHandler=nO,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ye))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?ZL[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ye.DEBUG,...e),this._logHandler(this,Ye.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ye.VERBOSE,...e),this._logHandler(this,Ye.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ye.INFO,...e),this._logHandler(this,Ye.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ye.WARN,...e),this._logHandler(this,Ye.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ye.ERROR,...e),this._logHandler(this,Ye.ERROR,...e)}}var t_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Na,g1;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,y){function k(){}k.prototype=y.prototype,j.D=y.prototype,j.prototype=new k,j.prototype.constructor=j,j.C=function(S,D,P){for(var C=Array(arguments.length-2),q=2;q<arguments.length;q++)C[q-2]=arguments[q];return y.prototype[D].apply(S,C)}}function n(){this.blockSize=-1}function s(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(s,n),s.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(j,y,k){k||(k=0);var S=Array(16);if(typeof y=="string")for(var D=0;16>D;++D)S[D]=y.charCodeAt(k++)|y.charCodeAt(k++)<<8|y.charCodeAt(k++)<<16|y.charCodeAt(k++)<<24;else for(D=0;16>D;++D)S[D]=y[k++]|y[k++]<<8|y[k++]<<16|y[k++]<<24;y=j.g[0],k=j.g[1],D=j.g[2];var P=j.g[3],C=y+(P^k&(D^P))+S[0]+3614090360&4294967295;y=k+(C<<7&4294967295|C>>>25),C=P+(D^y&(k^D))+S[1]+3905402710&4294967295,P=y+(C<<12&4294967295|C>>>20),C=D+(k^P&(y^k))+S[2]+606105819&4294967295,D=P+(C<<17&4294967295|C>>>15),C=k+(y^D&(P^y))+S[3]+3250441966&4294967295,k=D+(C<<22&4294967295|C>>>10),C=y+(P^k&(D^P))+S[4]+4118548399&4294967295,y=k+(C<<7&4294967295|C>>>25),C=P+(D^y&(k^D))+S[5]+1200080426&4294967295,P=y+(C<<12&4294967295|C>>>20),C=D+(k^P&(y^k))+S[6]+2821735955&4294967295,D=P+(C<<17&4294967295|C>>>15),C=k+(y^D&(P^y))+S[7]+4249261313&4294967295,k=D+(C<<22&4294967295|C>>>10),C=y+(P^k&(D^P))+S[8]+1770035416&4294967295,y=k+(C<<7&4294967295|C>>>25),C=P+(D^y&(k^D))+S[9]+2336552879&4294967295,P=y+(C<<12&4294967295|C>>>20),C=D+(k^P&(y^k))+S[10]+4294925233&4294967295,D=P+(C<<17&4294967295|C>>>15),C=k+(y^D&(P^y))+S[11]+2304563134&4294967295,k=D+(C<<22&4294967295|C>>>10),C=y+(P^k&(D^P))+S[12]+1804603682&4294967295,y=k+(C<<7&4294967295|C>>>25),C=P+(D^y&(k^D))+S[13]+4254626195&4294967295,P=y+(C<<12&4294967295|C>>>20),C=D+(k^P&(y^k))+S[14]+2792965006&4294967295,D=P+(C<<17&4294967295|C>>>15),C=k+(y^D&(P^y))+S[15]+1236535329&4294967295,k=D+(C<<22&4294967295|C>>>10),C=y+(D^P&(k^D))+S[1]+4129170786&4294967295,y=k+(C<<5&4294967295|C>>>27),C=P+(k^D&(y^k))+S[6]+3225465664&4294967295,P=y+(C<<9&4294967295|C>>>23),C=D+(y^k&(P^y))+S[11]+643717713&4294967295,D=P+(C<<14&4294967295|C>>>18),C=k+(P^y&(D^P))+S[0]+3921069994&4294967295,k=D+(C<<20&4294967295|C>>>12),C=y+(D^P&(k^D))+S[5]+3593408605&4294967295,y=k+(C<<5&4294967295|C>>>27),C=P+(k^D&(y^k))+S[10]+38016083&4294967295,P=y+(C<<9&4294967295|C>>>23),C=D+(y^k&(P^y))+S[15]+3634488961&4294967295,D=P+(C<<14&4294967295|C>>>18),C=k+(P^y&(D^P))+S[4]+3889429448&4294967295,k=D+(C<<20&4294967295|C>>>12),C=y+(D^P&(k^D))+S[9]+568446438&4294967295,y=k+(C<<5&4294967295|C>>>27),C=P+(k^D&(y^k))+S[14]+3275163606&4294967295,P=y+(C<<9&4294967295|C>>>23),C=D+(y^k&(P^y))+S[3]+4107603335&4294967295,D=P+(C<<14&4294967295|C>>>18),C=k+(P^y&(D^P))+S[8]+1163531501&4294967295,k=D+(C<<20&4294967295|C>>>12),C=y+(D^P&(k^D))+S[13]+2850285829&4294967295,y=k+(C<<5&4294967295|C>>>27),C=P+(k^D&(y^k))+S[2]+4243563512&4294967295,P=y+(C<<9&4294967295|C>>>23),C=D+(y^k&(P^y))+S[7]+1735328473&4294967295,D=P+(C<<14&4294967295|C>>>18),C=k+(P^y&(D^P))+S[12]+2368359562&4294967295,k=D+(C<<20&4294967295|C>>>12),C=y+(k^D^P)+S[5]+4294588738&4294967295,y=k+(C<<4&4294967295|C>>>28),C=P+(y^k^D)+S[8]+2272392833&4294967295,P=y+(C<<11&4294967295|C>>>21),C=D+(P^y^k)+S[11]+1839030562&4294967295,D=P+(C<<16&4294967295|C>>>16),C=k+(D^P^y)+S[14]+4259657740&4294967295,k=D+(C<<23&4294967295|C>>>9),C=y+(k^D^P)+S[1]+2763975236&4294967295,y=k+(C<<4&4294967295|C>>>28),C=P+(y^k^D)+S[4]+1272893353&4294967295,P=y+(C<<11&4294967295|C>>>21),C=D+(P^y^k)+S[7]+4139469664&4294967295,D=P+(C<<16&4294967295|C>>>16),C=k+(D^P^y)+S[10]+3200236656&4294967295,k=D+(C<<23&4294967295|C>>>9),C=y+(k^D^P)+S[13]+681279174&4294967295,y=k+(C<<4&4294967295|C>>>28),C=P+(y^k^D)+S[0]+3936430074&4294967295,P=y+(C<<11&4294967295|C>>>21),C=D+(P^y^k)+S[3]+3572445317&4294967295,D=P+(C<<16&4294967295|C>>>16),C=k+(D^P^y)+S[6]+76029189&4294967295,k=D+(C<<23&4294967295|C>>>9),C=y+(k^D^P)+S[9]+3654602809&4294967295,y=k+(C<<4&4294967295|C>>>28),C=P+(y^k^D)+S[12]+3873151461&4294967295,P=y+(C<<11&4294967295|C>>>21),C=D+(P^y^k)+S[15]+530742520&4294967295,D=P+(C<<16&4294967295|C>>>16),C=k+(D^P^y)+S[2]+3299628645&4294967295,k=D+(C<<23&4294967295|C>>>9),C=y+(D^(k|~P))+S[0]+4096336452&4294967295,y=k+(C<<6&4294967295|C>>>26),C=P+(k^(y|~D))+S[7]+1126891415&4294967295,P=y+(C<<10&4294967295|C>>>22),C=D+(y^(P|~k))+S[14]+2878612391&4294967295,D=P+(C<<15&4294967295|C>>>17),C=k+(P^(D|~y))+S[5]+4237533241&4294967295,k=D+(C<<21&4294967295|C>>>11),C=y+(D^(k|~P))+S[12]+1700485571&4294967295,y=k+(C<<6&4294967295|C>>>26),C=P+(k^(y|~D))+S[3]+2399980690&4294967295,P=y+(C<<10&4294967295|C>>>22),C=D+(y^(P|~k))+S[10]+4293915773&4294967295,D=P+(C<<15&4294967295|C>>>17),C=k+(P^(D|~y))+S[1]+2240044497&4294967295,k=D+(C<<21&4294967295|C>>>11),C=y+(D^(k|~P))+S[8]+1873313359&4294967295,y=k+(C<<6&4294967295|C>>>26),C=P+(k^(y|~D))+S[15]+4264355552&4294967295,P=y+(C<<10&4294967295|C>>>22),C=D+(y^(P|~k))+S[6]+2734768916&4294967295,D=P+(C<<15&4294967295|C>>>17),C=k+(P^(D|~y))+S[13]+1309151649&4294967295,k=D+(C<<21&4294967295|C>>>11),C=y+(D^(k|~P))+S[4]+4149444226&4294967295,y=k+(C<<6&4294967295|C>>>26),C=P+(k^(y|~D))+S[11]+3174756917&4294967295,P=y+(C<<10&4294967295|C>>>22),C=D+(y^(P|~k))+S[2]+718787259&4294967295,D=P+(C<<15&4294967295|C>>>17),C=k+(P^(D|~y))+S[9]+3951481745&4294967295,j.g[0]=j.g[0]+y&4294967295,j.g[1]=j.g[1]+(D+(C<<21&4294967295|C>>>11))&4294967295,j.g[2]=j.g[2]+D&4294967295,j.g[3]=j.g[3]+P&4294967295}s.prototype.u=function(j,y){y===void 0&&(y=j.length);for(var k=y-this.blockSize,S=this.B,D=this.h,P=0;P<y;){if(D==0)for(;P<=k;)r(this,j,P),P+=this.blockSize;if(typeof j=="string"){for(;P<y;)if(S[D++]=j.charCodeAt(P++),D==this.blockSize){r(this,S),D=0;break}}else for(;P<y;)if(S[D++]=j[P++],D==this.blockSize){r(this,S),D=0;break}}this.h=D,this.o+=y},s.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var y=1;y<j.length-8;++y)j[y]=0;var k=8*this.o;for(y=j.length-8;y<j.length;++y)j[y]=k&255,k/=256;for(this.u(j),j=Array(16),y=k=0;4>y;++y)for(var S=0;32>S;S+=8)j[k++]=this.g[y]>>>S&255;return j};function i(j,y){var k=l;return Object.prototype.hasOwnProperty.call(k,j)?k[j]:k[j]=y(j)}function o(j,y){this.h=y;for(var k=[],S=!0,D=j.length-1;0<=D;D--){var P=j[D]|0;S&&P==y||(k[D]=P,S=!1)}this.g=k}var l={};function c(j){return-128<=j&&128>j?i(j,function(y){return new o([y|0],0>y?-1:0)}):new o([j|0],0>j?-1:0)}function u(j){if(isNaN(j)||!isFinite(j))return f;if(0>j)return E(u(-j));for(var y=[],k=1,S=0;j>=k;S++)y[S]=j/k|0,k*=4294967296;return new o(y,0)}function h(j,y){if(j.length==0)throw Error("number format error: empty string");if(y=y||10,2>y||36<y)throw Error("radix out of range: "+y);if(j.charAt(0)=="-")return E(h(j.substring(1),y));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var k=u(Math.pow(y,8)),S=f,D=0;D<j.length;D+=8){var P=Math.min(8,j.length-D),C=parseInt(j.substring(D,D+P),y);8>P?(P=u(Math.pow(y,P)),S=S.j(P).add(u(C))):(S=S.j(k),S=S.add(u(C)))}return S}var f=c(0),m=c(1),x=c(16777216);t=o.prototype,t.m=function(){if(N(this))return-E(this).m();for(var j=0,y=1,k=0;k<this.g.length;k++){var S=this.i(k);j+=(0<=S?S:4294967296+S)*y,y*=4294967296}return j},t.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(b(this))return"0";if(N(this))return"-"+E(this).toString(j);for(var y=u(Math.pow(j,6)),k=this,S="";;){var D=I(k,y).g;k=w(k,D.j(y));var P=((0<k.g.length?k.g[0]:k.h)>>>0).toString(j);if(k=D,b(k))return P+S;for(;6>P.length;)P="0"+P;S=P+S}},t.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function b(j){if(j.h!=0)return!1;for(var y=0;y<j.g.length;y++)if(j.g[y]!=0)return!1;return!0}function N(j){return j.h==-1}t.l=function(j){return j=w(this,j),N(j)?-1:b(j)?0:1};function E(j){for(var y=j.g.length,k=[],S=0;S<y;S++)k[S]=~j.g[S];return new o(k,~j.h).add(m)}t.abs=function(){return N(this)?E(this):this},t.add=function(j){for(var y=Math.max(this.g.length,j.g.length),k=[],S=0,D=0;D<=y;D++){var P=S+(this.i(D)&65535)+(j.i(D)&65535),C=(P>>>16)+(this.i(D)>>>16)+(j.i(D)>>>16);S=C>>>16,P&=65535,C&=65535,k[D]=C<<16|P}return new o(k,k[k.length-1]&-2147483648?-1:0)};function w(j,y){return j.add(E(y))}t.j=function(j){if(b(this)||b(j))return f;if(N(this))return N(j)?E(this).j(E(j)):E(E(this).j(j));if(N(j))return E(this.j(E(j)));if(0>this.l(x)&&0>j.l(x))return u(this.m()*j.m());for(var y=this.g.length+j.g.length,k=[],S=0;S<2*y;S++)k[S]=0;for(S=0;S<this.g.length;S++)for(var D=0;D<j.g.length;D++){var P=this.i(S)>>>16,C=this.i(S)&65535,q=j.i(D)>>>16,ue=j.i(D)&65535;k[2*S+2*D]+=C*ue,v(k,2*S+2*D),k[2*S+2*D+1]+=P*ue,v(k,2*S+2*D+1),k[2*S+2*D+1]+=C*q,v(k,2*S+2*D+1),k[2*S+2*D+2]+=P*q,v(k,2*S+2*D+2)}for(S=0;S<y;S++)k[S]=k[2*S+1]<<16|k[2*S];for(S=y;S<2*y;S++)k[S]=0;return new o(k,0)};function v(j,y){for(;(j[y]&65535)!=j[y];)j[y+1]+=j[y]>>>16,j[y]&=65535,y++}function T(j,y){this.g=j,this.h=y}function I(j,y){if(b(y))throw Error("division by zero");if(b(j))return new T(f,f);if(N(j))return y=I(E(j),y),new T(E(y.g),E(y.h));if(N(y))return y=I(j,E(y)),new T(E(y.g),y.h);if(30<j.g.length){if(N(j)||N(y))throw Error("slowDivide_ only works with positive integers.");for(var k=m,S=y;0>=S.l(j);)k=R(k),S=R(S);var D=V(k,1),P=V(S,1);for(S=V(S,2),k=V(k,2);!b(S);){var C=P.add(S);0>=C.l(j)&&(D=D.add(k),P=C),S=V(S,1),k=V(k,1)}return y=w(j,D.j(y)),new T(D,y)}for(D=f;0<=j.l(y);){for(k=Math.max(1,Math.floor(j.m()/y.m())),S=Math.ceil(Math.log(k)/Math.LN2),S=48>=S?1:Math.pow(2,S-48),P=u(k),C=P.j(y);N(C)||0<C.l(j);)k-=S,P=u(k),C=P.j(y);b(P)&&(P=m),D=D.add(P),j=w(j,C)}return new T(D,j)}t.A=function(j){return I(this,j).h},t.and=function(j){for(var y=Math.max(this.g.length,j.g.length),k=[],S=0;S<y;S++)k[S]=this.i(S)&j.i(S);return new o(k,this.h&j.h)},t.or=function(j){for(var y=Math.max(this.g.length,j.g.length),k=[],S=0;S<y;S++)k[S]=this.i(S)|j.i(S);return new o(k,this.h|j.h)},t.xor=function(j){for(var y=Math.max(this.g.length,j.g.length),k=[],S=0;S<y;S++)k[S]=this.i(S)^j.i(S);return new o(k,this.h^j.h)};function R(j){for(var y=j.g.length+1,k=[],S=0;S<y;S++)k[S]=j.i(S)<<1|j.i(S-1)>>>31;return new o(k,j.h)}function V(j,y){var k=y>>5;y%=32;for(var S=j.g.length-k,D=[],P=0;P<S;P++)D[P]=0<y?j.i(P+k)>>>y|j.i(P+k+1)<<32-y:j.i(P+k);return new o(D,j.h)}s.prototype.digest=s.prototype.v,s.prototype.reset=s.prototype.s,s.prototype.update=s.prototype.u,g1=s,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=h,Na=o}).apply(typeof t_<"u"?t_:typeof self<"u"?self:typeof window<"u"?window:{});var Ld=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var x1,pc,y1,hh,$g,v1,b1,w1;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,p,_){return d==Array.prototype||d==Object.prototype||(d[p]=_.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Ld=="object"&&Ld];for(var p=0;p<d.length;++p){var _=d[p];if(_&&_.Math==Math)return _}throw Error("Cannot find global object")}var s=n(this);function r(d,p){if(p)e:{var _=s;d=d.split(".");for(var A=0;A<d.length-1;A++){var B=d[A];if(!(B in _))break e;_=_[B]}d=d[d.length-1],A=_[d],p=p(A),p!=A&&p!=null&&e(_,d,{configurable:!0,writable:!0,value:p})}}function i(d,p){d instanceof String&&(d+="");var _=0,A=!1,B={next:function(){if(!A&&_<d.length){var W=_++;return{value:p(W,d[W]),done:!1}}return A=!0,{done:!0,value:void 0}}};return B[Symbol.iterator]=function(){return B},B}r("Array.prototype.values",function(d){return d||function(){return i(this,function(p,_){return _})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(d){var p=typeof d;return p=p!="object"?p:d?Array.isArray(d)?"array":p:"null",p=="array"||p=="object"&&typeof d.length=="number"}function u(d){var p=typeof d;return p=="object"&&d!=null||p=="function"}function h(d,p,_){return d.call.apply(d.bind,arguments)}function f(d,p,_){if(!d)throw Error();if(2<arguments.length){var A=Array.prototype.slice.call(arguments,2);return function(){var B=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(B,A),d.apply(p,B)}}return function(){return d.apply(p,arguments)}}function m(d,p,_){return m=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:f,m.apply(null,arguments)}function x(d,p){var _=Array.prototype.slice.call(arguments,1);return function(){var A=_.slice();return A.push.apply(A,arguments),d.apply(this,A)}}function b(d,p){function _(){}_.prototype=p.prototype,d.aa=p.prototype,d.prototype=new _,d.prototype.constructor=d,d.Qb=function(A,B,W){for(var de=Array(arguments.length-2),ot=2;ot<arguments.length;ot++)de[ot-2]=arguments[ot];return p.prototype[B].apply(A,de)}}function N(d){const p=d.length;if(0<p){const _=Array(p);for(let A=0;A<p;A++)_[A]=d[A];return _}return[]}function E(d,p){for(let _=1;_<arguments.length;_++){const A=arguments[_];if(c(A)){const B=d.length||0,W=A.length||0;d.length=B+W;for(let de=0;de<W;de++)d[B+de]=A[de]}else d.push(A)}}class w{constructor(p,_){this.i=p,this.j=_,this.h=0,this.g=null}get(){let p;return 0<this.h?(this.h--,p=this.g,this.g=p.next,p.next=null):p=this.i(),p}}function v(d){return/^[\s\xa0]*$/.test(d)}function T(){var d=l.navigator;return d&&(d=d.userAgent)?d:""}function I(d){return I[" "](d),d}I[" "]=function(){};var R=T().indexOf("Gecko")!=-1&&!(T().toLowerCase().indexOf("webkit")!=-1&&T().indexOf("Edge")==-1)&&!(T().indexOf("Trident")!=-1||T().indexOf("MSIE")!=-1)&&T().indexOf("Edge")==-1;function V(d,p,_){for(const A in d)p.call(_,d[A],A,d)}function j(d,p){for(const _ in d)p.call(void 0,d[_],_,d)}function y(d){const p={};for(const _ in d)p[_]=d[_];return p}const k="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function S(d,p){let _,A;for(let B=1;B<arguments.length;B++){A=arguments[B];for(_ in A)d[_]=A[_];for(let W=0;W<k.length;W++)_=k[W],Object.prototype.hasOwnProperty.call(A,_)&&(d[_]=A[_])}}function D(d){var p=1;d=d.split(":");const _=[];for(;0<p&&d.length;)_.push(d.shift()),p--;return d.length&&_.push(d.join(":")),_}function P(d){l.setTimeout(()=>{throw d},0)}function C(){var d=se;let p=null;return d.g&&(p=d.g,d.g=d.g.next,d.g||(d.h=null),p.next=null),p}class q{constructor(){this.h=this.g=null}add(p,_){const A=ue.get();A.set(p,_),this.h?this.h.next=A:this.g=A,this.h=A}}var ue=new w(()=>new Se,d=>d.reset());class Se{constructor(){this.next=this.g=this.h=null}set(p,_){this.h=p,this.g=_,this.next=null}reset(){this.next=this.g=this.h=null}}let fe,K=!1,se=new q,ne=()=>{const d=l.Promise.resolve(void 0);fe=()=>{d.then(F)}};var F=()=>{for(var d;d=C();){try{d.h.call(d.g)}catch(_){P(_)}var p=ue;p.j(d),100>p.h&&(p.h++,d.next=p.g,p.g=d)}K=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(d,p){this.type=d,this.g=this.target=p,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var we=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var d=!1,p=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const _=()=>{};l.addEventListener("test",_,p),l.removeEventListener("test",_,p)}catch{}return d}();function je(d,p){if(J.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var _=this.type=d.type,A=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=p,p=d.relatedTarget){if(R){e:{try{I(p.nodeName);var B=!0;break e}catch{}B=!1}B||(p=null)}}else _=="mouseover"?p=d.fromElement:_=="mouseout"&&(p=d.toElement);this.relatedTarget=p,A?(this.clientX=A.clientX!==void 0?A.clientX:A.pageX,this.clientY=A.clientY!==void 0?A.clientY:A.pageY,this.screenX=A.screenX||0,this.screenY=A.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:U[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&je.aa.h.call(this)}}b(je,J);var U={2:"touch",3:"pen",4:"mouse"};je.prototype.h=function(){je.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var xe="closure_listenable_"+(1e6*Math.random()|0),re=0;function Ee(d,p,_,A,B){this.listener=d,this.proxy=null,this.src=p,this.type=_,this.capture=!!A,this.ha=B,this.key=++re,this.da=this.fa=!1}function be(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function Q(d){this.src=d,this.g={},this.h=0}Q.prototype.add=function(d,p,_,A,B){var W=d.toString();d=this.g[W],d||(d=this.g[W]=[],this.h++);var de=Me(d,p,A,B);return-1<de?(p=d[de],_||(p.fa=!1)):(p=new Ee(p,this.src,W,!!A,B),p.fa=_,d.push(p)),p};function oe(d,p){var _=p.type;if(_ in d.g){var A=d.g[_],B=Array.prototype.indexOf.call(A,p,void 0),W;(W=0<=B)&&Array.prototype.splice.call(A,B,1),W&&(be(p),d.g[_].length==0&&(delete d.g[_],d.h--))}}function Me(d,p,_,A){for(var B=0;B<d.length;++B){var W=d[B];if(!W.da&&W.listener==p&&W.capture==!!_&&W.ha==A)return B}return-1}var Ze="closure_lm_"+(1e6*Math.random()|0),vt={};function Pn(d,p,_,A,B){if(Array.isArray(p)){for(var W=0;W<p.length;W++)Pn(d,p[W],_,A,B);return null}return _=z(_),d&&d[xe]?d.K(p,_,u(A)?!!A.capture:!1,B):Yt(d,p,_,!1,A,B)}function Yt(d,p,_,A,B,W){if(!p)throw Error("Invalid event type");var de=u(B)?!!B.capture:!!B,ot=Z(d);if(ot||(d[Ze]=ot=new Q(d)),_=ot.add(p,_,A,de,W),_.proxy)return _;if(A=as(),_.proxy=A,A.src=d,A.listener=_,d.addEventListener)we||(B=de),B===void 0&&(B=!1),d.addEventListener(p.toString(),A,B);else if(d.attachEvent)d.attachEvent(Wn(p.toString()),A);else if(d.addListener&&d.removeListener)d.addListener(A);else throw Error("addEventListener and attachEvent are unavailable.");return _}function as(){function d(_){return p.call(d.src,d.listener,_)}const p=bs;return d}function un(d,p,_,A,B){if(Array.isArray(p))for(var W=0;W<p.length;W++)un(d,p[W],_,A,B);else A=u(A)?!!A.capture:!!A,_=z(_),d&&d[xe]?(d=d.i,p=String(p).toString(),p in d.g&&(W=d.g[p],_=Me(W,_,A,B),-1<_&&(be(W[_]),Array.prototype.splice.call(W,_,1),W.length==0&&(delete d.g[p],d.h--)))):d&&(d=Z(d))&&(p=d.g[p.toString()],d=-1,p&&(d=Me(p,_,A,B)),(_=-1<d?p[d]:null)&&Nt(_))}function Nt(d){if(typeof d!="number"&&d&&!d.da){var p=d.src;if(p&&p[xe])oe(p.i,d);else{var _=d.type,A=d.proxy;p.removeEventListener?p.removeEventListener(_,A,d.capture):p.detachEvent?p.detachEvent(Wn(_),A):p.addListener&&p.removeListener&&p.removeListener(A),(_=Z(p))?(oe(_,d),_.h==0&&(_.src=null,p[Ze]=null)):be(d)}}}function Wn(d){return d in vt?vt[d]:vt[d]="on"+d}function bs(d,p){if(d.da)d=!0;else{p=new je(p,this);var _=d.listener,A=d.ha||d.src;d.fa&&Nt(d),d=_.call(A,p)}return d}function Z(d){return d=d[Ze],d instanceof Q?d:null}var X="__closure_events_fn_"+(1e9*Math.random()>>>0);function z(d){return typeof d=="function"?d:(d[X]||(d[X]=function(p){return d.handleEvent(p)}),d[X])}function pe(){G.call(this),this.i=new Q(this),this.M=this,this.F=null}b(pe,G),pe.prototype[xe]=!0,pe.prototype.removeEventListener=function(d,p,_,A){un(this,d,p,_,A)};function ye(d,p){var _,A=d.F;if(A)for(_=[];A;A=A.F)_.push(A);if(d=d.M,A=p.type||p,typeof p=="string")p=new J(p,d);else if(p instanceof J)p.target=p.target||d;else{var B=p;p=new J(A,d),S(p,B)}if(B=!0,_)for(var W=_.length-1;0<=W;W--){var de=p.g=_[W];B=ge(de,A,!0,p)&&B}if(de=p.g=d,B=ge(de,A,!0,p)&&B,B=ge(de,A,!1,p)&&B,_)for(W=0;W<_.length;W++)de=p.g=_[W],B=ge(de,A,!1,p)&&B}pe.prototype.N=function(){if(pe.aa.N.call(this),this.i){var d=this.i,p;for(p in d.g){for(var _=d.g[p],A=0;A<_.length;A++)be(_[A]);delete d.g[p],d.h--}}this.F=null},pe.prototype.K=function(d,p,_,A){return this.i.add(String(d),p,!1,_,A)},pe.prototype.L=function(d,p,_,A){return this.i.add(String(d),p,!0,_,A)};function ge(d,p,_,A){if(p=d.i.g[String(p)],!p)return!0;p=p.concat();for(var B=!0,W=0;W<p.length;++W){var de=p[W];if(de&&!de.da&&de.capture==_){var ot=de.listener,hn=de.ha||de.src;de.fa&&oe(d.i,de),B=ot.call(hn,A)!==!1&&B}}return B&&!A.defaultPrevented}function Ce(d,p,_){if(typeof d=="function")_&&(d=m(d,_));else if(d&&typeof d.handleEvent=="function")d=m(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(p)?-1:l.setTimeout(d,p||0)}function Et(d){d.g=Ce(()=>{d.g=null,d.i&&(d.i=!1,Et(d))},d.l);const p=d.h;d.h=null,d.m.apply(null,p)}class Dn extends G{constructor(p,_){super(),this.m=p,this.l=_,this.h=null,this.i=!1,this.g=null}j(p){this.h=arguments,this.g?this.i=!0:Et(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ds(d){G.call(this),this.h=d,this.g={}}b(Ds,G);var Za=[];function Xi(d){V(d.g,function(p,_){this.g.hasOwnProperty(_)&&Nt(p)},d),d.g={}}Ds.prototype.N=function(){Ds.aa.N.call(this),Xi(this)},Ds.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Kr=l.JSON.stringify,Qr=l.JSON.parse,dn=class{stringify(d){return l.JSON.stringify(d,void 0)}parse(d){return l.JSON.parse(d,void 0)}};function vn(){}vn.prototype.h=null;function Yr(d){return d.h||(d.h=d.i())}function Xr(){}var Gn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Jr(){J.call(this,"d")}b(Jr,J);function Zr(){J.call(this,"c")}b(Zr,J);var ws={},O=null;function Le(){return O=O||new pe}ws.La="serverreachability";function Ue(d){J.call(this,ws.La,d)}b(Ue,J);function at(d){const p=Le();ye(p,new Ue(p))}ws.STAT_EVENT="statevent";function qt(d,p){J.call(this,ws.STAT_EVENT,d),this.stat=p}b(qt,J);function Ke(d){const p=Le();ye(p,new qt(p,d))}ws.Ma="timingevent";function eo(d,p){J.call(this,ws.Ma,d),this.size=p}b(eo,J);function Ks(d,p){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){d()},p)}function pr(){this.g=!0}pr.prototype.xa=function(){this.g=!1};function Hn(d,p,_,A,B,W){d.info(function(){if(d.g)if(W)for(var de="",ot=W.split("&"),hn=0;hn<ot.length;hn++){var Je=ot[hn].split("=");if(1<Je.length){var wn=Je[0];Je=Je[1];var _n=wn.split("_");de=2<=_n.length&&_n[1]=="type"?de+(wn+"="+Je+"&"):de+(wn+"=redacted&")}}else de=null;else de=W;return"XMLHTTP REQ ("+A+") [attempt "+B+"]: "+p+`
`+_+`
`+de})}function os(d,p,_,A,B,W,de){d.info(function(){return"XMLHTTP RESP ("+A+") [ attempt "+B+"]: "+p+`
`+_+`
`+W+" "+de})}function bn(d,p,_,A){d.info(function(){return"XMLHTTP TEXT ("+p+"): "+Wt(d,_)+(A?" "+A:"")})}function gr(d,p){d.info(function(){return"TIMEOUT: "+p})}pr.prototype.info=function(){};function Wt(d,p){if(!d.g)return p;if(!p)return null;try{var _=JSON.parse(p);if(_){for(d=0;d<_.length;d++)if(Array.isArray(_[d])){var A=_[d];if(!(2>A.length)){var B=A[1];if(Array.isArray(B)&&!(1>B.length)){var W=B[0];if(W!="noop"&&W!="stop"&&W!="close")for(var de=1;de<B.length;de++)B[de]=""}}}}return Kr(_)}catch{return p}}var Vs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Ji={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Vl;function to(){}b(to,vn),to.prototype.g=function(){return new XMLHttpRequest},to.prototype.i=function(){return{}},Vl=new to;function _s(d,p,_,A){this.j=d,this.i=p,this.l=_,this.R=A||1,this.U=new Ds(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ml}function Ml(){this.i=null,this.g="",this.h=!1}var Ll={},no={};function so(d,p,_){d.L=1,d.v=ud(yr(p)),d.m=_,d.P=!0,Ol(d,null)}function Ol(d,p){d.F=Date.now(),Zi(d),d.A=yr(d.v);var _=d.A,A=d.R;Array.isArray(A)||(A=[String(A)]),Vv(_.i,"t",A),d.C=0,_=d.j.J,d.h=new Ml,d.g=Zv(d.j,_?p:null,!d.m),0<d.O&&(d.M=new Dn(m(d.Y,d,d.g),d.O)),p=d.U,_=d.g,A=d.ca;var B="readystatechange";Array.isArray(B)||(B&&(Za[0]=B.toString()),B=Za);for(var W=0;W<B.length;W++){var de=Pn(_,B[W],A||p.handleEvent,!1,p.h||p);if(!de)break;p.g[de.key]=de}p=d.H?y(d.H):{},d.m?(d.u||(d.u="POST"),p["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,p)):(d.u="GET",d.g.ea(d.A,d.u,null,p)),at(),Hn(d.i,d.u,d.A,d.l,d.R,d.m)}_s.prototype.ca=function(d){d=d.target;const p=this.M;p&&vr(d)==3?p.j():this.Y(d)},_s.prototype.Y=function(d){try{if(d==this.g)e:{const _n=vr(this.g);var p=this.g.Ba();const oo=this.g.Z();if(!(3>_n)&&(_n!=3||this.g&&(this.h.h||this.g.oa()||$v(this.g)))){this.J||_n!=4||p==7||(p==8||0>=oo?at(3):at(2)),ro(this);var _=this.g.Z();this.X=_;t:if(Fl(this)){var A=$v(this.g);d="";var B=A.length,W=vr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Qs(this),ei(this);var de="";break t}this.h.i=new l.TextDecoder}for(p=0;p<B;p++)this.h.h=!0,d+=this.h.i.decode(A[p],{stream:!(W&&p==B-1)});A.length=0,this.h.g+=d,this.C=0,de=this.h.g}else de=this.g.oa();if(this.o=_==200,os(this.i,this.u,this.A,this.l,this.R,_n,_),this.o){if(this.T&&!this.K){t:{if(this.g){var ot,hn=this.g;if((ot=hn.g?hn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!v(ot)){var Je=ot;break t}}Je=null}if(_=Je)bn(this.i,this.l,_,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,M(this,_);else{this.o=!1,this.s=3,Ke(12),Qs(this),ei(this);break e}}if(this.P){_=!0;let Ms;for(;!this.J&&this.C<de.length;)if(Ms=od(this,de),Ms==no){_n==4&&(this.s=4,Ke(14),_=!1),bn(this.i,this.l,null,"[Incomplete Response]");break}else if(Ms==Ll){this.s=4,Ke(15),bn(this.i,this.l,de,"[Invalid Chunk]"),_=!1;break}else bn(this.i,this.l,Ms,null),M(this,Ms);if(Fl(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),_n!=4||de.length!=0||this.h.h||(this.s=1,Ke(16),_=!1),this.o=this.o&&_,!_)bn(this.i,this.l,de,"[Invalid Chunked Response]"),Qs(this),ei(this);else if(0<de.length&&!this.W){this.W=!0;var wn=this.j;wn.g==this&&wn.ba&&!wn.M&&(wn.j.info("Great, no buffering proxy detected. Bytes received: "+de.length),km(wn),wn.M=!0,Ke(11))}}else bn(this.i,this.l,de,null),M(this,de);_n==4&&Qs(this),this.o&&!this.J&&(_n==4?Qv(this.j,this):(this.o=!1,Zi(this)))}else QA(this.g),_==400&&0<de.indexOf("Unknown SID")?(this.s=3,Ke(12)):(this.s=0,Ke(13)),Qs(this),ei(this)}}}catch{}finally{}};function Fl(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function od(d,p){var _=d.C,A=p.indexOf(`
`,_);return A==-1?no:(_=Number(p.substring(_,A)),isNaN(_)?Ll:(A+=1,A+_>p.length?no:(p=p.slice(A,A+_),d.C=A+_,p)))}_s.prototype.cancel=function(){this.J=!0,Qs(this)};function Zi(d){d.S=Date.now()+d.I,Ul(d,d.I)}function Ul(d,p){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Ks(m(d.ba,d),p)}function ro(d){d.B&&(l.clearTimeout(d.B),d.B=null)}_s.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(gr(this.i,this.A),this.L!=2&&(at(),Ke(17)),Qs(this),this.s=2,ei(this)):Ul(this,this.S-d)};function ei(d){d.j.G==0||d.J||Qv(d.j,d)}function Qs(d){ro(d);var p=d.M;p&&typeof p.ma=="function"&&p.ma(),d.M=null,Xi(d.U),d.g&&(p=d.g,d.g=null,p.abort(),p.ma())}function M(d,p){try{var _=d.j;if(_.G!=0&&(_.g==d||Ge(_.h,d))){if(!d.K&&Ge(_.h,d)&&_.G==3){try{var A=_.Da.g.parse(p)}catch{A=null}if(Array.isArray(A)&&A.length==3){var B=A;if(B[0]==0){e:if(!_.u){if(_.g)if(_.g.F+3e3<d.F)gd(_),md(_);else break e;jm(_),Ke(18)}}else _.za=B[1],0<_.za-_.T&&37500>B[2]&&_.F&&_.v==0&&!_.C&&(_.C=Ks(m(_.Za,_),6e3));if(1>=Te(_.h)&&_.ca){try{_.ca()}catch{}_.ca=void 0}}else ta(_,11)}else if((d.K||_.g==d)&&gd(_),!v(p))for(B=_.Da.g.parse(p),p=0;p<B.length;p++){let Je=B[p];if(_.T=Je[0],Je=Je[1],_.G==2)if(Je[0]=="c"){_.K=Je[1],_.ia=Je[2];const wn=Je[3];wn!=null&&(_.la=wn,_.j.info("VER="+_.la));const _n=Je[4];_n!=null&&(_.Aa=_n,_.j.info("SVER="+_.Aa));const oo=Je[5];oo!=null&&typeof oo=="number"&&0<oo&&(A=1.5*oo,_.L=A,_.j.info("backChannelRequestTimeoutMs_="+A)),A=_;const Ms=d.g;if(Ms){const yd=Ms.g?Ms.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(yd){var W=A.h;W.g||yd.indexOf("spdy")==-1&&yd.indexOf("quic")==-1&&yd.indexOf("h2")==-1||(W.j=W.l,W.g=new Set,W.h&&(Be(W,W.h),W.h=null))}if(A.D){const Im=Ms.g?Ms.g.getResponseHeader("X-HTTP-Session-Id"):null;Im&&(A.ya=Im,ht(A.I,A.D,Im))}}_.G=3,_.l&&_.l.ua(),_.ba&&(_.R=Date.now()-d.F,_.j.info("Handshake RTT: "+_.R+"ms")),A=_;var de=d;if(A.qa=Jv(A,A.J?A.ia:null,A.W),de.K){Vt(A.h,de);var ot=de,hn=A.L;hn&&(ot.I=hn),ot.B&&(ro(ot),Zi(ot)),A.g=de}else Hv(A);0<_.i.length&&pd(_)}else Je[0]!="stop"&&Je[0]!="close"||ta(_,7);else _.G==3&&(Je[0]=="stop"||Je[0]=="close"?Je[0]=="stop"?ta(_,7):Sm(_):Je[0]!="noop"&&_.l&&_.l.ta(Je),_.v=0)}}at(4)}catch{}}var ee=class{constructor(d,p){this.g=d,this.map=p}};function le(d){this.l=d||10,l.PerformanceNavigationTiming?(d=l.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ae(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function Te(d){return d.h?1:d.g?d.g.size:0}function Ge(d,p){return d.h?d.h==p:d.g?d.g.has(p):!1}function Be(d,p){d.g?d.g.add(p):d.h=p}function Vt(d,p){d.h&&d.h==p?d.h=null:d.g&&d.g.has(p)&&d.g.delete(p)}le.prototype.cancel=function(){if(this.i=Ys(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function Ys(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let p=d.i;for(const _ of d.g.values())p=p.concat(_.D);return p}return N(d.i)}function Vn(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(c(d)){for(var p=[],_=d.length,A=0;A<_;A++)p.push(d[A]);return p}p=[],_=0;for(A in d)p[_++]=d[A];return p}function Xs(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(c(d)||typeof d=="string"){var p=[];d=d.length;for(var _=0;_<d;_++)p.push(_);return p}p=[],_=0;for(const A in d)p[_++]=A;return p}}}function xr(d,p){if(d.forEach&&typeof d.forEach=="function")d.forEach(p,void 0);else if(c(d)||typeof d=="string")Array.prototype.forEach.call(d,p,void 0);else for(var _=Xs(d),A=Vn(d),B=A.length,W=0;W<B;W++)p.call(void 0,A[W],_&&_[W],d)}var Cv=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function MA(d,p){if(d){d=d.split("&");for(var _=0;_<d.length;_++){var A=d[_].indexOf("="),B=null;if(0<=A){var W=d[_].substring(0,A);B=d[_].substring(A+1)}else W=d[_];p(W,B?decodeURIComponent(B.replace(/\+/g," ")):"")}}}function ea(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof ea){this.h=d.h,ld(this,d.j),this.o=d.o,this.g=d.g,cd(this,d.s),this.l=d.l;var p=d.i,_=new zl;_.i=p.i,p.g&&(_.g=new Map(p.g),_.h=p.h),Av(this,_),this.m=d.m}else d&&(p=String(d).match(Cv))?(this.h=!1,ld(this,p[1]||"",!0),this.o=Bl(p[2]||""),this.g=Bl(p[3]||"",!0),cd(this,p[4]),this.l=Bl(p[5]||"",!0),Av(this,p[6]||"",!0),this.m=Bl(p[7]||"")):(this.h=!1,this.i=new zl(null,this.h))}ea.prototype.toString=function(){var d=[],p=this.j;p&&d.push($l(p,Rv,!0),":");var _=this.g;return(_||p=="file")&&(d.push("//"),(p=this.o)&&d.push($l(p,Rv,!0),"@"),d.push(encodeURIComponent(String(_)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),_=this.s,_!=null&&d.push(":",String(_))),(_=this.l)&&(this.g&&_.charAt(0)!="/"&&d.push("/"),d.push($l(_,_.charAt(0)=="/"?FA:OA,!0))),(_=this.i.toString())&&d.push("?",_),(_=this.m)&&d.push("#",$l(_,BA)),d.join("")};function yr(d){return new ea(d)}function ld(d,p,_){d.j=_?Bl(p,!0):p,d.j&&(d.j=d.j.replace(/:$/,""))}function cd(d,p){if(p){if(p=Number(p),isNaN(p)||0>p)throw Error("Bad port number "+p);d.s=p}else d.s=null}function Av(d,p,_){p instanceof zl?(d.i=p,$A(d.i,d.h)):(_||(p=$l(p,UA)),d.i=new zl(p,d.h))}function ht(d,p,_){d.i.set(p,_)}function ud(d){return ht(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function Bl(d,p){return d?p?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function $l(d,p,_){return typeof d=="string"?(d=encodeURI(d).replace(p,LA),_&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function LA(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var Rv=/[#\/\?@]/g,OA=/[#\?:]/g,FA=/[#\?]/g,UA=/[#\?@]/g,BA=/#/g;function zl(d,p){this.h=this.g=null,this.i=d||null,this.j=!!p}function ti(d){d.g||(d.g=new Map,d.h=0,d.i&&MA(d.i,function(p,_){d.add(decodeURIComponent(p.replace(/\+/g," ")),_)}))}t=zl.prototype,t.add=function(d,p){ti(this),this.i=null,d=io(this,d);var _=this.g.get(d);return _||this.g.set(d,_=[]),_.push(p),this.h+=1,this};function Pv(d,p){ti(d),p=io(d,p),d.g.has(p)&&(d.i=null,d.h-=d.g.get(p).length,d.g.delete(p))}function Dv(d,p){return ti(d),p=io(d,p),d.g.has(p)}t.forEach=function(d,p){ti(this),this.g.forEach(function(_,A){_.forEach(function(B){d.call(p,B,A,this)},this)},this)},t.na=function(){ti(this);const d=Array.from(this.g.values()),p=Array.from(this.g.keys()),_=[];for(let A=0;A<p.length;A++){const B=d[A];for(let W=0;W<B.length;W++)_.push(p[A])}return _},t.V=function(d){ti(this);let p=[];if(typeof d=="string")Dv(this,d)&&(p=p.concat(this.g.get(io(this,d))));else{d=Array.from(this.g.values());for(let _=0;_<d.length;_++)p=p.concat(d[_])}return p},t.set=function(d,p){return ti(this),this.i=null,d=io(this,d),Dv(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[p]),this.h+=1,this},t.get=function(d,p){return d?(d=this.V(d),0<d.length?String(d[0]):p):p};function Vv(d,p,_){Pv(d,p),0<_.length&&(d.i=null,d.g.set(io(d,p),N(_)),d.h+=_.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],p=Array.from(this.g.keys());for(var _=0;_<p.length;_++){var A=p[_];const W=encodeURIComponent(String(A)),de=this.V(A);for(A=0;A<de.length;A++){var B=W;de[A]!==""&&(B+="="+encodeURIComponent(String(de[A]))),d.push(B)}}return this.i=d.join("&")};function io(d,p){return p=String(p),d.j&&(p=p.toLowerCase()),p}function $A(d,p){p&&!d.j&&(ti(d),d.i=null,d.g.forEach(function(_,A){var B=A.toLowerCase();A!=B&&(Pv(this,A),Vv(this,B,_))},d)),d.j=p}function zA(d,p){const _=new pr;if(l.Image){const A=new Image;A.onload=x(ni,_,"TestLoadImage: loaded",!0,p,A),A.onerror=x(ni,_,"TestLoadImage: error",!1,p,A),A.onabort=x(ni,_,"TestLoadImage: abort",!1,p,A),A.ontimeout=x(ni,_,"TestLoadImage: timeout",!1,p,A),l.setTimeout(function(){A.ontimeout&&A.ontimeout()},1e4),A.src=d}else p(!1)}function qA(d,p){const _=new pr,A=new AbortController,B=setTimeout(()=>{A.abort(),ni(_,"TestPingServer: timeout",!1,p)},1e4);fetch(d,{signal:A.signal}).then(W=>{clearTimeout(B),W.ok?ni(_,"TestPingServer: ok",!0,p):ni(_,"TestPingServer: server error",!1,p)}).catch(()=>{clearTimeout(B),ni(_,"TestPingServer: error",!1,p)})}function ni(d,p,_,A,B){try{B&&(B.onload=null,B.onerror=null,B.onabort=null,B.ontimeout=null),A(_)}catch{}}function WA(){this.g=new dn}function GA(d,p,_){const A=_||"";try{xr(d,function(B,W){let de=B;u(B)&&(de=Kr(B)),p.push(A+W+"="+encodeURIComponent(de))})}catch(B){throw p.push(A+"type="+encodeURIComponent("_badmap")),B}}function dd(d){this.l=d.Ub||null,this.j=d.eb||!1}b(dd,vn),dd.prototype.g=function(){return new hd(this.l,this.j)},dd.prototype.i=function(d){return function(){return d}}({});function hd(d,p){pe.call(this),this.D=d,this.o=p,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}b(hd,pe),t=hd.prototype,t.open=function(d,p){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=p,this.readyState=1,Wl(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const p={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(p.body=d),(this.D||l).fetch(new Request(this.A,p)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,ql(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Wl(this)),this.g&&(this.readyState=3,Wl(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Mv(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function Mv(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var p=d.value?d.value:new Uint8Array(0);(p=this.v.decode(p,{stream:!d.done}))&&(this.response=this.responseText+=p)}d.done?ql(this):Wl(this),this.readyState==3&&Mv(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,ql(this))},t.Qa=function(d){this.g&&(this.response=d,ql(this))},t.ga=function(){this.g&&ql(this)};function ql(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Wl(d)}t.setRequestHeader=function(d,p){this.u.append(d,p)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],p=this.h.entries();for(var _=p.next();!_.done;)_=_.value,d.push(_[0]+": "+_[1]),_=p.next();return d.join(`\r
`)};function Wl(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(hd.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function Lv(d){let p="";return V(d,function(_,A){p+=A,p+=":",p+=_,p+=`\r
`}),p}function Tm(d,p,_){e:{for(A in _){var A=!1;break e}A=!0}A||(_=Lv(_),typeof d=="string"?_!=null&&encodeURIComponent(String(_)):ht(d,p,_))}function Mt(d){pe.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}b(Mt,pe);var HA=/^https?$/i,KA=["POST","PUT"];t=Mt.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,p,_,A){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);p=p?p.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Vl.g(),this.v=this.o?Yr(this.o):Yr(Vl),this.g.onreadystatechange=m(this.Ea,this);try{this.B=!0,this.g.open(p,String(d),!0),this.B=!1}catch(W){Ov(this,W);return}if(d=_||"",_=new Map(this.headers),A)if(Object.getPrototypeOf(A)===Object.prototype)for(var B in A)_.set(B,A[B]);else if(typeof A.keys=="function"&&typeof A.get=="function")for(const W of A.keys())_.set(W,A.get(W));else throw Error("Unknown input type for opt_headers: "+String(A));A=Array.from(_.keys()).find(W=>W.toLowerCase()=="content-type"),B=l.FormData&&d instanceof l.FormData,!(0<=Array.prototype.indexOf.call(KA,p,void 0))||A||B||_.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[W,de]of _)this.g.setRequestHeader(W,de);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Bv(this),this.u=!0,this.g.send(d),this.u=!1}catch(W){Ov(this,W)}};function Ov(d,p){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=p,d.m=5,Fv(d),fd(d)}function Fv(d){d.A||(d.A=!0,ye(d,"complete"),ye(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,ye(this,"complete"),ye(this,"abort"),fd(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),fd(this,!0)),Mt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Uv(this):this.bb())},t.bb=function(){Uv(this)};function Uv(d){if(d.h&&typeof o<"u"&&(!d.v[1]||vr(d)!=4||d.Z()!=2)){if(d.u&&vr(d)==4)Ce(d.Ea,0,d);else if(ye(d,"readystatechange"),vr(d)==4){d.h=!1;try{const de=d.Z();e:switch(de){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var p=!0;break e;default:p=!1}var _;if(!(_=p)){var A;if(A=de===0){var B=String(d.D).match(Cv)[1]||null;!B&&l.self&&l.self.location&&(B=l.self.location.protocol.slice(0,-1)),A=!HA.test(B?B.toLowerCase():"")}_=A}if(_)ye(d,"complete"),ye(d,"success");else{d.m=6;try{var W=2<vr(d)?d.g.statusText:""}catch{W=""}d.l=W+" ["+d.Z()+"]",Fv(d)}}finally{fd(d)}}}}function fd(d,p){if(d.g){Bv(d);const _=d.g,A=d.v[0]?()=>{}:null;d.g=null,d.v=null,p||ye(d,"ready");try{_.onreadystatechange=A}catch{}}}function Bv(d){d.I&&(l.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function vr(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<vr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var p=this.g.responseText;return d&&p.indexOf(d)==0&&(p=p.substring(d.length)),Qr(p)}};function $v(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function QA(d){const p={};d=(d.g&&2<=vr(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let A=0;A<d.length;A++){if(v(d[A]))continue;var _=D(d[A]);const B=_[0];if(_=_[1],typeof _!="string")continue;_=_.trim();const W=p[B]||[];p[B]=W,W.push(_)}j(p,function(A){return A.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Gl(d,p,_){return _&&_.internalChannelParams&&_.internalChannelParams[d]||p}function zv(d){this.Aa=0,this.i=[],this.j=new pr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Gl("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Gl("baseRetryDelayMs",5e3,d),this.cb=Gl("retryDelaySeedMs",1e4,d),this.Wa=Gl("forwardChannelMaxRetries",2,d),this.wa=Gl("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new le(d&&d.concurrentRequestLimit),this.Da=new WA,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=zv.prototype,t.la=8,t.G=1,t.connect=function(d,p,_,A){Ke(0),this.W=d,this.H=p||{},_&&A!==void 0&&(this.H.OSID=_,this.H.OAID=A),this.F=this.X,this.I=Jv(this,null,this.W),pd(this)};function Sm(d){if(qv(d),d.G==3){var p=d.U++,_=yr(d.I);if(ht(_,"SID",d.K),ht(_,"RID",p),ht(_,"TYPE","terminate"),Hl(d,_),p=new _s(d,d.j,p),p.L=2,p.v=ud(yr(_)),_=!1,l.navigator&&l.navigator.sendBeacon)try{_=l.navigator.sendBeacon(p.v.toString(),"")}catch{}!_&&l.Image&&(new Image().src=p.v,_=!0),_||(p.g=Zv(p.j,null),p.g.ea(p.v)),p.F=Date.now(),Zi(p)}Xv(d)}function md(d){d.g&&(km(d),d.g.cancel(),d.g=null)}function qv(d){md(d),d.u&&(l.clearTimeout(d.u),d.u=null),gd(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&l.clearTimeout(d.s),d.s=null)}function pd(d){if(!Ae(d.h)&&!d.s){d.s=!0;var p=d.Ga;fe||ne(),K||(fe(),K=!0),se.add(p,d),d.B=0}}function YA(d,p){return Te(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=p.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Ks(m(d.Ga,d,p),Yv(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const B=new _s(this,this.j,d);let W=this.o;if(this.S&&(W?(W=y(W),S(W,this.S)):W=this.S),this.m!==null||this.O||(B.H=W,W=null),this.P)e:{for(var p=0,_=0;_<this.i.length;_++){t:{var A=this.i[_];if("__data__"in A.map&&(A=A.map.__data__,typeof A=="string")){A=A.length;break t}A=void 0}if(A===void 0)break;if(p+=A,4096<p){p=_;break e}if(p===4096||_===this.i.length-1){p=_+1;break e}}p=1e3}else p=1e3;p=Gv(this,B,p),_=yr(this.I),ht(_,"RID",d),ht(_,"CVER",22),this.D&&ht(_,"X-HTTP-Session-Id",this.D),Hl(this,_),W&&(this.O?p="headers="+encodeURIComponent(String(Lv(W)))+"&"+p:this.m&&Tm(_,this.m,W)),Be(this.h,B),this.Ua&&ht(_,"TYPE","init"),this.P?(ht(_,"$req",p),ht(_,"SID","null"),B.T=!0,so(B,_,null)):so(B,_,p),this.G=2}}else this.G==3&&(d?Wv(this,d):this.i.length==0||Ae(this.h)||Wv(this))};function Wv(d,p){var _;p?_=p.l:_=d.U++;const A=yr(d.I);ht(A,"SID",d.K),ht(A,"RID",_),ht(A,"AID",d.T),Hl(d,A),d.m&&d.o&&Tm(A,d.m,d.o),_=new _s(d,d.j,_,d.B+1),d.m===null&&(_.H=d.o),p&&(d.i=p.D.concat(d.i)),p=Gv(d,_,1e3),_.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Be(d.h,_),so(_,A,p)}function Hl(d,p){d.H&&V(d.H,function(_,A){ht(p,A,_)}),d.l&&xr({},function(_,A){ht(p,A,_)})}function Gv(d,p,_){_=Math.min(d.i.length,_);var A=d.l?m(d.l.Na,d.l,d):null;e:{var B=d.i;let W=-1;for(;;){const de=["count="+_];W==-1?0<_?(W=B[0].g,de.push("ofs="+W)):W=0:de.push("ofs="+W);let ot=!0;for(let hn=0;hn<_;hn++){let Je=B[hn].g;const wn=B[hn].map;if(Je-=W,0>Je)W=Math.max(0,B[hn].g-100),ot=!1;else try{GA(wn,de,"req"+Je+"_")}catch{A&&A(wn)}}if(ot){A=de.join("&");break e}}}return d=d.i.splice(0,_),p.D=d,A}function Hv(d){if(!d.g&&!d.u){d.Y=1;var p=d.Fa;fe||ne(),K||(fe(),K=!0),se.add(p,d),d.v=0}}function jm(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Ks(m(d.Fa,d),Yv(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,Kv(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Ks(m(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ke(10),md(this),Kv(this))};function km(d){d.A!=null&&(l.clearTimeout(d.A),d.A=null)}function Kv(d){d.g=new _s(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var p=yr(d.qa);ht(p,"RID","rpc"),ht(p,"SID",d.K),ht(p,"AID",d.T),ht(p,"CI",d.F?"0":"1"),!d.F&&d.ja&&ht(p,"TO",d.ja),ht(p,"TYPE","xmlhttp"),Hl(d,p),d.m&&d.o&&Tm(p,d.m,d.o),d.L&&(d.g.I=d.L);var _=d.g;d=d.ia,_.L=1,_.v=ud(yr(p)),_.m=null,_.P=!0,Ol(_,d)}t.Za=function(){this.C!=null&&(this.C=null,md(this),jm(this),Ke(19))};function gd(d){d.C!=null&&(l.clearTimeout(d.C),d.C=null)}function Qv(d,p){var _=null;if(d.g==p){gd(d),km(d),d.g=null;var A=2}else if(Ge(d.h,p))_=p.D,Vt(d.h,p),A=1;else return;if(d.G!=0){if(p.o)if(A==1){_=p.m?p.m.length:0,p=Date.now()-p.F;var B=d.B;A=Le(),ye(A,new eo(A,_)),pd(d)}else Hv(d);else if(B=p.s,B==3||B==0&&0<p.X||!(A==1&&YA(d,p)||A==2&&jm(d)))switch(_&&0<_.length&&(p=d.h,p.i=p.i.concat(_)),B){case 1:ta(d,5);break;case 4:ta(d,10);break;case 3:ta(d,6);break;default:ta(d,2)}}}function Yv(d,p){let _=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(_*=2),_*p}function ta(d,p){if(d.j.info("Error code "+p),p==2){var _=m(d.fb,d),A=d.Xa;const B=!A;A=new ea(A||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||ld(A,"https"),ud(A),B?zA(A.toString(),_):qA(A.toString(),_)}else Ke(2);d.G=0,d.l&&d.l.sa(p),Xv(d),qv(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Ke(2)):(this.j.info("Failed to ping google.com"),Ke(1))};function Xv(d){if(d.G=0,d.ka=[],d.l){const p=Ys(d.h);(p.length!=0||d.i.length!=0)&&(E(d.ka,p),E(d.ka,d.i),d.h.i.length=0,N(d.i),d.i.length=0),d.l.ra()}}function Jv(d,p,_){var A=_ instanceof ea?yr(_):new ea(_);if(A.g!="")p&&(A.g=p+"."+A.g),cd(A,A.s);else{var B=l.location;A=B.protocol,p=p?p+"."+B.hostname:B.hostname,B=+B.port;var W=new ea(null);A&&ld(W,A),p&&(W.g=p),B&&cd(W,B),_&&(W.l=_),A=W}return _=d.D,p=d.ya,_&&p&&ht(A,_,p),ht(A,"VER",d.la),Hl(d,A),A}function Zv(d,p,_){if(p&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return p=d.Ca&&!d.pa?new Mt(new dd({eb:_})):new Mt(d.pa),p.Ha(d.J),p}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function eb(){}t=eb.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function xd(){}xd.prototype.g=function(d,p){return new ls(d,p)};function ls(d,p){pe.call(this),this.g=new zv(p),this.l=d,this.h=p&&p.messageUrlParams||null,d=p&&p.messageHeaders||null,p&&p.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=p&&p.initMessageHeaders||null,p&&p.messageContentType&&(d?d["X-WebChannel-Content-Type"]=p.messageContentType:d={"X-WebChannel-Content-Type":p.messageContentType}),p&&p.va&&(d?d["X-WebChannel-Client-Profile"]=p.va:d={"X-WebChannel-Client-Profile":p.va}),this.g.S=d,(d=p&&p.Sb)&&!v(d)&&(this.g.m=d),this.v=p&&p.supportsCrossDomainXhr||!1,this.u=p&&p.sendRawJson||!1,(p=p&&p.httpSessionIdParam)&&!v(p)&&(this.g.D=p,d=this.h,d!==null&&p in d&&(d=this.h,p in d&&delete d[p])),this.j=new ao(this)}b(ls,pe),ls.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ls.prototype.close=function(){Sm(this.g)},ls.prototype.o=function(d){var p=this.g;if(typeof d=="string"){var _={};_.__data__=d,d=_}else this.u&&(_={},_.__data__=Kr(d),d=_);p.i.push(new ee(p.Ya++,d)),p.G==3&&pd(p)},ls.prototype.N=function(){this.g.l=null,delete this.j,Sm(this.g),delete this.g,ls.aa.N.call(this)};function tb(d){Jr.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var p=d.__sm__;if(p){e:{for(const _ in p){d=_;break e}d=void 0}(this.i=d)&&(d=this.i,p=p!==null&&d in p?p[d]:void 0),this.data=p}else this.data=d}b(tb,Jr);function nb(){Zr.call(this),this.status=1}b(nb,Zr);function ao(d){this.g=d}b(ao,eb),ao.prototype.ua=function(){ye(this.g,"a")},ao.prototype.ta=function(d){ye(this.g,new tb(d))},ao.prototype.sa=function(d){ye(this.g,new nb)},ao.prototype.ra=function(){ye(this.g,"b")},xd.prototype.createWebChannel=xd.prototype.g,ls.prototype.send=ls.prototype.o,ls.prototype.open=ls.prototype.m,ls.prototype.close=ls.prototype.close,w1=function(){return new xd},b1=function(){return Le()},v1=ws,$g={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Vs.NO_ERROR=0,Vs.TIMEOUT=8,Vs.HTTP_ERROR=6,hh=Vs,Ji.COMPLETE="complete",y1=Ji,Xr.EventType=Gn,Gn.OPEN="a",Gn.CLOSE="b",Gn.ERROR="c",Gn.MESSAGE="d",pe.prototype.listen=pe.prototype.K,pc=Xr,Mt.prototype.listenOnce=Mt.prototype.L,Mt.prototype.getLastError=Mt.prototype.Ka,Mt.prototype.getLastErrorCode=Mt.prototype.Ba,Mt.prototype.getStatus=Mt.prototype.Z,Mt.prototype.getResponseJson=Mt.prototype.Oa,Mt.prototype.getResponseText=Mt.prototype.oa,Mt.prototype.send=Mt.prototype.ea,Mt.prototype.setWithCredentials=Mt.prototype.Ha,x1=Mt}).apply(typeof Ld<"u"?Ld:typeof self<"u"?self:typeof window<"u"?window:{});const n_="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Sn.UNAUTHENTICATED=new Sn(null),Sn.GOOGLE_CREDENTIALS=new Sn("google-credentials-uid"),Sn.FIRST_PARTY=new Sn("first-party-uid"),Sn.MOCK_USER=new Sn("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tl="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Va=new sO("@firebase/firestore");function go(){return Va.logLevel}function te(t,...e){if(Va.logLevel<=Ye.DEBUG){const n=e.map(zy);Va.debug(`Firestore (${Tl}): ${t}`,...n)}}function $t(t,...e){if(Va.logLevel<=Ye.ERROR){const n=e.map(zy);Va.error(`Firestore (${Tl}): ${t}`,...n)}}function uu(t,...e){if(Va.logLevel<=Ye.WARN){const n=e.map(zy);Va.warn(`Firestore (${Tl}): ${t}`,...n)}}function zy(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _e(t="Unexpected state"){const e=`FIRESTORE (${Tl}) INTERNAL ASSERTION FAILED: `+t;throw $t(e),new Error(e)}function ke(t,e){t||_e()}function Ne(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ce extends m1{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rO{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class iO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Sn.UNAUTHENTICATED))}shutdown(){}}class aO{constructor(e){this.t=e,this.currentUser=Sn.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){ke(this.o===void 0);let s=this.i;const r=c=>this.i!==s?(s=this.i,n(c)):Promise.resolve();let i=new cr;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new cr,e.enqueueRetryable(()=>r(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await r(this.currentUser)})},l=c=>{te("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(te("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new cr)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(s=>this.i!==e?(te("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):s?(ke(typeof s.accessToken=="string"),new rO(s.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return ke(e===null||typeof e=="string"),new Sn(e)}}class oO{constructor(e,n,s){this.l=e,this.h=n,this.P=s,this.type="FirstParty",this.user=Sn.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class lO{constructor(e,n,s){this.l=e,this.h=n,this.P=s}getToken(){return Promise.resolve(new oO(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Sn.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class cO{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class uO{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){ke(this.o===void 0);const s=i=>{i.error!=null&&te("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.R;return this.R=i.token,te("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>s(i))};const r=i=>{te("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>r(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?r(i):te("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(ke(typeof n.token=="string"),this.R=n.token,new cO(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dO(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let s=0;s<t;s++)n[s]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _1{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let s="";for(;s.length<20;){const r=dO(40);for(let i=0;i<r.length;++i)s.length<20&&r[i]<n&&(s+=e.charAt(r[i]%e.length))}return s}}function Oe(t,e){return t<e?-1:t>e?1:0}function il(t,e,n){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}function N1(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class At{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ce(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ce(Y.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ce(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ce(Y.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return At.fromMillis(Date.now())}static fromDate(e){return At.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),s=Math.floor(1e6*(e-1e3*n));return new At(n,s)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Oe(this.nanoseconds,e.nanoseconds):Oe(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Re{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Re(e)}static min(){return new Re(new At(0,0))}static max(){return new Re(new At(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(e,n,s){n===void 0?n=0:n>e.length&&_e(),s===void 0?s=e.length-n:s>e.length-n&&_e(),this.segments=e,this.offset=n,this.len=s}get length(){return this.len}isEqual(e){return du.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof du?e.forEach(s=>{n.push(s)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,s=this.limit();n<s;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const s=Math.min(e.length,n.length);for(let r=0;r<s;r++){const i=e.get(r),o=n.get(r);if(i<o)return-1;if(i>o)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class et extends du{construct(e,n,s){return new et(e,n,s)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const s of e){if(s.indexOf("//")>=0)throw new ce(Y.INVALID_ARGUMENT,`Invalid segment (${s}). Paths must not contain // in them.`);n.push(...s.split("/").filter(r=>r.length>0))}return new et(n)}static emptyPath(){return new et([])}}const hO=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class St extends du{construct(e,n,s){return new St(e,n,s)}static isValidIdentifier(e){return hO.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),St.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new St(["__name__"])}static fromServerFormat(e){const n=[];let s="",r=0;const i=()=>{if(s.length===0)throw new ce(Y.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(s),s=""};let o=!1;for(;r<e.length;){const l=e[r];if(l==="\\"){if(r+1===e.length)throw new ce(Y.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ce(Y.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);s+=c,r+=2}else l==="`"?(o=!o,r++):l!=="."||o?(s+=l,r++):(i(),r++)}if(i(),o)throw new ce(Y.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new St(n)}static emptyPath(){return new St([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class me{constructor(e){this.path=e}static fromPath(e){return new me(et.fromString(e))}static fromName(e){return new me(et.fromString(e).popFirst(5))}static empty(){return new me(et.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&et.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return et.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new me(new et(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rf{constructor(e,n,s,r){this.indexId=e,this.collectionGroup=n,this.fields=s,this.indexState=r}}function zg(t){return t.fields.find(e=>e.kind===2)}function oa(t){return t.fields.filter(e=>e.kind!==2)}rf.UNKNOWN_ID=-1;class fh{constructor(e,n){this.fieldPath=e,this.kind=n}}class hu{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new hu(0,gs.min())}}function E1(t,e){const n=t.toTimestamp().seconds,s=t.toTimestamp().nanoseconds+1,r=Re.fromTimestamp(s===1e9?new At(n+1,0):new At(n,s));return new gs(r,me.empty(),e)}function T1(t){return new gs(t.readTime,t.key,-1)}class gs{constructor(e,n,s){this.readTime=e,this.documentKey=n,this.largestBatchId=s}static min(){return new gs(Re.min(),me.empty(),-1)}static max(){return new gs(Re.max(),me.empty(),-1)}}function qy(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=me.comparator(t.documentKey,e.documentKey),n!==0?n:Oe(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const S1="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class j1{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Wi(t){if(t.code!==Y.FAILED_PRECONDITION||t.message!==S1)throw t;te("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ${constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&_e(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new $((s,r)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(s,r)},this.catchCallback=i=>{this.wrapFailure(n,i).next(s,r)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof $?n:$.resolve(n)}catch(n){return $.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):$.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):$.reject(n)}static resolve(e){return new $((n,s)=>{n(e)})}static reject(e){return new $((n,s)=>{s(e)})}static waitFor(e){return new $((n,s)=>{let r=0,i=0,o=!1;e.forEach(l=>{++r,l.next(()=>{++i,o&&i===r&&n()},c=>s(c))}),o=!0,i===r&&n()})}static or(e){let n=$.resolve(!1);for(const s of e)n=n.next(r=>r?$.resolve(r):s());return n}static forEach(e,n){const s=[];return e.forEach((r,i)=>{s.push(n.call(this,r,i))}),this.waitFor(s)}static mapArray(e,n){return new $((s,r)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(h=>{o[u]=h,++l,l===i&&s(o)},h=>r(h))}})}static doWhile(e,n){return new $((s,r)=>{const i=()=>{e()===!0?n().next(()=>{i()},r):s()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zf{constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.V=new cr,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{n.error?this.V.reject(new Ac(e,n.error)):this.V.resolve()},this.transaction.onerror=s=>{const r=Wy(s.target.error);this.V.reject(new Ac(e,r))}}static open(e,n,s,r){try{return new Zf(n,e.transaction(r,s))}catch(i){throw new Ac(n,i)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(te("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new mO(n)}}class Ai{constructor(e,n,s){this.name=e,this.version=n,this.p=s,Ai.S(sf())===12.2&&$t("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return te("SimpleDb","Removing database:",e),ca(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!HL())return!1;if(Ai.v())return!0;const e=sf(),n=Ai.S(e),s=0<n&&n<10,r=k1(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||s||i)}static v(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.C)==="YES"}static F(e,n){return e.store(n)}static S(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),s=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(s)}async M(e){return this.db||(te("SimpleDb","Opening database:",this.name),this.db=await new Promise((n,s)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=i=>{const o=i.target.result;n(o)},r.onblocked=()=>{s(new Ac(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=i=>{const o=i.target.error;o.name==="VersionError"?s(new ce(Y.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?s(new ce(Y.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):s(new Ac(e,o))},r.onupgradeneeded=i=>{te("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;this.p.O(o,r.transaction,i.oldVersion,this.version).next(()=>{te("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=n=>this.N(n)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,s,r){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.M(e);const l=Zf.open(this.db,e,i?"readonly":"readwrite",s),c=r(l).next(u=>(l.g(),u)).catch(u=>(l.abort(u),$.reject(u))).toPromise();return c.catch(()=>{}),await l.m,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(te("SimpleDb","Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function k1(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class fO{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return ca(this.B.delete())}}class Ac extends ce{constructor(e,n){super(Y.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Gi(t){return t.name==="IndexedDbTransactionError"}class mO{constructor(e){this.store=e}put(e,n){let s;return n!==void 0?(te("SimpleDb","PUT",this.store.name,e,n),s=this.store.put(n,e)):(te("SimpleDb","PUT",this.store.name,"<auto-key>",e),s=this.store.put(e)),ca(s)}add(e){return te("SimpleDb","ADD",this.store.name,e,e),ca(this.store.add(e))}get(e){return ca(this.store.get(e)).next(n=>(n===void 0&&(n=null),te("SimpleDb","GET",this.store.name,e,n),n))}delete(e){return te("SimpleDb","DELETE",this.store.name,e),ca(this.store.delete(e))}count(){return te("SimpleDb","COUNT",this.store.name),ca(this.store.count())}U(e,n){const s=this.options(e,n),r=s.index?this.store.index(s.index):this.store;if(typeof r.getAll=="function"){const i=r.getAll(s.range);return new $((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(s),o=[];return this.W(i,(l,c)=>{o.push(c)}).next(()=>o)}}G(e,n){const s=this.store.getAll(e,n===null?void 0:n);return new $((r,i)=>{s.onerror=o=>{i(o.target.error)},s.onsuccess=o=>{r(o.target.result)}})}j(e,n){te("SimpleDb","DELETE ALL",this.store.name);const s=this.options(e,n);s.H=!1;const r=this.cursor(s);return this.W(r,(i,o,l)=>l.delete())}J(e,n){let s;n?s=e:(s={},n=e);const r=this.cursor(s);return this.W(r,n)}Y(e){const n=this.cursor({});return new $((s,r)=>{n.onerror=i=>{const o=Wy(i.target.error);r(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():s()}):s()}})}W(e,n){const s=[];return new $((r,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void r();const c=new fO(l),u=n(l.primaryKey,l.value,c);if(u instanceof $){const h=u.catch(f=>(c.done(),$.reject(f)));s.push(h)}c.isDone?r():c.K===null?l.continue():l.continue(c.K)}}).next(()=>$.waitFor(s))}options(e,n){let s;return e!==void 0&&(typeof e=="string"?s=e:n=e),{index:s,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const s=this.store.index(e.index);return e.H?s.openKeyCursor(e.range,n):s.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function ca(t){return new $((e,n)=>{t.onsuccess=s=>{const r=s.target.result;e(r)},t.onerror=s=>{const r=Wy(s.target.error);n(r)}})}let s_=!1;function Wy(t){const e=Ai.S(sf());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const s=new ce("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return s_||(s_=!0,setTimeout(()=>{throw s},0)),s}}return t}class pO{constructor(e,n){this.asyncQueue=e,this.Z=n,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(e){te("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{te("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(n){Gi(n)?te("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",n):await Wi(n)}await this.X(6e4)})}}class gO{constructor(e,n){this.localStore=e,this.persistence=n}async ee(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.te(n,e))}te(e,n){const s=new Set;let r=n,i=!0;return $.doWhile(()=>i===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!s.has(o))return te("IndexBackfiller",`Processing collection: ${o}`),this.ne(e,o,r).next(l=>{r-=l,s.add(o)});i=!1})).next(()=>n-r)}ne(e,n,s){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(r=>this.localStore.localDocuments.getNextDocuments(e,n,r,s).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.re(r,i)).next(l=>(te("IndexBackfiller",`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}re(e,n){let s=e;return n.changes.forEach((r,i)=>{const o=T1(i);qy(o,s)>0&&(s=o)}),new gs(s.readTime,s.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=s=>this.ie(s),this.se=s=>n.writeSequenceNumber(s))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Jn.oe=-1;function em(t){return t==null}function fu(t){return t===0&&1/t==-1/0}function I1(t){return typeof t=="number"&&Number.isInteger(t)&&!fu(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Un(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=r_(e)),e=xO(t.get(n),e);return r_(e)}function xO(t,e){let n=e;const s=t.length;for(let r=0;r<s;r++){const i=t.charAt(r);switch(i){case"\0":n+="";break;case"":n+="";break;default:n+=i}}return n}function r_(t){return t+""}function nr(t){const e=t.length;if(ke(e>=2),e===2)return ke(t.charAt(0)===""&&t.charAt(1)===""),et.emptyPath();const n=e-2,s=[];let r="";for(let i=0;i<e;){const o=t.indexOf("",i);switch((o<0||o>n)&&_e(),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;r.length===0?c=l:(r+=l,c=r,r=""),s.push(c);break;case"":r+=t.substring(i,o),r+="\0";break;case"":r+=t.substring(i,o+1);break;default:_e()}i=o+2}return new et(s)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i_=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mh(t,e){return[t,Un(e)]}function C1(t,e,n){return[t,Un(e),n]}const yO={},vO=["prefixPath","collectionGroup","readTime","documentId"],bO=["prefixPath","collectionGroup","documentId"],wO=["collectionGroup","readTime","prefixPath","documentId"],_O=["canonicalId","targetId"],NO=["targetId","path"],EO=["path","targetId"],TO=["collectionId","parent"],SO=["indexId","uid"],jO=["uid","sequenceNumber"],kO=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],IO=["indexId","uid","orderedDocumentKey"],CO=["userId","collectionPath","documentId"],AO=["userId","collectionPath","largestBatchId"],RO=["userId","collectionGroup","largestBatchId"],A1=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],PO=[...A1,"documentOverlays"],R1=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],P1=R1,Gy=[...P1,"indexConfiguration","indexState","indexEntries"],DO=Gy,VO=[...Gy,"globals"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg extends j1{constructor(e,n){super(),this._e=e,this.currentSequenceNumber=n}}function an(t,e){const n=Ne(t);return Ai.F(n._e,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Qa(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function D1(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e,n){this.comparator=e,this.root=n||pn.EMPTY}insert(e,n){return new dt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,pn.BLACK,null,null))}remove(e){return new dt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,pn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const s=this.comparator(e,n.key);if(s===0)return n.value;s<0?n=n.left:s>0&&(n=n.right)}return null}indexOf(e){let n=0,s=this.root;for(;!s.isEmpty();){const r=this.comparator(e,s.key);if(r===0)return n+s.left.size;r<0?s=s.left:(n+=s.left.size+1,s=s.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,s)=>(e(n,s),!1))}toString(){const e=[];return this.inorderTraversal((n,s)=>(e.push(`${n}:${s}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Od(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Od(this.root,e,this.comparator,!1)}getReverseIterator(){return new Od(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Od(this.root,e,this.comparator,!0)}}class Od{constructor(e,n,s,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?s(e.key,n):1,n&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class pn{constructor(e,n,s,r,i){this.key=e,this.value=n,this.color=s??pn.RED,this.left=r??pn.EMPTY,this.right=i??pn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,s,r,i){return new pn(e??this.key,n??this.value,s??this.color,r??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,s){let r=this;const i=s(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,n,s),null):i===0?r.copy(null,n,null,null,null):r.copy(null,null,null,null,r.right.insert(e,n,s)),r.fixUp()}removeMin(){if(this.left.isEmpty())return pn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let s,r=this;if(n(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),n(e,r.key)===0){if(r.right.isEmpty())return pn.EMPTY;s=r.right.min(),r=r.copy(s.key,s.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,pn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,pn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw _e();const e=this.left.check();if(e!==this.right.check())throw _e();return e+(this.isRed()?0:1)}}pn.EMPTY=null,pn.RED=!0,pn.BLACK=!1;pn.EMPTY=new class{constructor(){this.size=0}get key(){throw _e()}get value(){throw _e()}get color(){throw _e()}get left(){throw _e()}get right(){throw _e()}copy(e,n,s,r,i){return this}insert(e,n,s){return new pn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class it{constructor(e){this.comparator=e,this.data=new dt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,s)=>(e(n),!1))}forEachInRange(e,n){const s=this.data.getIteratorFrom(e[0]);for(;s.hasNext();){const r=s.getNext();if(this.comparator(r.key,e[1])>=0)return;n(r.key)}}forEachWhile(e,n){let s;for(s=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();s.hasNext();)if(!e(s.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new o_(this.data.getIterator())}getIteratorFrom(e){return new o_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(s=>{n=n.add(s)}),n}isEqual(e){if(!(e instanceof it)||this.size!==e.size)return!1;const n=this.data.getIterator(),s=e.data.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(this.comparator(r,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new it(this.comparator);return n.data=e,n}}class o_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function co(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.fields=e,e.sort(St.comparator)}static empty(){return new Zn([])}unionWith(e){let n=new it(St.comparator);for(const s of this.fields)n=n.add(s);for(const s of e)n=n.add(s);return new Zn(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return il(this.fields,e.fields,(n,s)=>n.isEqual(s))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V1 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zt{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(r){try{return atob(r)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new V1("Invalid base64 string: "+i):i}}(e);return new zt(n)}static fromUint8Array(e){const n=function(r){let i="";for(let o=0;o<r.length;++o)i+=String.fromCharCode(r[o]);return i}(e);return new zt(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Oe(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zt.EMPTY_BYTE_STRING=new zt("");const MO=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fr(t){if(ke(!!t),typeof t=="string"){let e=0;const n=MO.exec(t);if(ke(!!n),n[1]){let r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}const s=new Date(t);return{seconds:Math.floor(s.getTime()/1e3),nanos:e}}return{seconds:bt(t.seconds),nanos:bt(t.nanos)}}function bt(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Mi(t){return typeof t=="string"?zt.fromBase64String(t):zt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hy(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Ky(t){const e=t.mapValue.fields.__previous_value__;return Hy(e)?Ky(e):e}function mu(t){const e=Fr(t.mapValue.fields.__local_write_time__.timestampValue);return new At(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LO{constructor(e,n,s,r,i,o,l,c,u){this.databaseId=e,this.appId=n,this.persistenceKey=s,this.host=r,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u}}class Ma{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new Ma("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof Ma&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ph={nullValue:"NULL_VALUE"};function La(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Hy(t)?4:M1(t)?9007199254740991:tm(t)?10:11:_e()}function hr(t,e){if(t===e)return!0;const n=La(t);if(n!==La(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return mu(t).isEqual(mu(e));case 3:return function(r,i){if(typeof r.timestampValue=="string"&&typeof i.timestampValue=="string"&&r.timestampValue.length===i.timestampValue.length)return r.timestampValue===i.timestampValue;const o=Fr(r.timestampValue),l=Fr(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,i){return Mi(r.bytesValue).isEqual(Mi(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,i){return bt(r.geoPointValue.latitude)===bt(i.geoPointValue.latitude)&&bt(r.geoPointValue.longitude)===bt(i.geoPointValue.longitude)}(t,e);case 2:return function(r,i){if("integerValue"in r&&"integerValue"in i)return bt(r.integerValue)===bt(i.integerValue);if("doubleValue"in r&&"doubleValue"in i){const o=bt(r.doubleValue),l=bt(i.doubleValue);return o===l?fu(o)===fu(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return il(t.arrayValue.values||[],e.arrayValue.values||[],hr);case 10:case 11:return function(r,i){const o=r.mapValue.fields||{},l=i.mapValue.fields||{};if(a_(o)!==a_(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!hr(o[c],l[c])))return!1;return!0}(t,e);default:return _e()}}function pu(t,e){return(t.values||[]).find(n=>hr(n,e))!==void 0}function Li(t,e){if(t===e)return 0;const n=La(t),s=La(e);if(n!==s)return Oe(n,s);switch(n){case 0:case 9007199254740991:return 0;case 1:return Oe(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=bt(i.integerValue||i.doubleValue),c=bt(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return l_(t.timestampValue,e.timestampValue);case 4:return l_(mu(t),mu(e));case 5:return Oe(t.stringValue,e.stringValue);case 6:return function(i,o){const l=Mi(i),c=Mi(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const h=Oe(l[u],c[u]);if(h!==0)return h}return Oe(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Oe(bt(i.latitude),bt(o.latitude));return l!==0?l:Oe(bt(i.longitude),bt(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return c_(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,h;const f=i.fields||{},m=o.fields||{},x=(l=f.value)===null||l===void 0?void 0:l.arrayValue,b=(c=m.value)===null||c===void 0?void 0:c.arrayValue,N=Oe(((u=x==null?void 0:x.values)===null||u===void 0?void 0:u.length)||0,((h=b==null?void 0:b.values)===null||h===void 0?void 0:h.length)||0);return N!==0?N:c_(x,b)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===bi.mapValue&&o===bi.mapValue)return 0;if(i===bi.mapValue)return 1;if(o===bi.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},h=Object.keys(u);c.sort(),h.sort();for(let f=0;f<c.length&&f<h.length;++f){const m=Oe(c[f],h[f]);if(m!==0)return m;const x=Li(l[c[f]],u[h[f]]);if(x!==0)return x}return Oe(c.length,h.length)}(t.mapValue,e.mapValue);default:throw _e()}}function l_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Oe(t,e);const n=Fr(t),s=Fr(e),r=Oe(n.seconds,s.seconds);return r!==0?r:Oe(n.nanos,s.nanos)}function c_(t,e){const n=t.values||[],s=e.values||[];for(let r=0;r<n.length&&r<s.length;++r){const i=Li(n[r],s[r]);if(i)return i}return Oe(n.length,s.length)}function al(t){return Wg(t)}function Wg(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const s=Fr(n);return`time(${s.seconds},${s.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Mi(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return me.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let s="[",r=!0;for(const i of n.values||[])r?r=!1:s+=",",s+=Wg(i);return s+"]"}(t.arrayValue):"mapValue"in t?function(n){const s=Object.keys(n.fields||{}).sort();let r="{",i=!0;for(const o of s)i?i=!1:r+=",",r+=`${o}:${Wg(n.fields[o])}`;return r+"}"}(t.mapValue):_e()}function gu(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Gg(t){return!!t&&"integerValue"in t}function xu(t){return!!t&&"arrayValue"in t}function u_(t){return!!t&&"nullValue"in t}function d_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function gh(t){return!!t&&"mapValue"in t}function tm(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Rc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Qa(t.mapValue.fields,(n,s)=>e.mapValue.fields[n]=Rc(s)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Rc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function M1(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}const L1={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function OO(t){return"nullValue"in t?ph:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?gu(Ma.empty(),me.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?tm(t)?L1:{mapValue:{}}:_e()}function FO(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?gu(Ma.empty(),me.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?L1:"mapValue"in t?tm(t)?{mapValue:{}}:bi:_e()}function h_(t,e){const n=Li(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function f_(t,e){const n=Li(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kn{constructor(e){this.value=e}static empty(){return new kn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let s=0;s<e.length-1;++s)if(n=(n.mapValue.fields||{})[e.get(s)],!gh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Rc(n)}setAll(e){let n=St.emptyPath(),s={},r=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,s,r),s={},r=[],n=l.popLast()}o?s[l.lastSegment()]=Rc(o):r.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,s,r)}delete(e){const n=this.field(e.popLast());gh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return hr(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let s=0;s<e.length;++s){let r=n.mapValue.fields[e.get(s)];gh(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},n.mapValue.fields[e.get(s)]=r),n=r}return n.mapValue.fields}applyChanges(e,n,s){Qa(n,(r,i)=>e[r]=i);for(const r of s)delete e[r]}clone(){return new kn(Rc(this.value))}}function O1(t){const e=[];return Qa(t.fields,(n,s)=>{const r=new St([n]);if(gh(s)){const i=O1(s.mapValue).fields;if(i.length===0)e.push(r);else for(const o of i)e.push(r.child(o))}else e.push(r)}),new Zn(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ut{constructor(e,n,s,r,i,o,l){this.key=e,this.documentType=n,this.version=s,this.readTime=r,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Ut(e,0,Re.min(),Re.min(),Re.min(),kn.empty(),0)}static newFoundDocument(e,n,s,r){return new Ut(e,1,n,Re.min(),s,r,0)}static newNoDocument(e,n){return new Ut(e,2,n,Re.min(),Re.min(),kn.empty(),0)}static newUnknownDocument(e,n){return new Ut(e,3,n,Re.min(),Re.min(),kn.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Re.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=kn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=kn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Re.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Ut&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ut(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ol{constructor(e,n){this.position=e,this.inclusive=n}}function m_(t,e,n){let s=0;for(let r=0;r<t.position.length;r++){const i=e[r],o=t.position[r];if(i.field.isKeyField()?s=me.comparator(me.fromName(o.referenceValue),n.key):s=Li(o,n.data.field(i.field)),i.dir==="desc"&&(s*=-1),s!==0)break}return s}function p_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!hr(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e,n="asc"){this.field=e,this.dir=n}}function UO(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F1{}class He extends F1{constructor(e,n,s){super(),this.field=e,this.op=n,this.value=s}static create(e,n,s){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,s):new BO(e,n,s):n==="array-contains"?new qO(e,s):n==="in"?new W1(e,s):n==="not-in"?new WO(e,s):n==="array-contains-any"?new GO(e,s):new He(e,n,s)}static createKeyFieldInFilter(e,n,s){return n==="in"?new $O(e,s):new zO(e,s)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Li(n,this.value)):n!==null&&La(this.value)===La(n)&&this.matchesComparison(Li(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _e()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class nt extends F1{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new nt(e,n)}matches(e){return ll(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function ll(t){return t.op==="and"}function Hg(t){return t.op==="or"}function Qy(t){return U1(t)&&ll(t)}function U1(t){for(const e of t.filters)if(e instanceof nt)return!1;return!0}function Kg(t){if(t instanceof He)return t.field.canonicalString()+t.op.toString()+al(t.value);if(Qy(t))return t.filters.map(e=>Kg(e)).join(",");{const e=t.filters.map(n=>Kg(n)).join(",");return`${t.op}(${e})`}}function B1(t,e){return t instanceof He?function(s,r){return r instanceof He&&s.op===r.op&&s.field.isEqual(r.field)&&hr(s.value,r.value)}(t,e):t instanceof nt?function(s,r){return r instanceof nt&&s.op===r.op&&s.filters.length===r.filters.length?s.filters.reduce((i,o,l)=>i&&B1(o,r.filters[l]),!0):!1}(t,e):void _e()}function $1(t,e){const n=t.filters.concat(e);return nt.create(n,t.op)}function z1(t){return t instanceof He?function(n){return`${n.field.canonicalString()} ${n.op} ${al(n.value)}`}(t):t instanceof nt?function(n){return n.op.toString()+" {"+n.getFilters().map(z1).join(" ,")+"}"}(t):"Filter"}class BO extends He{constructor(e,n,s){super(e,n,s),this.key=me.fromName(s.referenceValue)}matches(e){const n=me.comparator(e.key,this.key);return this.matchesComparison(n)}}class $O extends He{constructor(e,n){super(e,"in",n),this.keys=q1("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class zO extends He{constructor(e,n){super(e,"not-in",n),this.keys=q1("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function q1(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(s=>me.fromName(s.referenceValue))}class qO extends He{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return xu(n)&&pu(n.arrayValue,this.value)}}class W1 extends He{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&pu(this.value.arrayValue,n)}}class WO extends He{constructor(e,n){super(e,"not-in",n)}matches(e){if(pu(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!pu(this.value.arrayValue,n)}}class GO extends He{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!xu(n)||!n.arrayValue.values)&&n.arrayValue.values.some(s=>pu(this.value.arrayValue,s))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HO{constructor(e,n=null,s=[],r=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=s,this.filters=r,this.limit=i,this.startAt=o,this.endAt=l,this.ue=null}}function Qg(t,e=null,n=[],s=[],r=null,i=null,o=null){return new HO(t,e,n,s,r,i,o)}function Oa(t){const e=Ne(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(s=>Kg(s)).join(","),n+="|ob:",n+=e.orderBy.map(s=>function(i){return i.field.canonicalString()+i.dir}(s)).join(","),em(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(s=>al(s)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(s=>al(s)).join(",")),e.ue=n}return e.ue}function Bu(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!UO(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!B1(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!p_(t.startAt,e.startAt)&&p_(t.endAt,e.endAt)}function af(t){return me.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function of(t,e){return t.filters.filter(n=>n instanceof He&&n.field.isEqual(e))}function g_(t,e,n){let s=ph,r=!0;for(const i of of(t,e)){let o=ph,l=!0;switch(i.op){case"<":case"<=":o=OO(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=ph}h_({value:s,inclusive:r},{value:o,inclusive:l})<0&&(s=o,r=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];h_({value:s,inclusive:r},{value:o,inclusive:n.inclusive})<0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}function x_(t,e,n){let s=bi,r=!0;for(const i of of(t,e)){let o=bi,l=!0;switch(i.op){case">=":case">":o=FO(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=bi}f_({value:s,inclusive:r},{value:o,inclusive:l})>0&&(s=o,r=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];f_({value:s,inclusive:r},{value:o,inclusive:n.inclusive})>0&&(s=o,r=n.inclusive);break}}return{value:s,inclusive:r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl{constructor(e,n=null,s=[],r=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=s,this.filters=r,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function G1(t,e,n,s,r,i,o,l){return new Sl(t,e,n,s,r,i,o,l)}function $u(t){return new Sl(t)}function y_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function H1(t){return t.collectionGroup!==null}function Pc(t){const e=Ne(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const s=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new it(St.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new yu(i,s))}),n.has(St.keyField().canonicalString())||e.ce.push(new yu(St.keyField(),s))}return e.ce}function ms(t){const e=Ne(t);return e.le||(e.le=KO(e,Pc(t))),e.le}function KO(t,e){if(t.limitType==="F")return Qg(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(r=>{const i=r.dir==="desc"?"asc":"desc";return new yu(r.field,i)});const n=t.endAt?new ol(t.endAt.position,t.endAt.inclusive):null,s=t.startAt?new ol(t.startAt.position,t.startAt.inclusive):null;return Qg(t.path,t.collectionGroup,e,t.filters,t.limit,n,s)}}function Yg(t,e){const n=t.filters.concat([e]);return new Sl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function lf(t,e,n){return new Sl(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function nm(t,e){return Bu(ms(t),ms(e))&&t.limitType===e.limitType}function K1(t){return`${Oa(ms(t))}|lt:${t.limitType}`}function xo(t){return`Query(target=${function(n){let s=n.path.canonicalString();return n.collectionGroup!==null&&(s+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(s+=`, filters: [${n.filters.map(r=>z1(r)).join(", ")}]`),em(n.limit)||(s+=", limit: "+n.limit),n.orderBy.length>0&&(s+=`, orderBy: [${n.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),n.startAt&&(s+=", startAt: ",s+=n.startAt.inclusive?"b:":"a:",s+=n.startAt.position.map(r=>al(r)).join(",")),n.endAt&&(s+=", endAt: ",s+=n.endAt.inclusive?"a:":"b:",s+=n.endAt.position.map(r=>al(r)).join(",")),`Target(${s})`}(ms(t))}; limitType=${t.limitType})`}function zu(t,e){return e.isFoundDocument()&&function(s,r){const i=r.key.path;return s.collectionGroup!==null?r.key.hasCollectionId(s.collectionGroup)&&s.path.isPrefixOf(i):me.isDocumentKey(s.path)?s.path.isEqual(i):s.path.isImmediateParentOf(i)}(t,e)&&function(s,r){for(const i of Pc(s))if(!i.field.isKeyField()&&r.data.field(i.field)===null)return!1;return!0}(t,e)&&function(s,r){for(const i of s.filters)if(!i.matches(r))return!1;return!0}(t,e)&&function(s,r){return!(s.startAt&&!function(o,l,c){const u=m_(o,l,c);return o.inclusive?u<=0:u<0}(s.startAt,Pc(s),r)||s.endAt&&!function(o,l,c){const u=m_(o,l,c);return o.inclusive?u>=0:u>0}(s.endAt,Pc(s),r))}(t,e)}function Q1(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Y1(t){return(e,n)=>{let s=!1;for(const r of Pc(t)){const i=QO(r,e,n);if(i!==0)return i;s=s||r.field.isKeyField()}return 0}}function QO(t,e,n){const s=t.field.isKeyField()?me.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Li(c,u):_e()}(t.field,e,n);switch(t.dir){case"asc":return s;case"desc":return-1*s;default:return _e()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hi{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s!==void 0){for(const[r,i]of s)if(this.equalsFn(r,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const s=this.mapKeyFn(e),r=this.inner[s];if(r===void 0)return this.inner[s]=[[e,n]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,n]);r.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),s=this.inner[n];if(s===void 0)return!1;for(let r=0;r<s.length;r++)if(this.equalsFn(s[r][0],e))return s.length===1?delete this.inner[n]:s.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Qa(this.inner,(n,s)=>{for(const[r,i]of s)e(r,i)})}isEmpty(){return D1(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YO=new dt(me.comparator);function ds(){return YO}const X1=new dt(me.comparator);function gc(...t){let e=X1;for(const n of t)e=e.insert(n.key,n);return e}function J1(t){let e=X1;return t.forEach((n,s)=>e=e.insert(n,s.overlayedDocument)),e}function sr(){return Dc()}function Z1(){return Dc()}function Dc(){return new Hi(t=>t.toString(),(t,e)=>t.isEqual(e))}const XO=new dt(me.comparator),JO=new it(me.comparator);function $e(...t){let e=JO;for(const n of t)e=e.add(n);return e}const ZO=new it(Oe);function Yy(){return ZO}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xy(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:fu(e)?"-0":e}}function ek(t){return{integerValue:""+t}}function tk(t,e){return I1(e)?ek(e):Xy(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sm{constructor(){this._=void 0}}function e5(t,e,n){return t instanceof cl?function(r,i){const o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return i&&Hy(i)&&(i=Ky(i)),i&&(o.fields.__previous_value__=i),{mapValue:o}}(n,e):t instanceof Fa?sk(t,e):t instanceof Ua?rk(t,e):function(r,i){const o=nk(r,i),l=v_(o)+v_(r.Pe);return Gg(o)&&Gg(r.Pe)?ek(l):Xy(r.serializer,l)}(t,e)}function t5(t,e,n){return t instanceof Fa?sk(t,e):t instanceof Ua?rk(t,e):n}function nk(t,e){return t instanceof ul?function(s){return Gg(s)||function(i){return!!i&&"doubleValue"in i}(s)}(e)?e:{integerValue:0}:null}class cl extends sm{}class Fa extends sm{constructor(e){super(),this.elements=e}}function sk(t,e){const n=ik(e);for(const s of t.elements)n.some(r=>hr(r,s))||n.push(s);return{arrayValue:{values:n}}}class Ua extends sm{constructor(e){super(),this.elements=e}}function rk(t,e){let n=ik(e);for(const s of t.elements)n=n.filter(r=>!hr(r,s));return{arrayValue:{values:n}}}class ul extends sm{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function v_(t){return bt(t.integerValue||t.doubleValue)}function ik(t){return xu(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qu{constructor(e,n){this.field=e,this.transform=n}}function n5(t,e){return t.field.isEqual(e.field)&&function(s,r){return s instanceof Fa&&r instanceof Fa||s instanceof Ua&&r instanceof Ua?il(s.elements,r.elements,hr):s instanceof ul&&r instanceof ul?hr(s.Pe,r.Pe):s instanceof cl&&r instanceof cl}(t.transform,e.transform)}class s5{constructor(e,n){this.version=e,this.transformResults=n}}class tn{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new tn}static exists(e){return new tn(void 0,e)}static updateTime(e){return new tn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function xh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class rm{}function ak(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Wu(t.key,tn.none()):new jl(t.key,t.data,tn.none());{const n=t.data,s=kn.empty();let r=new it(St.comparator);for(let i of e.fields)if(!r.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?s.delete(i):s.set(i,o),r=r.add(i)}return new Gr(t.key,s,new Zn(r.toArray()),tn.none())}}function r5(t,e,n){t instanceof jl?function(r,i,o){const l=r.value.clone(),c=w_(r.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Gr?function(r,i,o){if(!xh(r.precondition,i))return void i.convertToUnknownDocument(o.version);const l=w_(r.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(ok(r)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(r,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function Vc(t,e,n,s){return t instanceof jl?function(i,o,l,c){if(!xh(i.precondition,o))return l;const u=i.value.clone(),h=__(i.fieldTransforms,c,o);return u.setAll(h),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,s):t instanceof Gr?function(i,o,l,c){if(!xh(i.precondition,o))return l;const u=__(i.fieldTransforms,c,o),h=o.data;return h.setAll(ok(i)),h.setAll(u),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(f=>f.field))}(t,e,n,s):function(i,o,l){return xh(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function i5(t,e){let n=null;for(const s of t.fieldTransforms){const r=e.data.field(s.field),i=nk(s.transform,r||null);i!=null&&(n===null&&(n=kn.empty()),n.set(s.field,i))}return n||null}function b_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(s,r){return s===void 0&&r===void 0||!(!s||!r)&&il(s,r,(i,o)=>n5(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class jl extends rm{constructor(e,n,s,r=[]){super(),this.key=e,this.value=n,this.precondition=s,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Gr extends rm{constructor(e,n,s,r,i=[]){super(),this.key=e,this.data=n,this.fieldMask=s,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function ok(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const s=t.data.field(n);e.set(n,s)}}),e}function w_(t,e,n){const s=new Map;ke(t.length===n.length);for(let r=0;r<n.length;r++){const i=t[r],o=i.transform,l=e.data.field(i.field);s.set(i.field,t5(o,l,n[r]))}return s}function __(t,e,n){const s=new Map;for(const r of t){const i=r.transform,o=n.data.field(r.field);s.set(r.field,e5(i,o,e))}return s}class Wu extends rm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class lk extends rm{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jy{constructor(e,n,s,r){this.batchId=e,this.localWriteTime=n,this.baseMutations=s,this.mutations=r}applyToRemoteDocument(e,n){const s=n.mutationResults;for(let r=0;r<this.mutations.length;r++){const i=this.mutations[r];i.key.isEqual(e.key)&&r5(i,e,s[r])}}applyToLocalView(e,n){for(const s of this.baseMutations)s.key.isEqual(e.key)&&(n=Vc(s,e,n,this.localWriteTime));for(const s of this.mutations)s.key.isEqual(e.key)&&(n=Vc(s,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const s=Z1();return this.mutations.forEach(r=>{const i=e.get(r.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(r.key)?null:l;const c=ak(o,l);c!==null&&s.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(Re.min())}),s}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),$e())}isEqual(e){return this.batchId===e.batchId&&il(this.mutations,e.mutations,(n,s)=>b_(n,s))&&il(this.baseMutations,e.baseMutations,(n,s)=>b_(n,s))}}class Zy{constructor(e,n,s,r){this.batch=e,this.commitVersion=n,this.mutationResults=s,this.docVersions=r}static from(e,n,s){ke(e.mutations.length===s.length);let r=function(){return XO}();const i=e.mutations;for(let o=0;o<i.length;o++)r=r.insert(i[o].key,s[o].version);return new Zy(e,n,s,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e0{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a5{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gt,Qe;function o5(t){switch(t){default:return _e();case Y.CANCELLED:case Y.UNKNOWN:case Y.DEADLINE_EXCEEDED:case Y.RESOURCE_EXHAUSTED:case Y.INTERNAL:case Y.UNAVAILABLE:case Y.UNAUTHENTICATED:return!1;case Y.INVALID_ARGUMENT:case Y.NOT_FOUND:case Y.ALREADY_EXISTS:case Y.PERMISSION_DENIED:case Y.FAILED_PRECONDITION:case Y.ABORTED:case Y.OUT_OF_RANGE:case Y.UNIMPLEMENTED:case Y.DATA_LOSS:return!0}}function ck(t){if(t===void 0)return $t("GRPC error has no .code"),Y.UNKNOWN;switch(t){case Gt.OK:return Y.OK;case Gt.CANCELLED:return Y.CANCELLED;case Gt.UNKNOWN:return Y.UNKNOWN;case Gt.DEADLINE_EXCEEDED:return Y.DEADLINE_EXCEEDED;case Gt.RESOURCE_EXHAUSTED:return Y.RESOURCE_EXHAUSTED;case Gt.INTERNAL:return Y.INTERNAL;case Gt.UNAVAILABLE:return Y.UNAVAILABLE;case Gt.UNAUTHENTICATED:return Y.UNAUTHENTICATED;case Gt.INVALID_ARGUMENT:return Y.INVALID_ARGUMENT;case Gt.NOT_FOUND:return Y.NOT_FOUND;case Gt.ALREADY_EXISTS:return Y.ALREADY_EXISTS;case Gt.PERMISSION_DENIED:return Y.PERMISSION_DENIED;case Gt.FAILED_PRECONDITION:return Y.FAILED_PRECONDITION;case Gt.ABORTED:return Y.ABORTED;case Gt.OUT_OF_RANGE:return Y.OUT_OF_RANGE;case Gt.UNIMPLEMENTED:return Y.UNIMPLEMENTED;case Gt.DATA_LOSS:return Y.DATA_LOSS;default:return _e()}}(Qe=Gt||(Gt={}))[Qe.OK=0]="OK",Qe[Qe.CANCELLED=1]="CANCELLED",Qe[Qe.UNKNOWN=2]="UNKNOWN",Qe[Qe.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Qe[Qe.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Qe[Qe.NOT_FOUND=5]="NOT_FOUND",Qe[Qe.ALREADY_EXISTS=6]="ALREADY_EXISTS",Qe[Qe.PERMISSION_DENIED=7]="PERMISSION_DENIED",Qe[Qe.UNAUTHENTICATED=16]="UNAUTHENTICATED",Qe[Qe.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Qe[Qe.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Qe[Qe.ABORTED=10]="ABORTED",Qe[Qe.OUT_OF_RANGE=11]="OUT_OF_RANGE",Qe[Qe.UNIMPLEMENTED=12]="UNIMPLEMENTED",Qe[Qe.INTERNAL=13]="INTERNAL",Qe[Qe.UNAVAILABLE=14]="UNAVAILABLE",Qe[Qe.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l5(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c5=new Na([4294967295,4294967295],0);function N_(t){const e=l5().encode(t),n=new g1;return n.update(e),new Uint8Array(n.digest())}function E_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),s=e.getUint32(4,!0),r=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Na([n,s],0),new Na([r,i],0)]}class t0{constructor(e,n,s){if(this.bitmap=e,this.padding=n,this.hashCount=s,n<0||n>=8)throw new xc(`Invalid padding: ${n}`);if(s<0)throw new xc(`Invalid hash count: ${s}`);if(e.length>0&&this.hashCount===0)throw new xc(`Invalid hash count: ${s}`);if(e.length===0&&n!==0)throw new xc(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Na.fromNumber(this.Ie)}Ee(e,n,s){let r=e.add(n.multiply(Na.fromNumber(s)));return r.compare(c5)===1&&(r=new Na([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=N_(e),[s,r]=E_(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(s,r,i);if(!this.de(o))return!1}return!0}static create(e,n,s){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new t0(i,r,n);return s.forEach(l=>o.insert(l)),o}insert(e){if(this.Ie===0)return;const n=N_(e),[s,r]=E_(n);for(let i=0;i<this.hashCount;i++){const o=this.Ee(s,r,i);this.Ae(o)}}Ae(e){const n=Math.floor(e/8),s=e%8;this.bitmap[n]|=1<<s}}class xc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gu{constructor(e,n,s,r,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=s,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,s){const r=new Map;return r.set(e,Hu.createSynthesizedTargetChangeForCurrentChange(e,n,s)),new Gu(Re.min(),r,new dt(Oe),ds(),$e())}}class Hu{constructor(e,n,s,r,i){this.resumeToken=e,this.current=n,this.addedDocuments=s,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,s){return new Hu(s,n,$e(),$e(),$e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yh{constructor(e,n,s,r){this.Re=e,this.removedTargetIds=n,this.key=s,this.Ve=r}}class uk{constructor(e,n){this.targetId=e,this.me=n}}class dk{constructor(e,n,s=zt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=n,this.resumeToken=s,this.cause=r}}class T_{constructor(){this.fe=0,this.ge=j_(),this.pe=zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=$e(),n=$e(),s=$e();return this.ge.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:n=n.add(r);break;case 1:s=s.add(r);break;default:_e()}}),new Hu(this.pe,this.ye,e,n,s)}Ce(){this.we=!1,this.ge=j_()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,ke(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class u5{constructor(e){this.Le=e,this.Be=new Map,this.ke=ds(),this.qe=S_(),this.Qe=new dt(Oe)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const s=this.Ge(n);switch(e.state){case 0:this.ze(n)&&s.De(e.resumeToken);break;case 1:s.Oe(),s.Se||s.Ce(),s.De(e.resumeToken);break;case 2:s.Oe(),s.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(s.Ne(),s.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),s.De(e.resumeToken));break;default:_e()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((s,r)=>{this.ze(r)&&n(r)})}He(e){const n=e.targetId,s=e.me.count,r=this.Je(n);if(r){const i=r.target;if(af(i))if(s===0){const o=new me(i.path);this.Ue(n,o,Ut.newNoDocument(o,Re.min()))}else ke(s===1);else{const o=this.Ye(n);if(o!==s){const l=this.Ze(e),c=l?this.Xe(l,e,o):1;if(c!==0){this.je(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,u)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:s="",padding:r=0},hashCount:i=0}=n;let o,l;try{o=Mi(s).toUint8Array()}catch(c){if(c instanceof V1)return uu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new t0(o,r,i)}catch(c){return uu(c instanceof xc?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.Ie===0?null:l}Xe(e,n,s){return n.me.count===s-this.nt(e,n.targetId)?0:2}nt(e,n){const s=this.Le.getRemoteKeysForTarget(n);let r=0;return s.forEach(i=>{const o=this.Le.tt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.Ue(n,i,null),r++)}),r}rt(e){const n=new Map;this.Be.forEach((i,o)=>{const l=this.Je(o);if(l){if(i.current&&af(l.target)){const c=new me(l.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,Ut.newNoDocument(c,e))}i.be&&(n.set(o,i.ve()),i.Ce())}});let s=$e();this.qe.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this.Je(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(s=s.add(i))}),this.ke.forEach((i,o)=>o.setReadTime(e));const r=new Gu(e,n,this.Qe,this.ke,s);return this.ke=ds(),this.qe=S_(),this.Qe=new dt(Oe),r}$e(e,n){if(!this.ze(e))return;const s=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,s),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,s){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,n)?r.Fe(n,1):r.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),s&&(this.ke=this.ke.insert(n,s))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new T_,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new it(Oe),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||te("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new T_),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function S_(){return new dt(me.comparator)}function j_(){return new dt(me.comparator)}const d5={asc:"ASCENDING",desc:"DESCENDING"},h5={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},f5={and:"AND",or:"OR"};class m5{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Xg(t,e){return t.useProto3Json||em(e)?e:{value:e}}function dl(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function hk(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function p5(t,e){return dl(t,e.toTimestamp())}function Bn(t){return ke(!!t),Re.fromTimestamp(function(n){const s=Fr(n);return new At(s.seconds,s.nanos)}(t))}function n0(t,e){return Jg(t,e).canonicalString()}function Jg(t,e){const n=function(r){return new et(["projects",r.projectId,"databases",r.database])}(t).child("documents");return e===void 0?n:n.child(e)}function fk(t){const e=et.fromString(t);return ke(_k(e)),e}function cf(t,e){return n0(t.databaseId,e.path)}function Ea(t,e){const n=fk(e);if(n.get(1)!==t.databaseId.projectId)throw new ce(Y.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ce(Y.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new me(gk(n))}function mk(t,e){return n0(t.databaseId,e)}function pk(t){const e=fk(t);return e.length===4?et.emptyPath():gk(e)}function Zg(t){return new et(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function gk(t){return ke(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function k_(t,e,n){return{name:cf(t,e),fields:n.value.mapValue.fields}}function g5(t,e,n){const s=Ea(t,e.name),r=Bn(e.updateTime),i=e.createTime?Bn(e.createTime):Re.min(),o=new kn({mapValue:{fields:e.fields}}),l=Ut.newFoundDocument(s,r,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function x5(t,e){let n;if("targetChange"in e){e.targetChange;const s=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:_e()}(e.targetChange.targetChangeType||"NO_CHANGE"),r=e.targetChange.targetIds||[],i=function(u,h){return u.useProto3Json?(ke(h===void 0||typeof h=="string"),zt.fromBase64String(h||"")):(ke(h===void 0||h instanceof Buffer||h instanceof Uint8Array),zt.fromUint8Array(h||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const h=u.code===void 0?Y.UNKNOWN:ck(u.code);return new ce(h,u.message||"")}(o);n=new dk(s,r,i,l||null)}else if("documentChange"in e){e.documentChange;const s=e.documentChange;s.document,s.document.name,s.document.updateTime;const r=Ea(t,s.document.name),i=Bn(s.document.updateTime),o=s.document.createTime?Bn(s.document.createTime):Re.min(),l=new kn({mapValue:{fields:s.document.fields}}),c=Ut.newFoundDocument(r,i,o,l),u=s.targetIds||[],h=s.removedTargetIds||[];n=new yh(u,h,c.key,c)}else if("documentDelete"in e){e.documentDelete;const s=e.documentDelete;s.document;const r=Ea(t,s.document),i=s.readTime?Bn(s.readTime):Re.min(),o=Ut.newNoDocument(r,i),l=s.removedTargetIds||[];n=new yh([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const s=e.documentRemove;s.document;const r=Ea(t,s.document),i=s.removedTargetIds||[];n=new yh([],i,r,null)}else{if(!("filter"in e))return _e();{e.filter;const s=e.filter;s.targetId;const{count:r=0,unchangedNames:i}=s,o=new a5(r,i),l=s.targetId;n=new uk(l,o)}}return n}function uf(t,e){let n;if(e instanceof jl)n={update:k_(t,e.key,e.value)};else if(e instanceof Wu)n={delete:cf(t,e.key)};else if(e instanceof Gr)n={update:k_(t,e.key,e.data),updateMask:N5(e.fieldMask)};else{if(!(e instanceof lk))return _e();n={verify:cf(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(s=>function(i,o){const l=o.transform;if(l instanceof cl)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof Fa)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Ua)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof ul)return{fieldPath:o.field.canonicalString(),increment:l.Pe};throw _e()}(0,s))),e.precondition.isNone||(n.currentDocument=function(r,i){return i.updateTime!==void 0?{updateTime:p5(r,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:_e()}(t,e.precondition)),n}function ex(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?tn.updateTime(Bn(i.updateTime)):i.exists!==void 0?tn.exists(i.exists):tn.none()}(e.currentDocument):tn.none(),s=e.updateTransforms?e.updateTransforms.map(r=>function(o,l){let c=null;if("setToServerValue"in l)ke(l.setToServerValue==="REQUEST_TIME"),c=new cl;else if("appendMissingElements"in l){const h=l.appendMissingElements.values||[];c=new Fa(h)}else if("removeAllFromArray"in l){const h=l.removeAllFromArray.values||[];c=new Ua(h)}else"increment"in l?c=new ul(o,l.increment):_e();const u=St.fromServerFormat(l.fieldPath);return new qu(u,c)}(t,r)):[];if(e.update){e.update.name;const r=Ea(t,e.update.name),i=new kn({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new Zn(u.map(h=>St.fromServerFormat(h)))}(e.updateMask);return new Gr(r,i,o,n,s)}return new jl(r,i,n,s)}if(e.delete){const r=Ea(t,e.delete);return new Wu(r,n)}if(e.verify){const r=Ea(t,e.verify);return new lk(r,n)}return _e()}function y5(t,e){return t&&t.length>0?(ke(e!==void 0),t.map(n=>function(r,i){let o=r.updateTime?Bn(r.updateTime):Bn(i);return o.isEqual(Re.min())&&(o=Bn(i)),new s5(o,r.transformResults||[])}(n,e))):[]}function xk(t,e){return{documents:[mk(t,e.path)]}}function yk(t,e){const n={structuredQuery:{}},s=e.path;let r;e.collectionGroup!==null?(r=s,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(r=s.popLast(),n.structuredQuery.from=[{collectionId:s.lastSegment()}]),n.parent=mk(t,r);const i=function(u){if(u.length!==0)return wk(nt.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(h=>function(m){return{field:yo(m.field),direction:b5(m.dir)}}(h))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=Xg(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{_t:n,parent:r}}function vk(t){let e=pk(t.parent);const n=t.structuredQuery,s=n.from?n.from.length:0;let r=null;if(s>0){ke(s===1);const h=n.from[0];h.allDescendants?r=h.collectionId:e=e.child(h.collectionId)}let i=[];n.where&&(i=function(f){const m=bk(f);return m instanceof nt&&Qy(m)?m.getFilters():[m]}(n.where));let o=[];n.orderBy&&(o=function(f){return f.map(m=>function(b){return new yu(vo(b.field),function(E){switch(E){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}(m))}(n.orderBy));let l=null;n.limit&&(l=function(f){let m;return m=typeof f=="object"?f.value:f,em(m)?null:m}(n.limit));let c=null;n.startAt&&(c=function(f){const m=!!f.before,x=f.values||[];return new ol(x,m)}(n.startAt));let u=null;return n.endAt&&(u=function(f){const m=!f.before,x=f.values||[];return new ol(x,m)}(n.endAt)),G1(e,r,o,i,l,"F",c,u)}function v5(t,e){const n=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _e()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function bk(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const s=vo(n.unaryFilter.field);return He.create(s,"==",{doubleValue:NaN});case"IS_NULL":const r=vo(n.unaryFilter.field);return He.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=vo(n.unaryFilter.field);return He.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=vo(n.unaryFilter.field);return He.create(o,"!=",{nullValue:"NULL_VALUE"});default:return _e()}}(t):t.fieldFilter!==void 0?function(n){return He.create(vo(n.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return _e()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return nt.create(n.compositeFilter.filters.map(s=>bk(s)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return _e()}}(n.compositeFilter.op))}(t):_e()}function b5(t){return d5[t]}function w5(t){return h5[t]}function _5(t){return f5[t]}function yo(t){return{fieldPath:t.canonicalString()}}function vo(t){return St.fromServerFormat(t.fieldPath)}function wk(t){return t instanceof He?function(n){if(n.op==="=="){if(d_(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NAN"}};if(u_(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(d_(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NAN"}};if(u_(n.value))return{unaryFilter:{field:yo(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:yo(n.field),op:w5(n.op),value:n.value}}}(t):t instanceof nt?function(n){const s=n.getFilters().map(r=>wk(r));return s.length===1?s[0]:{compositeFilter:{op:_5(n.op),filters:s}}}(t):_e()}function N5(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function _k(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kr{constructor(e,n,s,r,i=Re.min(),o=Re.min(),l=zt.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=s,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new kr(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new kr(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(e){this.ct=e}}function E5(t,e){let n;if(e.document)n=g5(t.ct,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const s=me.fromSegments(e.noDocument.path),r=$a(e.noDocument.readTime);n=Ut.newNoDocument(s,r),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return _e();{const s=me.fromSegments(e.unknownDocument.path),r=$a(e.unknownDocument.version);n=Ut.newUnknownDocument(s,r)}}return e.readTime&&n.setReadTime(function(r){const i=new At(r[0],r[1]);return Re.fromTimestamp(i)}(e.readTime)),n}function I_(t,e){const n=e.key,s={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:df(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())s.document=function(i,o){return{name:cf(i,o.key),fields:o.data.value.mapValue.fields,updateTime:dl(i,o.version.toTimestamp()),createTime:dl(i,o.createTime.toTimestamp())}}(t.ct,e);else if(e.isNoDocument())s.noDocument={path:n.path.toArray(),readTime:Ba(e.version)};else{if(!e.isUnknownDocument())return _e();s.unknownDocument={path:n.path.toArray(),version:Ba(e.version)}}return s}function df(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function Ba(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function $a(t){const e=new At(t.seconds,t.nanoseconds);return Re.fromTimestamp(e)}function ua(t,e){const n=(e.baseMutations||[]).map(i=>ex(t.ct,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const s=e.mutations.map(i=>ex(t.ct,i)),r=At.fromMillis(e.localWriteTimeMs);return new Jy(e.batchId,r,n,s)}function yc(t){const e=$a(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?$a(t.lastLimboFreeSnapshotVersion):Re.min();let s;return s=function(i){return i.documents!==void 0}(t.query)?function(i){return ke(i.documents.length===1),ms($u(pk(i.documents[0])))}(t.query):function(i){return ms(vk(i))}(t.query),new kr(s,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,zt.fromBase64String(t.resumeToken))}function Ek(t,e){const n=Ba(e.snapshotVersion),s=Ba(e.lastLimboFreeSnapshotVersion);let r;r=af(e.target)?xk(t.ct,e.target):yk(t.ct,e.target)._t;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Oa(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:s,query:r}}function Tk(t){const e=vk({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?lf(e,e.limit,"L"):e}function up(t,e){return new e0(e.largestBatchId,ex(t.ct,e.overlayMutation))}function C_(t,e){const n=e.path.lastSegment();return[t,Un(e.path.popLast()),n]}function A_(t,e,n,s){return{indexId:t,uid:e,sequenceNumber:n,readTime:Ba(s.readTime),documentKey:Un(s.documentKey.path),largestBatchId:s.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T5{getBundleMetadata(e,n){return R_(e).get(n).next(s=>{if(s)return function(i){return{id:i.bundleId,createTime:$a(i.createTime),version:i.version}}(s)})}saveBundleMetadata(e,n){return R_(e).put(function(r){return{bundleId:r.id,createTime:Ba(Bn(r.createTime)),version:r.version}}(n))}getNamedQuery(e,n){return P_(e).get(n).next(s=>{if(s)return function(i){return{name:i.name,query:Tk(i.bundledQuery),readTime:$a(i.readTime)}}(s)})}saveNamedQuery(e,n){return P_(e).put(function(r){return{name:r.name,readTime:Ba(Bn(r.readTime)),bundledQuery:r.bundledQuery}}(n))}}function R_(t){return an(t,"bundles")}function P_(t){return an(t,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class im{constructor(e,n){this.serializer=e,this.userId=n}static lt(e,n){const s=n.uid||"";return new im(e,s)}getOverlay(e,n){return nc(e).get(C_(this.userId,n)).next(s=>s?up(this.serializer,s):null)}getOverlays(e,n){const s=sr();return $.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){const r=[];return s.forEach((i,o)=>{const l=new e0(n,o);r.push(this.ht(e,l))}),$.waitFor(r)}removeOverlaysForBatchId(e,n,s){const r=new Set;n.forEach(o=>r.add(Un(o.getCollectionPath())));const i=[];return r.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,s],[this.userId,o,s+1],!1,!0);i.push(nc(e).j("collectionPathOverlayIndex",l))}),$.waitFor(i)}getOverlaysForCollection(e,n,s){const r=sr(),i=Un(n),o=IDBKeyRange.bound([this.userId,i,s],[this.userId,i,Number.POSITIVE_INFINITY],!0);return nc(e).U("collectionPathOverlayIndex",o).next(l=>{for(const c of l){const u=up(this.serializer,c);r.set(u.getKey(),u)}return r})}getOverlaysForCollectionGroup(e,n,s,r){const i=sr();let o;const l=IDBKeyRange.bound([this.userId,n,s],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nc(e).J({index:"collectionGroupOverlayIndex",range:l},(c,u,h)=>{const f=up(this.serializer,u);i.size()<r||f.largestBatchId===o?(i.set(f.getKey(),f),o=f.largestBatchId):h.done()}).next(()=>i)}ht(e,n){return nc(e).put(function(r,i,o){const[l,c,u]=C_(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:uf(r.ct,o.mutation)}}(this.serializer,this.userId,n))}}function nc(t){return an(t,"documentOverlays")}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S5{Pt(e){return an(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next(n=>{const s=n==null?void 0:n.value;return s?zt.fromUint8Array(s):zt.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Pt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class da{constructor(){}It(e,n){this.Tt(e,n),n.Et()}Tt(e,n){if("nullValue"in e)this.dt(n,5);else if("booleanValue"in e)this.dt(n,10),n.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(n,15),n.At(bt(e.integerValue));else if("doubleValue"in e){const s=bt(e.doubleValue);isNaN(s)?this.dt(n,13):(this.dt(n,15),fu(s)?n.At(0):n.At(s))}else if("timestampValue"in e){let s=e.timestampValue;this.dt(n,20),typeof s=="string"&&(s=Fr(s)),n.Rt(`${s.seconds||""}`),n.At(s.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,n),this.ft(n);else if("bytesValue"in e)this.dt(n,30),n.gt(Mi(e.bytesValue)),this.ft(n);else if("referenceValue"in e)this.yt(e.referenceValue,n);else if("geoPointValue"in e){const s=e.geoPointValue;this.dt(n,45),n.At(s.latitude||0),n.At(s.longitude||0)}else"mapValue"in e?M1(e)?this.dt(n,Number.MAX_SAFE_INTEGER):tm(e)?this.wt(e.mapValue,n):(this.St(e.mapValue,n),this.ft(n)):"arrayValue"in e?(this.bt(e.arrayValue,n),this.ft(n)):_e()}Vt(e,n){this.dt(n,25),this.Dt(e,n)}Dt(e,n){n.Rt(e)}St(e,n){const s=e.fields||{};this.dt(n,55);for(const r of Object.keys(s))this.Vt(r,n),this.Tt(s[r],n)}wt(e,n){var s,r;const i=e.fields||{};this.dt(n,53);const o="value",l=((r=(s=i[o].arrayValue)===null||s===void 0?void 0:s.values)===null||r===void 0?void 0:r.length)||0;this.dt(n,15),n.At(bt(l)),this.Vt(o,n),this.Tt(i[o],n)}bt(e,n){const s=e.values||[];this.dt(n,50);for(const r of s)this.Tt(r,n)}yt(e,n){this.dt(n,37),me.fromName(e).path.forEach(s=>{this.dt(n,60),this.Dt(s,n)})}dt(e,n){e.At(n)}ft(e){e.At(2)}}da.vt=new da;function j5(t){if(t===0)return 8;let e=0;return!(t>>4)&&(e+=4,t<<=4),!(t>>6)&&(e+=2,t<<=2),!(t>>7)&&(e+=1),e}function D_(t){const e=64-function(s){let r=0;for(let i=0;i<8;++i){const o=j5(255&s[i]);if(r+=o,o!==8)break}return r}(t);return Math.ceil(e/8)}class k5{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ft(s.value),s=n.next();this.Mt()}xt(e){const n=e[Symbol.iterator]();let s=n.next();for(;!s.done;)this.Ot(s.value),s=n.next();this.Nt()}Lt(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ft(s);else if(s<2048)this.Ft(960|s>>>6),this.Ft(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ft(480|s>>>12),this.Ft(128|63&s>>>6),this.Ft(128|63&s);else{const r=n.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Bt(e){for(const n of e){const s=n.charCodeAt(0);if(s<128)this.Ot(s);else if(s<2048)this.Ot(960|s>>>6),this.Ot(128|63&s);else if(n<"\uD800"||"\uDBFF"<n)this.Ot(480|s>>>12),this.Ot(128|63&s>>>6),this.Ot(128|63&s);else{const r=n.codePointAt(0);this.Ot(240|r>>>18),this.Ot(128|63&r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r)}}this.Nt()}kt(e){const n=this.qt(e),s=D_(n);this.Qt(1+s),this.buffer[this.position++]=255&s;for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=255&n[r]}Kt(e){const n=this.qt(e),s=D_(n);this.Qt(1+s),this.buffer[this.position++]=~(255&s);for(let r=n.length-s;r<n.length;++r)this.buffer[this.position++]=~(255&n[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),s=(128&n[0])!=0;n[0]^=s?255:128;for(let r=1;r<n.length;++r)n[r]^=s?255:0;return n}Ft(e){const n=255&e;n===0?(this.Ut(0),this.Ut(255)):n===255?(this.Ut(255),this.Ut(0)):this.Ut(n)}Ot(e){const n=255&e;n===0?(this.Gt(0),this.Gt(255)):n===255?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const n=e+this.position;if(n<=this.buffer.length)return;let s=2*this.buffer.length;s<n&&(s=n);const r=new Uint8Array(s);r.set(this.buffer),this.buffer=r}}class I5{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class C5{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class sc{constructor(){this.jt=new k5,this.Ht=new I5(this.jt),this.Jt=new C5(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return e===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ha{constructor(e,n,s,r){this.indexId=e,this.documentKey=n,this.arrayValue=s,this.directionalValue=r}Zt(){const e=this.directionalValue.length,n=e===0||this.directionalValue[e-1]===255?e+1:e,s=new Uint8Array(n);return s.set(this.directionalValue,0),n!==e?s.set([0],this.directionalValue.length):++s[s.length-1],new ha(this.indexId,this.documentKey,this.arrayValue,s)}}function ii(t,e){let n=t.indexId-e.indexId;return n!==0?n:(n=V_(t.arrayValue,e.arrayValue),n!==0?n:(n=V_(t.directionalValue,e.directionalValue),n!==0?n:me.comparator(t.documentKey,e.documentKey)))}function V_(t,e){for(let n=0;n<t.length&&n<e.length;++n){const s=t[n]-e[n];if(s!==0)return s}return t.length-e.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M_{constructor(e){this.Xt=new it((n,s)=>St.comparator(n.field,s.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const n of e.filters){const s=n;s.isInequality()?this.Xt=this.Xt.add(s):this.tn.push(s)}}get nn(){return this.Xt.size>1}rn(e){if(ke(e.collectionGroup===this.collectionId),this.nn)return!1;const n=zg(e);if(n!==void 0&&!this.sn(n))return!1;const s=oa(e);let r=new Set,i=0,o=0;for(;i<s.length&&this.sn(s[i]);++i)r=r.add(s[i].fieldPath.canonicalString());if(i===s.length)return!0;if(this.Xt.size>0){const l=this.Xt.getIterator().getNext();if(!r.has(l.field.canonicalString())){const c=s[i];if(!this.on(l,c)||!this._n(this.en[o++],c))return!1}++i}for(;i<s.length;++i){const l=s[i];if(o>=this.en.length||!this._n(this.en[o++],l))return!1}return!0}an(){if(this.nn)return null;let e=new it(St.comparator);const n=[];for(const s of this.tn)if(!s.field.isKeyField())if(s.op==="array-contains"||s.op==="array-contains-any")n.push(new fh(s.field,2));else{if(e.has(s.field))continue;e=e.add(s.field),n.push(new fh(s.field,0))}for(const s of this.en)s.field.isKeyField()||e.has(s.field)||(e=e.add(s.field),n.push(new fh(s.field,s.dir==="asc"?0:1)));return new rf(rf.UNKNOWN_ID,this.collectionId,n,hu.empty())}sn(e){for(const n of this.tn)if(this.on(n,e))return!0;return!1}on(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const s=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===s}_n(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sk(t){var e,n;if(ke(t instanceof He||t instanceof nt),t instanceof He){if(t instanceof W1){const r=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>He.create(t.field,"==",i)))||[];return nt.create(r,"or")}return t}const s=t.filters.map(r=>Sk(r));return nt.create(s,t.op)}function A5(t){if(t.getFilters().length===0)return[];const e=sx(Sk(t));return ke(jk(e)),tx(e)||nx(e)?[e]:e.getFilters()}function tx(t){return t instanceof He}function nx(t){return t instanceof nt&&Qy(t)}function jk(t){return tx(t)||nx(t)||function(n){if(n instanceof nt&&Hg(n)){for(const s of n.getFilters())if(!tx(s)&&!nx(s))return!1;return!0}return!1}(t)}function sx(t){if(ke(t instanceof He||t instanceof nt),t instanceof He)return t;if(t.filters.length===1)return sx(t.filters[0]);const e=t.filters.map(s=>sx(s));let n=nt.create(e,t.op);return n=hf(n),jk(n)?n:(ke(n instanceof nt),ke(ll(n)),ke(n.filters.length>1),n.filters.reduce((s,r)=>s0(s,r)))}function s0(t,e){let n;return ke(t instanceof He||t instanceof nt),ke(e instanceof He||e instanceof nt),n=t instanceof He?e instanceof He?function(r,i){return nt.create([r,i],"and")}(t,e):L_(t,e):e instanceof He?L_(e,t):function(r,i){if(ke(r.filters.length>0&&i.filters.length>0),ll(r)&&ll(i))return $1(r,i.getFilters());const o=Hg(r)?r:i,l=Hg(r)?i:r,c=o.filters.map(u=>s0(u,l));return nt.create(c,"or")}(t,e),hf(n)}function L_(t,e){if(ll(e))return $1(e,t.getFilters());{const n=e.filters.map(s=>s0(t,s));return nt.create(n,"or")}}function hf(t){if(ke(t instanceof He||t instanceof nt),t instanceof He)return t;const e=t.getFilters();if(e.length===1)return hf(e[0]);if(U1(t))return t;const n=e.map(r=>hf(r)),s=[];return n.forEach(r=>{r instanceof He?s.push(r):r instanceof nt&&(r.op===t.op?s.push(...r.filters):s.push(r))}),s.length===1?s[0]:nt.create(s,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R5{constructor(){this.un=new r0}addToCollectionParentIndex(e,n){return this.un.add(n),$.resolve()}getCollectionParents(e,n){return $.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return $.resolve()}deleteFieldIndex(e,n){return $.resolve()}deleteAllFieldIndexes(e){return $.resolve()}createTargetIndexes(e,n){return $.resolve()}getDocumentsMatchingTarget(e,n){return $.resolve(null)}getIndexType(e,n){return $.resolve(0)}getFieldIndexes(e,n){return $.resolve([])}getNextCollectionGroupToUpdate(e){return $.resolve(null)}getMinOffset(e,n){return $.resolve(gs.min())}getMinOffsetFromCollectionGroup(e,n){return $.resolve(gs.min())}updateCollectionGroup(e,n,s){return $.resolve()}updateIndexEntries(e,n){return $.resolve()}}class r0{constructor(){this.index={}}add(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n]||new it(et.comparator),i=!r.has(s);return this.index[n]=r.add(s),i}has(e){const n=e.lastSegment(),s=e.popLast(),r=this.index[n];return r&&r.has(s)}getEntries(e){return(this.index[e]||new it(et.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fd=new Uint8Array(0);class P5{constructor(e,n){this.databaseId=n,this.cn=new r0,this.ln=new Hi(s=>Oa(s),(s,r)=>Bu(s,r)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.cn.has(n)){const s=n.lastSegment(),r=n.popLast();e.addOnCommittedListener(()=>{this.cn.add(n)});const i={collectionId:s,parent:Un(r)};return O_(e).put(i)}return $.resolve()}getCollectionParents(e,n){const s=[],r=IDBKeyRange.bound([n,""],[N1(n),""],!1,!0);return O_(e).U(r).next(i=>{for(const o of i){if(o.collectionId!==n)break;s.push(nr(o.parent))}return s})}addFieldIndex(e,n){const s=rc(e),r=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete r.indexId;const i=s.add(r);if(n.indexState){const o=ho(e);return i.next(l=>{o.put(A_(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const s=rc(e),r=ho(e),i=uo(e);return s.delete(n.indexId).next(()=>r.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=rc(e),s=uo(e),r=ho(e);return n.j().next(()=>s.j()).next(()=>r.j())}createTargetIndexes(e,n){return $.forEach(this.hn(n),s=>this.getIndexType(e,s).next(r=>{if(r===0||r===1){const i=new M_(s).an();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const s=uo(e);let r=!0;const i=new Map;return $.forEach(this.hn(n),o=>this.Pn(e,o).next(l=>{r&&(r=!!l),i.set(o,l)})).next(()=>{if(r){let o=$e();const l=[];return $.forEach(i,(c,u)=>{te("IndexedDbIndexManager",`Using index ${function(T){return`id=${T.indexId}|cg=${T.collectionGroup}|f=${T.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(c)} to execute ${Oa(n)}`);const h=function(T,I){const R=zg(I);if(R===void 0)return null;for(const V of of(T,R.fieldPath))switch(V.op){case"array-contains-any":return V.value.arrayValue.values||[];case"array-contains":return[V.value]}return null}(u,c),f=function(T,I){const R=new Map;for(const V of oa(I))for(const j of of(T,V.fieldPath))switch(j.op){case"==":case"in":R.set(V.fieldPath.canonicalString(),j.value);break;case"not-in":case"!=":return R.set(V.fieldPath.canonicalString(),j.value),Array.from(R.values())}return null}(u,c),m=function(T,I){const R=[];let V=!0;for(const j of oa(I)){const y=j.kind===0?g_(T,j.fieldPath,T.startAt):x_(T,j.fieldPath,T.startAt);R.push(y.value),V&&(V=y.inclusive)}return new ol(R,V)}(u,c),x=function(T,I){const R=[];let V=!0;for(const j of oa(I)){const y=j.kind===0?x_(T,j.fieldPath,T.endAt):g_(T,j.fieldPath,T.endAt);R.push(y.value),V&&(V=y.inclusive)}return new ol(R,V)}(u,c),b=this.In(c,u,m),N=this.In(c,u,x),E=this.Tn(c,u,f),w=this.En(c.indexId,h,b,m.inclusive,N,x.inclusive,E);return $.forEach(w,v=>s.G(v,n.limit).next(T=>{T.forEach(I=>{const R=me.fromSegments(I.documentKey);o.has(R)||(o=o.add(R),l.push(R))})}))}).next(()=>l)}return $.resolve(null)})}hn(e){let n=this.ln.get(e);return n||(e.filters.length===0?n=[e]:n=A5(nt.create(e.filters,"and")).map(s=>Qg(e.path,e.collectionGroup,e.orderBy,s.getFilters(),e.limit,e.startAt,e.endAt)),this.ln.set(e,n),n)}En(e,n,s,r,i,o,l){const c=(n!=null?n.length:1)*Math.max(s.length,i.length),u=c/(n!=null?n.length:1),h=[];for(let f=0;f<c;++f){const m=n?this.dn(n[f/u]):Fd,x=this.An(e,m,s[f%u],r),b=this.Rn(e,m,i[f%u],o),N=l.map(E=>this.An(e,m,E,!0));h.push(...this.createRange(x,b,N))}return h}An(e,n,s,r){const i=new ha(e,me.empty(),n,s);return r?i:i.Zt()}Rn(e,n,s,r){const i=new ha(e,me.empty(),n,s);return r?i.Zt():i}Pn(e,n){const s=new M_(n),r=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,r).next(i=>{let o=null;for(const l of i)s.rn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let s=2;const r=this.hn(n);return $.forEach(r,i=>this.Pn(e,i).next(o=>{o?s!==0&&o.fields.length<function(c){let u=new it(St.comparator),h=!1;for(const f of c.filters)for(const m of f.getFlattenedFilters())m.field.isKeyField()||(m.op==="array-contains"||m.op==="array-contains-any"?h=!0:u=u.add(m.field));for(const f of c.orderBy)f.field.isKeyField()||(u=u.add(f.field));return u.size+(h?1:0)}(i)&&(s=1):s=0})).next(()=>function(o){return o.limit!==null}(n)&&r.length>1&&s===2?1:s)}Vn(e,n){const s=new sc;for(const r of oa(e)){const i=n.data.field(r.fieldPath);if(i==null)return null;const o=s.Yt(r.kind);da.vt.It(i,o)}return s.zt()}dn(e){const n=new sc;return da.vt.It(e,n.Yt(0)),n.zt()}mn(e,n){const s=new sc;return da.vt.It(gu(this.databaseId,n),s.Yt(function(i){const o=oa(i);return o.length===0?0:o[o.length-1].kind}(e))),s.zt()}Tn(e,n,s){if(s===null)return[];let r=[];r.push(new sc);let i=0;for(const o of oa(e)){const l=s[i++];for(const c of r)if(this.fn(n,o.fieldPath)&&xu(l))r=this.gn(r,o,l);else{const u=c.Yt(o.kind);da.vt.It(l,u)}}return this.pn(r)}In(e,n,s){return this.Tn(e,n,s.position)}pn(e){const n=[];for(let s=0;s<e.length;++s)n[s]=e[s].zt();return n}gn(e,n,s){const r=[...e],i=[];for(const o of s.arrayValue.values||[])for(const l of r){const c=new sc;c.seed(l.zt()),da.vt.It(o,c.Yt(n.kind)),i.push(c)}return i}fn(e,n){return!!e.filters.find(s=>s instanceof He&&s.field.isEqual(n)&&(s.op==="in"||s.op==="not-in"))}getFieldIndexes(e,n){const s=rc(e),r=ho(e);return(n?s.U("collectionGroupIndex",IDBKeyRange.bound(n,n)):s.U()).next(i=>{const o=[];return $.forEach(i,l=>r.get([l.indexId,this.uid]).next(c=>{o.push(function(h,f){const m=f?new hu(f.sequenceNumber,new gs($a(f.readTime),new me(nr(f.documentKey)),f.largestBatchId)):hu.empty(),x=h.fields.map(([b,N])=>new fh(St.fromServerFormat(b),N));return new rf(h.indexId,h.collectionGroup,x,m)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((s,r)=>{const i=s.indexState.sequenceNumber-r.indexState.sequenceNumber;return i!==0?i:Oe(s.collectionGroup,r.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,s){const r=rc(e),i=ho(e);return this.yn(e).next(o=>r.U("collectionGroupIndex",IDBKeyRange.bound(n,n)).next(l=>$.forEach(l,c=>i.put(A_(c.indexId,this.uid,o,s)))))}updateIndexEntries(e,n){const s=new Map;return $.forEach(n,(r,i)=>{const o=s.get(r.collectionGroup);return(o?$.resolve(o):this.getFieldIndexes(e,r.collectionGroup)).next(l=>(s.set(r.collectionGroup,l),$.forEach(l,c=>this.wn(e,r,c).next(u=>{const h=this.Sn(i,c);return u.isEqual(h)?$.resolve():this.bn(e,i,c,u,h)}))))})}Dn(e,n,s,r){return uo(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(s,n.key),documentKey:n.key.path.toArray()})}vn(e,n,s,r){return uo(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(s,n.key),n.key.path.toArray()])}wn(e,n,s){const r=uo(e);let i=new it(ii);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([s.indexId,this.uid,this.mn(s,n)])},(o,l)=>{i=i.add(new ha(s.indexId,n,l.arrayValue,l.directionalValue))}).next(()=>i)}Sn(e,n){let s=new it(ii);const r=this.Vn(n,e);if(r==null)return s;const i=zg(n);if(i!=null){const o=e.data.field(i.fieldPath);if(xu(o))for(const l of o.arrayValue.values||[])s=s.add(new ha(n.indexId,e.key,this.dn(l),r))}else s=s.add(new ha(n.indexId,e.key,Fd,r));return s}bn(e,n,s,r,i){te("IndexedDbIndexManager","Updating index entries for document '%s'",n.key);const o=[];return function(c,u,h,f,m){const x=c.getIterator(),b=u.getIterator();let N=co(x),E=co(b);for(;N||E;){let w=!1,v=!1;if(N&&E){const T=h(N,E);T<0?v=!0:T>0&&(w=!0)}else N!=null?v=!0:w=!0;w?(f(E),E=co(b)):v?(m(N),N=co(x)):(N=co(x),E=co(b))}}(r,i,ii,l=>{o.push(this.Dn(e,n,s,l))},l=>{o.push(this.vn(e,n,s,l))}),$.waitFor(o)}yn(e){let n=1;return ho(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(s,r,i)=>{i.done(),n=r.sequenceNumber+1}).next(()=>n)}createRange(e,n,s){s=s.sort((o,l)=>ii(o,l)).filter((o,l,c)=>!l||ii(o,c[l-1])!==0);const r=[];r.push(e);for(const o of s){const l=ii(o,e),c=ii(o,n);if(l===0)r[0]=e.Zt();else if(l>0&&c<0)r.push(o),r.push(o.Zt());else if(c>0)break}r.push(n);const i=[];for(let o=0;o<r.length;o+=2){if(this.Cn(r[o],r[o+1]))return[];const l=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Fd,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Fd,[]];i.push(IDBKeyRange.bound(l,c))}return i}Cn(e,n){return ii(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(F_)}getMinOffset(e,n){return $.mapArray(this.hn(n),s=>this.Pn(e,s).next(r=>r||_e())).next(F_)}}function O_(t){return an(t,"collectionParents")}function uo(t){return an(t,"indexEntries")}function rc(t){return an(t,"indexConfiguration")}function ho(t){return an(t,"indexState")}function F_(t){ke(t.length!==0);let e=t[0].indexState.offset,n=e.largestBatchId;for(let s=1;s<t.length;s++){const r=t[s].indexState.offset;qy(r,e)<0&&(e=r),n<r.largestBatchId&&(n=r.largestBatchId)}return new gs(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const U_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class Kn{constructor(e,n,s){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=s}static withCacheSize(e){return new Kn(e,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kk(t,e,n){const s=t.store("mutations"),r=t.store("documentMutations"),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=s.J({range:o},(h,f,m)=>(l++,m.delete()));i.push(c.next(()=>{ke(l===1)}));const u=[];for(const h of n.mutations){const f=C1(e,h.key.path,n.batchId);i.push(r.delete(f)),u.push(h.key)}return $.waitFor(i).next(()=>u)}function ff(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _e();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kn.DEFAULT_COLLECTION_PERCENTILE=10,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kn.DEFAULT=new Kn(41943040,Kn.DEFAULT_COLLECTION_PERCENTILE,Kn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kn.DISABLED=new Kn(-1,0,0);class am{constructor(e,n,s,r){this.userId=e,this.serializer=n,this.indexManager=s,this.referenceDelegate=r,this.Fn={}}static lt(e,n,s,r){ke(e.uid!=="");const i=e.isAuthenticated()?e.uid:"";return new am(i,n,s,r)}checkEmpty(e){let n=!0;const s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return ai(e).J({index:"userMutationsIndex",range:s},(r,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,s,r){const i=bo(e),o=ai(e);return o.add({}).next(l=>{ke(typeof l=="number");const c=new Jy(l,n,s,r),u=function(x,b,N){const E=N.baseMutations.map(v=>uf(x.ct,v)),w=N.mutations.map(v=>uf(x.ct,v));return{userId:b,batchId:N.batchId,localWriteTimeMs:N.localWriteTime.toMillis(),baseMutations:E,mutations:w}}(this.serializer,this.userId,c),h=[];let f=new it((m,x)=>Oe(m.canonicalString(),x.canonicalString()));for(const m of r){const x=C1(this.userId,m.key.path,l);f=f.add(m.key.path.popLast()),h.push(o.put(u)),h.push(i.put(x,yO))}return f.forEach(m=>{h.push(this.indexManager.addToCollectionParentIndex(e,m))}),e.addOnCommittedListener(()=>{this.Fn[l]=c.keys()}),$.waitFor(h).next(()=>c)})}lookupMutationBatch(e,n){return ai(e).get(n).next(s=>s?(ke(s.userId===this.userId),ua(this.serializer,s)):null)}Mn(e,n){return this.Fn[n]?$.resolve(this.Fn[n]):this.lookupMutationBatch(e,n).next(s=>{if(s){const r=s.keys();return this.Fn[n]=r,r}return null})}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=IDBKeyRange.lowerBound([this.userId,s]);let i=null;return ai(e).J({index:"userMutationsIndex",range:r},(o,l,c)=>{l.userId===this.userId&&(ke(l.batchId>=s),i=ua(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let s=-1;return ai(e).J({index:"userMutationsIndex",range:n,reverse:!0},(r,i,o)=>{s=i.batchId,o.done()}).next(()=>s)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return ai(e).U("userMutationsIndex",n).next(s=>s.map(r=>ua(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(e,n){const s=mh(this.userId,n.path),r=IDBKeyRange.lowerBound(s),i=[];return bo(e).J({range:r},(o,l,c)=>{const[u,h,f]=o,m=nr(h);if(u===this.userId&&n.path.isEqual(m))return ai(e).get(f).next(x=>{if(!x)throw _e();ke(x.userId===this.userId),i.push(ua(this.serializer,x))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new it(Oe);const r=[];return n.forEach(i=>{const o=mh(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=bo(e).J({range:l},(u,h,f)=>{const[m,x,b]=u,N=nr(x);m===this.userId&&i.path.isEqual(N)?s=s.add(b):f.done()});r.push(c)}),$.waitFor(r).next(()=>this.xn(e,s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1,i=mh(this.userId,s),o=IDBKeyRange.lowerBound(i);let l=new it(Oe);return bo(e).J({range:o},(c,u,h)=>{const[f,m,x]=c,b=nr(m);f===this.userId&&s.isPrefixOf(b)?b.length===r&&(l=l.add(x)):h.done()}).next(()=>this.xn(e,l))}xn(e,n){const s=[],r=[];return n.forEach(i=>{r.push(ai(e).get(i).next(o=>{if(o===null)throw _e();ke(o.userId===this.userId),s.push(ua(this.serializer,o))}))}),$.waitFor(r).next(()=>s)}removeMutationBatch(e,n){return kk(e._e,this.userId,n).next(s=>(e.addOnCommittedListener(()=>{this.On(n.batchId)}),$.forEach(s,r=>this.referenceDelegate.markPotentiallyOrphaned(e,r))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return $.resolve();const s=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return bo(e).J({range:s},(i,o,l)=>{if(i[0]===this.userId){const c=nr(i[1]);r.push(c)}else l.done()}).next(()=>{ke(r.length===0)})})}containsKey(e,n){return Ik(e,this.userId,n)}Nn(e){return Ck(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function Ik(t,e,n){const s=mh(e,n.path),r=s[1],i=IDBKeyRange.lowerBound(s);let o=!1;return bo(t).J({range:i,H:!0},(l,c,u)=>{const[h,f,m]=l;h===e&&f===r&&(o=!0),u.done()}).next(()=>o)}function ai(t){return an(t,"mutations")}function bo(t){return an(t,"documentMutations")}function Ck(t){return an(t,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class za{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new za(0)}static kn(){return new za(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D5{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.qn(e).next(n=>{const s=new za(n.highestTargetId);return n.highestTargetId=s.next(),this.Qn(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.qn(e).next(n=>Re.fromTimestamp(new At(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.qn(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,s){return this.qn(e).next(r=>(r.highestListenSequenceNumber=n,s&&(r.lastRemoteSnapshotVersion=s.toTimestamp()),n>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=n),this.Qn(e,r)))}addTargetData(e,n){return this.Kn(e,n).next(()=>this.qn(e).next(s=>(s.targetCount+=1,this.$n(n,s),this.Qn(e,s))))}updateTargetData(e,n){return this.Kn(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>fo(e).delete(n.targetId)).next(()=>this.qn(e)).next(s=>(ke(s.targetCount>0),s.targetCount-=1,this.Qn(e,s)))}removeTargets(e,n,s){let r=0;const i=[];return fo(e).J((o,l)=>{const c=yc(l);c.sequenceNumber<=n&&s.get(c.targetId)===null&&(r++,i.push(this.removeTargetData(e,c)))}).next(()=>$.waitFor(i)).next(()=>r)}forEachTarget(e,n){return fo(e).J((s,r)=>{const i=yc(r);n(i)})}qn(e){return B_(e).get("targetGlobalKey").next(n=>(ke(n!==null),n))}Qn(e,n){return B_(e).put("targetGlobalKey",n)}Kn(e,n){return fo(e).put(Ek(this.serializer,n))}$n(e,n){let s=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,s=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,s=!0),s}getTargetCount(e){return this.qn(e).next(n=>n.targetCount)}getTargetData(e,n){const s=Oa(n),r=IDBKeyRange.bound([s,Number.NEGATIVE_INFINITY],[s,Number.POSITIVE_INFINITY]);let i=null;return fo(e).J({range:r,index:"queryTargetsIndex"},(o,l,c)=>{const u=yc(l);Bu(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,s){const r=[],i=gi(e);return n.forEach(o=>{const l=Un(o.path);r.push(i.put({targetId:s,path:l})),r.push(this.referenceDelegate.addReference(e,s,o))}),$.waitFor(r)}removeMatchingKeys(e,n,s){const r=gi(e);return $.forEach(n,i=>{const o=Un(i.path);return $.waitFor([r.delete([s,o]),this.referenceDelegate.removeReference(e,s,i)])})}removeMatchingKeysForTargetId(e,n){const s=gi(e),r=IDBKeyRange.bound([n],[n+1],!1,!0);return s.delete(r)}getMatchingKeysForTargetId(e,n){const s=IDBKeyRange.bound([n],[n+1],!1,!0),r=gi(e);let i=$e();return r.J({range:s,H:!0},(o,l,c)=>{const u=nr(o[1]),h=new me(u);i=i.add(h)}).next(()=>i)}containsKey(e,n){const s=Un(n.path),r=IDBKeyRange.bound([s],[N1(s)],!1,!0);let i=0;return gi(e).J({index:"documentTargetsIndex",H:!0,range:r},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}ot(e,n){return fo(e).get(n).next(s=>s?yc(s):null)}}function fo(t){return an(t,"targets")}function B_(t){return an(t,"targetGlobal")}function gi(t){return an(t,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $_([t,e],[n,s]){const r=Oe(t,n);return r===0?Oe(e,s):r}class V5{constructor(e){this.Un=e,this.buffer=new it($_),this.Wn=0}Gn(){return++this.Wn}zn(e){const n=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(n);else{const s=this.buffer.last();$_(n,s)<0&&(this.buffer=this.buffer.delete(s).add(n))}}get maxValue(){return this.buffer.last()[0]}}class M5{constructor(e,n,s){this.garbageCollector=e,this.asyncQueue=n,this.localStore=s,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(e){te("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Gi(n)?te("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",n):await Wi(n)}await this.Hn(3e5)})}}class L5{constructor(e,n){this.Jn=e,this.params=n}calculateTargetCount(e,n){return this.Jn.Yn(e).next(s=>Math.floor(n/100*s))}nthSequenceNumber(e,n){if(n===0)return $.resolve(Jn.oe);const s=new V5(n);return this.Jn.forEachTarget(e,r=>s.zn(r.sequenceNumber)).next(()=>this.Jn.Zn(e,r=>s.zn(r))).next(()=>s.maxValue)}removeTargets(e,n,s){return this.Jn.removeTargets(e,n,s)}removeOrphanedDocuments(e,n){return this.Jn.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(te("LruGarbageCollector","Garbage collection skipped; disabled"),$.resolve(U_)):this.getCacheSize(e).next(s=>s<this.params.cacheSizeCollectionThreshold?(te("LruGarbageCollector",`Garbage collection skipped; Cache size ${s} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),U_):this.Xn(e,n))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,n){let s,r,i,o,l,c,u;const h=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(f=>(f>this.params.maximumSequenceNumbersToCollect?(te("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${f}`),r=this.params.maximumSequenceNumbersToCollect):r=f,o=Date.now(),this.nthSequenceNumber(e,r))).next(f=>(s=f,l=Date.now(),this.removeTargets(e,s,n))).next(f=>(i=f,c=Date.now(),this.removeOrphanedDocuments(e,s))).next(f=>(u=Date.now(),go()<=Ye.DEBUG&&te("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${f} documents in `+(u-c)+`ms
Total Duration: ${u-h}ms`),$.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:f})))}}function O5(t,e){return new L5(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(e,n){this.db=e,this.garbageCollector=O5(this,n)}Yn(e){const n=this.er(e);return this.db.getTargetCache().getTargetCount(e).next(s=>n.next(r=>s+r))}er(e){let n=0;return this.Zn(e,s=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}Zn(e,n){return this.tr(e,(s,r)=>n(r))}addReference(e,n,s){return Ud(e,s)}removeReference(e,n,s){return Ud(e,s)}removeTargets(e,n,s){return this.db.getTargetCache().removeTargets(e,n,s)}markPotentiallyOrphaned(e,n){return Ud(e,n)}nr(e,n){return function(r,i){let o=!1;return Ck(r).Y(l=>Ik(r,l,i).next(c=>(c&&(o=!0),$.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const s=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.tr(e,(o,l)=>{if(l<=n){const c=this.nr(e,o).next(u=>{if(!u)return i++,s.getEntry(e,o).next(()=>(s.removeEntry(o,Re.min()),gi(e).delete(function(f){return[0,Un(f.path)]}(o))))});r.push(c)}}).next(()=>$.waitFor(r)).next(()=>s.apply(e)).next(()=>i)}removeTarget(e,n){const s=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,s)}updateLimboDocument(e,n){return Ud(e,n)}tr(e,n){const s=gi(e);let r,i=Jn.oe;return s.J({index:"documentTargetsIndex"},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==Jn.oe&&n(new me(nr(r)),i),i=u,r=c):i=Jn.oe}).next(()=>{i!==Jn.oe&&n(new me(nr(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ud(t,e){return gi(t).put(function(s,r){return{targetId:0,path:Un(s.path),sequenceNumber:r}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ak{constructor(){this.changes=new Hi(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Ut.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const s=this.changes.get(n);return s!==void 0?$.resolve(s):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U5{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,s){return na(e).put(s)}removeEntry(e,n,s){return na(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],df(o),l[l.length-1]]}(n,s))}updateMetadata(e,n){return this.getMetadata(e).next(s=>(s.byteSize+=n,this.rr(e,s)))}getEntry(e,n){let s=Ut.newInvalidDocument(n);return na(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ic(n))},(r,i)=>{s=this.ir(n,i)}).next(()=>s)}sr(e,n){let s={size:0,document:Ut.newInvalidDocument(n)};return na(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ic(n))},(r,i)=>{s={document:this.ir(n,i),size:ff(i)}}).next(()=>s)}getEntries(e,n){let s=ds();return this._r(e,n,(r,i)=>{const o=this.ir(r,i);s=s.insert(r,o)}).next(()=>s)}ar(e,n){let s=ds(),r=new dt(me.comparator);return this._r(e,n,(i,o)=>{const l=this.ir(i,o);s=s.insert(i,l),r=r.insert(i,ff(o))}).next(()=>({documents:s,ur:r}))}_r(e,n,s){if(n.isEmpty())return $.resolve();let r=new it(W_);n.forEach(c=>r=r.add(c));const i=IDBKeyRange.bound(ic(r.first()),ic(r.last())),o=r.getIterator();let l=o.getNext();return na(e).J({index:"documentKeyIndex",range:i},(c,u,h)=>{const f=me.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&W_(l,f)<0;)s(l,null),l=o.getNext();l&&l.isEqual(f)&&(s(l,u),l=o.hasNext()?o.getNext():null),l?h.$(ic(l)):h.done()}).next(()=>{for(;l;)s(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,s,r,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),df(s.readTime),s.documentKey.path.isEmpty()?"":s.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return na(e).U(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let h=ds();for(const f of u){const m=this.ir(me.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);m.isFoundDocument()&&(zu(n,m)||r.has(m.key))&&(h=h.insert(m.key,m))}return h})}getAllFromCollectionGroup(e,n,s,r){let i=ds();const o=q_(n,s),l=q_(n,gs.max());return na(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,l,!0)},(c,u,h)=>{const f=this.ir(me.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(f.key,f),i.size===r&&h.done()}).next(()=>i)}newChangeBuffer(e){return new B5(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return z_(e).get("remoteDocumentGlobalKey").next(n=>(ke(!!n),n))}rr(e,n){return z_(e).put("remoteDocumentGlobalKey",n)}ir(e,n){if(n){const s=E5(this.serializer,n);if(!(s.isNoDocument()&&s.version.isEqual(Re.min())))return s}return Ut.newInvalidDocument(e)}}function Rk(t){return new U5(t)}class B5 extends Ak{constructor(e,n){super(),this.cr=e,this.trackRemovals=n,this.lr=new Hi(s=>s.toString(),(s,r)=>s.isEqual(r))}applyChanges(e){const n=[];let s=0,r=new it((i,o)=>Oe(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.lr.get(i);if(n.push(this.cr.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=I_(this.cr.serializer,o);r=r.add(i.path.popLast());const u=ff(c);s+=u-l.size,n.push(this.cr.addEntry(e,i,c))}else if(s-=l.size,this.trackRemovals){const c=I_(this.cr.serializer,o.convertToNoDocument(Re.min()));n.push(this.cr.addEntry(e,i,c))}}),r.forEach(i=>{n.push(this.cr.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.cr.updateMetadata(e,s)),$.waitFor(n)}getFromCache(e,n){return this.cr.sr(e,n).next(s=>(this.lr.set(n,{size:s.size,readTime:s.document.readTime}),s.document))}getAllFromCache(e,n){return this.cr.ar(e,n).next(({documents:s,ur:r})=>(r.forEach((i,o)=>{this.lr.set(i,{size:o,readTime:s.get(i).readTime})}),s))}}function z_(t){return an(t,"remoteDocumentGlobal")}function na(t){return an(t,"remoteDocumentsV14")}function ic(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function q_(t,e){const n=e.documentKey.path.toArray();return[t,df(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function W_(t,e){const n=t.path.toArray(),s=e.path.toArray();let r=0;for(let i=0;i<n.length-2&&i<s.length-2;++i)if(r=Oe(n[i],s[i]),r)return r;return r=Oe(n.length,s.length),r||(r=Oe(n[n.length-2],s[s.length-2]),r||Oe(n[n.length-1],s[s.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $5{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pk{constructor(e,n,s,r){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=s,this.indexManager=r}getDocument(e,n){let s=null;return this.documentOverlayCache.getOverlay(e,n).next(r=>(s=r,this.remoteDocumentCache.getEntry(e,n))).next(r=>(s!==null&&Vc(s.mutation,r,Zn.empty(),At.now()),r))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.getLocalViewOfDocuments(e,s,$e()).next(()=>s))}getLocalViewOfDocuments(e,n,s=$e()){const r=sr();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,s).next(i=>{let o=gc();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const s=sr();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,$e()))}populateOverlays(e,n,s){const r=[];return s.forEach(i=>{n.has(i)||r.push(i)}),this.documentOverlayCache.getOverlays(e,r).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,s,r){let i=ds();const o=Dc(),l=function(){return Dc()}();return n.forEach((c,u)=>{const h=s.get(u.key);r.has(u.key)&&(h===void 0||h.mutation instanceof Gr)?i=i.insert(u.key,u):h!==void 0?(o.set(u.key,h.mutation.getFieldMask()),Vc(h.mutation,u,h.mutation.getFieldMask(),At.now())):o.set(u.key,Zn.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,h)=>o.set(u,h)),n.forEach((u,h)=>{var f;return l.set(u,new $5(h,(f=o.get(u))!==null&&f!==void 0?f:null))}),l))}recalculateAndSaveOverlays(e,n){const s=Dc();let r=new dt((o,l)=>o-l),i=$e();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let h=s.get(c)||Zn.empty();h=l.applyToLocalView(u,h),s.set(c,h);const f=(r.get(l.batchId)||$e()).add(c);r=r.insert(l.batchId,f)})}).next(()=>{const o=[],l=r.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,h=c.value,f=Z1();h.forEach(m=>{if(!i.has(m)){const x=ak(n.get(m),s.get(m));x!==null&&f.set(m,x),i=i.add(m)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,f))}return $.waitFor(o)}).next(()=>s)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(s=>this.recalculateAndSaveOverlays(e,s))}getDocumentsMatchingQuery(e,n,s,r){return function(o){return me.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):H1(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,s,r):this.getDocumentsMatchingCollectionQuery(e,n,s,r)}getNextDocuments(e,n,s,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,s,r).next(i=>{const o=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,s.largestBatchId,r-i.size):$.resolve(sr());let l=-1,c=i;return o.next(u=>$.forEach(u,(h,f)=>(l<f.largestBatchId&&(l=f.largestBatchId),i.get(h)?$.resolve():this.remoteDocumentCache.getEntry(e,h).next(m=>{c=c.insert(h,m)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,$e())).next(h=>({batchId:l,changes:J1(h)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new me(n)).next(s=>{let r=gc();return s.isFoundDocument()&&(r=r.insert(s.key,s)),r})}getDocumentsMatchingCollectionGroupQuery(e,n,s,r){const i=n.collectionGroup;let o=gc();return this.indexManager.getCollectionParents(e,i).next(l=>$.forEach(l,c=>{const u=function(f,m){return new Sl(m,null,f.explicitOrderBy.slice(),f.filters.slice(),f.limit,f.limitType,f.startAt,f.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,s,r).next(h=>{h.forEach((f,m)=>{o=o.insert(f,m)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,s,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,s.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,s,i,r))).next(o=>{i.forEach((c,u)=>{const h=u.getKey();o.get(h)===null&&(o=o.insert(h,Ut.newInvalidDocument(h)))});let l=gc();return o.forEach((c,u)=>{const h=i.get(c);h!==void 0&&Vc(h.mutation,u,Zn.empty(),At.now()),zu(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z5{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return $.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(r){return{id:r.id,version:r.version,createTime:Bn(r.createTime)}}(n)),$.resolve()}getNamedQuery(e,n){return $.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(r){return{name:r.name,query:Tk(r.bundledQuery),readTime:Bn(r.readTime)}}(n)),$.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q5{constructor(){this.overlays=new dt(me.comparator),this.Ir=new Map}getOverlay(e,n){return $.resolve(this.overlays.get(n))}getOverlays(e,n){const s=sr();return $.forEach(n,r=>this.getOverlay(e,r).next(i=>{i!==null&&s.set(r,i)})).next(()=>s)}saveOverlays(e,n,s){return s.forEach((r,i)=>{this.ht(e,n,i)}),$.resolve()}removeOverlaysForBatchId(e,n,s){const r=this.Ir.get(s);return r!==void 0&&(r.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(s)),$.resolve()}getOverlaysForCollection(e,n,s){const r=sr(),i=n.length+1,o=new me(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>s&&r.set(c.getKey(),c)}return $.resolve(r)}getOverlaysForCollectionGroup(e,n,s,r){let i=new dt((u,h)=>u-h);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>s){let h=i.get(u.largestBatchId);h===null&&(h=sr(),i=i.insert(u.largestBatchId,h)),h.set(u.getKey(),u)}}const l=sr(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,h)=>l.set(u,h)),!(l.size()>=r)););return $.resolve(l)}ht(e,n,s){const r=this.overlays.get(s.key);if(r!==null){const o=this.Ir.get(r.largestBatchId).delete(s.key);this.Ir.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(s.key,new e0(n,s));let i=this.Ir.get(n);i===void 0&&(i=$e(),this.Ir.set(n,i)),this.Ir.set(n,i.add(s.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W5{constructor(){this.sessionToken=zt.EMPTY_BYTE_STRING}getSessionToken(e){return $.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,$.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i0{constructor(){this.Tr=new it(on.Er),this.dr=new it(on.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const s=new on(e,n);this.Tr=this.Tr.add(s),this.dr=this.dr.add(s)}Rr(e,n){e.forEach(s=>this.addReference(s,n))}removeReference(e,n){this.Vr(new on(e,n))}mr(e,n){e.forEach(s=>this.removeReference(s,n))}gr(e){const n=new me(new et([])),s=new on(n,e),r=new on(n,e+1),i=[];return this.dr.forEachInRange([s,r],o=>{this.Vr(o),i.push(o.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new me(new et([])),s=new on(n,e),r=new on(n,e+1);let i=$e();return this.dr.forEachInRange([s,r],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new on(e,0),s=this.Tr.firstAfterOrEqual(n);return s!==null&&e.isEqual(s.key)}}class on{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return me.comparator(e.key,n.key)||Oe(e.wr,n.wr)}static Ar(e,n){return Oe(e.wr,n.wr)||me.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G5{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new it(on.Er)}checkEmpty(e){return $.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,s,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Jy(i,n,s,r);this.mutationQueue.push(o);for(const l of r)this.br=this.br.add(new on(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return $.resolve(o)}lookupMutationBatch(e,n){return $.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const s=n+1,r=this.vr(s),i=r<0?0:r;return $.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return $.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return $.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const s=new on(n,0),r=new on(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([s,r],o=>{const l=this.Dr(o.wr);i.push(l)}),$.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let s=new it(Oe);return n.forEach(r=>{const i=new on(r,0),o=new on(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,o],l=>{s=s.add(l.wr)})}),$.resolve(this.Cr(s))}getAllMutationBatchesAffectingQuery(e,n){const s=n.path,r=s.length+1;let i=s;me.isDocumentKey(i)||(i=i.child(""));const o=new on(new me(i),0);let l=new it(Oe);return this.br.forEachWhile(c=>{const u=c.key.path;return!!s.isPrefixOf(u)&&(u.length===r&&(l=l.add(c.wr)),!0)},o),$.resolve(this.Cr(l))}Cr(e){const n=[];return e.forEach(s=>{const r=this.Dr(s);r!==null&&n.push(r)}),n}removeMutationBatch(e,n){ke(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let s=this.br;return $.forEach(n.mutations,r=>{const i=new on(r.key,n.batchId);return s=s.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.br=s})}On(e){}containsKey(e,n){const s=new on(n,0),r=this.br.firstAfterOrEqual(s);return $.resolve(n.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,$.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(e){this.Mr=e,this.docs=function(){return new dt(me.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const s=n.key,r=this.docs.get(s),i=r?r.size:0,o=this.Mr(n);return this.docs=this.docs.insert(s,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,s.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const s=this.docs.get(n);return $.resolve(s?s.document.mutableCopy():Ut.newInvalidDocument(n))}getEntries(e,n){let s=ds();return n.forEach(r=>{const i=this.docs.get(r);s=s.insert(r,i?i.document.mutableCopy():Ut.newInvalidDocument(r))}),$.resolve(s)}getDocumentsMatchingQuery(e,n,s,r){let i=ds();const o=n.path,l=new me(o.child("")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:h}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||qy(T1(h),s)<=0||(r.has(h.key)||zu(n,h))&&(i=i.insert(h.key,h.mutableCopy()))}return $.resolve(i)}getAllFromCollectionGroup(e,n,s,r){_e()}Or(e,n){return $.forEach(this.docs,s=>n(s))}newChangeBuffer(e){return new K5(this)}getSize(e){return $.resolve(this.size)}}class K5 extends Ak{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((s,r)=>{r.isValidDocument()?n.push(this.cr.addEntry(e,r)):this.cr.removeEntry(s)}),$.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q5{constructor(e){this.persistence=e,this.Nr=new Hi(n=>Oa(n),Bu),this.lastRemoteSnapshotVersion=Re.min(),this.highestTargetId=0,this.Lr=0,this.Br=new i0,this.targetCount=0,this.kr=za.Bn()}forEachTarget(e,n){return this.Nr.forEach((s,r)=>n(r)),$.resolve()}getLastRemoteSnapshotVersion(e){return $.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return $.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),$.resolve(this.highestTargetId)}setTargetsMetadata(e,n,s){return s&&(this.lastRemoteSnapshotVersion=s),n>this.Lr&&(this.Lr=n),$.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new za(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,$.resolve()}updateTargetData(e,n){return this.Kn(n),$.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,$.resolve()}removeTargets(e,n,s){let r=0;const i=[];return this.Nr.forEach((o,l)=>{l.sequenceNumber<=n&&s.get(l.targetId)===null&&(this.Nr.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),r++)}),$.waitFor(i).next(()=>r)}getTargetCount(e){return $.resolve(this.targetCount)}getTargetData(e,n){const s=this.Nr.get(n)||null;return $.resolve(s)}addMatchingKeys(e,n,s){return this.Br.Rr(n,s),$.resolve()}removeMatchingKeys(e,n,s){this.Br.mr(n,s);const r=this.persistence.referenceDelegate,i=[];return r&&n.forEach(o=>{i.push(r.markPotentiallyOrphaned(e,o))}),$.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),$.resolve()}getMatchingKeysForTargetId(e,n){const s=this.Br.yr(n);return $.resolve(s)}containsKey(e,n){return $.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dk{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Jn(0),this.Kr=!1,this.Kr=!0,this.$r=new W5,this.referenceDelegate=e(this),this.Ur=new Q5(this),this.indexManager=new R5,this.remoteDocumentCache=function(r){return new H5(r)}(s=>this.referenceDelegate.Wr(s)),this.serializer=new Nk(n),this.Gr=new z5(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new q5,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let s=this.qr[e.toKey()];return s||(s=new G5(n,this.referenceDelegate),this.qr[e.toKey()]=s),s}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,s){te("MemoryPersistence","Starting transaction:",e);const r=new Y5(this.Qr.next());return this.referenceDelegate.zr(),s(r).next(i=>this.referenceDelegate.jr(r).next(()=>i)).toPromise().then(i=>(r.raiseOnCommittedEvent(),i))}Hr(e,n){return $.or(Object.values(this.qr).map(s=>()=>s.containsKey(e,n)))}}class Y5 extends j1{constructor(e){super(),this.currentSequenceNumber=e}}class om{constructor(e){this.persistence=e,this.Jr=new i0,this.Yr=null}static Zr(e){return new om(e)}get Xr(){if(this.Yr)return this.Yr;throw _e()}addReference(e,n,s){return this.Jr.addReference(s,n),this.Xr.delete(s.toString()),$.resolve()}removeReference(e,n,s){return this.Jr.removeReference(s,n),this.Xr.add(s.toString()),$.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),$.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(r=>this.Xr.add(r.toString()));const s=this.persistence.getTargetCache();return s.getMatchingKeysForTargetId(e,n.targetId).next(r=>{r.forEach(i=>this.Xr.add(i.toString()))}).next(()=>s.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return $.forEach(this.Xr,s=>{const r=me.fromPath(s);return this.ei(e,r).next(i=>{i||n.removeEntry(r,Re.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(s=>{s?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return $.or([()=>$.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X5{constructor(e){this.serializer=e}O(e,n,s,r){const i=new Zf("createOrUpgrade",n);s<1&&r>=1&&(function(c){c.createObjectStore("owner")}(e),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",i_,{unique:!0}),c.createObjectStore("documentMutations")}(e),G_(e),function(c){c.createObjectStore("remoteDocuments")}(e));let o=$.resolve();return s<3&&r>=3&&(s!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(e),G_(e)),o=o.next(()=>function(c){const u=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Re.min().toTimestamp(),targetCount:0};return u.put("targetGlobalKey",h)}(i))),s<4&&r>=4&&(s!==0&&(o=o.next(()=>function(c,u){return u.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",i_,{unique:!0});const f=u.store("mutations"),m=h.map(x=>f.put(x));return $.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(e)})),s<5&&r>=5&&(o=o.next(()=>this.ni(i))),s<6&&r>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i)))),s<7&&r>=7&&(o=o.next(()=>this.ii(i))),s<8&&r>=8&&(o=o.next(()=>this.si(e,i))),s<9&&r>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),s<10&&r>=10&&(o=o.next(()=>this.oi(i))),s<11&&r>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),s<12&&r>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore("documentOverlays",{keyPath:CO});u.createIndex("collectionPathOverlayIndex",AO,{unique:!1}),u.createIndex("collectionGroupOverlayIndex",RO,{unique:!1})})(e)})),s<13&&r>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore("remoteDocumentsV14",{keyPath:vO});u.createIndex("documentKeyIndex",bO),u.createIndex("collectionGroupIndex",wO)}(e)).next(()=>this._i(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),s<14&&r>=14&&(o=o.next(()=>this.ai(e,i))),s<15&&r>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:SO}).createIndex("sequenceNumberIndex",jO,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:kO}).createIndex("documentKeyIndex",IO,{unique:!1})}(e))),s<16&&r>=16&&(o=o.next(()=>{n.objectStore("indexState").clear()}).next(()=>{n.objectStore("indexEntries").clear()})),s<17&&r>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(e)})),o}ri(e){let n=0;return e.store("remoteDocuments").J((s,r)=>{n+=ff(r)}).next(()=>{const s={byteSize:n};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",s)})}ni(e){const n=e.store("mutationQueues"),s=e.store("mutations");return n.U().next(r=>$.forEach(r,i=>{const o=IDBKeyRange.bound([i.userId,-1],[i.userId,i.lastAcknowledgedBatchId]);return s.U("userMutationsIndex",o).next(l=>$.forEach(l,c=>{ke(c.userId===i.userId);const u=ua(this.serializer,c);return kk(e,i.userId,u).next(()=>{})}))}))}ii(e){const n=e.store("targetDocuments"),s=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(r=>{const i=[];return s.J((o,l)=>{const c=new et(o),u=function(f){return[0,Un(f)]}(c);i.push(n.get(u).next(h=>h?$.resolve():(f=>n.put({targetId:0,path:Un(f),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>$.waitFor(i))})}si(e,n){e.createObjectStore("collectionParents",{keyPath:TO});const s=n.store("collectionParents"),r=new r0,i=o=>{if(r.add(o)){const l=o.lastSegment(),c=o.popLast();return s.put({collectionId:l,parent:Un(c)})}};return n.store("remoteDocuments").J({H:!0},(o,l)=>{const c=new et(o);return i(c.popLast())}).next(()=>n.store("documentMutations").J({H:!0},([o,l,c],u)=>{const h=nr(l);return i(h.popLast())}))}oi(e){const n=e.store("targets");return n.J((s,r)=>{const i=yc(r),o=Ek(this.serializer,i);return n.put(o)})}_i(e,n){const s=n.store("remoteDocuments"),r=[];return s.J((i,o)=>{const l=n.store("remoteDocumentsV14"),c=function(f){return f.document?new me(et.fromString(f.document.name).popFirst(5)):f.noDocument?me.fromSegments(f.noDocument.path):f.unknownDocument?me.fromSegments(f.unknownDocument.path):_e()}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(l.put(u))}).next(()=>$.waitFor(r))}ai(e,n){const s=n.store("mutations"),r=Rk(this.serializer),i=new Dk(om.Zr,this.serializer.ct);return s.U().next(o=>{const l=new Map;return o.forEach(c=>{var u;let h=(u=l.get(c.userId))!==null&&u!==void 0?u:$e();ua(this.serializer,c).keys().forEach(f=>h=h.add(f)),l.set(c.userId,h)}),$.forEach(l,(c,u)=>{const h=new Sn(u),f=im.lt(this.serializer,h),m=i.getIndexManager(h),x=am.lt(h,this.serializer,m,i.referenceDelegate);return new Pk(r,x,f,m).recalculateAndSaveOverlaysForDocumentKeys(new qg(n,Jn.oe),c).next()})})}}function G_(t){t.createObjectStore("targetDocuments",{keyPath:NO}).createIndex("documentTargetsIndex",EO,{unique:!0}),t.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",_O,{unique:!0}),t.createObjectStore("targetGlobal")}const dp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class a0{constructor(e,n,s,r,i,o,l,c,u,h,f=17){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=s,this.ui=i,this.window=o,this.document=l,this.ci=u,this.li=h,this.hi=f,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=m=>Promise.resolve(),!a0.D())throw new ce(Y.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new F5(this,r),this.Ai=n+"main",this.serializer=new Nk(c),this.Ri=new Ai(this.Ai,this.hi,new X5(this.serializer)),this.$r=new S5,this.Ur=new D5(this.referenceDelegate,this.serializer),this.remoteDocumentCache=Rk(this.serializer),this.Gr=new T5,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&$t("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ce(Y.FAILED_PRECONDITION,dp);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ur.getHighestSequenceNumber(e))}).then(e=>{this.Qr=new Jn(e,this.ci)}).then(()=>{this.Kr=!0}).catch(e=>(this.Ri&&this.Ri.close(),Promise.reject(e)))}yi(e){return this.di=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget(async()=>{this.started&&await this.mi()}))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Bd(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(e).next(n=>{n||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(e)).next(n=>this.isPrimary&&!n?this.bi(e).next(()=>!1):!!n&&this.Di(e).next(()=>!0))).catch(e=>{if(Gi(e))return te("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return te("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.ui.enqueueRetryable(()=>this.di(e)),this.isPrimary=e})}wi(e){return ac(e).get("owner").next(n=>$.resolve(this.vi(n)))}Ci(e){return Bd(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const s=an(n,"clientMetadata");return s.U().next(r=>{const i=this.xi(r,18e5),o=r.filter(l=>i.indexOf(l)===-1);return $.forEach(o,l=>s.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(const n of e)this.Vi.removeItem(this.Oi(n.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?$.resolve(!0):ac(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)){if(this.vi(n)&&this.networkEnabled)return!0;if(!this.vi(n)){if(!n.allowTabSynchronization)throw new ce(Y.FAILED_PRECONDITION,dp);return!1}}return!(!this.networkEnabled||!this.inForeground)||Bd(e).U().next(s=>this.xi(s,5e3).find(r=>{if(this.clientId!==r.clientId){const i=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,l=this.networkEnabled===r.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&te("IndexedDbPersistence",`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{const n=new qg(e,Jn.oe);return this.bi(n).next(()=>this.Ci(n))}),this.Ri.close(),this.qi()}xi(e,n){return e.filter(s=>this.Mi(s.updateTimeMs,n)&&!this.Ni(s.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",e=>Bd(e).U().next(n=>this.xi(n,18e5).map(s=>s.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,n){return am.lt(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new P5(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return im.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,n,s){te("IndexedDbPersistence","Starting transaction:",e);const r=n==="readonly"?"readonly":"readwrite",i=function(c){return c===17?VO:c===16?DO:c===15?Gy:c===14?P1:c===13?R1:c===12?PO:c===11?A1:void _e()}(this.hi);let o;return this.Ri.runTransaction(e,r,i,l=>(o=new qg(l,this.Qr?this.Qr.next():Jn.oe),n==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw $t(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new ce(Y.FAILED_PRECONDITION,S1);return s(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>s(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Ki(e){return ac(e).get("owner").next(n=>{if(n!==null&&this.Mi(n.leaseTimestampMs,5e3)&&!this.Ni(n.ownerId)&&!this.vi(n)&&!(this.li||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ce(Y.FAILED_PRECONDITION,dp)})}Di(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ac(e).put("owner",n)}static D(){return Ai.D()}bi(e){const n=ac(e);return n.get("owner").next(s=>this.vi(s)?(te("IndexedDbPersistence","Releasing primary lease."),n.delete("owner")):$.resolve())}Mi(e,n){const s=Date.now();return!(e<s-n)&&(!(e>s)||($t(`Detected an update time that is in the future: ${e} > ${s}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Pi=()=>{this.Li();const n=/(?:Version|Mobile)\/1[456]/;f1()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var n;try{const s=((n=this.Vi)===null||n===void 0?void 0:n.getItem(this.Oi(e)))!==null;return te("IndexedDbPersistence",`Client '${e}' ${s?"is":"is not"} zombied in LocalStorage`),s}catch(s){return $t("IndexedDbPersistence","Failed to get zombied client id.",s),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){$t("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ac(t){return an(t,"owner")}function Bd(t){return an(t,"clientMetadata")}function Vk(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o0{constructor(e,n,s,r){this.targetId=e,this.fromCache=n,this.$i=s,this.Ui=r}static Wi(e,n){let s=$e(),r=$e();for(const i of n.docChanges)switch(i.type){case 0:s=s.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new o0(e,n.fromCache,s,r)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J5{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mk{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return f1()?8:k1(sf())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,s,r){const i={result:null};return this.Yi(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Zi(e,n,r,s).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new J5;return this.Xi(e,n,o).next(l=>{if(i.result=l,this.zi)return this.es(e,n,o,l.size)})}).next(()=>i.result)}es(e,n,s,r){return s.documentReadCount<this.ji?(go()<=Ye.DEBUG&&te("QueryEngine","SDK will not create cache indexes for query:",xo(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),$.resolve()):(go()<=Ye.DEBUG&&te("QueryEngine","Query:",xo(n),"scans",s.documentReadCount,"local documents and returns",r,"documents as results."),s.documentReadCount>this.Hi*r?(go()<=Ye.DEBUG&&te("QueryEngine","The SDK decides to create cache indexes for query:",xo(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ms(n))):$.resolve())}Yi(e,n){if(y_(n))return $.resolve(null);let s=ms(n);return this.indexManager.getIndexType(e,s).next(r=>r===0?null:(n.limit!==null&&r===1&&(n=lf(n,null,"F"),s=ms(n)),this.indexManager.getDocumentsMatchingTarget(e,s).next(i=>{const o=$e(...i);return this.Ji.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,s).next(c=>{const u=this.ts(n,l);return this.ns(n,u,o,c.readTime)?this.Yi(e,lf(n,null,"F")):this.rs(e,u,n,c)}))})))}Zi(e,n,s,r){return y_(n)||r.isEqual(Re.min())?$.resolve(null):this.Ji.getDocuments(e,s).next(i=>{const o=this.ts(n,i);return this.ns(n,o,s,r)?$.resolve(null):(go()<=Ye.DEBUG&&te("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),xo(n)),this.rs(e,o,n,E1(r,-1)).next(l=>l))})}ts(e,n){let s=new it(Y1(e));return n.forEach((r,i)=>{zu(e,i)&&(s=s.add(i))}),s}ns(e,n,s,r){if(e.limit===null)return!1;if(s.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,n,s){return go()<=Ye.DEBUG&&te("QueryEngine","Using full collection scan to execute query:",xo(n)),this.Ji.getDocumentsMatchingQuery(e,n,gs.min(),s)}rs(e,n,s,r){return this.Ji.getDocumentsMatchingQuery(e,s,r).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e,n,s,r){this.persistence=e,this.ss=n,this.serializer=r,this.os=new dt(Oe),this._s=new Hi(i=>Oa(i),Bu),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(s)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Pk(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function Lk(t,e,n,s){return new Z5(t,e,n,s)}async function Ok(t,e){const n=Ne(t);return await n.persistence.runTransaction("Handle user change","readonly",s=>{let r;return n.mutationQueue.getAllMutationBatches(s).next(i=>(r=i,n.ls(e),n.mutationQueue.getAllMutationBatches(s))).next(i=>{const o=[],l=[];let c=$e();for(const u of r){o.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}for(const u of i){l.push(u.batchId);for(const h of u.mutations)c=c.add(h.key)}return n.localDocuments.getDocuments(s,c).next(u=>({hs:u,removedBatchIds:o,addedBatchIds:l}))})})}function eF(t,e){const n=Ne(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",s=>{const r=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,h){const f=u.batch,m=f.keys();let x=$.resolve();return m.forEach(b=>{x=x.next(()=>h.getEntry(c,b)).next(N=>{const E=u.docVersions.get(b);ke(E!==null),N.version.compareTo(E)<0&&(f.applyToRemoteDocument(N,u),N.isValidDocument()&&(N.setReadTime(u.commitVersion),h.addEntry(N)))})}),x.next(()=>l.mutationQueue.removeMutationBatch(c,f))}(n,s,e,i).next(()=>i.apply(s)).next(()=>n.mutationQueue.performConsistencyCheck(s)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(s,r,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(s,function(l){let c=$e();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(s,r))})}function Fk(t){const e=Ne(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function tF(t,e){const n=Ne(t),s=e.snapshotVersion;let r=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.cs.newChangeBuffer({trackRemovals:!0});r=n.os;const l=[];e.targetChanges.forEach((h,f)=>{const m=r.get(f);if(!m)return;l.push(n.Ur.removeMatchingKeys(i,h.removedDocuments,f).next(()=>n.Ur.addMatchingKeys(i,h.addedDocuments,f)));let x=m.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(f)!==null?x=x.withResumeToken(zt.EMPTY_BYTE_STRING,Re.min()).withLastLimboFreeSnapshotVersion(Re.min()):h.resumeToken.approximateByteSize()>0&&(x=x.withResumeToken(h.resumeToken,s)),r=r.insert(f,x),function(N,E,w){return N.resumeToken.approximateByteSize()===0||E.snapshotVersion.toMicroseconds()-N.snapshotVersion.toMicroseconds()>=3e8?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(m,x,h)&&l.push(n.Ur.updateTargetData(i,x))});let c=ds(),u=$e();if(e.documentUpdates.forEach(h=>{e.resolvedLimboDocuments.has(h)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,h))}),l.push(nF(i,o,e.documentUpdates).next(h=>{c=h.Ps,u=h.Is})),!s.isEqual(Re.min())){const h=n.Ur.getLastRemoteSnapshotVersion(i).next(f=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,s));l.push(h)}return $.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.os=r,i))}function nF(t,e,n){let s=$e(),r=$e();return n.forEach(i=>s=s.add(i)),e.getEntries(t,s).next(i=>{let o=ds();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(r=r.add(l)),c.isNoDocument()&&c.version.isEqual(Re.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):te("LocalStore","Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{Ps:o,Is:r}})}function sF(t,e){const n=Ne(t);return n.persistence.runTransaction("Get next mutation batch","readonly",s=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(s,e)))}function mf(t,e){const n=Ne(t);return n.persistence.runTransaction("Allocate target","readwrite",s=>{let r;return n.Ur.getTargetData(s,e).next(i=>i?(r=i,$.resolve(r)):n.Ur.allocateTargetId(s).next(o=>(r=new kr(e,o,"TargetPurposeListen",s.currentSequenceNumber),n.Ur.addTargetData(s,r).next(()=>r))))}).then(s=>{const r=n.os.get(s.targetId);return(r===null||s.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(s.targetId,s),n._s.set(e,s.targetId)),s})}async function hl(t,e,n){const s=Ne(t),r=s.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await s.persistence.runTransaction("Release target",i,o=>s.persistence.referenceDelegate.removeTarget(o,r))}catch(o){if(!Gi(o))throw o;te("LocalStore",`Failed to update sequence numbers for target ${e}: ${o}`)}s.os=s.os.remove(e),s._s.delete(r.target)}function rx(t,e,n){const s=Ne(t);let r=Re.min(),i=$e();return s.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,h){const f=Ne(c),m=f._s.get(h);return m!==void 0?$.resolve(f.os.get(m)):f.Ur.getTargetData(u,h)}(s,o,ms(e)).next(l=>{if(l)return r=l.lastLimboFreeSnapshotVersion,s.Ur.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>s.ss.getDocumentsMatchingQuery(o,e,n?r:Re.min(),n?i:$e())).next(l=>($k(s,Q1(e),l),{documents:l,Ts:i})))}function Uk(t,e){const n=Ne(t),s=Ne(n.Ur),r=n.os.get(e);return r?Promise.resolve(r.target):n.persistence.runTransaction("Get target data","readonly",i=>s.ot(i,e).next(o=>o?o.target:null))}function Bk(t,e){const n=Ne(t),s=n.us.get(e)||Re.min();return n.persistence.runTransaction("Get new document changes","readonly",r=>n.cs.getAllFromCollectionGroup(r,e,E1(s,-1),Number.MAX_SAFE_INTEGER)).then(r=>($k(n,e,r),r))}function $k(t,e,n){let s=t.us.get(e)||Re.min();n.forEach((r,i)=>{i.readTime.compareTo(s)>0&&(s=i.readTime)}),t.us.set(e,s)}function H_(t,e){return`firestore_clients_${t}_${e}`}function K_(t,e,n){let s=`firestore_mutations_${t}_${n}`;return e.isAuthenticated()&&(s+=`_${e.uid}`),s}function hp(t,e){return`firestore_targets_${t}_${e}`}class pf{constructor(e,n,s,r){this.user=e,this.batchId=n,this.state=s,this.error=r}static Rs(e,n,s){const r=JSON.parse(s);let i,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(i=new ce(r.error.code,r.error.message))),o?new pf(e,n,r.state,i):($t("SharedClientState",`Failed to parse mutation state for ID '${n}': ${s}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Mc{constructor(e,n,s){this.targetId=e,this.state=n,this.error=s}static Rs(e,n){const s=JSON.parse(n);let r,i=typeof s=="object"&&["not-current","current","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return i&&s.error&&(i=typeof s.error.message=="string"&&typeof s.error.code=="string",i&&(r=new ce(s.error.code,s.error.message))),i?new Mc(e,s.state,r):($t("SharedClientState",`Failed to parse target state for ID '${e}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class gf{constructor(e,n){this.clientId=e,this.activeTargetIds=n}static Rs(e,n){const s=JSON.parse(n);let r=typeof s=="object"&&s.activeTargetIds instanceof Array,i=Yy();for(let o=0;r&&o<s.activeTargetIds.length;++o)r=I1(s.activeTargetIds[o]),i=i.add(s.activeTargetIds[o]);return r?new gf(e,i):($t("SharedClientState",`Failed to parse client data for instance '${e}': ${n}`),null)}}class l0{constructor(e,n){this.clientId=e,this.onlineState=n}static Rs(e){const n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new l0(n.clientId,n.onlineState):($t("SharedClientState",`Failed to parse online state: ${e}`),null)}}class ix{constructor(){this.activeTargetIds=Yy()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class fp{constructor(e,n,s,r,i){this.window=e,this.ui=n,this.persistenceKey=s,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new dt(Oe),this.started=!1,this.bs=[];const o=s.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=H_(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ix),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const s of e){if(s===this.ps)continue;const r=this.getItem(H_(this.persistenceKey,s));if(r){const i=gf.Rs(s,r);i&&(this.Ss=this.Ss.insert(i.clientId,i))}}this.Ns();const n=this.storage.getItem(this.xs);if(n){const s=this.Ls(n);s&&this.Bs(s)}for(const s of this.bs)this.ws(s);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let n=!1;return this.Ss.forEach((s,r)=>{r.activeTargetIds.has(e)&&(n=!0)}),n}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,n,s){this.qs(e,n,s),this.Qs(e)}addLocalQueryTarget(e,n=!0){let s="not-current";if(this.isActiveQueryTarget(e)){const r=this.storage.getItem(hp(this.persistenceKey,e));if(r){const i=Mc.Rs(e,r);i&&(s=i.state)}}return n&&this.Ks.fs(e),this.Ns(),s}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(hp(this.persistenceKey,e))}updateQueryState(e,n,s){this.$s(e,n,s)}handleUserChange(e,n,s){n.forEach(r=>{this.Qs(r)}),this.currentUser=e,s.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const n=this.storage.getItem(e);return te("SharedClientState","READ",e,n),n}setItem(e,n){te("SharedClientState","SET",e,n),this.storage.setItem(e,n)}removeItem(e){te("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const n=e;if(n.storageArea===this.storage){if(te("SharedClientState","EVENT",n.key,n.newValue),n.key===this.Ds)return void $t("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(async()=>{if(this.started){if(n.key!==null){if(this.Cs.test(n.key)){if(n.newValue==null){const s=this.Gs(n.key);return this.zs(s,null)}{const s=this.js(n.key,n.newValue);if(s)return this.zs(s.clientId,s)}}else if(this.Fs.test(n.key)){if(n.newValue!==null){const s=this.Hs(n.key,n.newValue);if(s)return this.Js(s)}}else if(this.Ms.test(n.key)){if(n.newValue!==null){const s=this.Ys(n.key,n.newValue);if(s)return this.Zs(s)}}else if(n.key===this.xs){if(n.newValue!==null){const s=this.Ls(n.newValue);if(s)return this.Bs(s)}}else if(n.key===this.vs){const s=function(i){let o=Jn.oe;if(i!=null)try{const l=JSON.parse(i);ke(typeof l=="number"),o=l}catch(l){$t("SharedClientState","Failed to read sequence number from WebStorage",l)}return o}(n.newValue);s!==Jn.oe&&this.sequenceNumberHandler(s)}else if(n.key===this.Os){const s=this.Xs(n.newValue);await Promise.all(s.map(r=>this.syncEngine.eo(r)))}}}else this.bs.push(n)})}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,n,s){const r=new pf(this.currentUser,e,n,s),i=K_(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Vs())}Qs(e){const n=K_(this.persistenceKey,this.currentUser,e);this.removeItem(n)}Us(e){const n={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(n))}$s(e,n,s){const r=hp(this.persistenceKey,e),i=new Mc(e,n,s);this.setItem(r,i.Vs())}Ws(e){const n=JSON.stringify(Array.from(e));this.setItem(this.Os,n)}Gs(e){const n=this.Cs.exec(e);return n?n[1]:null}js(e,n){const s=this.Gs(e);return gf.Rs(s,n)}Hs(e,n){const s=this.Fs.exec(e),r=Number(s[1]),i=s[2]!==void 0?s[2]:null;return pf.Rs(new Sn(i),r,n)}Ys(e,n){const s=this.Ms.exec(e),r=Number(s[1]);return Mc.Rs(r,n)}Ls(e){return l0.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);te("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,n){const s=n?this.Ss.insert(e,n):this.Ss.remove(e),r=this.ks(this.Ss),i=this.ks(s),o=[],l=[];return i.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{i.has(c)||l.push(c)}),this.syncEngine.io(o,l).then(()=>{this.Ss=s})}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let n=Yy();return e.forEach((s,r)=>{n=n.unionWith(r.activeTargetIds)}),n}}class zk{constructor(){this.so=new ix,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,s){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,s){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new ix,Promise.resolve()}handleUserChange(e,n,s){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rF{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q_{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){te("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){te("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $d=null;function mp(){return $d===null?$d=function(){return 268435456+Math.round(2147483648*Math.random())}():$d++,"0x"+$d.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iF={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aF{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tn="WebChannelConnection";class oF extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const s=n.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=s+"://"+n.host,this.vo=`projects/${r}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${i}`}get Fo(){return!1}Mo(n,s,r,i,o){const l=mp(),c=this.xo(n,s.toUriEncodedString());te("RestConnection",`Sending RPC '${n}' ${l}:`,c,r);const u={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(u,i,o),this.No(n,c,u,r).then(h=>(te("RestConnection",`Received RPC '${n}' ${l}: `,h),h),h=>{throw uu("RestConnection",`RPC '${n}' ${l} failed with error: `,h,"url: ",c,"request:",r),h})}Lo(n,s,r,i,o,l){return this.Mo(n,s,r,i,o)}Oo(n,s,r){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tl}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),s&&s.headers.forEach((i,o)=>n[o]=i),r&&r.headers.forEach((i,o)=>n[o]=i)}xo(n,s){const r=iF[n];return`${this.Do}/v1/${s}:${r}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,s,r){const i=mp();return new Promise((o,l)=>{const c=new x1;c.setWithCredentials(!0),c.listenOnce(y1.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case hh.NO_ERROR:const h=c.getResponseJson();te(Tn,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(h)),o(h);break;case hh.TIMEOUT:te(Tn,`RPC '${e}' ${i} timed out`),l(new ce(Y.DEADLINE_EXCEEDED,"Request time out"));break;case hh.HTTP_ERROR:const f=c.getStatus();if(te(Tn,`RPC '${e}' ${i} failed with status:`,f,"response text:",c.getResponseText()),f>0){let m=c.getResponseJson();Array.isArray(m)&&(m=m[0]);const x=m==null?void 0:m.error;if(x&&x.status&&x.message){const b=function(E){const w=E.toLowerCase().replace(/_/g,"-");return Object.values(Y).indexOf(w)>=0?w:Y.UNKNOWN}(x.status);l(new ce(b,x.message))}else l(new ce(Y.UNKNOWN,"Server responded with status "+c.getStatus()))}else l(new ce(Y.UNAVAILABLE,"Connection failed."));break;default:_e()}}finally{te(Tn,`RPC '${e}' ${i} completed.`)}});const u=JSON.stringify(r);te(Tn,`RPC '${e}' ${i} sending request:`,r),c.send(n,"POST",u,s,15)})}Bo(e,n,s){const r=mp(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=w1(),l=b1(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Oo(c.initMessageHeaders,n,s),c.encodeInitMessageHeaders=!0;const h=i.join("");te(Tn,`Creating RPC '${e}' stream ${r}: ${h}`,c);const f=o.createWebChannel(h,c);let m=!1,x=!1;const b=new aF({Io:E=>{x?te(Tn,`Not sending because RPC '${e}' stream ${r} is closed:`,E):(m||(te(Tn,`Opening RPC '${e}' stream ${r} transport.`),f.open(),m=!0),te(Tn,`RPC '${e}' stream ${r} sending:`,E),f.send(E))},To:()=>f.close()}),N=(E,w,v)=>{E.listen(w,T=>{try{v(T)}catch(I){setTimeout(()=>{throw I},0)}})};return N(f,pc.EventType.OPEN,()=>{x||(te(Tn,`RPC '${e}' stream ${r} transport opened.`),b.yo())}),N(f,pc.EventType.CLOSE,()=>{x||(x=!0,te(Tn,`RPC '${e}' stream ${r} transport closed`),b.So())}),N(f,pc.EventType.ERROR,E=>{x||(x=!0,uu(Tn,`RPC '${e}' stream ${r} transport errored:`,E),b.So(new ce(Y.UNAVAILABLE,"The operation could not be completed")))}),N(f,pc.EventType.MESSAGE,E=>{var w;if(!x){const v=E.data[0];ke(!!v);const T=v,I=T.error||((w=T[0])===null||w===void 0?void 0:w.error);if(I){te(Tn,`RPC '${e}' stream ${r} received error:`,I);const R=I.status;let V=function(k){const S=Gt[k];if(S!==void 0)return ck(S)}(R),j=I.message;V===void 0&&(V=Y.INTERNAL,j="Unknown error status: "+R+" with message "+I.message),x=!0,b.So(new ce(V,j)),f.close()}else te(Tn,`RPC '${e}' stream ${r} received:`,v),b.bo(v)}}),N(l,v1.STAT_EVENT,E=>{E.stat===$g.PROXY?te(Tn,`RPC '${e}' stream ${r} detected buffering proxy`):E.stat===$g.NOPROXY&&te(Tn,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{b.wo()},0),b}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(){return typeof window<"u"?window:null}function vh(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lm(t){return new m5(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk{constructor(e,n,s=1e3,r=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=s,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),s=Math.max(0,Date.now()-this.Uo),r=Math.max(0,n-s);r>0&&te("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${s} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gk{constructor(e,n,s,r,i,o,l,c){this.ui=e,this.Ho=s,this.Jo=r,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Wk(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Y.RESOURCE_EXHAUSTED?($t(n.toString()),$t("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Y.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([s,r])=>{this.Yo===n&&this.P_(s,r)},s=>{e(()=>{const r=new ce(Y.UNKNOWN,"Fetching auth token failed: "+s.message);return this.I_(r)})})}P_(e,n){const s=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{s(()=>this.listener.Eo())}),this.stream.Ro(()=>{s(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{s(()=>this.I_(r))}),this.stream.onMessage(r=>{s(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return te("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(te("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class lF extends Gk{constructor(e,n,s,r,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=x5(this.serializer,e),s=function(i){if(!("targetChange"in i))return Re.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Re.min():o.readTime?Bn(o.readTime):Re.min()}(e);return this.listener.d_(n,s)}A_(e){const n={};n.database=Zg(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=af(c)?{documents:xk(i,c)}:{query:yk(i,c)._t},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=hk(i,o.resumeToken);const u=Xg(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Re.min())>0){l.readTime=dl(i,o.snapshotVersion.toTimestamp());const u=Xg(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const s=v5(this.serializer,e);s&&(n.labels=s),this.a_(n)}R_(e){const n={};n.database=Zg(this.serializer),n.removeTarget=e,this.a_(n)}}class cF extends Gk{constructor(e,n,s,r,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,s,r,o),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return ke(!!e.streamToken),this.lastStreamToken=e.streamToken,ke(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){ke(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=y5(e.writeResults,e.commitTime),s=Bn(e.commitTime);return this.listener.g_(s,n)}p_(){const e={};e.database=Zg(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(s=>uf(this.serializer,s))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uF extends class{}{constructor(e,n,s,r){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=s,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new ce(Y.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,s,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.Mo(e,Jg(n,s),r,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ce(Y.UNKNOWN,i.toString())})}Lo(e,n,s,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Lo(e,Jg(n,s),r,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Y.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ce(Y.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class dF{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?($t(n),this.D_=!1):te("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hF{constructor(e,n,s,r,i){this.localStore=e,this.datastore=n,this.asyncQueue=s,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(o=>{s.enqueueAndForget(async()=>{Ya(this)&&(te("RemoteStore","Restarting streams for network reachability change."),await async function(c){const u=Ne(c);u.L_.add(4),await Ku(u),u.q_.set("Unknown"),u.L_.delete(4),await cm(u)}(this))})}),this.q_=new dF(s,r)}}async function cm(t){if(Ya(t))for(const e of t.B_)await e(!0)}async function Ku(t){for(const e of t.B_)await e(!1)}function um(t,e){const n=Ne(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),d0(n)?u0(n):Il(n).r_()&&c0(n,e))}function fl(t,e){const n=Ne(t),s=Il(n);n.N_.delete(e),s.r_()&&Hk(n,e),n.N_.size===0&&(s.r_()?s.o_():Ya(n)&&n.q_.set("Unknown"))}function c0(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Re.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Il(t).A_(e)}function Hk(t,e){t.Q_.xe(e),Il(t).R_(e)}function u0(t){t.Q_=new u5({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Il(t).start(),t.q_.v_()}function d0(t){return Ya(t)&&!Il(t).n_()&&t.N_.size>0}function Ya(t){return Ne(t).L_.size===0}function Kk(t){t.Q_=void 0}async function fF(t){t.q_.set("Online")}async function mF(t){t.N_.forEach((e,n)=>{c0(t,e)})}async function pF(t,e){Kk(t),d0(t)?(t.q_.M_(e),u0(t)):t.q_.set("Unknown")}async function gF(t,e,n){if(t.q_.set("Online"),e instanceof dk&&e.state===2&&e.cause)try{await async function(r,i){const o=i.cause;for(const l of i.targetIds)r.N_.has(l)&&(await r.remoteSyncer.rejectListen(l,o),r.N_.delete(l),r.Q_.removeTarget(l))}(t,e)}catch(s){te("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),s),await xf(t,s)}else if(e instanceof yh?t.Q_.Ke(e):e instanceof uk?t.Q_.He(e):t.Q_.We(e),!n.isEqual(Re.min()))try{const s=await Fk(t.localStore);n.compareTo(s)>=0&&await function(i,o){const l=i.Q_.rt(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const h=i.N_.get(u);h&&i.N_.set(u,h.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const h=i.N_.get(c);if(!h)return;i.N_.set(c,h.withResumeToken(zt.EMPTY_BYTE_STRING,h.snapshotVersion)),Hk(i,c);const f=new kr(h.target,c,u,h.sequenceNumber);c0(i,f)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(s){te("RemoteStore","Failed to raise snapshot:",s),await xf(t,s)}}async function xf(t,e,n){if(!Gi(e))throw e;t.L_.add(1),await Ku(t),t.q_.set("Offline"),n||(n=()=>Fk(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{te("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await cm(t)})}function Qk(t,e){return e().catch(n=>xf(t,n,e))}async function kl(t){const e=Ne(t),n=Oi(e);let s=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;xF(e);)try{const r=await sF(e.localStore,s);if(r===null){e.O_.length===0&&n.o_();break}s=r.batchId,yF(e,r)}catch(r){await xf(e,r)}Yk(e)&&Xk(e)}function xF(t){return Ya(t)&&t.O_.length<10}function yF(t,e){t.O_.push(e);const n=Oi(t);n.r_()&&n.V_&&n.m_(e.mutations)}function Yk(t){return Ya(t)&&!Oi(t).n_()&&t.O_.length>0}function Xk(t){Oi(t).start()}async function vF(t){Oi(t).p_()}async function bF(t){const e=Oi(t);for(const n of t.O_)e.m_(n.mutations)}async function wF(t,e,n){const s=t.O_.shift(),r=Zy.from(s,e,n);await Qk(t,()=>t.remoteSyncer.applySuccessfulWrite(r)),await kl(t)}async function _F(t,e){e&&Oi(t).V_&&await async function(s,r){if(function(o){return o5(o)&&o!==Y.ABORTED}(r.code)){const i=s.O_.shift();Oi(s).s_(),await Qk(s,()=>s.remoteSyncer.rejectFailedWrite(i.batchId,r)),await kl(s)}}(t,e),Yk(t)&&Xk(t)}async function Y_(t,e){const n=Ne(t);n.asyncQueue.verifyOperationInProgress(),te("RemoteStore","RemoteStore received new credentials");const s=Ya(n);n.L_.add(3),await Ku(n),s&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await cm(n)}async function ax(t,e){const n=Ne(t);e?(n.L_.delete(2),await cm(n)):e||(n.L_.add(2),await Ku(n),n.q_.set("Unknown"))}function Il(t){return t.K_||(t.K_=function(n,s,r){const i=Ne(n);return i.w_(),new lF(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Eo:fF.bind(null,t),Ro:mF.bind(null,t),mo:pF.bind(null,t),d_:gF.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),d0(t)?u0(t):t.q_.set("Unknown")):(await t.K_.stop(),Kk(t))})),t.K_}function Oi(t){return t.U_||(t.U_=function(n,s,r){const i=Ne(n);return i.w_(),new cF(s,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:vF.bind(null,t),mo:_F.bind(null,t),f_:bF.bind(null,t),g_:wF.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await kl(t)):(await t.U_.stop(),t.O_.length>0&&(te("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h0{constructor(e,n,s,r,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=s,this.op=r,this.removalCallback=i,this.deferred=new cr,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,s,r,i){const o=Date.now()+s,l=new h0(e,n,o,r,i);return l.start(s),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ce(Y.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function f0(t,e){if($t("AsyncQueue",`${e}: ${t}`),Gi(t))return new ce(Y.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ko{constructor(e){this.comparator=e?(n,s)=>e(n,s)||me.comparator(n.key,s.key):(n,s)=>me.comparator(n.key,s.key),this.keyedMap=gc(),this.sortedSet=new dt(this.comparator)}static emptySet(e){return new Ko(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,s)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ko)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),s=e.sortedSet.getIterator();for(;n.hasNext();){const r=n.getNext().key,i=s.getNext().key;if(!r.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const s=new Ko;return s.comparator=this.comparator,s.keyedMap=e,s.sortedSet=n,s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X_{constructor(){this.W_=new dt(me.comparator)}track(e){const n=e.doc.key,s=this.W_.get(n);s?e.type!==0&&s.type===3?this.W_=this.W_.insert(n,e):e.type===3&&s.type!==1?this.W_=this.W_.insert(n,{type:s.type,doc:e.doc}):e.type===2&&s.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&s.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&s.type===0?this.W_=this.W_.remove(n):e.type===1&&s.type===2?this.W_=this.W_.insert(n,{type:1,doc:s.doc}):e.type===0&&s.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):_e():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,s)=>{e.push(s)}),e}}class ml{constructor(e,n,s,r,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=s,this.docChanges=r,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,s,r,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new ml(e,n,Ko.emptySet(n),o,s,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&nm(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,s=e.docChanges;if(n.length!==s.length)return!1;for(let r=0;r<n.length;r++)if(n[r].type!==s[r].type||!n[r].doc.isEqual(s[r].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NF{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class EF{constructor(){this.queries=J_(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,s){const r=Ne(n),i=r.queries;r.queries=J_(),i.forEach((o,l)=>{for(const c of l.j_)c.onError(s)})})(this,new ce(Y.ABORTED,"Firestore shutting down"))}}function J_(){return new Hi(t=>K1(t),nm)}async function m0(t,e){const n=Ne(t);let s=3;const r=e.query;let i=n.queries.get(r);i?!i.H_()&&e.J_()&&(s=2):(i=new NF,s=e.J_()?0:1);try{switch(s){case 0:i.z_=await n.onListen(r,!0);break;case 1:i.z_=await n.onListen(r,!1);break;case 2:await n.onFirstRemoteStoreListen(r)}}catch(o){const l=f0(o,`Initialization of query '${xo(e.query)}' failed`);return void e.onError(l)}n.queries.set(r,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&g0(n)}async function p0(t,e){const n=Ne(t),s=e.query;let r=3;const i=n.queries.get(s);if(i){const o=i.j_.indexOf(e);o>=0&&(i.j_.splice(o,1),i.j_.length===0?r=e.J_()?0:1:!i.H_()&&e.J_()&&(r=2))}switch(r){case 0:return n.queries.delete(s),n.onUnlisten(s,!0);case 1:return n.queries.delete(s),n.onUnlisten(s,!1);case 2:return n.onLastRemoteStoreUnlisten(s);default:return}}function TF(t,e){const n=Ne(t);let s=!1;for(const r of e){const i=r.query,o=n.queries.get(i);if(o){for(const l of o.j_)l.X_(r)&&(s=!0);o.z_=r}}s&&g0(n)}function SF(t,e,n){const s=Ne(t),r=s.queries.get(e);if(r)for(const i of r.j_)i.onError(n);s.queries.delete(e)}function g0(t){t.Y_.forEach(e=>{e.next()})}var ox,Z_;(Z_=ox||(ox={})).ea="default",Z_.Cache="cache";class x0{constructor(e,n,s){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=s||{}}X_(e){if(!this.options.includeMetadataChanges){const s=[];for(const r of e.docChanges)r.type!==3&&s.push(r);e=new ml(e.query,e.docs,e.oldDocs,s,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const s=n!=="Offline";return(!this.options._a||!s)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=ml.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==ox.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jk{constructor(e){this.key=e}}class Zk{constructor(e){this.key=e}}class jF{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=$e(),this.mutatedKeys=$e(),this.Aa=Y1(e),this.Ra=new Ko(this.Aa)}get Va(){return this.Ta}ma(e,n){const s=n?n.fa:new X_,r=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,o=r,l=!1;const c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,u=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((h,f)=>{const m=r.get(h),x=zu(this.query,f)?f:null,b=!!m&&this.mutatedKeys.has(m.key),N=!!x&&(x.hasLocalMutations||this.mutatedKeys.has(x.key)&&x.hasCommittedMutations);let E=!1;m&&x?m.data.isEqual(x.data)?b!==N&&(s.track({type:3,doc:x}),E=!0):this.ga(m,x)||(s.track({type:2,doc:x}),E=!0,(c&&this.Aa(x,c)>0||u&&this.Aa(x,u)<0)&&(l=!0)):!m&&x?(s.track({type:0,doc:x}),E=!0):m&&!x&&(s.track({type:1,doc:m}),E=!0,(c||u)&&(l=!0)),E&&(x?(o=o.add(x),i=N?i.add(h):i.delete(h)):(o=o.delete(h),i=i.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),i=i.delete(h.key),s.track({type:1,doc:h})}return{Ra:o,fa:s,ns:l,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,s,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const o=e.fa.G_();o.sort((h,f)=>function(x,b){const N=E=>{switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _e()}};return N(x)-N(b)}(h.type,f.type)||this.Aa(h.doc,f.doc)),this.pa(s),r=r!=null&&r;const l=n&&!r?this.ya():[],c=this.da.size===0&&this.current&&!r?1:0,u=c!==this.Ea;return this.Ea=c,o.length!==0||u?{snapshot:new ml(this.query,e.Ra,i,o,e.mutatedKeys,c===0,u,!1,!!s&&s.resumeToken.approximateByteSize()>0),wa:l}:{wa:l}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new X_,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=$e(),this.Ra.forEach(s=>{this.Sa(s.key)&&(this.da=this.da.add(s.key))});const n=[];return e.forEach(s=>{this.da.has(s)||n.push(new Zk(s))}),this.da.forEach(s=>{e.has(s)||n.push(new Jk(s))}),n}ba(e){this.Ta=e.Ts,this.da=$e();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return ml.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class kF{constructor(e,n,s){this.query=e,this.targetId=n,this.view=s}}class IF{constructor(e){this.key=e,this.va=!1}}class CF{constructor(e,n,s,r,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=s,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Hi(l=>K1(l),nm),this.Ma=new Map,this.xa=new Set,this.Oa=new dt(me.comparator),this.Na=new Map,this.La=new i0,this.Ba={},this.ka=new Map,this.qa=za.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function AF(t,e,n=!0){const s=dm(t);let r;const i=s.Fa.get(e);return i?(s.sharedClientState.addLocalQueryTarget(i.targetId),r=i.view.Da()):r=await eI(s,e,n,!0),r}async function RF(t,e){const n=dm(t);await eI(n,e,!0,!1)}async function eI(t,e,n,s){const r=await mf(t.localStore,ms(e)),i=r.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return s&&(l=await y0(t,e,i,o==="current",r.resumeToken)),t.isPrimaryClient&&n&&um(t.remoteStore,r),l}async function y0(t,e,n,s,r){t.Ka=(f,m,x)=>async function(N,E,w,v){let T=E.view.ma(w);T.ns&&(T=await rx(N.localStore,E.query,!1).then(({documents:j})=>E.view.ma(j,T)));const I=v&&v.targetChanges.get(E.targetId),R=v&&v.targetMismatches.get(E.targetId)!=null,V=E.view.applyChanges(T,N.isPrimaryClient,I,R);return lx(N,E.targetId,V.wa),V.snapshot}(t,f,m,x);const i=await rx(t.localStore,e,!0),o=new jF(e,i.Ts),l=o.ma(i.documents),c=Hu.createSynthesizedTargetChangeForCurrentChange(n,s&&t.onlineState!=="Offline",r),u=o.applyChanges(l,t.isPrimaryClient,c);lx(t,n,u.wa);const h=new kF(e,n,o);return t.Fa.set(e,h),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),u.snapshot}async function PF(t,e,n){const s=Ne(t),r=s.Fa.get(e),i=s.Ma.get(r.targetId);if(i.length>1)return s.Ma.set(r.targetId,i.filter(o=>!nm(o,e))),void s.Fa.delete(e);s.isPrimaryClient?(s.sharedClientState.removeLocalQueryTarget(r.targetId),s.sharedClientState.isActiveQueryTarget(r.targetId)||await hl(s.localStore,r.targetId,!1).then(()=>{s.sharedClientState.clearQueryState(r.targetId),n&&fl(s.remoteStore,r.targetId),pl(s,r.targetId)}).catch(Wi)):(pl(s,r.targetId),await hl(s.localStore,r.targetId,!0))}async function DF(t,e){const n=Ne(t),s=n.Fa.get(e),r=n.Ma.get(s.targetId);n.isPrimaryClient&&r.length===1&&(n.sharedClientState.removeLocalQueryTarget(s.targetId),fl(n.remoteStore,s.targetId))}async function VF(t,e,n){const s=_0(t);try{const r=await function(o,l){const c=Ne(o),u=At.now(),h=l.reduce((x,b)=>x.add(b.key),$e());let f,m;return c.persistence.runTransaction("Locally write mutations","readwrite",x=>{let b=ds(),N=$e();return c.cs.getEntries(x,h).next(E=>{b=E,b.forEach((w,v)=>{v.isValidDocument()||(N=N.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(x,b)).next(E=>{f=E;const w=[];for(const v of l){const T=i5(v,f.get(v.key).overlayedDocument);T!=null&&w.push(new Gr(v.key,T,O1(T.value.mapValue),tn.exists(!0)))}return c.mutationQueue.addMutationBatch(x,u,w,l)}).next(E=>{m=E;const w=E.applyToLocalDocumentSet(f,N);return c.documentOverlayCache.saveOverlays(x,E.batchId,w)})}).then(()=>({batchId:m.batchId,changes:J1(f)}))}(s.localStore,e);s.sharedClientState.addPendingMutation(r.batchId),function(o,l,c){let u=o.Ba[o.currentUser.toKey()];u||(u=new dt(Oe)),u=u.insert(l,c),o.Ba[o.currentUser.toKey()]=u}(s,r.batchId,n),await Ki(s,r.changes),await kl(s.remoteStore)}catch(r){const i=f0(r,"Failed to persist write");n.reject(i)}}async function tI(t,e){const n=Ne(t);try{const s=await tF(n.localStore,e);e.targetChanges.forEach((r,i)=>{const o=n.Na.get(i);o&&(ke(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.va=!0:r.modifiedDocuments.size>0?ke(o.va):r.removedDocuments.size>0&&(ke(o.va),o.va=!1))}),await Ki(n,s,e)}catch(s){await Wi(s)}}function eN(t,e,n){const s=Ne(t);if(s.isPrimaryClient&&n===0||!s.isPrimaryClient&&n===1){const r=[];s.Fa.forEach((i,o)=>{const l=o.view.Z_(e);l.snapshot&&r.push(l.snapshot)}),function(o,l){const c=Ne(o);c.onlineState=l;let u=!1;c.queries.forEach((h,f)=>{for(const m of f.j_)m.Z_(l)&&(u=!0)}),u&&g0(c)}(s.eventManager,e),r.length&&s.Ca.d_(r),s.onlineState=e,s.isPrimaryClient&&s.sharedClientState.setOnlineState(e)}}async function MF(t,e,n){const s=Ne(t);s.sharedClientState.updateQueryState(e,"rejected",n);const r=s.Na.get(e),i=r&&r.key;if(i){let o=new dt(me.comparator);o=o.insert(i,Ut.newNoDocument(i,Re.min()));const l=$e().add(i),c=new Gu(Re.min(),new Map,new dt(Oe),o,l);await tI(s,c),s.Oa=s.Oa.remove(i),s.Na.delete(e),w0(s)}else await hl(s.localStore,e,!1).then(()=>pl(s,e,n)).catch(Wi)}async function LF(t,e){const n=Ne(t),s=e.batch.batchId;try{const r=await eF(n.localStore,e);b0(n,s,null),v0(n,s),n.sharedClientState.updateMutationState(s,"acknowledged"),await Ki(n,r)}catch(r){await Wi(r)}}async function OF(t,e,n){const s=Ne(t);try{const r=await function(o,l){const c=Ne(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let h;return c.mutationQueue.lookupMutationBatch(u,l).next(f=>(ke(f!==null),h=f.keys(),c.mutationQueue.removeMutationBatch(u,f))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,h,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,h)).next(()=>c.localDocuments.getDocuments(u,h))})}(s.localStore,e);b0(s,e,n),v0(s,e),s.sharedClientState.updateMutationState(e,"rejected",n),await Ki(s,r)}catch(r){await Wi(r)}}function v0(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function b0(t,e,n){const s=Ne(t);let r=s.Ba[s.currentUser.toKey()];if(r){const i=r.get(e);i&&(n?i.reject(n):i.resolve(),r=r.remove(e)),s.Ba[s.currentUser.toKey()]=r}}function pl(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const s of t.Ma.get(e))t.Fa.delete(s),n&&t.Ca.$a(s,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(s=>{t.La.containsKey(s)||nI(t,s)})}function nI(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(fl(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),w0(t))}function lx(t,e,n){for(const s of n)s instanceof Jk?(t.La.addReference(s.key,e),FF(t,s)):s instanceof Zk?(te("SyncEngine","Document no longer in limbo: "+s.key),t.La.removeReference(s.key,e),t.La.containsKey(s.key)||nI(t,s.key)):_e()}function FF(t,e){const n=e.key,s=n.path.canonicalString();t.Oa.get(n)||t.xa.has(s)||(te("SyncEngine","New document in limbo: "+n),t.xa.add(s),w0(t))}function w0(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new me(et.fromString(e)),s=t.qa.next();t.Na.set(s,new IF(n)),t.Oa=t.Oa.insert(n,s),um(t.remoteStore,new kr(ms($u(n.path)),s,"TargetPurposeLimboResolution",Jn.oe))}}async function Ki(t,e,n){const s=Ne(t),r=[],i=[],o=[];s.Fa.isEmpty()||(s.Fa.forEach((l,c)=>{o.push(s.Ka(c,e,n).then(u=>{var h;if((u||n)&&s.isPrimaryClient){const f=u?!u.fromCache:(h=n==null?void 0:n.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;s.sharedClientState.updateQueryState(c.targetId,f?"current":"not-current")}if(u){r.push(u);const f=o0.Wi(c.targetId,u);i.push(f)}}))}),await Promise.all(o),s.Ca.d_(r),await async function(c,u){const h=Ne(c);try{await h.persistence.runTransaction("notifyLocalViewChanges","readwrite",f=>$.forEach(u,m=>$.forEach(m.$i,x=>h.persistence.referenceDelegate.addReference(f,m.targetId,x)).next(()=>$.forEach(m.Ui,x=>h.persistence.referenceDelegate.removeReference(f,m.targetId,x)))))}catch(f){if(!Gi(f))throw f;te("LocalStore","Failed to update sequence numbers: "+f)}for(const f of u){const m=f.targetId;if(!f.fromCache){const x=h.os.get(m),b=x.snapshotVersion,N=x.withLastLimboFreeSnapshotVersion(b);h.os=h.os.insert(m,N)}}}(s.localStore,i))}async function UF(t,e){const n=Ne(t);if(!n.currentUser.isEqual(e)){te("SyncEngine","User change. New user:",e.toKey());const s=await Ok(n.localStore,e);n.currentUser=e,function(i,o){i.ka.forEach(l=>{l.forEach(c=>{c.reject(new ce(Y.CANCELLED,o))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,s.removedBatchIds,s.addedBatchIds),await Ki(n,s.hs)}}function BF(t,e){const n=Ne(t),s=n.Na.get(e);if(s&&s.va)return $e().add(s.key);{let r=$e();const i=n.Ma.get(e);if(!i)return r;for(const o of i){const l=n.Fa.get(o);r=r.unionWith(l.view.Va)}return r}}async function $F(t,e){const n=Ne(t),s=await rx(n.localStore,e.query,!0),r=e.view.ba(s);return n.isPrimaryClient&&lx(n,e.targetId,r.wa),r}async function zF(t,e){const n=Ne(t);return Bk(n.localStore,e).then(s=>Ki(n,s))}async function qF(t,e,n,s){const r=Ne(t),i=await function(l,c){const u=Ne(l),h=Ne(u.mutationQueue);return u.persistence.runTransaction("Lookup mutation documents","readonly",f=>h.Mn(f,c).next(m=>m?u.localDocuments.getDocuments(f,m):$.resolve(null)))}(r.localStore,e);i!==null?(n==="pending"?await kl(r.remoteStore):n==="acknowledged"||n==="rejected"?(b0(r,e,s||null),v0(r,e),function(l,c){Ne(Ne(l).mutationQueue).On(c)}(r.localStore,e)):_e(),await Ki(r,i)):te("SyncEngine","Cannot apply mutation batch with id: "+e)}async function WF(t,e){const n=Ne(t);if(dm(n),_0(n),e===!0&&n.Qa!==!0){const s=n.sharedClientState.getAllActiveQueryTargets(),r=await tN(n,s.toArray());n.Qa=!0,await ax(n.remoteStore,!0);for(const i of r)um(n.remoteStore,i)}else if(e===!1&&n.Qa!==!1){const s=[];let r=Promise.resolve();n.Ma.forEach((i,o)=>{n.sharedClientState.isLocalQueryTarget(o)?s.push(o):r=r.then(()=>(pl(n,o),hl(n.localStore,o,!0))),fl(n.remoteStore,o)}),await r,await tN(n,s),function(o){const l=Ne(o);l.Na.forEach((c,u)=>{fl(l.remoteStore,u)}),l.La.pr(),l.Na=new Map,l.Oa=new dt(me.comparator)}(n),n.Qa=!1,await ax(n.remoteStore,!1)}}async function tN(t,e,n){const s=Ne(t),r=[],i=[];for(const o of e){let l;const c=s.Ma.get(o);if(c&&c.length!==0){l=await mf(s.localStore,ms(c[0]));for(const u of c){const h=s.Fa.get(u),f=await $F(s,h);f.snapshot&&i.push(f.snapshot)}}else{const u=await Uk(s.localStore,o);l=await mf(s.localStore,u),await y0(s,sI(u),o,!1,l.resumeToken)}r.push(l)}return s.Ca.d_(i),r}function sI(t){return G1(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function GF(t){return function(n){return Ne(Ne(n).persistence).Qi()}(Ne(t).localStore)}async function HF(t,e,n,s){const r=Ne(t);if(r.Qa)return void te("SyncEngine","Ignoring unexpected query state notification.");const i=r.Ma.get(e);if(i&&i.length>0)switch(n){case"current":case"not-current":{const o=await Bk(r.localStore,Q1(i[0])),l=Gu.createSynthesizedRemoteEventForCurrentChange(e,n==="current",zt.EMPTY_BYTE_STRING);await Ki(r,o,l);break}case"rejected":await hl(r.localStore,e,!0),pl(r,e,s);break;default:_e()}}async function KF(t,e,n){const s=dm(t);if(s.Qa){for(const r of e){if(s.Ma.has(r)&&s.sharedClientState.isActiveQueryTarget(r)){te("SyncEngine","Adding an already active target "+r);continue}const i=await Uk(s.localStore,r),o=await mf(s.localStore,i);await y0(s,sI(i),o.targetId,!1,o.resumeToken),um(s.remoteStore,o)}for(const r of n)s.Ma.has(r)&&await hl(s.localStore,r,!1).then(()=>{fl(s.remoteStore,r),pl(s,r)}).catch(Wi)}}function dm(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tI.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=BF.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=MF.bind(null,e),e.Ca.d_=TF.bind(null,e.eventManager),e.Ca.$a=SF.bind(null,e.eventManager),e}function _0(t){const e=Ne(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=LF.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=OF.bind(null,e),e}class vu{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lm(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return Lk(this.persistence,new Mk,e.initialUser,this.serializer)}Ga(e){return new Dk(om.Zr,this.serializer)}Wa(e){return new zk}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}vu.provider={build:()=>new vu};class rI extends vu{constructor(e,n,s){super(),this.Ja=e,this.cacheSizeBytes=n,this.forceOwnership=s,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await _0(this.Ja.syncEngine),await kl(this.Ja.remoteStore),await this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}za(e){return Lk(this.persistence,new Mk,e.initialUser,this.serializer)}ja(e,n){const s=this.persistence.referenceDelegate.garbageCollector;return new M5(s,e.asyncQueue,n)}Ha(e,n){const s=new gO(n,this.persistence);return new pO(e.asyncQueue,s)}Ga(e){const n=Vk(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),s=this.cacheSizeBytes!==void 0?Kn.withCacheSize(this.cacheSizeBytes):Kn.DEFAULT;return new a0(this.synchronizeTabs,n,e.clientId,s,e.asyncQueue,qk(),vh(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new zk}}class QF extends rI{constructor(e,n){super(e,n,!1),this.Ja=e,this.cacheSizeBytes=n,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const n=this.Ja.syncEngine;this.sharedClientState instanceof fp&&(this.sharedClientState.syncEngine={no:qF.bind(null,n),ro:HF.bind(null,n),io:KF.bind(null,n),Qi:GF.bind(null,n),eo:zF.bind(null,n)},await this.sharedClientState.start()),await this.persistence.yi(async s=>{await WF(this.Ja.syncEngine,s),this.gcScheduler&&(s&&!this.gcScheduler.started?this.gcScheduler.start():s||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(s&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():s||this.indexBackfillerScheduler.stop())})}Wa(e){const n=qk();if(!fp.D(n))throw new ce(Y.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const s=Vk(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new fp(n,e.asyncQueue,s,e.clientId,e.initialUser)}}class bu{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=s=>eN(this.syncEngine,s,1),this.remoteStore.remoteSyncer.handleCredentialChange=UF.bind(null,this.syncEngine),await ax(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new EF}()}createDatastore(e){const n=lm(e.databaseInfo.databaseId),s=function(i){return new oF(i)}(e.databaseInfo);return function(i,o,l,c){return new uF(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,s,n)}createRemoteStore(e){return function(s,r,i,o,l){return new hF(s,r,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>eN(this.syncEngine,n,0),function(){return Q_.D()?new Q_:new rF}())}createSyncEngine(e,n){return function(r,i,o,l,c,u,h){const f=new CF(r,i,o,l,c,u);return h&&(f.Qa=!0),f}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(r){const i=Ne(r);te("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await Ku(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}bu.provider={build:()=>new bu};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):$t("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,n,s,r,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=s,this.databaseInfo=r,this.user=Sn.UNAUTHENTICATED,this.clientId=_1.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(s,async o=>{te("FirestoreClient","Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(s,o=>(te("FirestoreClient","Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new cr;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const s=f0(n,"Failed to shutdown persistence");e.reject(s)}}),e.promise}}async function pp(t,e){t.asyncQueue.verifyOperationInProgress(),te("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let s=n.initialUser;t.setCredentialChangeListener(async r=>{s.isEqual(r)||(await Ok(e.localStore,r),s=r)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function nN(t,e){t.asyncQueue.verifyOperationInProgress();const n=await XF(t);te("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(s=>Y_(e.remoteStore,s)),t.setAppCheckTokenChangeListener((s,r)=>Y_(e.remoteStore,r)),t._onlineComponents=e}async function XF(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){te("FirestoreClient","Using user provided OfflineComponentProvider");try{await pp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(r){return r.name==="FirebaseError"?r.code===Y.FAILED_PRECONDITION||r.code===Y.UNIMPLEMENTED:!(typeof DOMException<"u"&&r instanceof DOMException)||r.code===22||r.code===20||r.code===11}(n))throw n;uu("Error using user provided cache. Falling back to memory cache: "+n),await pp(t,new vu)}}else te("FirestoreClient","Using default OfflineComponentProvider"),await pp(t,new vu);return t._offlineComponents}async function iI(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(te("FirestoreClient","Using user provided OnlineComponentProvider"),await nN(t,t._uninitializedComponentsProvider._online)):(te("FirestoreClient","Using default OnlineComponentProvider"),await nN(t,new bu))),t._onlineComponents}function JF(t){return iI(t).then(e=>e.syncEngine)}async function yf(t){const e=await iI(t),n=e.eventManager;return n.onListen=AF.bind(null,e.syncEngine),n.onUnlisten=PF.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=RF.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=DF.bind(null,e.syncEngine),n}function ZF(t,e,n={}){const s=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const h=new N0({next:m=>{h.Za(),o.enqueueAndForget(()=>p0(i,f));const x=m.docs.has(l);!x&&m.fromCache?u.reject(new ce(Y.UNAVAILABLE,"Failed to get document because the client is offline.")):x&&m.fromCache&&c&&c.source==="server"?u.reject(new ce(Y.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new x0($u(l.path),h,{includeMetadataChanges:!0,_a:!0});return m0(i,f)}(await yf(t),t.asyncQueue,e,n,s)),s.promise}function e3(t,e,n={}){const s=new cr;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const h=new N0({next:m=>{h.Za(),o.enqueueAndForget(()=>p0(i,f)),m.fromCache&&c.source==="server"?u.reject(new ce(Y.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(m)},error:m=>u.reject(m)}),f=new x0(l,h,{includeMetadataChanges:!0,_a:!0});return m0(i,f)}(await yf(t),t.asyncQueue,e,n,s)),s.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aI(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sN=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t,e,n){if(!n)throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function t3(t,e,n,s){if(e===!0&&s===!0)throw new ce(Y.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function rN(t){if(!me.isDocumentKey(t))throw new ce(Y.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function iN(t){if(me.isDocumentKey(t))throw new ce(Y.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function hm(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(s){return s.constructor?s.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_e()}function rs(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ce(Y.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=hm(t);throw new ce(Y.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function n3(t,e){if(e<=0)throw new ce(Y.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){var n,s;if(e.host===void 0){if(e.ssl!==void 0)throw new ce(Y.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ce(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}t3("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=aI((s=e.experimentalLongPollingOptions)!==null&&s!==void 0?s:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ce(Y.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(s,r){return s.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class E0{constructor(e,n,s,r){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=s,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new aN({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ce(Y.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ce(Y.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new aN(e),e.credentials!==void 0&&(this._authCredentials=function(s){if(!s)return new iO;switch(s.type){case"firstParty":return new lO(s.sessionIndex||"0",s.iamToken||null,s.authTokenFactory||null);case"provider":return s.client;default:throw new ce(Y.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const s=sN.get(n);s&&(te("ComponentProvider","Removing Datastore"),sN.delete(n),s.terminate())}(this),Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hr{constructor(e,n,s){this.converter=n,this._query=s,this.type="query",this.firestore=e}withConverter(e){return new Hr(this.firestore,e,this._query)}}class Cn{constructor(e,n,s){this.converter=n,this._key=s,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Ri(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Cn(this.firestore,e,this._key)}}class Ri extends Hr{constructor(e,n,s){super(e,n,$u(s)),this._path=s,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Cn(this.firestore,null,new me(e))}withConverter(e){return new Ri(this.firestore,e,this._path)}}function ae(t,e,...n){if(t=Ps(t),oI("collection","path",e),t instanceof E0){const s=et.fromString(e,...n);return iN(s),new Ri(t,null,s)}{if(!(t instanceof Cn||t instanceof Ri))throw new ce(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(et.fromString(e,...n));return iN(s),new Ri(t.firestore,null,s)}}function H(t,e,...n){if(t=Ps(t),arguments.length===1&&(e=_1.newId()),oI("doc","path",e),t instanceof E0){const s=et.fromString(e,...n);return rN(s),new Cn(t,null,new me(s))}{if(!(t instanceof Cn||t instanceof Ri))throw new ce(Y.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const s=t._path.child(et.fromString(e,...n));return rN(s),new Cn(t.firestore,t instanceof Ri?t.converter:null,new me(s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Wk(this,"async_queue_retry"),this.Vu=()=>{const s=vh();s&&te("AsyncQueue","Visibility state changed to "+s.visibilityState),this.t_.jo()},this.mu=e;const n=vh();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=vh();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new cr;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Gi(e))throw e;te("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(s=>{this.Eu=s,this.du=!1;const r=function(o){let l=o.message||"";return o.stack&&(l=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),l}(s);throw $t("INTERNAL UNHANDLED ERROR: ",r),s}).then(s=>(this.du=!1,s))));return this.mu=n,n}enqueueAfterDelay(e,n,s){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const r=h0.createAndSchedule(this,e,n,s,i=>this.yu(i));return this.Tu.push(r),r}fu(){this.Eu&&_e()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,s)=>n.targetTimeMs-s.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}function lN(t){return function(n,s){if(typeof n!="object"||n===null)return!1;const r=n;for(const i of s)if(i in r&&typeof r[i]=="function")return!0;return!1}(t,["next","error","complete"])}class fr extends E0{constructor(e,n,s,r){super(e,n,s,r),this.type="firestore",this._queue=new oN,this._persistenceKey=(r==null?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new oN(e),this._firestoreClient=void 0,await e}}}function s3(t,e,n){n||(n="(default)");const s=Du(t,"firestore");if(s.isInitialized(n)){const r=s.getImmediate({identifier:n}),i=s.getOptions(n);if(Jf(i,e))return r;throw new ce(Y.FAILED_PRECONDITION,"initializeFirestore() has already been called with different options. To avoid this error, call initializeFirestore() with the same options as when it was originally called, or call getFirestore() to return the already initialized instance.")}if(e.cacheSizeBytes!==void 0&&e.localCache!==void 0)throw new ce(Y.INVALID_ARGUMENT,"cache and cacheSizeBytes cannot be specified at the same time as cacheSizeBytes willbe deprecated. Instead, specify the cache size in the cache object");if(e.cacheSizeBytes!==void 0&&e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ce(Y.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");return s.initialize({options:e,instanceIdentifier:n})}function Qu(t){if(t._terminated)throw new ce(Y.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||r3(t),t._firestoreClient}function r3(t){var e,n,s;const r=t._freezeSettings(),i=function(l,c,u,h){return new LO(l,c,u,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,aI(h.experimentalLongPollingOptions),h.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,r);t._componentsProvider||!((n=r.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((s=r.localCache)===null||s===void 0)&&s._onlineComponentProvider)&&(t._componentsProvider={_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider}),t._firestoreClient=new YF(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gl{constructor(e){this._byteString=e}static fromBase64String(e){try{return new gl(zt.fromBase64String(e))}catch(n){throw new ce(Y.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new gl(zt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ce(Y.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new St(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xa{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T0{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ce(Y.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ce(Y.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Oe(this._lat,e._lat)||Oe(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(s,r){if(s.length!==r.length)return!1;for(let i=0;i<s.length;++i)if(s[i]!==r[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i3=/^__.*__$/;class a3{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return this.fieldMask!==null?new Gr(e,this.data,this.fieldMask,n,this.fieldTransforms):new jl(e,this.data,n,this.fieldTransforms)}}class lI{constructor(e,n,s){this.data=e,this.fieldMask=n,this.fieldTransforms=s}toMutation(e,n){return new Gr(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function cI(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _e()}}class fm{constructor(e,n,s,r,i,o){this.settings=e,this.databaseId=n,this.serializer=s,this.ignoreUndefinedProperties=r,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new fm(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.Fu({path:s,xu:!1});return r.Ou(e),r}Nu(e){var n;const s=(n=this.path)===null||n===void 0?void 0:n.child(e),r=this.Fu({path:s,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return vf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(cI(this.Cu)&&i3.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class o3{constructor(e,n,s){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=s||lm(e)}Qu(e,n,s,r=!1){return new fm({Cu:e,methodName:n,qu:s,path:St.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Xu(t){const e=t._freezeSettings(),n=lm(t._databaseId);return new o3(t._databaseId,!!e.ignoreUndefinedProperties,n)}function j0(t,e,n,s,r,i={}){const o=t.Qu(i.merge||i.mergeFields?2:0,e,n,r);R0("Data must be an object, but it was:",o,s);const l=fI(s,o);let c,u;if(i.merge)c=new Zn(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const h=[];for(const f of i.mergeFields){const m=cx(e,f,n);if(!o.contains(m))throw new ce(Y.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);pI(h,m)||h.push(m)}c=new Zn(h),u=o.fieldTransforms.filter(f=>c.covers(f.field))}else c=null,u=o.fieldTransforms;return new a3(new kn(l),c,u)}class mm extends Xa{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof mm}}function uI(t,e,n){return new fm({Cu:3,qu:e.settings.qu,methodName:t._methodName,xu:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class k0 extends Xa{_toFieldTransform(e){return new qu(e.path,new cl)}isEqual(e){return e instanceof k0}}class I0 extends Xa{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=uI(this,e,!0),s=this.Ku.map(i=>Ja(i,n)),r=new Fa(s);return new qu(e.path,r)}isEqual(e){return e instanceof I0&&Jf(this.Ku,e.Ku)}}class C0 extends Xa{constructor(e,n){super(e),this.Ku=n}_toFieldTransform(e){const n=uI(this,e,!0),s=this.Ku.map(i=>Ja(i,n)),r=new Ua(s);return new qu(e.path,r)}isEqual(e){return e instanceof C0&&Jf(this.Ku,e.Ku)}}class A0 extends Xa{constructor(e,n){super(e),this.$u=n}_toFieldTransform(e){const n=new ul(e.serializer,tk(e.serializer,this.$u));return new qu(e.path,n)}isEqual(e){return e instanceof A0&&this.$u===e.$u}}function dI(t,e,n,s){const r=t.Qu(1,e,n);R0("Data must be an object, but it was:",r,s);const i=[],o=kn.empty();Qa(s,(c,u)=>{const h=P0(e,c,n);u=Ps(u);const f=r.Nu(h);if(u instanceof mm)i.push(h);else{const m=Ja(u,f);m!=null&&(i.push(h),o.set(h,m))}});const l=new Zn(i);return new lI(o,l,r.fieldTransforms)}function hI(t,e,n,s,r,i){const o=t.Qu(1,e,n),l=[cx(e,s,n)],c=[r];if(i.length%2!=0)throw new ce(Y.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let m=0;m<i.length;m+=2)l.push(cx(e,i[m])),c.push(i[m+1]);const u=[],h=kn.empty();for(let m=l.length-1;m>=0;--m)if(!pI(u,l[m])){const x=l[m];let b=c[m];b=Ps(b);const N=o.Nu(x);if(b instanceof mm)u.push(x);else{const E=Ja(b,N);E!=null&&(u.push(x),h.set(x,E))}}const f=new Zn(u);return new lI(h,f,o.fieldTransforms)}function l3(t,e,n,s=!1){return Ja(n,t.Qu(s?4:3,e))}function Ja(t,e){if(mI(t=Ps(t)))return R0("Unsupported field value:",e,t),fI(t,e);if(t instanceof Xa)return function(s,r){if(!cI(r.Cu))throw r.Bu(`${s._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Bu(`${s._methodName}() is not currently supported inside arrays`);const i=s._toFieldTransform(r);i&&r.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(s,r){const i=[];let o=0;for(const l of s){let c=Ja(l,r.Lu(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(s,r){if((s=Ps(s))===null)return{nullValue:"NULL_VALUE"};if(typeof s=="number")return tk(r.serializer,s);if(typeof s=="boolean")return{booleanValue:s};if(typeof s=="string")return{stringValue:s};if(s instanceof Date){const i=At.fromDate(s);return{timestampValue:dl(r.serializer,i)}}if(s instanceof At){const i=new At(s.seconds,1e3*Math.floor(s.nanoseconds/1e3));return{timestampValue:dl(r.serializer,i)}}if(s instanceof T0)return{geoPointValue:{latitude:s.latitude,longitude:s.longitude}};if(s instanceof gl)return{bytesValue:hk(r.serializer,s._byteString)};if(s instanceof Cn){const i=r.databaseId,o=s.firestore._databaseId;if(!o.isEqual(i))throw r.Bu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:n0(s.firestore._databaseId||r.databaseId,s._key.path)}}if(s instanceof S0)return function(o,l){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw l.Bu("VectorValues must only contain numeric values.");return Xy(l.serializer,c)})}}}}}}(s,r);throw r.Bu(`Unsupported field value: ${hm(s)}`)}(t,e)}function fI(t,e){const n={};return D1(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Qa(t,(s,r)=>{const i=Ja(r,e.Mu(s));i!=null&&(n[s]=i)}),{mapValue:{fields:n}}}function mI(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof At||t instanceof T0||t instanceof gl||t instanceof Cn||t instanceof Xa||t instanceof S0)}function R0(t,e,n){if(!mI(n)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(n)){const s=hm(n);throw s==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+s)}}function cx(t,e,n){if((e=Ps(e))instanceof Yu)return e._internalPath;if(typeof e=="string")return P0(t,e);throw vf("Field path arguments must be of type string or ",t,!1,void 0,n)}const c3=new RegExp("[~\\*/\\[\\]]");function P0(t,e,n){if(e.search(c3)>=0)throw vf(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Yu(...e.split("."))._internalPath}catch{throw vf(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function vf(t,e,n,s,r){const i=s&&!s.isEmpty(),o=r!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${s}`),o&&(c+=` in document ${r}`),c+=")"),new ce(Y.INVALID_ARGUMENT,l+t+c)}function pI(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gI{constructor(e,n,s,r,i){this._firestore=e,this._userDataWriter=n,this._key=s,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Cn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new u3(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(pm("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class u3 extends gI{data(){return super.data()}}function pm(t,e){return typeof e=="string"?P0(t,e):e instanceof Yu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xI(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ce(Y.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class D0{}class V0 extends D0{}function qe(t,e,...n){let s=[];e instanceof D0&&s.push(e),s=s.concat(n),function(i){const o=i.filter(c=>c instanceof M0).length,l=i.filter(c=>c instanceof gm).length;if(o>1||o>0&&l>0)throw new ce(Y.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(s);for(const r of s)t=r._apply(t);return t}class gm extends V0{constructor(e,n,s){super(),this._field=e,this._op=n,this._value=s,this.type="where"}static _create(e,n,s){return new gm(e,n,s)}_apply(e){const n=this._parse(e);return yI(e._query,n),new Hr(e.firestore,e.converter,Yg(e._query,n))}_parse(e){const n=Xu(e.firestore);return function(i,o,l,c,u,h,f){let m;if(u.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new ce(Y.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){uN(f,h);const x=[];for(const b of f)x.push(cN(c,i,b));m={arrayValue:{values:x}}}else m=cN(c,i,f)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||uN(f,h),m=l3(l,o,f,h==="in"||h==="not-in");return He.create(u,h,m)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function rt(t,e,n){const s=e,r=pm("where",t);return gm._create(r,s,n)}class M0 extends D0{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new M0(e,n)}_parse(e){const n=this._queryConstraints.map(s=>s._parse(e)).filter(s=>s.getFilters().length>0);return n.length===1?n[0]:nt.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(r,i){let o=r;const l=i.getFlattenedFilters();for(const c of l)yI(o,c),o=Yg(o,c)}(e._query,n),new Hr(e.firestore,e.converter,Yg(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class L0 extends V0{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new L0(e,n)}_apply(e){const n=function(r,i,o){if(r.startAt!==null)throw new ce(Y.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new ce(Y.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new yu(i,o)}(e._query,this._field,this._direction);return new Hr(e.firestore,e.converter,function(r,i){const o=r.explicitOrderBy.concat([i]);return new Sl(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(e._query,n))}}function _t(t,e="asc"){const n=e,s=pm("orderBy",t);return L0._create(s,n)}class O0 extends V0{constructor(e,n,s){super(),this.type=e,this._limit=n,this._limitType=s}static _create(e,n,s){return new O0(e,n,s)}_apply(e){return new Hr(e.firestore,e.converter,lf(e._query,this._limit,this._limitType))}}function Ur(t){return n3("limit",t),O0._create("limit",t,"F")}function cN(t,e,n){if(typeof(n=Ps(n))=="string"){if(n==="")throw new ce(Y.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!H1(e)&&n.indexOf("/")!==-1)throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const s=e.path.child(et.fromString(n));if(!me.isDocumentKey(s))throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${s}' is not because it has an odd number of segments (${s.length}).`);return gu(t,new me(s))}if(n instanceof Cn)return gu(t,n._key);throw new ce(Y.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${hm(n)}.`)}function uN(t,e){if(!Array.isArray(t)||t.length===0)throw new ce(Y.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yI(t,e){const n=function(r,i){for(const o of r)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ce(Y.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ce(Y.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class d3{convertValue(e,n="none"){switch(La(e)){case 0:return null;case 1:return e.booleanValue;case 2:return bt(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Mi(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw _e()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const s={};return Qa(e,(r,i)=>{s[r]=this.convertValue(i,n)}),s}convertVectorValue(e){var n,s,r;const i=(r=(s=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||s===void 0?void 0:s.values)===null||r===void 0?void 0:r.map(o=>bt(o.doubleValue));return new S0(i)}convertGeoPoint(e){return new T0(bt(e.latitude),bt(e.longitude))}convertArray(e,n){return(e.values||[]).map(s=>this.convertValue(s,n))}convertServerTimestamp(e,n){switch(n){case"previous":const s=Ky(e);return s==null?null:this.convertValue(s,n);case"estimate":return this.convertTimestamp(mu(e));default:return null}}convertTimestamp(e){const n=Fr(e);return new At(n.seconds,n.nanos)}convertDocumentKey(e,n){const s=et.fromString(e);ke(_k(s));const r=new Ma(s.get(1),s.get(3)),i=new me(s.popFirst(5));return r.isEqual(n)||$t(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F0(t,e,n){let s;return s=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class vI extends gI{constructor(e,n,s,r,i,o){super(e,n,s,r,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new bh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const s=this._document.data.field(pm("DocumentSnapshot.get",e));if(s!==null)return this._userDataWriter.convertValue(s,n.serverTimestamps)}}}class bh extends vI{data(e={}){return super.data(e)}}class bI{constructor(e,n,s,r){this._firestore=e,this._userDataWriter=n,this._snapshot=r,this.metadata=new vc(r.hasPendingWrites,r.fromCache),this.query=s}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(s=>{e.call(n,new bh(this._firestore,this._userDataWriter,s.key,s,new vc(this._snapshot.mutatedKeys.has(s.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ce(Y.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,i){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(l=>{const c=new bh(r._firestore,r._userDataWriter,l.doc.key,l.doc,new vc(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new bh(r._firestore,r._userDataWriter,l.doc.key,l.doc,new vc(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter);let u=-1,h=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),h=o.indexOf(l.doc.key)),{type:h3(l.type),doc:c,oldIndex:u,newIndex:h}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function h3(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _e()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jt(t){t=rs(t,Cn);const e=rs(t.firestore,fr);return ZF(Qu(e),t._key).then(n=>wI(e,t,n))}class U0 extends d3{constructor(e){super(),this.firestore=e}convertBytes(e){return new gl(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Cn(this.firestore,null,n)}}function Zt(t){t=rs(t,Hr);const e=rs(t.firestore,fr),n=Qu(e),s=new U0(e);return xI(t._query),e3(n,t._query).then(r=>new bI(e,s,t,r))}function Ir(t,e,n){t=rs(t,Cn);const s=rs(t.firestore,fr),r=F0(t.converter,e,n);return Ju(s,[j0(Xu(s),"setDoc",t._key,r,t.converter!==null,n).toMutation(t._key,tn.none())])}function he(t,e,n,...s){t=rs(t,Cn);const r=rs(t.firestore,fr),i=Xu(r);let o;return o=typeof(e=Ps(e))=="string"||e instanceof Yu?hI(i,"updateDoc",t._key,e,n,s):dI(i,"updateDoc",t._key,e),Ju(r,[o.toMutation(t._key,tn.exists(!0))])}function is(t){return Ju(rs(t.firestore,fr),[new Wu(t._key,tn.none())])}function ze(t,e){const n=rs(t.firestore,fr),s=H(t),r=F0(t.converter,e);return Ju(n,[j0(Xu(t.firestore),"addDoc",s._key,r,t.converter!==null,{}).toMutation(s._key,tn.exists(!1))]).then(()=>s)}function Fe(t,...e){var n,s,r;t=Ps(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||lN(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(lN(e[o])){const f=e[o];e[o]=(n=f.next)===null||n===void 0?void 0:n.bind(f),e[o+1]=(s=f.error)===null||s===void 0?void 0:s.bind(f),e[o+2]=(r=f.complete)===null||r===void 0?void 0:r.bind(f)}let c,u,h;if(t instanceof Cn)u=rs(t.firestore,fr),h=$u(t._key.path),c={next:f=>{e[o]&&e[o](wI(u,t,f))},error:e[o+1],complete:e[o+2]};else{const f=rs(t,Hr);u=rs(f.firestore,fr),h=f._query;const m=new U0(u);c={next:x=>{e[o]&&e[o](new bI(u,m,f,x))},error:e[o+1],complete:e[o+2]},xI(t._query)}return function(m,x,b,N){const E=new N0(N),w=new x0(x,E,b);return m.asyncQueue.enqueueAndForget(async()=>m0(await yf(m),w)),()=>{E.Za(),m.asyncQueue.enqueueAndForget(async()=>p0(await yf(m),w))}}(Qu(u),h,l,c)}function Ju(t,e){return function(s,r){const i=new cr;return s.asyncQueue.enqueueAndForget(async()=>VF(await JF(s),r,i)),i.promise}(Qu(t),e)}function wI(t,e,n){const s=n.docs.get(e._key),r=new U0(t);return new vI(t,r,e._key,s,new vc(n.hasPendingWrites,n.fromCache),e.converter)}class f3{constructor(e){let n;this.kind="persistent",e!=null&&e.tabManager?(e.tabManager._initialize(e),n=e.tabManager):(n=x3(),n._initialize(e)),this._onlineComponentProvider=n._onlineComponentProvider,this._offlineComponentProvider=n._offlineComponentProvider}toJSON(){return{kind:this.kind}}}function m3(t){return new f3(t)}class p3{constructor(e){this.forceOwnership=e,this.kind="persistentSingleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bu.provider,this._offlineComponentProvider={build:n=>new rI(n,e==null?void 0:e.cacheSizeBytes,this.forceOwnership)}}}class g3{constructor(){this.kind="PersistentMultipleTab"}toJSON(){return{kind:this.kind}}_initialize(e){this._onlineComponentProvider=bu.provider,this._offlineComponentProvider={build:n=>new QF(n,e==null?void 0:e.cacheSizeBytes)}}}function x3(t){return new p3(void 0)}function y3(){return new g3}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v3{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=Xu(e)}set(e,n,s){this._verifyNotCommitted();const r=gp(e,this._firestore),i=F0(r.converter,n,s),o=j0(this._dataReader,"WriteBatch.set",r._key,i,r.converter!==null,s);return this._mutations.push(o.toMutation(r._key,tn.none())),this}update(e,n,s,...r){this._verifyNotCommitted();const i=gp(e,this._firestore);let o;return o=typeof(n=Ps(n))=="string"||n instanceof Yu?hI(this._dataReader,"WriteBatch.update",i._key,n,s,r):dI(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(o.toMutation(i._key,tn.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=gp(e,this._firestore);return this._mutations=this._mutations.concat(new Wu(n._key,tn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ce(Y.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function gp(t,e){if((t=Ps(t)).firestore!==e)throw new ce(Y.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}function Ie(){return new k0("serverTimestamp")}function ut(...t){return new I0("arrayUnion",t)}function kt(...t){return new C0("arrayRemove",t)}function pt(t){return new A0("increment",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xl(t){return Qu(t=rs(t,fr)),new v3(t,e=>Ju(t,e))}(function(e,n=!0){(function(r){Tl=r})(Ka),Vi(new JL("firestore",(s,{instanceIdentifier:r,options:i})=>{const o=s.getProvider("app").getImmediate(),l=new fr(new aO(s.getProvider("auth-internal")),new uO(s.getProvider("app-check-internal")),function(u,h){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ce(Y.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ma(u.options.projectId,h)}(o,r),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),Is(n_,"4.7.3",e),Is(n_,"4.7.3","esm2017")})();var dN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _I=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},b3=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],l=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},NI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,l=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,x=u&63;c||(x=64,o||(m=64)),s.push(n[h],n[f],n[m],n[x])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(_I(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):b3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const f=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||l==null||u==null||f==null)throw new w3;const m=i<<2|l>>4;if(s.push(m),u!==64){const x=l<<4&240|u>>2;if(s.push(x),f!==64){const b=u<<6&192|f;s.push(b)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let w3=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const _3=function(t){const e=_I(t);return NI.encodeByteArray(e,!0)},hN=function(t){return _3(t).replace(/\./g,"")},N3=function(t){try{return NI.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T3=()=>E3().__FIREBASE_DEFAULTS__,S3=()=>{if(typeof process>"u"||typeof dN>"u")return;const t=dN.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},j3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&N3(t[1]);return e&&JSON.parse(e)},k3=()=>{try{return T3()||S3()||j3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},I3=t=>{var e,n;return(n=(e=k3())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},C3=t=>{const e=I3(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A3(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},s=e||"demo-project",r=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${s}`,aud:s,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[hN(JSON.stringify(n)),hN(JSON.stringify(o)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R3="FirebaseError";let EI=class TI extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=R3,Object.setPrototypeOf(this,TI.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,P3.prototype.create)}},P3=class{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?D3(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new EI(r,l,s)}};function D3(t,e){return t.replace(V3,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const V3=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zu(t){return t&&t._delegate?t._delegate:t}let M3=class{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SI="firebasestorage.googleapis.com",jI="storageBucket",L3=2*60*1e3,O3=10*60*1e3,F3=1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dt extends EI{constructor(e,n,s=0){super(xp(e),`Firebase Storage: ${n} (${xp(e)})`),this.status_=s,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Dt.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return xp(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var yt;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(yt||(yt={}));function xp(t){return"storage/"+t}function B0(){const t="An unknown error occurred, please check the error payload for server response.";return new Dt(yt.UNKNOWN,t)}function U3(t){return new Dt(yt.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function B3(t){return new Dt(yt.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function $3(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Dt(yt.UNAUTHENTICATED,t)}function z3(){return new Dt(yt.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function q3(t){return new Dt(yt.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function kI(){return new Dt(yt.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function II(){return new Dt(yt.CANCELED,"User canceled the upload/download.")}function W3(t){return new Dt(yt.INVALID_URL,"Invalid URL '"+t+"'.")}function G3(t){return new Dt(yt.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function H3(){return new Dt(yt.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+jI+"' property when initializing the app?")}function CI(){return new Dt(yt.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function K3(){return new Dt(yt.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function Q3(){return new Dt(yt.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Y3(t){return new Dt(yt.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function ux(t){return new Dt(yt.INVALID_ARGUMENT,t)}function AI(){return new Dt(yt.APP_DELETED,"The Firebase app was deleted.")}function X3(t){return new Dt(yt.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Lc(t,e){return new Dt(yt.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function oc(t){throw new Dt(yt.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let s;try{s=hs.makeFromUrl(e,n)}catch{return new hs(e,"")}if(s.path==="")return s;throw G3(e)}static makeFromUrl(e,n){let s=null;const r="([A-Za-z0-9.\\-_]+)";function i(I){I.path.charAt(I.path.length-1)==="/"&&(I.path_=I.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+r+o,"i"),c={bucket:1,path:3};function u(I){I.path_=decodeURIComponent(I.path)}const h="v[A-Za-z0-9_]+",f=n.replace(/[.]/g,"\\."),m="(/([^?#]*).*)?$",x=new RegExp(`^https?://${f}/${h}/b/${r}/o${m}`,"i"),b={bucket:1,path:3},N=n===SI?"(?:storage.googleapis.com|storage.cloud.google.com)":n,E="([^?#]*)",w=new RegExp(`^https?://${N}/${r}/${E}`,"i"),T=[{regex:l,indices:c,postModify:i},{regex:x,indices:b,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let I=0;I<T.length;I++){const R=T[I],V=R.regex.exec(e);if(V){const j=V[R.indices.bucket];let y=V[R.indices.path];y||(y=""),s=new hs(j,y),R.postModify(s);break}}if(s==null)throw W3(e);return s}}class J3{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z3(t,e,n){let s=1,r=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function h(...E){u||(u=!0,e.apply(null,E))}function f(E){r=setTimeout(()=>{r=null,t(x,c())},E)}function m(){i&&clearTimeout(i)}function x(E,...w){if(u){m();return}if(E){m(),h.call(null,E,...w);return}if(c()||o){m(),h.call(null,E,...w);return}s<64&&(s*=2);let T;l===1?(l=2,T=0):T=(s+Math.random())*1e3,f(T)}let b=!1;function N(E){b||(b=!0,m(),!u&&(r!==null?(E||(l=2),clearTimeout(r),f(0)):E||(l=1)))}return f(0),i=setTimeout(()=>{o=!0,N(!0)},n),N}function eU(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tU(t){return t!==void 0}function nU(t){return typeof t=="function"}function sU(t){return typeof t=="object"&&!Array.isArray(t)}function xm(t){return typeof t=="string"||t instanceof String}function fN(t){return $0()&&t instanceof Blob}function $0(){return typeof Blob<"u"}function mN(t,e,n,s){if(s<e)throw ux(`Invalid value for '${t}'. Expected ${e} or greater.`);if(s>n)throw ux(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ed(t,e,n){let s=e;return n==null&&(s=`https://${e}`),`${n}://${s}/v0${t}`}function RI(t){const e=encodeURIComponent;let n="?";for(const s in t)if(t.hasOwnProperty(s)){const r=e(s)+"="+e(t[s]);n=n+r+"&"}return n=n.slice(0,-1),n}var Ta;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ta||(Ta={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PI(t,e){const n=t>=500&&t<600,r=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||r||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rU{constructor(e,n,s,r,i,o,l,c,u,h,f,m=!0){this.url_=e,this.method_=n,this.headers_=s,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=h,this.connectionFactory_=f,this.retry=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((x,b)=>{this.resolve_=x,this.reject_=b,this.start_()})}start_(){const e=(s,r)=>{if(r){s(!1,new zd(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Ta.NO_ERROR,c=i.getStatus();if(!l||PI(c,this.additionalRetryCodes_)&&this.retry){const h=i.getErrorCode()===Ta.ABORT;s(!1,new zd(!1,null,h));return}const u=this.successCodes_.indexOf(c)!==-1;s(!0,new zd(u,i))})},n=(s,r)=>{const i=this.resolve_,o=this.reject_,l=r.connection;if(r.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());tU(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=B0();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(r.canceled){const c=this.appDelete_?AI():II();o(c)}else{const c=kI();o(c)}};this.canceled_?n(!1,new zd(!1,null,!0)):this.backoffId_=Z3(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&eU(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class zd{constructor(e,n,s){this.wasSuccessCode=e,this.connection=n,this.canceled=!!s}}function iU(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function aU(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function oU(t,e){e&&(t["X-Firebase-GMPID"]=e)}function lU(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function cU(t,e,n,s,r,i,o=!0){const l=RI(t.urlParams),c=t.url+l,u=Object.assign({},t.headers);return oU(u,e),iU(u,n),aU(u,i),lU(u,s),new rU(c,t.method,u,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uU(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function dU(...t){const e=uU();if(e!==void 0){const n=new e;for(let s=0;s<t.length;s++)n.append(t[s]);return n.getBlob()}else{if($0())return new Blob(t);throw new Dt(yt.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function hU(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fU(t){if(typeof atob>"u")throw Y3("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rr={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class yp{constructor(e,n){this.data=e,this.contentType=n||null}}function mU(t,e){switch(t){case rr.RAW:return new yp(DI(e));case rr.BASE64:case rr.BASE64URL:return new yp(VI(t,e));case rr.DATA_URL:return new yp(gU(e),xU(e))}throw B0()}function DI(t){const e=[];for(let n=0;n<t.length;n++){let s=t.charCodeAt(n);if(s<=127)e.push(s);else if(s<=2047)e.push(192|s>>6,128|s&63);else if((s&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=s,o=t.charCodeAt(++n);s=65536|(i&1023)<<10|o&1023,e.push(240|s>>18,128|s>>12&63,128|s>>6&63,128|s&63)}else(s&64512)===56320?e.push(239,191,189):e.push(224|s>>12,128|s>>6&63,128|s&63)}return new Uint8Array(e)}function pU(t){let e;try{e=decodeURIComponent(t)}catch{throw Lc(rr.DATA_URL,"Malformed data URL.")}return DI(e)}function VI(t,e){switch(t){case rr.BASE64:{const r=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(r||i)throw Lc(t,"Invalid character '"+(r?"-":"_")+"' found: is it base64url encoded?");break}case rr.BASE64URL:{const r=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(r||i)throw Lc(t,"Invalid character '"+(r?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=fU(e)}catch(r){throw r.message.includes("polyfill")?r:Lc(t,"Invalid character found")}const s=new Uint8Array(n.length);for(let r=0;r<n.length;r++)s[r]=n.charCodeAt(r);return s}class MI{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw Lc(rr.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const s=n[1]||null;s!=null&&(this.base64=yU(s,";base64"),this.contentType=this.base64?s.substring(0,s.length-7):s),this.rest=e.substring(e.indexOf(",")+1)}}function gU(t){const e=new MI(t);return e.base64?VI(rr.BASE64,e.rest):pU(e.rest)}function xU(t){return new MI(t).contentType}function yU(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _r{constructor(e,n){let s=0,r="";fN(e)?(this.data_=e,s=e.size,r=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),s=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),s=e.length),this.size_=s,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,n){if(fN(this.data_)){const s=this.data_,r=hU(s,e,n);return r===null?null:new _r(r)}else{const s=new Uint8Array(this.data_.buffer,e,n-e);return new _r(s,!0)}}static getBlob(...e){if($0()){const n=e.map(s=>s instanceof _r?s.data_:s);return new _r(dU.apply(null,n))}else{const n=e.map(o=>xm(o)?mU(rr.RAW,o).data:o.data_);let s=0;n.forEach(o=>{s+=o.byteLength});const r=new Uint8Array(s);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)r[i++]=o[l]}),new _r(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LI(t){let e;try{e=JSON.parse(t)}catch{return null}return sU(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vU(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function bU(t,e){const n=e.split("/").filter(s=>s.length>0).join("/");return t.length===0?n:t+"/"+n}function OI(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wU(t,e){return e}class Mn{constructor(e,n,s,r){this.server=e,this.local=n||e,this.writable=!!s,this.xform=r||wU}}let qd=null;function _U(t){return!xm(t)||t.length<2?t:OI(t)}function z0(){if(qd)return qd;const t=[];t.push(new Mn("bucket")),t.push(new Mn("generation")),t.push(new Mn("metageneration")),t.push(new Mn("name","fullPath",!0));function e(i,o){return _U(o)}const n=new Mn("name");n.xform=e,t.push(n);function s(i,o){return o!==void 0?Number(o):o}const r=new Mn("size");return r.xform=s,t.push(r),t.push(new Mn("timeCreated")),t.push(new Mn("updated")),t.push(new Mn("md5Hash",null,!0)),t.push(new Mn("cacheControl",null,!0)),t.push(new Mn("contentDisposition",null,!0)),t.push(new Mn("contentEncoding",null,!0)),t.push(new Mn("contentLanguage",null,!0)),t.push(new Mn("contentType",null,!0)),t.push(new Mn("metadata","customMetadata",!0)),qd=t,qd}function NU(t,e){function n(){const s=t.bucket,r=t.fullPath,i=new hs(s,r);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function EU(t,e,n){const s={};s.type="file";const r=n.length;for(let i=0;i<r;i++){const o=n[i];s[o.local]=o.xform(s,e[o.server])}return NU(s,t),s}function FI(t,e,n){const s=LI(e);return s===null?null:EU(t,s,n)}function TU(t,e,n,s){const r=LI(e);if(r===null||!xm(r.downloadTokens))return null;const i=r.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const h=t.bucket,f=t.fullPath,m="/b/"+o(h)+"/o/"+o(f),x=ed(m,n,s),b=RI({alt:"media",token:u});return x+b})[0]}function UI(t,e){const n={},s=e.length;for(let r=0;r<s;r++){const i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class Cl{constructor(e,n,s,r){this.url=e,this.method=n,this.handler=s,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rr(t){if(!t)throw B0()}function q0(t,e){function n(s,r){const i=FI(t,r,e);return Rr(i!==null),i}return n}function SU(t,e){function n(s,r){const i=FI(t,r,e);return Rr(i!==null),TU(i,r,t.host,t._protocol)}return n}function td(t){function e(n,s){let r;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?r=z3():r=$3():n.getStatus()===402?r=B3(t.bucket):n.getStatus()===403?r=q3(t.path):r=s,r.status=n.getStatus(),r.serverResponse=s.serverResponse,r}return e}function BI(t){const e=td(t);function n(s,r){let i=e(s,r);return s.getStatus()===404&&(i=U3(t.path)),i.serverResponse=r.serverResponse,i}return n}function jU(t,e,n){const s=e.fullServerUrl(),r=ed(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new Cl(r,i,q0(t,n),o);return l.errorHandler=BI(e),l}function kU(t,e,n){const s=e.fullServerUrl(),r=ed(s,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new Cl(r,i,SU(t,n),o);return l.errorHandler=BI(e),l}function IU(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function $I(t,e,n){const s=Object.assign({},n);return s.fullPath=t.path,s.size=e.size(),s.contentType||(s.contentType=IU(null,e)),s}function zI(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let T="";for(let I=0;I<2;I++)T=T+Math.random().toString().slice(2);return T}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=$I(e,s,r),h=UI(u,n),f="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+h+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,m=`\r
--`+c+"--",x=_r.getBlob(f,s,m);if(x===null)throw CI();const b={name:u.fullPath},N=ed(i,t.host,t._protocol),E="POST",w=t.maxUploadRetryTime,v=new Cl(N,E,q0(t,n),w);return v.urlParams=b,v.headers=o,v.body=x.uploadData(),v.errorHandler=td(e),v}class bf{constructor(e,n,s,r){this.current=e,this.total=n,this.finalized=!!s,this.metadata=r||null}}function W0(t,e){let n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Rr(!1)}return Rr(!!n&&(e||["active"]).indexOf(n)!==-1),n}function CU(t,e,n,s,r){const i=e.bucketOnlyServerUrl(),o=$I(e,s,r),l={name:o.fullPath},c=ed(i,t.host,t._protocol),u="POST",h={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${s.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},f=UI(o,n),m=t.maxUploadRetryTime;function x(N){W0(N);let E;try{E=N.getResponseHeader("X-Goog-Upload-URL")}catch{Rr(!1)}return Rr(xm(E)),E}const b=new Cl(c,u,x,m);return b.urlParams=l,b.headers=h,b.body=f,b.errorHandler=td(e),b}function AU(t,e,n,s){const r={"X-Goog-Upload-Command":"query"};function i(u){const h=W0(u,["active","final"]);let f=null;try{f=u.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Rr(!1)}f||Rr(!1);const m=Number(f);return Rr(!isNaN(m)),new bf(m,s.size(),h==="final")}const o="POST",l=t.maxUploadRetryTime,c=new Cl(n,o,i,l);return c.headers=r,c.errorHandler=td(e),c}const pN=256*1024;function RU(t,e,n,s,r,i,o,l){const c=new bf(0,0);if(o?(c.current=o.current,c.total=o.total):(c.current=0,c.total=s.size()),s.size()!==c.total)throw K3();const u=c.total-c.current;let h=u;r>0&&(h=Math.min(h,r));const f=c.current,m=f+h;let x="";h===0?x="finalize":u===h?x="upload, finalize":x="upload";const b={"X-Goog-Upload-Command":x,"X-Goog-Upload-Offset":`${c.current}`},N=s.slice(f,m);if(N===null)throw CI();function E(I,R){const V=W0(I,["active","final"]),j=c.current+h,y=s.size();let k;return V==="final"?k=q0(e,i)(I,R):k=null,new bf(j,y,V==="final",k)}const w="POST",v=e.maxUploadRetryTime,T=new Cl(n,w,E,v);return T.headers=b,T.body=N.uploadData(),T.progressCallback=l||null,T.errorHandler=td(t),T}const Qn={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function vp(t){switch(t){case"running":case"pausing":case"canceling":return Qn.RUNNING;case"paused":return Qn.PAUSED;case"success":return Qn.SUCCESS;case"canceled":return Qn.CANCELED;case"error":return Qn.ERROR;default:return Qn.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PU{constructor(e,n,s){if(nU(e)||n!=null||s!=null)this.next=e,this.error=n??void 0,this.complete=s??void 0;else{const i=e;this.next=i.next,this.error=i.error,this.complete=i.complete}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t){return(...e)=>{Promise.resolve().then(()=>t(...e))}}class DU{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Ta.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Ta.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Ta.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,s,r){if(this.sent_)throw oc("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),r!==void 0)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw oc("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw oc("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw oc("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw oc("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class VU extends DU{initXhr(){this.xhr_.responseType="text"}}function fa(){return new VU}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MU{constructor(e,n,s=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=s,this._mappings=z0(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=r=>{if(this._request=void 0,this._chunkMultiplier=1,r._codeEquals(yt.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{const i=this.isExponentialBackoffExpired();if(PI(r.status,[]))if(i)r=kI();else{this.sleepTime=Math.max(this.sleepTime*2,F3),this._needToFetchStatus=!0,this.completeTransitions_();return}this._error=r,this._transition("error")}},this._metadataErrorHandler=r=>{this._request=void 0,r._codeEquals(yt.CANCELED)?this.completeTransitions_():(this._error=r,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((r,i)=>{this._resolve=r,this._reject=i,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){const e=this._transferred;return n=>this._updateProgress(e+n)}_shouldDoResumable(e){return e.size()>256*1024}_start(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([n,s])=>{switch(this._state){case"running":e(n,s);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((e,n)=>{const s=CU(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,fa,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._uploadUrl=i,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const e=this._uploadUrl;this._resolveToken((n,s)=>{const r=AU(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,fa,n,s);this._request=i,i.getPromise().then(o=>{o=o,this._request=void 0,this._updateProgress(o.current),this._needToFetchStatus=!1,o.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const e=pN*this._chunkMultiplier,n=new bf(this._transferred,this._blob.size()),s=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=RU(this._ref._location,this._ref.storage,s,this._blob,e,this._mappings,n,this._makeProgressCallback())}catch(c){this._error=c,this._transition("error");return}const l=this._ref.storage._makeRequest(o,fa,r,i,!1);this._request=l,l.getPromise().then(c=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(c.current),c.finalized?(this._metadata=c.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){pN*this._chunkMultiplier*2<32*1024*1024&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,n)=>{const s=jU(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(s,fa,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,n)=>{const s=zI(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(s,fa,e,n);this._request=r,r.getPromise().then(i=>{this._request=void 0,this._metadata=i,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){const n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,this._request!==void 0?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":const n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=II(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const e=vp(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,n,s,r){const i=new PU(n||void 0,s||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,n){return this._promise.then(e,n)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){const n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)}_notifyObservers(){this._finishPromise(),this._observers.slice().forEach(n=>{this._notifyObserver(n)})}_finishPromise(){if(this._resolve!==void 0){let e=!0;switch(vp(this._state)){case Qn.SUCCESS:mo(this._resolve.bind(null,this.snapshot))();break;case Qn.CANCELED:case Qn.ERROR:const n=this._reject;mo(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){switch(vp(this._state)){case Qn.RUNNING:case Qn.PAUSED:e.next&&mo(e.next.bind(e,this.snapshot))();break;case Qn.SUCCESS:e.complete&&mo(e.complete.bind(e))();break;case Qn.CANCELED:case Qn.ERROR:e.error&&mo(e.error.bind(e,this._error))();break;default:e.error&&mo(e.error.bind(e,this._error))()}}resume(){const e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e}pause(){const e=this._state==="running";return e&&this._transition("pausing"),e}cancel(){const e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qa{constructor(e,n){this._service=e,n instanceof hs?this._location=n:this._location=hs.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new qa(e,n)}get root(){const e=new hs(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return OI(this._location.path)}get storage(){return this._service}get parent(){const e=vU(this._location.path);if(e===null)return null;const n=new hs(this._location.bucket,e);return new qa(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw X3(e)}}function LU(t,e,n){t._throwIfRoot("uploadBytes");const s=zI(t.storage,t._location,z0(),new _r(e,!0),n);return t.storage.makeRequestWithTokens(s,fa).then(r=>({metadata:r,ref:t}))}function OU(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new MU(t,new _r(e),n)}function FU(t){t._throwIfRoot("getDownloadURL");const e=kU(t.storage,t._location,z0());return t.storage.makeRequestWithTokens(e,fa).then(n=>{if(n===null)throw Q3();return n})}function UU(t,e){const n=bU(t._location.path,e),s=new hs(t._location.bucket,n);return new qa(t.storage,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BU(t){return/^[A-Za-z]+:\/\//.test(t)}function $U(t,e){return new qa(t,e)}function qI(t,e){if(t instanceof G0){const n=t;if(n._bucket==null)throw H3();const s=new qa(n,n._bucket);return e!=null?qI(s,e):s}else return e!==void 0?UU(t,e):t}function zU(t,e){if(e&&BU(e)){if(t instanceof G0)return $U(t,e);throw ux("To use ref(service, url), the first argument must be a Storage instance.")}else return qI(t,e)}function gN(t,e){const n=e==null?void 0:e[jI];return n==null?null:hs.makeFromBucketSpec(n,t)}function qU(t,e,n,s={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:r}=s;r&&(t._overrideAuthToken=typeof r=="string"?r:A3(r,t.app.options.projectId))}class G0{constructor(e,n,s,r,i){this.app=e,this._authProvider=n,this._appCheckProvider=s,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=SI,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=L3,this._maxUploadRetryTime=O3,this._requests=new Set,r!=null?this._bucket=hs.makeFromBucketSpec(r,this._host):this._bucket=gN(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=hs.makeFromBucketSpec(this._url,e):this._bucket=gN(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){mN("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){mN("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new qa(this,e)}_makeRequest(e,n,s,r,i=!0){if(this._deleted)return new J3(AI());{const o=cU(e,this._appId,s,r,n,this._firebaseVersion,i);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[s,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,s,r).getPromise()}}const xN="@firebase/storage",yN="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WI="storage";function An(t,e,n){return t=Zu(t),LU(t,e,n)}function bp(t,e,n){return t=Zu(t),OU(t,e,n)}function nn(t){return t=Zu(t),FU(t)}function sn(t,e){return t=Zu(t),zU(t,e)}function WU(t=Py(),e){t=Zu(t);const s=Du(t,WI).getImmediate({identifier:e}),r=C3("storage");return r&&GU(s,...r),s}function GU(t,e,n,s={}){qU(t,e,n,s)}function HU(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),s=t.getProvider("auth-internal"),r=t.getProvider("app-check-internal");return new G0(n,s,r,e,Ka)}function KU(){Vi(new M3(WI,HU,"PUBLIC").setMultipleInstances(!0)),Is(xN,yN,""),Is(xN,yN,"esm2017")}KU();var vN={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QU=function(t){const e=[];let n=0;for(let s=0;s<t.length;s++){let r=t.charCodeAt(s);r<128?e[n++]=r:r<2048?(e[n++]=r>>6|192,e[n++]=r&63|128):(r&64512)===55296&&s+1<t.length&&(t.charCodeAt(s+1)&64512)===56320?(r=65536+((r&1023)<<10)+(t.charCodeAt(++s)&1023),e[n++]=r>>18|240,e[n++]=r>>12&63|128,e[n++]=r>>6&63|128,e[n++]=r&63|128):(e[n++]=r>>12|224,e[n++]=r>>6&63|128,e[n++]=r&63|128)}return e},YU=function(t){const e=[];let n=0,s=0;for(;n<t.length;){const r=t[n++];if(r<128)e[s++]=String.fromCharCode(r);else if(r>191&&r<224){const i=t[n++];e[s++]=String.fromCharCode((r&31)<<6|i&63)}else if(r>239&&r<365){const i=t[n++],o=t[n++],l=t[n++],c=((r&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[s++]=String.fromCharCode(55296+(c>>10)),e[s++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[s++]=String.fromCharCode((r&15)<<12|(i&63)<<6|o&63)}}return e.join("")},XU={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,s=[];for(let r=0;r<t.length;r+=3){const i=t[r],o=r+1<t.length,l=o?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,h=i>>2,f=(i&3)<<4|l>>4;let m=(l&15)<<2|u>>6,x=u&63;c||(x=64,o||(m=64)),s.push(n[h],n[f],n[m],n[x])}return s.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(QU(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):YU(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,s=[];for(let r=0;r<t.length;){const i=n[t.charAt(r++)],l=r<t.length?n[t.charAt(r)]:0;++r;const u=r<t.length?n[t.charAt(r)]:64;++r;const f=r<t.length?n[t.charAt(r)]:64;if(++r,i==null||l==null||u==null||f==null)throw new JU;const m=i<<2|l>>4;if(s.push(m),u!==64){const x=l<<4&240|u>>2;if(s.push(x),f!==64){const b=u<<6&192|f;s.push(b)}}}return s},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class JU extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const ZU=function(t){try{return XU.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=()=>eB().__FIREBASE_DEFAULTS__,nB=()=>{if(typeof process>"u"||typeof vN>"u")return;const t=vN.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},sB=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&ZU(t[1]);return e&&JSON.parse(e)},rB=()=>{try{return tB()||nB()||sB()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},iB=t=>{var e,n;return(n=(e=rB())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},aB=t=>{const e=iB(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const s=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),s]:[e.substring(0,n),s]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oB="FirebaseError";class ym extends Error{constructor(e,n,s){super(n),this.code=e,this.customData=s,this.name=oB,Object.setPrototypeOf(this,ym.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lB.prototype.create)}}class lB{constructor(e,n,s){this.service=e,this.serviceName=n,this.errors=s}create(e,...n){const s=n[0]||{},r=`${this.service}/${e}`,i=this.errors[e],o=i?cB(i,s):"Error",l=`${this.serviceName}: ${o} (${r}).`;return new ym(r,l,s)}}function cB(t,e){return t.replace(uB,(n,s)=>{const r=e[s];return r!=null?String(r):`<${s}?>`})}const uB=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t){return t&&t._delegate?t._delegate:t}class dB{constructor(e,n,s){this.name=e,this.instanceFactory=n,this.type=s,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hB="type.googleapis.com/google.protobuf.Int64Value",fB="type.googleapis.com/google.protobuf.UInt64Value";function GI(t,e){const n={};for(const s in t)t.hasOwnProperty(s)&&(n[s]=e(t[s]));return n}function dx(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>dx(e));if(typeof t=="function"||typeof t=="object")return GI(t,e=>dx(e));throw new Error("Data cannot be encoded in JSON: "+t)}function wf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case hB:case fB:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>wf(e)):typeof t=="function"||typeof t=="object"?GI(t,e=>wf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K0="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bN={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Qo extends ym{constructor(e,n,s){super(`${K0}/${e}`,n||""),this.details=s}}function mB(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function pB(t,e){let n=mB(t),s=n,r;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!bN[o])return new Qo("internal","internal");n=bN[o],s=o}const l=i.message;typeof l=="string"&&(s=l),r=i.details,r!==void 0&&(r=wf(r))}}catch{}return n==="ok"?null:new Qo(n,s,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gB{constructor(e,n,s){this.auth=null,this.messaging=null,this.appCheck=null,this.auth=e.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||e.get().then(r=>this.auth=r,()=>{}),this.messaging||n.get().then(r=>this.messaging=r,()=>{}),this.appCheck||s.get().then(r=>this.appCheck=r,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),s=await this.getMessagingToken(),r=await this.getAppCheckToken(e);return{authToken:n,messagingToken:s,appCheckToken:r}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hx="us-central1";function xB(t){let e=null;return{promise:new Promise((n,s)=>{e=setTimeout(()=>{s(new Qo("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class yB{constructor(e,n,s,r,i=hx,o){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new gB(n,s,r),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=hx}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function vB(t,e,n){t.emulatorOrigin=`http://${e}:${n}`}function bB(t,e,n){return s=>_B(t,e,s,{})}async function wB(t,e,n,s){n["Content-Type"]="application/json";let r;try{r=await s(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await r.json()}catch{}return{status:r.status,json:i}}function _B(t,e,n,s){const r=t._url(e);return NB(t,r,n,s)}async function NB(t,e,n,s){n=dx(n);const r={data:n},i={},o=await t.contextProvider.getContext(s.limitedUseAppCheckTokens);o.authToken&&(i.Authorization="Bearer "+o.authToken),o.messagingToken&&(i["Firebase-Instance-ID-Token"]=o.messagingToken),o.appCheckToken!==null&&(i["X-Firebase-AppCheck"]=o.appCheckToken);const l=s.timeout||7e4,c=xB(l),u=await Promise.race([wB(e,r,i,t.fetchImpl),c.promise,t.cancelAllRequests]);if(c.cancel(),!u)throw new Qo("cancelled","Firebase Functions instance was deleted.");const h=pB(u.status,u.json);if(h)throw h;if(!u.json)throw new Qo("internal","Response is not valid JSON object.");let f=u.json.data;if(typeof f>"u"&&(f=u.json.result),typeof f>"u")throw new Qo("internal","Response is missing data field.");return{data:wf(f)}}const wN="@firebase/functions",_N="0.11.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EB="auth-internal",TB="app-check-internal",SB="messaging-internal";function jB(t,e){const n=(s,{instanceIdentifier:r})=>{const i=s.getProvider("app").getImmediate(),o=s.getProvider(EB),l=s.getProvider(SB),c=s.getProvider(TB);return new yB(i,o,l,c,r,t)};Vi(new dB(K0,n,"PUBLIC").setMultipleInstances(!0)),Is(wN,_N,e),Is(wN,_N,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(t=Py(),e=hx){const s=Du(H0(t),K0).getImmediate({identifier:e}),r=aB("functions");return r&&IB(s,...r),s}function IB(t,e,n){vB(H0(t),e,n)}function HI(t,e,n){return bB(H0(t),e)}jB(fetch.bind(self));const CB={apiKey:"AIzaSyCeBLEh6xtwDtnMWrj8N3As7tcJ_ZX8Yis",authDomain:"tukumi-7d3b8.firebaseapp.com",projectId:"tukumi-7d3b8",storageBucket:"tukumi-7d3b8.firebasestorage.app",messagingSenderId:"1040756277051",appId:"1:1040756277051:web:8d4604e5bbe7f35edc411e",measurementId:"G-WY8V9GB1RW"},vm=wj(CB),Ve=RL(vm),L=s3(vm,{localCache:m3({tabManager:y3()})}),rn=WU(vm),KI=kB(vm);vM(Ve,r1).catch(console.error);const AB=()=>{const t=tt(),e=Hs(),n=x=>e.pathname===x||x!=="/"&&e.pathname.startsWith(x+"/"),[s,r]=g.useState({displayName:"",handle:"",photoURL:null}),[i,o]=g.useState(!1),[l,c]=g.useState(0),[u,h]=g.useState(!1);g.useEffect(()=>{const x=Pt(Ve,b=>{if(b){const N={displayName:b.displayName||"Aristocrat",handle:b.email?b.email.split("@")[0]:"user-handle",photoURL:b.photoURL};r(N),h(!1);const E=Fe(H(L,"users",b.uid),w=>{if(w.exists()){const v=w.data();r(T=>({...T,...v,photoURL:v.photoURL||T.photoURL})),o(v.isAdmin||!1)}});return()=>E()}else r({displayName:"",handle:"",photoURL:null}),o(!1),c(0)});return()=>x()},[]),g.useEffect(()=>{const x=Ve.currentUser;if(!x)return;const b=qe(ae(L,"conversations"),rt("participants","array-contains",x.uid)),N=Fe(b,E=>{let w=0;E.docs.forEach(v=>{const T=v.data();T.unreadCounts&&T.unreadCounts[x.uid]&&(w+=T.unreadCounts[x.uid])}),c(w)},E=>{console.log("Sidebar chat listener:",E.code)});return()=>N()},[s.handle]);const f=async()=>{try{await Fu(Ve),t("/auth")}catch(x){console.error("Error signing out",x)}},m=({to:x,icon:b,label:N,badge:E})=>a.jsxs("div",{onClick:()=>t(x),className:`group flex items-center p-3 my-2 rounded-2xl cursor-pointer transition-all duration-200 font-medium
            ${n(x)&&x!=="/"||n(x)&&x==="/"&&e.pathname==="/"?"bg-primary text-white shadow-lg shadow-primary/30 translate-x-2":"text-gray-600 hover:bg-white hover:text-primary hover:translate-x-1"}`,children:[a.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center mr-3 transition-all
                ${n(x)?"bg-white/20":"bg-white shadow-sm group-hover:shadow-md"}`,children:a.jsx("i",{className:`fas ${b} text-lg`})}),a.jsx("span",{className:"tracking-wide",children:N}),E>0&&a.jsx("span",{className:"ml-auto bg-red-500 text-white text-[10px] font-bold px-2 py-1 rounded-full shadow-sm",children:E>99?"99+":E})]});return a.jsx("div",{className:"hidden md:flex flex-col w-[280px] h-[calc(100vh-40px)] fixed top-5 left-5 z-50",children:a.jsxs("div",{className:"glass-panel flex-1 rounded-[30px] p-6 flex flex-col overflow-y-auto no-scrollbar",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-10 pl-2 cursor-pointer",onClick:()=>t("/"),children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-tr from-primary to-gold rounded-xl flex items-center justify-center shadow-lg shadow-primary/20 relative",children:a.jsx("i",{className:"fas fa-cube text-white text-lg transform -rotate-12"})}),a.jsx("h1",{className:"text-2xl font-black tracking-tighter text-dark",children:"TUKUMI"})]}),a.jsxs("div",{onClick:()=>t("/profile"),className:"mb-8 p-3 bg-white/60 rounded-2xl border border-white flex items-center gap-3 cursor-pointer hover:shadow-md transition-all group",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex-shrink-0 overflow-hidden bg-gray-200 border border-white shadow-sm group-hover:scale-105 transition-transform flex items-center justify-center",children:s.photoURL&&!u?a.jsx("img",{src:s.photoURL,onError:()=>h(!0),className:"w-full h-full object-cover",alt:"Profile"}):a.jsx("i",{className:"fas fa-user text-gray-400 text-lg"})}),a.jsxs("div",{className:"min-w-0",children:[a.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:s.displayName||"User"}),a.jsx("p",{className:"text-[10px] text-primary font-bold uppercase tracking-wider",children:"View Profile"})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("p",{className:"text-[10px] uppercase tracking-[0.2em] text-gray-400 font-bold mb-3 pl-4",children:"Menu"}),a.jsx(m,{to:"/",icon:"fa-home",label:"Feed"}),a.jsx(m,{to:"/explore",icon:"fa-compass",label:"Explore"}),a.jsx(m,{to:"/circles",icon:"fa-dot-circle",label:"Circles"}),a.jsx(m,{to:"/dating",icon:"fa-heart",label:"Dating"}),a.jsx(m,{to:"/watch",icon:"fa-play",label:"Watch"}),a.jsx(m,{to:"/marketplace",icon:"fa-store",label:"Market"}),a.jsx(m,{to:"/messages",icon:"fa-comment-dots",label:"Shinobi",badge:l}),i&&a.jsx(m,{to:"/admin",icon:"fa-shield-alt",label:"Admin Panel"}),a.jsx(m,{to:"/boost",icon:"fa-rocket",label:"Boost"})]}),a.jsx("div",{className:"mt-auto pt-6 space-y-3",children:a.jsxs("button",{onClick:f,className:"w-full flex items-center justify-center gap-2 p-3 rounded-xl text-gray-500 hover:bg-red-50 hover:text-red-500 transition-all font-bold text-sm",children:[a.jsx("i",{className:"fas fa-sign-out-alt"})," Sign Out"]})})]})})},RB=()=>{const t=tt(),e=Hs(),n=N=>e.pathname===N,[s,r]=g.useState(!0),[i,o]=g.useState(0),l=g.useRef(null),c=g.useRef(!1),u=g.useRef(0),h=()=>{c.current=!1,l.current=setTimeout(()=>{c.current=!0,m()},3e3)},f=()=>{clearTimeout(l.current)},m=async()=>{if(navigator.vibrate&&navigator.vibrate(200),window.confirm("Do you want to sign out?"))try{await Fu(Ve)}catch(N){console.error(N)}},x=N=>{if(c.current)return;const E=new Date().getTime(),w=E-u.current;w<300&&w>0?(window.scrollTo({top:0,behavior:"smooth"}),navigator.vibrate&&navigator.vibrate(50)):e.pathname!=="/"&&t("/"),u.current=E};g.useEffect(()=>{const N=Pt(Ve,E=>{if(E){const w=qe(ae(L,"conversations"),rt("participants","array-contains",E.uid)),v=Fe(w,T=>{let I=0;T.docs.forEach(R=>{const V=R.data();V.unreadCounts&&V.unreadCounts[E.uid]&&(I+=V.unreadCounts[E.uid])}),o(I)},T=>{console.error("MobileNav error:",T)});return()=>v()}});return()=>N()},[]),g.useEffect(()=>{const N=v=>{(["input","textarea"].includes(v.target.tagName.toLowerCase())||v.target.isContentEditable)&&r(!1)},E=()=>{setTimeout(()=>{["input","textarea"].includes(document.activeElement.tagName.toLowerCase())||r(!0)},200)},w=v=>r(v.detail.visible);return document.addEventListener("focusin",N),document.addEventListener("focusout",E),window.addEventListener("toggle-nav",w),r(!0),()=>{document.removeEventListener("focusin",N),document.removeEventListener("focusout",E),window.removeEventListener("toggle-nav",w)}},[e.pathname]);const b=({to:N,icon:E,activeColor:w="text-primary",badgeCount:v=0})=>a.jsxs("button",{onClick:()=>t(N),className:`relative flex flex-col items-center justify-center w-full h-full transition-all duration-200 ${n(N)?`${w} -translate-y-1`:"text-gray-400 hover:text-gray-600"}`,children:[a.jsx("span",{className:`text-xl mb-1 ${n(N)?"drop-shadow-sm scale-110":""}`,children:a.jsx("i",{className:`fas ${E}`})}),n(N)&&a.jsx("span",{className:`absolute bottom-2 w-1 h-1 rounded-full ${n(N)&&N==="/dating"?"bg-pink-500":"bg-primary"}`}),v>0&&a.jsx("span",{className:"absolute top-2 right-3 bg-red-500 text-white text-[9px] font-bold min-w-[16px] h-[16px] flex items-center justify-center rounded-full border-2 border-white animate-bounce-in",children:v>9?"9+":v})]});return a.jsx("div",{className:`md:hidden fixed bottom-0 left-0 right-0 z-[90] transition-transform duration-300 ease-in-out ${s?"translate-y-0":"translate-y-full"}`,children:a.jsxs("div",{className:"h-[65px] bg-white/95 backdrop-blur-xl border-t border-gray-200 flex justify-between items-center shadow-[0_-5px_20px_rgba(0,0,0,0.05)] px-1 pb-safe",children:[a.jsx(b,{to:"/dating",icon:"fa-heart",activeColor:"text-pink-500"}),a.jsx(b,{to:"/circles",icon:"fa-dot-circle"}),a.jsx(b,{to:"/messages",icon:"fa-comment-dots",badgeCount:i}),a.jsx("div",{className:"relative -top-6 mx-1",children:a.jsx("button",{onMouseDown:h,onMouseUp:f,onTouchStart:h,onTouchEnd:f,onClick:x,className:"w-14 h-14 bg-gradient-to-tr from-primary to-gold rounded-2xl flex items-center justify-center text-white shadow-lg shadow-primary/40 border-4 border-white transform active:scale-95 transition-transform select-none",children:a.jsx("i",{className:"fas fa-cube text-2xl"})})}),a.jsx(b,{to:"/watch",icon:"fa-play"}),a.jsx(b,{to:"/marketplace",icon:"fa-store"}),a.jsx(b,{to:"/profile",icon:"fa-user"})]})})},QI=g.createContext(),Q0=()=>{const t=g.useContext(QI);if(!t)throw new Error("useCall must be used within a CallProvider");return t},PB=({children:t})=>{const[e,n]=g.useState(null),[s,r]=g.useState(null),[i,o]=g.useState(null),[l,c]=g.useState(!1),[u,h]=g.useState(null),f=g.useRef(null),m=g.useRef(null);g.useEffect(()=>{m.current=new Audio("https://assets.mixkit.co/active_storage/sfx/2869/2869-preview.mp3"),m.current.loop=!0;const I=Pt(Ve,R=>{n(R)});return()=>{I(),b()}},[]);const x=async()=>{try{m.current&&(m.current.currentTime=0,await m.current.play())}catch(I){console.warn("Autoplay prevented:",I)}},b=()=>{m.current&&(m.current.pause(),m.current.currentTime=0)},N=async(I,R,V="system")=>{if(I)try{await ze(ae(L,`conversations/${I}/messages`),{text:R,senderId:(e==null?void 0:e.uid)||"system",senderName:"System",type:V,timestamp:Ie(),status:"sent"}),await he(H(L,"conversations",I),{lastMessage:R,updatedAt:Ie()})}catch(j){console.error("Log error:",j)}};g.useEffect(()=>{if(!e)return;const I=qe(ae(L,"calls"),rt("receiverId","==",e.uid),rt("status","==","ringing"),_t("timestamp","desc"),Ur(1)),R=Fe(I,V=>{var j;if(V.empty)i&&(o(null),b());else{const y={id:V.docs[0].id,...V.docs[0].data()},k=(j=y.timestamp)==null?void 0:j.toDate().getTime(),S=Date.now();if(k&&S-k>3e4){he(H(L,"calls",y.id),{status:"missed"});return}!s&&!i&&(o(y),x())}},V=>console.error("Call Listener Error:",V));return()=>{R(),b()}},[e,s]);const E=async(I,R,V,j="video",y)=>{if(e)try{const k=y||null,S=await ze(ae(L,"calls"),{callerId:e.uid,callerName:e.displayName||"Unknown",callerAvatar:e.photoURL||null,receiverId:I,receiverName:R,receiverAvatar:V,conversationId:k,type:j,status:"ringing",timestamp:Ie(),offer:null,answer:null});f.current=Date.now(),r({id:S.id,isCaller:!0,otherUser:{name:R,avatar:V},type:j,conversationId:k})}catch(k){console.error("Error starting call:",k),alert("Could not connect call. Check internet connection.")}},w=()=>{i&&(b(),f.current=Date.now(),r({id:i.id,isCaller:!1,otherUser:{name:i.callerName,avatar:i.callerAvatar},type:i.type,conversationId:i.conversationId}),o(null))},v=async()=>{if(i){b();try{await he(H(L,"calls",i.id),{status:"rejected"}),i.conversationId&&await N(i.conversationId," Call declined (Busy)")}catch(I){console.error(I)}o(null)}},T=async()=>{if(!s)return;let I="";if(f.current){const V=Math.floor((Date.now()-f.current)/1e3),j=Math.floor(V/60),y=V%60;I=` (${j}:${y.toString().padStart(2,"0")})`}const R=` Call ended${I}`;try{await he(H(L,"calls",s.id),{status:"ended"}),s.conversationId&&await N(s.conversationId,R)}catch{}r(null),c(!1),f.current=null};return a.jsx(QI.Provider,{value:{user:e,activeCall:s,setActiveCall:r,incomingCall:i,startCall:E,answerCall:w,declineCall:v,endActiveCall:T,isMinimized:l,setIsMinimized:c,viewingChatId:u,setViewingChatId:h},children:t})},DB=()=>{const t=tt(),{incomingCall:e,answerCall:n,declineCall:s,viewingChatId:r}=Q0(),[i,o]=g.useState(null),[l,c]=g.useState(null),u=g.useRef(null),h=g.useRef(null),f=g.useRef(new Set);g.useEffect(()=>(u.current=new Audio("https://assets.mixkit.co/active_storage/sfx/2346/2346-preview.mp3"),h.current=new Audio("https://assets.mixkit.co/active_storage/sfx/1359/1359-preview.mp3"),h.current&&(h.current.loop=!0,h.current.volume=.8),Pt(Ve,x=>{if(o(x),x){const b=qe(ae(L,"conversations"),rt("participants","array-contains",x.uid),_t("updatedAt","desc"),Ur(5)),N=Fe(b,E=>{E.docChanges().forEach(w=>{var v,T,I;if(w.type==="modified"||w.type==="added"){const R=w.doc.data(),V=((v=R.updatedAt)==null?void 0:v.seconds)>Date.now()/1e3-5,j=R.lastSenderId||R.lastMessageSenderId,y=j&&j!==x.uid,k=w.doc.id+"_"+((T=R.updatedAt)==null?void 0:T.seconds),S=f.current.has(k),D=r===w.doc.id;if(V&&y&&!S&&!D){f.current.add(k);const P=(I=R.users)==null?void 0:I.find(C=>C.uid!==x.uid);c({id:w.doc.id,senderName:(P==null?void 0:P.displayName)||"Someone",senderAvatar:P==null?void 0:P.photoURL,text:R.lastMessage}),u.current&&(u.current.currentTime=0,u.current.play().catch(()=>{})),setTimeout(()=>c(null),4e3)}}})});return()=>N()}}),()=>{h.current&&(h.current.pause(),h.current.currentTime=0)}),[r]),g.useEffect(()=>{e?h.current&&h.current.paused&&(h.current.currentTime=0,h.current.play().catch(()=>{})):h.current&&(h.current.pause(),h.current.currentTime=0)},[e]);const m=()=>{e&&(n(e),t("/messages"))};return a.jsxs("div",{className:"fixed z-[9999] pointer-events-none inset-0 flex flex-col items-center pt-4 px-4",children:[e&&a.jsxs("div",{className:"pointer-events-auto bg-gray-900/95 backdrop-blur-md text-white p-4 rounded-2xl shadow-2xl w-full max-w-sm flex items-center gap-4 animate-slide-down border border-white/10",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:e.callerAvatar||"https://via.placeholder.com/50",className:"w-14 h-14 rounded-full border-2 border-green-500 animate-pulse object-cover"}),a.jsx("div",{className:"absolute -bottom-1 -right-1 bg-green-500 rounded-full p-1",children:a.jsx("i",{className:"fas fa-phone text-xs"})})]}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-lg truncate",children:e.callerName}),a.jsxs("p",{className:"text-xs text-gray-300 flex items-center gap-1",children:[e.type==="video"?"Video Call":"Audio Call","..."]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:s,className:"w-10 h-10 rounded-full bg-red-500 hover:bg-red-600 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("button",{onClick:m,className:"w-10 h-10 rounded-full bg-green-500 hover:bg-green-600 flex items-center justify-center animate-bounce",children:a.jsx("i",{className:"fas fa-phone"})})]})]}),l&&!e&&a.jsxs("div",{onClick:()=>{t("/messages",{state:{activeConversationId:l.id}}),c(null)},className:"pointer-events-auto mt-4 bg-white/90 backdrop-blur-xl p-3 rounded-2xl shadow-lg border border-gray-100 flex items-center gap-3 w-full max-w-sm cursor-pointer hover:scale-105 transition-all animate-fade-in-up",children:[a.jsx("img",{src:l.senderAvatar||"https://via.placeholder.com/40",className:"w-10 h-10 rounded-full object-cover"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h5",{className:"font-black text-dark text-sm",children:l.senderName}),a.jsx("p",{className:"text-gray-600 text-xs truncate",children:l.text})]}),a.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})]})},VB=()=>{g.useEffect(()=>{console.log("Auth Page Mounted. Auth instance:",Ve?"Present":"Missing")},[]);const[t,e]=g.useState(!1),[n,s]=g.useState(!1),[r,i]=g.useState(!1),[o,l]=g.useState(null),[c,u]=g.useState(null),[h,f]=g.useState(""),[m,x]=g.useState(""),[b,N]=g.useState(""),[E,w]=g.useState(""),[v,T]=g.useState(""),[I,R]=g.useState(""),V=async y=>{if(y.preventDefault(),!h)return l("Please enter your email address.");i(!0),l(null),u(null);try{await e1(Ve,h),console.log("Reset attempt processed for:",h),u("If this email is registered, we have sent a reset link. Check your Inbox and Spam."),setTimeout(()=>s(!1),5e3)}catch(k){console.error("Reset email failed:",k),l(k.message)}finally{i(!1)}},j=async y=>{y.preventDefault(),l(null),i(!0);try{if(t){if(!b||!E||!v||!I)throw new Error("Please fill in all fields to continue.");const S=(await pM(Ve,h,m)).user;await yM(S,{displayName:b}),await t1(S),alert("Account created! Please check your email for verification."),await Ir(H(L,"users",S.uid),{uid:S.uid,displayName:b,email:S.email,handle:b.toLowerCase().replace(/\s+/g,"_")+Math.floor(Math.random()*1e3),birthday:E,gender:v,profession:I,isDatingActive:!1,photoURL:null,coverPhotoURL:"https://images.unsplash.com/photo-1579546929518-9e396f3cc809",bio:`I am a ${I}. New to Tukumi.`,joinedAt:Ie(),followers:0,following:0})}else await gM(Ve,h,m)}catch(k){console.error("Auth Error:",k);let S=k.message;k.code==="auth/invalid-credential"&&(S="Invalid email or password."),k.code==="auth/user-not-found"&&(S="No account found with this email."),k.code==="auth/wrong-password"&&(S="Incorrect password."),l(S),i(!1)}};return a.jsxs("div",{className:"min-h-screen w-full flex items-center justify-center p-4 relative overflow-hidden bg-[#f0f4f8]",children:[a.jsx("div",{className:"absolute top-0 left-0 w-[500px] h-[500px] bg-primary/20 rounded-full blur-[120px] -translate-x-1/2 -translate-y-1/2 animate-pulse"}),a.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gold/20 rounded-full blur-[120px] translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),a.jsxs("div",{className:"glass-panel w-full max-w-5xl min-h-[600px] rounded-[40px] flex overflow-hidden shadow-2xl relative z-10",children:[a.jsxs("div",{className:"hidden md:flex flex-1 bg-gradient-to-br from-primary to-primary-dark text-white flex-col justify-center p-12 relative overflow-hidden",children:[a.jsx("div",{className:"absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/cubes.png')] opacity-10"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("div",{className:"w-20 h-20 mb-8 relative perspective-container group",children:a.jsx("div",{className:"w-16 h-16 bg-white/20 backdrop-blur-md rounded-xl border border-white/40 shadow-2xl flex items-center justify-center transform rotate-12 transition-transform duration-700 group-hover:rotate-[360deg]",children:a.jsx("div",{className:"w-10 h-10 bg-gold/80 rounded-lg shadow-inner"})})}),a.jsx("h1",{className:"text-5xl font-black tracking-tight mb-4 drop-shadow-sm",children:"TUKUMI"}),a.jsxs("p",{className:"text-lg text-white/90 font-medium leading-relaxed",children:["The aristocratic social network. ",a.jsx("br",{}),"Connect, Trade, and Date in a premium environment."]})]})]}),a.jsx("div",{className:"flex-1 bg-white/80 backdrop-blur-xl p-8 md:p-12 flex flex-col justify-center relative overflow-y-auto",children:a.jsx("div",{className:"max-w-md mx-auto w-full",children:n?a.jsxs("div",{className:"animate-fade-in",children:[a.jsxs("button",{onClick:()=>s(!1),className:"text-gray-400 hover:text-dark mb-4 flex items-center gap-2 font-bold text-sm",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Login"]}),a.jsx("h2",{className:"text-3xl font-black text-dark mb-2",children:"Reset Password"}),a.jsx("p",{className:"text-gray-500 font-medium mb-8",children:"Enter your email and we'll send you a link to get back into your account."}),a.jsxs("form",{onSubmit:V,className:"space-y-5",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx("i",{className:"fas fa-envelope absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"email",placeholder:"you@example.com",required:!0,className:"w-full bg-white border border-gray-200 rounded-xl pl-10 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all font-bold text-dark",value:h,onChange:y=>f(y.target.value)})]})]}),o&&a.jsx("div",{className:"text-red-500 text-sm font-bold bg-red-50 p-3 rounded-xl",children:o}),c&&a.jsx("div",{className:"text-green-600 text-sm font-bold bg-green-50 p-3 rounded-xl",children:c}),a.jsx("button",{type:"submit",disabled:r,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg disabled:opacity-70",children:r?"Sending...":"Send Reset Link"})]})]}):a.jsxs(a.Fragment,{children:[a.jsx("h2",{className:"text-3xl font-black text-dark mb-2",children:t?"Join the Elite":"Welcome Back"}),a.jsx("p",{className:"text-gray-500 font-medium mb-8",children:t?"Create your identity to get started.":"Enter your credentials to access your account."}),a.jsxs("form",{className:"space-y-5",onSubmit:j,children:[t&&a.jsxs("div",{className:"animate-fade-in space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Full Name"}),a.jsxs("div",{className:"relative",children:[a.jsx("i",{className:"fas fa-user absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Your Name",required:t,className:"w-full bg-white border border-gray-200 rounded-xl pl-10 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all font-bold text-dark placeholder-gray-300",value:b,onChange:y=>N(y.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Profession"}),a.jsxs("div",{className:"relative",children:[a.jsx("i",{className:"fas fa-briefcase absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"e.g. Software Engineer",required:t,className:"w-full bg-white border border-gray-200 rounded-xl pl-10 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all font-bold text-dark placeholder-gray-300",value:I,onChange:y=>R(y.target.value)})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Birthday"}),a.jsx("input",{type:"date",required:t,className:"w-full bg-white border border-gray-200 rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all text-sm font-bold text-dark",value:E,onChange:y=>w(y.target.value)})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Gender"}),a.jsxs("select",{required:t,className:"w-full bg-white border border-gray-200 rounded-xl px-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all text-sm font-bold text-dark appearance-none cursor-pointer",value:v,onChange:y=>T(y.target.value),children:[a.jsx("option",{value:"",disabled:!0,children:"Select..."}),a.jsx("option",{value:"Male",children:"Male"}),a.jsx("option",{value:"Female",children:"Female"}),a.jsx("option",{value:"Non-binary",children:"Non-binary"}),a.jsx("option",{value:"Other",children:"Other"})]})]})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Email Address"}),a.jsxs("div",{className:"relative",children:[a.jsx("i",{className:"fas fa-envelope absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"email",placeholder:"you@example.com",required:!0,className:"w-full bg-white border border-gray-200 rounded-xl pl-10 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all font-bold text-dark placeholder-gray-300",value:h,onChange:y=>f(y.target.value)})]})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider ml-1",children:"Password"}),a.jsxs("div",{className:"relative",children:[a.jsx("i",{className:"fas fa-lock absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"password",placeholder:"",required:!0,className:"w-full bg-white border border-gray-200 rounded-xl pl-10 pr-4 py-3 outline-none focus:border-primary focus:ring-4 focus:ring-primary/10 transition-all font-bold text-dark placeholder-gray-300",value:m,onChange:y=>x(y.target.value)})]})]}),!t&&a.jsx("div",{className:"text-right",children:a.jsx("button",{type:"button",onClick:()=>s(!0),className:"text-xs font-bold text-primary hover:underline",children:"Forgot Password?"})}),o&&a.jsxs("div",{className:"flex items-center gap-3 text-red-500 text-sm font-bold bg-red-50 p-4 rounded-xl border border-red-100 animate-shake",children:[a.jsx("i",{className:"fas fa-exclamation-circle text-lg"}),o]}),a.jsx("button",{type:"submit",disabled:r,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg shadow-dark/20 transform active:scale-[0.98] disabled:opacity-70 disabled:cursor-not-allowed flex items-center justify-center gap-2 mt-6",children:r?a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-circle-notch fa-spin"})," Processing..."]}):t?"Create Account":"Sign In"})]}),a.jsx("div",{className:"mt-8 text-center",children:a.jsxs("p",{className:"text-gray-500 text-sm font-medium",children:[t?"Already a member?":"Don't have an account?",a.jsx("button",{onClick:()=>{e(!t),l(null)},className:"ml-2 text-primary font-black hover:underline transition-all",children:t?"Sign In":"Sign Up"})]})})]})})})]})]})},MB=({user:t})=>{const[e,n]=g.useState(!1),[s,r]=g.useState(""),i=async()=>{n(!0);try{await t.reload(),t.emailVerified?window.location.reload():r("Not verified yet. Please check your email (and spam folder).")}catch(c){console.error(c),r("Error checking status. Please try again.")}finally{n(!1)}},o=async()=>{n(!0);try{await t1(t),r("Verification email resent! Check your inbox.")}catch(c){console.error(c),r("Error resending email. Try again later.")}finally{n(!1)}},l=()=>{Fu(Ve).then(()=>window.location.reload())};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f0f4f8] p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-[30px] shadow-2xl p-8 text-center animate-fade-in",children:[a.jsx("div",{className:"w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mx-auto mb-6 text-4xl",children:""}),a.jsx("h1",{className:"text-2xl font-black text-dark mb-2",children:"Verify your Email"}),a.jsxs("p",{className:"text-gray-500 mb-6",children:["We sent a verification link to ",a.jsx("br",{}),a.jsx("span",{className:"font-bold text-primary",children:t.email})]}),s&&a.jsx("div",{className:"mb-6 p-3 bg-blue-50 text-blue-600 text-sm font-bold rounded-xl border border-blue-100",children:s}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:i,disabled:e,className:"w-full bg-primary text-white font-bold py-3.5 rounded-xl hover:bg-primary-dark transition-all shadow-lg shadow-primary/20",children:e?"Checking...":"I have Verified"}),a.jsx("button",{onClick:o,disabled:e,className:"w-full bg-white border-2 border-gray-100 text-gray-600 font-bold py-3.5 rounded-xl hover:bg-gray-50 transition-all",children:"Resend Email"}),a.jsx("button",{onClick:l,className:"text-sm text-gray-400 font-bold hover:text-red-500 transition-colors mt-4",children:"Sign Out / Use Different Email"})]})]})})},LB=({onClose:t})=>{const e=tt(),[n,s]=g.useState(""),[r,i]=g.useState("all"),[o,l]=g.useState({people:[],business:[],products:[],circles:[],videos:[]}),[c,u]=g.useState(!1);g.useEffect(()=>{const m=setTimeout(()=>{n.trim().length>1?h():l({people:[],business:[],products:[],circles:[],videos:[]})},500);return()=>clearTimeout(m)},[n]);const h=async()=>{u(!0);const m=n.toLowerCase(),x=m.startsWith("@"),b=x?m.substring(1):m,N=(w,v,T)=>qe(w,rt(v,">=",T),rt(v,"<=",T+""),Ur(5));let E={people:[],business:[],products:[],circles:[],videos:[]};try{if(x){const w=N(ae(L,"users"),"handle",b),v=await Zt(w);E.people=v.docs.map(T=>({id:T.id,...T.data()}))}else{const w=N(ae(L,"users"),"displayName",n),v=await Zt(w);E.people=v.docs.map(T=>({id:T.id,...T.data()}))}if(!x){const w=N(ae(L,"business_pages"),"name",n),v=await Zt(w);E.business=v.docs.map(k=>({id:k.id,...k.data()}));const T=N(ae(L,"marketplace"),"title",n),I=await Zt(T);E.products=I.docs.map(k=>({id:k.id,...k.data()}));const R=N(ae(L,"circles"),"name",n),V=await Zt(R);E.circles=V.docs.map(k=>({id:k.id,...k.data()}));const j=qe(ae(L,"posts"),rt("mediaType","==","video"),_t("timestamp","desc"),Ur(20)),y=await Zt(j);E.videos=y.docs.map(k=>({id:k.id,...k.data()})).filter(k=>{var S;return(S=k.text)==null?void 0:S.toLowerCase().includes(m)})}l(E)}catch(w){console.error("Search error:",w)}finally{u(!1)}},f=m=>{e(m),t()};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-start justify-center z-[9999] p-4 pt-20 animate-fade-in cursor-pointer",onClick:t,children:a.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] cursor-default",onClick:m=>m.stopPropagation(),children:[a.jsxs("div",{className:"p-4 border-b border-gray-100 bg-[#F8FAFD]",children:[a.jsxs("div",{className:"flex items-center gap-3 bg-white p-3 rounded-2xl border border-gray-200 shadow-sm focus-within:ring-2 ring-primary/20 transition-all",children:[a.jsx("i",{className:"fas fa-search text-gray-400 text-xl ml-2"}),a.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search Products, Business, People...",className:"flex-1 bg-transparent outline-none text-lg font-medium text-dark placeholder-gray-400",value:n,onChange:m=>s(m.target.value)}),n&&a.jsx("button",{onClick:()=>s(""),className:"text-gray-400 hover:text-dark",children:a.jsx("i",{className:"fas fa-times-circle"})})]}),a.jsx("div",{className:"flex gap-6 mt-4 px-2 overflow-x-auto no-scrollbar",children:["all","products","business","people","circles","videos"].map(m=>a.jsx("button",{onClick:()=>i(m),className:`pb-2 font-bold text-sm capitalize border-b-2 transition-all whitespace-nowrap ${r===m?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:m},m))})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white min-h-[300px]",children:c?a.jsxs("div",{className:"text-center py-10 text-gray-400",children:[a.jsx("i",{className:"fas fa-circle-notch fa-spin text-2xl"}),a.jsx("p",{className:"mt-2 text-xs font-bold",children:"Searching..."})]}):n.length<2?a.jsxs("div",{className:"text-center py-20 text-gray-300",children:[a.jsx("i",{className:"fas fa-search text-4xl mb-4"}),a.jsx("p",{children:"Find products, businesses, or friends."})]}):a.jsxs("div",{className:"space-y-8",children:[(r==="all"||r==="products")&&o.products.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Products"}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:o.products.map(m=>a.jsxs("div",{onClick:()=>f(`/product/${m.id}`),className:"bg-white border border-gray-100 rounded-xl p-2 cursor-pointer hover:shadow-md transition-all flex flex-col",children:[a.jsx("img",{src:m.image,className:"w-full h-24 object-cover rounded-lg mb-2 bg-gray-100",alt:m.title}),a.jsx("h5",{className:"font-bold text-sm text-dark truncate",children:m.title}),a.jsxs("p",{className:"text-primary font-black text-xs",children:[m.currency==="BDT"?"":m.currency,m.price]})]},m.id))})]}),(r==="all"||r==="business")&&o.business.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Businesses"}),a.jsx("div",{className:"space-y-2",children:o.business.map(m=>a.jsxs("div",{onClick:()=>f(`/business/${m.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors border border-transparent hover:border-gray-100",children:[a.jsx("img",{src:m.logo,className:"w-12 h-12 rounded-xl object-cover shadow-sm",alt:m.name}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h5",{className:"font-bold text-dark flex items-center gap-1",children:[m.name,m.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:m.category})]}),a.jsx("button",{className:"text-xs bg-white border border-gray-200 px-3 py-1 rounded-full font-bold hover:bg-dark hover:text-white transition-colors",children:"Visit"})]},m.id))})]}),(r==="all"||r==="people")&&o.people.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"People"}),a.jsx("div",{className:"space-y-2",children:o.people.map(m=>a.jsxs("div",{onClick:()=>f(`/profile/${m.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors",children:[a.jsx("img",{src:m.photoURL||"https://via.placeholder.com/150",className:"w-10 h-10 rounded-full object-cover border border-gray-100",alt:m.displayName}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-sm",children:m.displayName}),a.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:["@",m.handle||"user"]})]})]},m.id))})]}),(r==="all"||r==="circles")&&o.circles.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Circles"}),a.jsx("div",{className:"space-y-2",children:o.circles.map(m=>a.jsxs("div",{onClick:()=>f(`/circles/${m.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors",children:[a.jsx("img",{src:m.image,className:"w-10 h-10 rounded-xl object-cover",alt:m.name}),a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-dark text-sm",children:m.name}),a.jsxs("p",{className:"text-xs text-gray-500",children:[m.memberCount||0," Members"]})]})]},m.id))})]}),(r==="all"||r==="videos")&&o.videos.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Videos"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.videos.map(m=>a.jsxs("div",{onClick:()=>f("/watch"),className:"relative rounded-xl overflow-hidden aspect-video cursor-pointer group bg-black",children:[a.jsx("video",{src:m.mediaURL,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white",children:a.jsx("i",{className:"fas fa-play text-xs"})})}),a.jsx("p",{className:"absolute bottom-2 left-2 text-white text-[10px] font-bold truncate w-11/12 shadow-black drop-shadow-md",children:m.text})]},m.id))})]}),Object.values(o).every(m=>m.length===0)&&a.jsxs("div",{className:"text-center py-10 text-gray-400",children:[a.jsx("i",{className:"far fa-folder-open text-2xl mb-2"}),a.jsxs("p",{children:['No results found for "',n,'"']})]})]})}),a.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100 text-center",children:a.jsx("button",{onClick:t,className:"text-gray-500 font-bold text-sm hover:text-dark",children:"Close Search"})})]})})},YI=g.createContext(),OB=({children:t})=>{const[e,n]=g.useState(()=>localStorage.getItem("theme")||"light");g.useEffect(()=>{const r=window.document.documentElement;r.classList.remove("dark"),r.classList.remove("reading"),r.classList.remove("light"),e==="reading"?r.classList.add("reading"):r.classList.add("light"),localStorage.setItem("theme",e)},[e]),g.useEffect(()=>{const r="reading-mode-styles";let i=document.getElementById(r);e==="reading"?i||(i=document.createElement("style"),i.id=r,i.innerHTML=`
          /* --- READING MODE OVERRIDES (Applied when <html> has class 'reading') --- */
          .reading body {
            background-color: #F8F5E6 !important; /* Warm Paper Background */
            color: #4A3B2A !important;           /* Dark Coffee Text */
          }
          
          /* Override White Cards */
          .reading .bg-white, 
          .reading .md\\:bg-white,
          .reading .glass-panel {
            background-color: #FFFCF0 !important; /* Softer Cream for Cards */
            border-color: #E8E0C5 !important;
            color: #4A3B2A !important;
          }

          /* Soften Grays */
          .reading .text-gray-500,
          .reading .text-gray-600, 
          .reading .text-gray-400 {
            color: #8C7B65 !important; /* Warm Gray */
          }

          /* Dark Text becomes Soft Brown */
          .reading .text-dark {
            color: #2E2218 !important;
          }

          /* Input Fields */
          .reading input, 
          .reading textarea, 
          .reading .bg-gray-50,
          .reading .bg-gray-100 {
            background-color: #F0EAD6 !important; /* Eggshell */
            border-color: #DBCDAF !important;
            color: #4A3B2A !important;
          }
          
          /* Hover States */
          .reading .hover\\:bg-gray-50:hover {
            background-color: #EBE0C5 !important;
          }
        `,document.head.appendChild(i)):i&&i.remove()},[e]);const s=()=>{n(r=>r==="light"?"reading":"light")};return a.jsx(YI.Provider,{value:{theme:e,toggleTheme:s},children:t})},FB=()=>g.useContext(YI),XI=({user:t,onClose:e,onSave:n})=>{const[s,r]=g.useState({displayName:t.displayName||"",bio:t.bio||"",profession:t.profession||"",location:t.location||"",handle:t.handle||""}),[i,o]=g.useState(null),[l,c]=g.useState(null),[u,h]=g.useState(!1),f=async()=>{h(!0);try{let m=t.photoURL,x=t.coverPhotoURL;if(i){const b=sn(rn,`users/${t.uid}/profile_${Date.now()}`);await An(b,i),m=await nn(b)}if(l){const b=sn(rn,`users/${t.uid}/cover_${Date.now()}`);await An(b,l),x=await nn(b)}await he(H(L,"users",t.uid),{...s,photoURL:m,coverPhotoURL:x}),n(),e()}catch(m){console.error("Error updating profile:",m),alert("Failed to update profile.")}finally{h(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Edit Profile"}),a.jsx("button",{onClick:e,children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[a.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"Profile Photo"}),a.jsx("input",{type:"file",onChange:m=>o(m.target.files[0]),className:"text-sm"})]}),a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[a.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"Cover Photo"}),a.jsx("input",{type:"file",onChange:m=>c(m.target.files[0]),className:"text-sm"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Display Name"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold",value:s.displayName,onChange:m=>r({...s,displayName:m.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Bio"}),a.jsx("textarea",{rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl",value:s.bio,onChange:m=>r({...s,bio:m.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Profession"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl",value:s.profession,onChange:m=>r({...s,profession:m.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Location"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl",value:s.location,onChange:m=>r({...s,location:m.target.value})})]})]})]})]}),a.jsx("div",{className:"p-6 border-t border-gray-100 bg-white",children:a.jsx("button",{onClick:f,disabled:u,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg",children:u?"Saving...":"Save Changes"})})]})})},NN=({message:t,onConfirm:e,onCancel:n,title:s="Confirm Action"})=>a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[10001] p-4",children:a.jsxs("div",{className:"bg-white reading:bg-[#FFFCF0] p-6 rounded-2xl shadow-2xl w-full max-w-sm text-center",children:[a.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:s}),a.jsx("p",{className:"text-gray-600 mb-6",children:t}),a.jsxs("div",{className:"flex justify-center gap-3",children:[a.jsx("button",{onClick:n,className:"bg-gray-100 text-gray-700 font-semibold px-4 py-2 rounded-xl hover:bg-gray-200 transition-colors flex-1",children:"Cancel"}),a.jsx("button",{onClick:e,className:"bg-red-500 text-white font-semibold px-4 py-2 rounded-xl hover:bg-red-600 transition-colors flex-1",children:"Confirm"})]})]})}),UB=({user:t,onClose:e})=>{var j;const[n,s]=g.useState("main"),[r,i]=g.useState(!1),[o,l]=g.useState(!1),[c,u]=g.useState(null),{theme:h,toggleTheme:f}=FB(),[m,x]=g.useState({privateAccount:t.isPrivate||!1,activeStatus:t.isOnline||!0,notifications:!0}),b=y=>{u({action:"message",message:y,title:"Notification"})},N=async y=>{const k=!m[y];x({...m,[y]:k});try{y==="privateAccount"&&await he(H(L,"users",t.uid),{isPrivate:k})}catch(S){console.error("Error updating setting:",S)}},E=async()=>{if(!t.email)return b("No email address found for your account.");l(!0);try{await e1(Ve,t.email),b(`Password reset email sent to ${t.email}`)}catch(y){b("Error sending reset email: "+y.message)}finally{l(!1)}},w=()=>{u({action:"signout",message:"Are you sure you want to sign out?",title:"Confirm Sign Out"})},v=async()=>{u(null);try{await Fu(Ve),window.location.reload()}catch(y){console.error("Error signing out:",y)}},T=()=>{u({action:"delete",message:" ARE YOU SURE? This will permanently delete your account and all associated data. This cannot be undone.",title:"Permanent Deletion"})},I=async()=>{u(null),l(!0);try{await is(H(L,"users",t.uid)),await _M(Ve.currentUser),b("Account deleted successfully. Goodbye!"),setTimeout(()=>window.location.reload(),1500)}catch(y){console.error("Delete Error:",y),y.code==="auth/requires-recent-login"?b("Security check: Please sign out and sign in again before deleting your account."):b("Failed to delete account: "+y.message)}finally{l(!1)}},R=({id:y,icon:k,label:S,color:D="text-gray-600",bg:P="bg-gray-100"})=>a.jsxs("button",{onClick:()=>s(y),className:"w-full bg-white reading:bg-[#FFFCF0] border border-gray-100 reading:border-[#E8E0C5] p-4 rounded-2xl flex items-center justify-between hover:bg-gray-50 reading:hover:bg-[#EBE0C5] transition-all shadow-sm mb-3 group",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${P} ${D} group-hover:scale-110 transition-transform`,children:a.jsx("i",{className:`fas ${k}`})}),a.jsx("span",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:S})]}),a.jsx("i",{className:"fas fa-chevron-right text-gray-300"})]}),V=({title:y})=>a.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-gray-100 reading:border-[#E8E0C5]",children:[a.jsx("button",{onClick:()=>s("main"),className:"w-8 h-8 rounded-full bg-gray-100 reading:bg-[#F0EAD6] flex items-center justify-center hover:bg-gray-200 reading:hover:bg-[#EBE0C5] transition-colors",children:a.jsx("i",{className:"fas fa-arrow-left text-gray-600 reading:text-[#4A3B2A]"})}),a.jsx("h2",{className:"text-xl font-black text-gray-900 reading:text-[#2E2218]",children:y})]});return a.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:[a.jsxs("div",{className:"bg-white reading:bg-[#FFFCF0] w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] relative transition-colors duration-300",children:[a.jsx("button",{onClick:e,className:"absolute top-5 right-5 z-10 text-gray-400 hover:text-gray-700 w-8 h-8 flex items-center justify-center rounded-full bg-gray-50 reading:bg-[#F0EAD6] hover:bg-gray-100 reading:hover:bg-[#EBE0C5] transition-all",children:a.jsx("i",{className:"fas fa-times text-lg"})}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 md:p-8",children:[n==="main"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx("h2",{className:"text-3xl font-black text-gray-900 reading:text-[#2E2218] mb-2",children:"Settings"}),a.jsx("p",{className:"text-gray-500 reading:text-[#8C7B65] font-bold mb-8",children:"Manage your account & preferences"}),a.jsxs("div",{className:"space-y-1",children:[a.jsx(R,{id:"account",icon:"fa-user-circle",label:"Account",color:"text-blue-500",bg:"bg-blue-50 reading:bg-[#F0EAD6]"}),a.jsx(R,{id:"privacy",icon:"fa-lock",label:"Privacy",color:"text-purple-500",bg:"bg-purple-50 reading:bg-[#F0EAD6]"}),a.jsx(R,{id:"security",icon:"fa-shield-alt",label:"Security",color:"text-green-500",bg:"bg-green-50 reading:bg-[#F0EAD6]"}),a.jsx(R,{id:"display",icon:"fa-book-open",label:"Display",color:"text-orange-500",bg:"bg-orange-50 reading:bg-[#F0EAD6]"}),a.jsx(R,{id:"help",icon:"fa-question-circle",label:"Help & Support",color:"text-cyan-500",bg:"bg-cyan-50 reading:bg-[#F0EAD6]"})]}),a.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100 reading:border-[#E8E0C5]",children:a.jsxs("button",{onClick:w,className:"w-full bg-red-50 reading:bg-[#F8F5E6] text-red-500 p-4 rounded-2xl flex items-center justify-center gap-2 font-bold hover:bg-red-100 reading:hover:bg-[#EBE0C5] transition-all",children:[a.jsx("i",{className:"fas fa-sign-out-alt"})," Log Out"]})})]}),n==="account"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(V,{title:"Account"}),a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("img",{src:t.photoURL||"https://placehold.co/150x150/e0e0e0/333?text=PFP",className:"w-24 h-24 rounded-full object-cover border-4 border-gray-50 reading:border-[#E8E0C5] mb-3 mx-auto",alt:"User"}),a.jsx("h3",{className:"text-xl font-bold text-gray-900 reading:text-[#2E2218]",children:t.displayName}),a.jsxs("p",{className:"text-gray-500 reading:text-[#8C7B65]",children:["@",t.handle||"user"]}),a.jsx("button",{onClick:()=>i(!0),className:"mt-4 bg-gray-900 reading:bg-[#4A3B2A] text-white px-6 py-2 rounded-xl font-bold text-sm shadow-lg hover:opacity-90 transition-all",children:"Edit Profile"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"bg-gray-50 reading:bg-[#F0EAD6] p-4 rounded-2xl",children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 reading:text-[#8C7B65] uppercase",children:"Email"}),a.jsx("p",{className:"font-bold text-gray-900 reading:text-[#4A3B2A]",children:t.email})]}),a.jsxs("div",{className:"bg-gray-50 reading:bg-[#F0EAD6] p-4 rounded-2xl",children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 reading:text-[#8C7B65] uppercase",children:"Member Since"}),a.jsx("p",{className:"font-bold text-gray-900 reading:text-[#4A3B2A]",children:(j=t.metadata)!=null&&j.creationTime?new Date(t.metadata.creationTime).toDateString():"N/A"})]})]}),a.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 reading:border-[#E8E0C5]",children:[a.jsx("h4",{className:"text-red-500 font-bold mb-2 text-sm uppercase tracking-wider",children:"Danger Zone"}),a.jsx("button",{onClick:T,disabled:o,className:"w-full border-2 border-red-100 reading:border-[#E8E0C5] text-red-500 p-3 rounded-xl font-bold text-sm hover:bg-red-50 reading:hover:bg-[#EBE0C5] transition-all flex items-center justify-center gap-2",children:o?"Deleting...":a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-trash-alt"})," Delete Account"]})})]})]}),n==="privacy"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(V,{title:"Privacy"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 reading:border-[#E8E0C5] rounded-2xl bg-white reading:bg-[#FFFCF0]",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:"Private Account"}),a.jsx("p",{className:"text-xs text-gray-500 reading:text-[#8C7B65] mt-1",children:"Only followers can see your posts."})]}),a.jsx("div",{onClick:()=>N("privateAccount"),className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${m.privateAccount?"bg-indigo-500":"bg-gray-300"}`,children:a.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${m.privateAccount?"left-7":"left-1"}`})})]}),a.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 reading:border-[#E8E0C5] rounded-2xl bg-white reading:bg-[#FFFCF0]",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:"Active Status"}),a.jsx("p",{className:"text-xs text-gray-500 reading:text-[#8C7B65] mt-1",children:"Show when you're online."})]}),a.jsx("div",{onClick:()=>N("activeStatus"),className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${m.activeStatus?"bg-indigo-500":"bg-gray-300"}`,children:a.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${m.activeStatus?"left-7":"left-1"}`})})]})]})]}),n==="security"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(V,{title:"Security"}),a.jsxs("div",{className:"p-6 border border-orange-100 reading:border-[#E8E0C5] bg-orange-50 reading:bg-[#F0EAD6] rounded-3xl text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-white reading:bg-[#FFFCF0] rounded-full flex items-center justify-center text-orange-500 text-2xl shadow-sm mx-auto mb-4",children:a.jsx("i",{className:"fas fa-key"})}),a.jsx("h4",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg mb-2",children:"Change Password"}),a.jsx("p",{className:"text-sm text-gray-600 reading:text-[#8C7B65] mb-6",children:"We'll send you an email to reset your password securely."}),a.jsx("button",{onClick:E,disabled:o,className:"w-full bg-orange-500 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-orange-600 transition-all disabled:opacity-50",children:o?"Sending...":"Send Reset Link"})]})]}),n==="display"&&a.jsxs("div",{className:"animate-slide-in",children:[a.jsx(V,{title:"Display"}),a.jsxs("div",{className:"bg-yellow-50 reading:bg-[#F0EAD6] p-6 rounded-3xl border border-yellow-100 reading:border-[#E8E0C5] text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-white reading:bg-[#FFFCF0] rounded-full flex items-center justify-center text-yellow-600 text-3xl shadow-sm mx-auto mb-3",children:a.jsx("i",{className:"fas fa-book-reader"})}),a.jsx("h4",{className:"font-bold text-gray-900 reading:text-[#2E2218] text-lg",children:"Reading Mode"}),a.jsx("p",{className:"text-sm text-gray-600 reading:text-[#8C7B65] mb-0",children:"Warm, paper-like colors for relaxed viewing."})]}),a.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 reading:border-[#E8E0C5] rounded-2xl bg-white reading:bg-[#FFFCF0]",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:"Enable Reading Mode"}),a.jsx("p",{className:"text-xs text-gray-500 reading:text-[#8C7B65] mt-1",children:h==="reading"?"On":"Off"})]}),a.jsx("div",{onClick:f,className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${h==="reading"?"bg-orange-400":"bg-gray-300"}`,children:a.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${h==="reading"?"left-7":"left-1"}`})})]})]}),n==="help"&&a.jsxs("div",{className:"animate-slide-in text-center pt-10",children:[a.jsx(V,{title:"Help"}),a.jsx("div",{className:"w-24 h-24 bg-cyan-50 reading:bg-[#F0EAD6] rounded-full flex items-center justify-center text-cyan-500 text-4xl mx-auto mb-6",children:a.jsx("i",{className:"fas fa-life-ring"})}),a.jsx("h3",{className:"text-2xl font-black text-gray-900 reading:text-[#2E2218] mb-2",children:"Need Support?"}),a.jsx("p",{className:"text-gray-500 reading:text-[#8C7B65] mb-8 max-w-xs mx-auto",children:"Our team is here to help you with any issues regarding your account."}),a.jsx("button",{className:"bg-gray-900 reading:bg-[#4A3B2A] text-white px-8 py-3 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg",children:"Contact Support"})]})]})]}),r&&a.jsx("div",{className:"absolute inset-0 z-[10000]",children:a.jsx(XI,{user:t,onClose:()=>i(!1),onSave:()=>window.location.reload()})}),c&&c.action!=="message"&&a.jsx(NN,{title:c.title,message:c.message,onConfirm:c.action==="signout"?v:I,onCancel:()=>u(null)}),c&&c.action==="message"&&a.jsx(NN,{title:c.title,message:c.message,onConfirm:()=>u(null),onCancel:()=>u(null),children:a.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[10001] p-4",children:a.jsxs("div",{className:"bg-white reading:bg-[#FFFCF0] p-6 rounded-2xl shadow-2xl w-full max-w-sm text-center",children:[a.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:c.title}),a.jsx("p",{className:"text-gray-600 mb-6",children:c.message}),a.jsx("button",{onClick:()=>u(null),className:"bg-indigo-500 text-white font-semibold px-4 py-2 rounded-xl hover:bg-indigo-600 transition-colors w-full",children:"OK"})]})})})]})},yn=()=>{var D;const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState([]),[i,o]=g.useState(!1),[l,c]=g.useState(0),[u,h]=g.useState(!1),[f,m]=g.useState(!1),[x,b]=g.useState(!1),[N,E]=g.useState(!0),w=g.useRef(0),v=g.useRef(new Audio("https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3")),T=g.useRef(0),I=new Date().getHours(),R=I<12?"Good Morning":I<18?"Good Afternoon":"Good Evening";g.useEffect(()=>{Pt(Ve,q=>{if(q){n(q);const ue=qe(ae(L,"notifications"),rt("recipientId","==",q.uid),_t("timestamp","desc")),Se=Fe(ue,se=>{var F;const ne=se.docs.map(G=>({id:G.id,...G.data()}));ne.length>T.current&&!((F=ne[0])!=null&&F.isRead)&&v.current.play().catch(()=>{}),r(ne),T.current=ne.length}),fe=qe(ae(L,"conversations"),rt("participants","array-contains",q.uid)),K=Fe(fe,se=>{let ne=0;se.docs.forEach(F=>{const G=F.data();G.unreadCounts&&G.unreadCounts[q.uid]&&(ne+=G.unreadCounts[q.uid])}),c(ne)});return()=>{Se(),K()}}else n(null)});const P=()=>{const q=window.scrollY;q<10?E(!0):q>w.current?E(!1):E(!0),w.current=q};window.addEventListener("scroll",P,{passive:!0});const C=q=>{q.target.closest(".notification-container")||o(!1),q.target.closest(".app-menu-container")||m(!1)};return document.addEventListener("click",C),()=>{document.removeEventListener("click",C),window.removeEventListener("scroll",P)}},[]);const V=async()=>{const P=!i;if(o(P),P){const C=s.filter(q=>!q.isRead);if(C.length>0)try{const q=xl(L);C.forEach(ue=>{const Se=H(L,"notifications",ue.id);q.update(Se,{isRead:!0})}),await q.commit()}catch(q){console.error("Error marking notifications as read:",q)}}},j=async P=>{switch(P.isRead||he(H(L,"notifications",P.id),{isRead:!0}),o(!1),P.type){case"like":case"comment":case"mention":t(`/post/${P.targetId}`,{state:{commentId:P.commentId}});break;case"follow":case"circle_join":t(`/profile/${P.senderId}`);break;case"review":case"question":case"answer":const C=P.type==="review"?"reviews":"qa";t(`/product/${P.targetId}`,{state:{activeTab:C}});break;case"follow_business":t(`/business/${P.targetId}`);break;default:t("/")}},y=async()=>{const P=xl(L);s.forEach(C=>P.delete(H(L,"notifications",C.id))),await P.commit()},k=async()=>{window.confirm("Sign out?")&&(await Fu(Ve),window.location.reload())},S=s.filter(P=>!P.isRead).length;return a.jsxs(a.Fragment,{children:[a.jsx("div",{className:`sticky top-0 md:relative z-[40] transition-transform duration-300 ease-in-out ${N?"translate-y-0":"-translate-y-[120%]"}`,children:a.jsxs("div",{className:"flex justify-between items-center bg-white/95 backdrop-blur-md md:bg-white rounded-b-[24px] md:rounded-[24px] p-4 md:p-5 shadow-sm mb-6 border-b border-gray-100 md:border-none",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"text-2xl md:text-3xl mr-3 md:mr-4 animate-gentle-float",children:I<18?"":""}),a.jsx("div",{children:a.jsxs("h2",{className:"text-lg md:text-xl font-bold text-[#2C3E50] leading-tight",children:[R,", ",a.jsxs("span",{className:"hidden md:inline",children:[((D=e==null?void 0:e.displayName)==null?void 0:D.split(" ")[0])||"Friend","!"]})]})})]}),a.jsxs("div",{className:"flex gap-2 md:gap-3",children:[a.jsx("div",{onClick:()=>h(!0),className:"w-10 h-10 rounded-full bg-[#F8FAFD] flex items-center justify-center cursor-pointer hover:shadow-md transition-all text-[#2C3E50]",children:a.jsx("i",{className:"fas fa-search text-lg"})}),a.jsxs("div",{className:"relative notification-container",children:[a.jsxs("div",{onClick:V,className:`w-10 h-10 rounded-full flex items-center justify-center cursor-pointer transition-all relative ${i?"bg-primary text-white shadow-lg":"bg-[#F8FAFD] text-[#2C3E50] hover:shadow-md"}`,children:[a.jsx("i",{className:"fas fa-bell text-lg"}),S>0&&a.jsx("span",{className:"absolute top-0 right-0 bg-accent text-white text-[10px] font-bold w-4 h-4 flex items-center justify-center rounded-full border-2 border-white animate-bounce-in",children:S>9?"9+":S})]}),i&&a.jsxs("div",{className:"absolute right-0 top-14 w-80 md:w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden animate-fade-in z-[101]",children:[a.jsxs("div",{className:"p-4 border-b border-gray-50 flex justify-between items-center bg-gray-50/50",children:[a.jsx("h3",{className:"font-bold text-dark",children:"Notifications"}),s.length>0&&a.jsx("button",{onClick:y,className:"text-xs text-gray-400 hover:text-red-500",children:"Clear All"})]}),a.jsx("div",{className:"max-h-80 overflow-y-auto custom-scrollbar",children:s.length>0?s.map(P=>{var C;return a.jsxs("div",{onClick:()=>j(P),className:`p-4 flex gap-3 cursor-pointer hover:bg-gray-50 transition-colors border-b border-gray-50 last:border-0 ${P.isRead?"":"bg-blue-50/30"}`,children:[a.jsx("img",{src:P.senderAvatar||"https://via.placeholder.com/150",className:"w-10 h-10 rounded-full object-cover border border-white shadow-sm"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm text-gray-800 leading-tight",children:[a.jsx("span",{className:"font-bold",children:P.senderName}),P.type==="like"&&" liked your post.",P.type==="comment"&&" commented on your post.",P.type==="follow"&&" started following you.",P.type==="mention"&&" mentioned you.",P.type==="review"&&" reviewed your product.",P.type==="team_invite"&&" invited you to a team.",!["like","comment","follow","mention","review","team_invite"].includes(P.type)&&` ${P.message}`]}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(C=P.timestamp)!=null&&C.seconds?new Date(P.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"})]}),!P.isRead&&a.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 shrink-0"})]},P.id)}):a.jsxs("div",{className:"p-8 text-center text-gray-400",children:[a.jsx("i",{className:"far fa-bell-slash text-2xl mb-2"}),a.jsx("p",{className:"text-sm",children:"No notifications."})]})})]})]}),a.jsxs("div",{onClick:()=>m(!f),className:"relative app-menu-container w-10 h-10 rounded-full bg-gradient-to-tr from-primary to-gold text-white flex items-center justify-center cursor-pointer hover:shadow-md",children:[a.jsx("i",{className:"fas fa-bars text-lg"}),f&&a.jsxs("div",{className:"absolute right-0 top-14 w-64 bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden animate-fade-in z-[100] text-dark",children:[a.jsx("div",{className:"p-3 border-b border-gray-50 text-xs font-bold text-gray-400 uppercase bg-gray-50/50",children:"Menu"}),a.jsxs("div",{className:"flex flex-col p-2 space-y-1",children:[a.jsxs("button",{onClick:()=>{t("/explore"),m(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-sm font-bold",children:[a.jsx("i",{className:"fas fa-compass text-purple-500 w-6"})," Explore"]}),a.jsxs("button",{onClick:()=>{t("/business"),m(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-sm font-bold",children:[a.jsx("i",{className:"fas fa-briefcase text-blue-500 w-6"})," Business"]}),a.jsxs("button",{onClick:()=>{b(!0),m(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-sm font-bold",children:[a.jsx("i",{className:"fas fa-cog text-gray-500 w-6"})," Settings"]}),a.jsx("div",{className:"h-px bg-gray-100 my-1"}),a.jsxs("button",{onClick:k,className:"flex items-center gap-3 px-4 py-3 hover:bg-red-50 rounded-xl text-sm font-bold text-red-500",children:[a.jsx("i",{className:"fas fa-sign-out-alt w-6"})," Sign Out"]})]})]})]})]})]})}),u&&a.jsx(LB,{onClose:()=>h(!1)}),x&&e&&a.jsx(UB,{user:e,onClose:()=>b(!1)})]})},Y0=({amount:t,itemName:e,onClose:n,onSuccess:s,metadata:r={}})=>{const[i,o]=g.useState("card"),[l,c]=g.useState(!1),[u,h]=g.useState(null),f=HI(KI,"createPaymentSession"),m=async()=>{c(!0),h(null);try{const x=Ve.currentUser;if(!x)throw new Error("You must be signed in to pay.");await x.getIdToken(!0);const b=await ze(ae(L,"orders"),{userId:x.uid,itemName:e,amount:t,currency:"BDT",method:i,status:"pending",metadata:r,createdAt:Ie()}),N=await f({orderId:b.id,amount:t,currency:"BDT",paymentMethod:i,successUrl:`${window.location.origin}/?payment_success=true&orderId=${b.id}`,cancelUrl:`${window.location.origin}/?payment_cancel=true`}),{paymentUrl:E}=N.data;if(E)window.location.href=E;else throw new Error("Failed to generate payment link. Please try again.")}catch(x){console.error("Payment Error:",x),h(x.message.replace("INTERNAL ASSERTION FAILED: ","")||"Payment failed."),c(!1)}};return a.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-[35px] shadow-2xl overflow-hidden relative",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Secure Checkout"}),a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:e})]}),a.jsx("button",{onClick:n,className:"w-8 h-8 rounded-full bg-gray-100 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("p",{className:"text-gray-400 text-xs font-bold uppercase tracking-widest mb-1",children:"Total to Pay"}),a.jsxs("h1",{className:"text-4xl font-black text-dark",children:[" ",t.toLocaleString()]})]}),u&&a.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-500 text-xs font-bold rounded-xl border border-red-100 text-center",children:u}),a.jsxs("div",{className:"space-y-3 mb-8",children:[a.jsxs("div",{onClick:()=>o("card"),className:`flex items-center gap-4 p-4 rounded-2xl border-2 cursor-pointer ${i==="card"?"border-primary bg-primary/5":"border-gray-100"}`,children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary text-white flex items-center justify-center",children:a.jsx("i",{className:"fab fa-cc-visa"})}),a.jsx("div",{className:"flex-1",children:a.jsx("h5",{className:"font-bold text-dark text-sm",children:"Credit / Debit Card"})}),i==="card"&&a.jsx("i",{className:"fas fa-check-circle text-primary"})]}),a.jsxs("div",{onClick:()=>o("bkash"),className:`flex items-center gap-4 p-4 rounded-2xl border-2 cursor-pointer ${i==="bkash"?"border-pink-500 bg-pink-50":"border-gray-100"}`,children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-pink-500 text-white flex items-center justify-center",children:a.jsx("i",{className:"fas fa-mobile-alt"})}),a.jsx("div",{className:"flex-1",children:a.jsx("h5",{className:"font-bold text-dark text-sm",children:"bKash"})}),i==="bkash"&&a.jsx("i",{className:"fas fa-check-circle text-pink-500"})]})]}),a.jsx("button",{onClick:m,disabled:l,className:"w-full bg-dark text-white py-4 rounded-2xl font-bold text-lg shadow-xl hover:bg-primary transition-all disabled:opacity-70",children:l?"Processing...":"Pay Now"})]})]})})},JI=({target:t,onClose:e,onBoost:n})=>{const[s,r]=g.useState(1),[i,o]=g.useState(!1),[l,c]=g.useState(!1),u=["Dhaka, Bangladesh","Chittagong, Bangladesh","Sylhet, Bangladesh","Rajshahi, Bangladesh","Khulna, Bangladesh","Barisal, Bangladesh","Rangpur, Bangladesh","Mymensingh, Bangladesh","Comilla, Bangladesh","Narayanganj, Bangladesh","Gazipur, Bangladesh","Bogura, Bangladesh","Cox's Bazar, Bangladesh"],h=["New York, USA","London, UK","Toronto, Canada","Dubai, UAE","Sydney, Australia","Singapore","Kuala Lumpur, Malaysia"],[f,m]=g.useState({goal:"",audienceMode:"auto",locations:["Dhaka, Bangladesh"],gender:"All",ageRange:[18,55],interests:[],dailyBudget:500,duration:7,paymentMethod:"card"}),[x,b]=g.useState(""),[N,E]=g.useState([]),w=f.dailyBudget*f.duration,v=Math.floor(f.dailyBudget*18*(f.locations.length*.5+.8));g.useEffect(()=>{if(!x.trim()){E([]);return}const S=x.toLowerCase(),D=u.filter(C=>C.toLowerCase().includes(S)),P=h.filter(C=>C.toLowerCase().includes(S));E([...D,...P])},[x]);const T=S=>{f.locations.includes(S)||m(D=>({...D,locations:[...D.locations,S]})),b(""),E([])},I=S=>{m(D=>({...D,locations:D.locations.filter(P=>P!==S)}))},R=()=>t.type==="page"||t.type==="business"?[{id:"shop_visits",icon:"fa-store-alt",label:"Get Shop Visitors",desc:"Show to people near your shop"},{id:"messages",icon:"fa-comment-dollar",label:"Get Messages & Leads",desc:"Chat with potential buyers"},{id:"website",icon:"fa-globe",label:"Website Traffic",desc:"Send people to your site"},{id:"followers",icon:"fa-users",label:"Page Followers",desc:"Grow your brand audience"}]:t.type==="profile"?[{id:"followers",icon:"fa-user-plus",label:"Get More Followers",desc:"Grow your personal brand"},{id:"profile_visits",icon:"fa-id-card",label:"Profile Visits",desc:"Get people to view your profile"},{id:"influence",icon:"fa-star",label:"Build Influence",desc:"Reach more people"}]:[{id:"engagement",icon:"fa-thumbs-up",label:"Increase Engagement",desc:"More likes, comments & shares"},{id:"views",icon:"fa-eye",label:"Increase Views",desc:"Get more people to see this"},{id:"messages",icon:"fa-paper-plane",label:"Send Message",desc:"Let people contact you"}],V=async()=>{c(!0),setTimeout(()=>{n({...f,targetId:t.id,targetType:t.type,targetName:t.name,status:"active",createdAt:new Date().toISOString()}),c(!1),e()},1500)},j=()=>a.jsxs("div",{className:"space-y-5 animate-fade-in",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-blue-50 rounded-full flex items-center justify-center mx-auto mb-3 text-primary text-2xl",children:a.jsx("i",{className:`fas ${t.type==="business"?"fa-briefcase":t.type==="profile"?"fa-user-circle":"fa-bullhorn"}`})}),a.jsxs("h3",{className:"text-xl font-black text-dark",children:["Goal: Promote ",t.type==="page"?"Business":t.type]}),a.jsx("p",{className:"text-sm text-gray-500",children:"What outcome do you want?"})]}),a.jsx("div",{className:"grid grid-cols-1 gap-3",children:R().map(S=>a.jsxs("div",{onClick:()=>m({...f,goal:S.id}),className:`p-4 rounded-2xl border-2 cursor-pointer transition-all flex items-center gap-4 ${f.goal===S.id?"border-primary bg-primary/5 shadow-md":"border-gray-100 hover:border-gray-300 hover:bg-gray-50"}`,children:[a.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center text-lg shadow-sm ${f.goal===S.id?"bg-primary text-white":"bg-white text-gray-400"}`,children:a.jsx("i",{className:`fas ${S.icon}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-bold text-dark text-base",children:S.label}),a.jsx("p",{className:"text-xs text-gray-500 font-medium",children:S.desc})]}),f.goal===S.id&&a.jsx("i",{className:"fas fa-check-circle text-primary text-xl"})]},S.id))})]}),y=()=>a.jsxs("div",{className:"space-y-6 animate-fade-in",children:[a.jsx("h3",{className:"text-lg font-black text-dark",children:"2. Who should see this?"}),a.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl mb-4",children:[a.jsx("button",{onClick:()=>m({...f,audienceMode:"auto"}),className:`flex-1 py-2.5 rounded-lg text-xs font-bold transition-all ${f.audienceMode==="auto"?"bg-white shadow-sm text-primary":"text-gray-500"}`,children:"Automatic (Smart)"}),a.jsx("button",{onClick:()=>m({...f,audienceMode:"custom"}),className:`flex-1 py-2.5 rounded-lg text-xs font-bold transition-all ${f.audienceMode==="custom"?"bg-white shadow-sm text-primary":"text-gray-500"}`,children:"Custom Targeting"})]}),f.audienceMode==="auto"?a.jsxs("div",{className:"p-5 bg-blue-50 border border-blue-100 rounded-2xl text-sm text-blue-800 flex items-start gap-3",children:[a.jsx("i",{className:"fas fa-magic text-xl mt-1"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold mb-1",children:"Tukumi Smart AI"}),a.jsxs("p",{className:"opacity-80 text-xs leading-relaxed",children:["We will automatically show your ad to people similar to your current followers and people interested in ",t.category||"your content","."]})]})]}):a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"relative",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Locations"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:f.locations.map(S=>a.jsxs("span",{className:"bg-dark text-white text-xs font-bold px-3 py-1.5 rounded-full flex items-center gap-2 shadow-sm",children:[a.jsx("i",{className:"fas fa-map-marker-alt"})," ",S,a.jsx("button",{onClick:()=>I(S),className:"hover:text-red-300",children:a.jsx("i",{className:"fas fa-times"})})]},S))}),a.jsxs("div",{className:"flex items-center gap-2 bg-white border-2 border-gray-200 rounded-xl px-3 py-2 focus-within:border-primary focus-within:ring-4 focus-within:ring-primary/10 transition-all",children:[a.jsx("i",{className:"fas fa-search text-gray-400"}),a.jsx("input",{value:x,onChange:S=>b(S.target.value),className:"flex-1 bg-transparent outline-none text-sm font-bold text-dark placeholder-gray-400",placeholder:"Search city, town, or region..."})]}),N.length>0&&a.jsx("div",{className:"absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-xl border border-gray-100 z-20 max-h-40 overflow-y-auto custom-scrollbar",children:N.map(S=>a.jsxs("button",{onClick:()=>T(S),className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-600 hover:bg-gray-50 hover:text-primary flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-xs opacity-50"})," ",S]},S))})]}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-2xl border border-gray-100",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2",children:"Gender"}),a.jsx("div",{className:"flex gap-2",children:["All","Men","Women"].map(S=>a.jsx("button",{onClick:()=>m({...f,gender:S}),className:`flex-1 py-2 rounded-lg text-xs font-bold border ${f.gender===S?"bg-dark text-white border-dark":"bg-white text-gray-500 border-gray-200"}`,children:S},S))})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"text-xs font-bold text-gray-500 uppercase block mb-2 flex justify-between",children:[a.jsx("span",{children:"Age Range"})," ",a.jsxs("span",{children:[f.ageRange[0]," - ",f.ageRange[1]]})]}),a.jsx("input",{type:"range",min:"13",max:"65",value:f.ageRange[1],onChange:S=>m({...f,ageRange:[f.ageRange[0],parseInt(S.target.value)]}),className:"w-full accent-primary"})]})]})]})]}),k=()=>a.jsxs("div",{className:"space-y-6 animate-fade-in",children:[a.jsx("h3",{className:"text-lg font-black text-dark",children:"3. Budget & Schedule"}),a.jsxs("div",{className:"bg-gradient-to-r from-primary to-primary-dark p-6 rounded-3xl text-white shadow-xl relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full blur-2xl -mr-10 -mt-10"}),a.jsxs("div",{className:"relative z-10",children:[a.jsx("p",{className:"text-sm font-medium opacity-80 mb-1",children:"Estimated Reach"}),a.jsxs("h2",{className:"text-4xl font-black tracking-tight",children:[v.toLocaleString()," ",a.jsx("span",{className:"text-lg opacity-70 font-bold",children:"people"})]}),a.jsxs("div",{className:"mt-4 flex gap-2 text-xs font-bold bg-black/20 p-2 rounded-lg w-fit",children:[a.jsxs("span",{children:[" ",f.locations.length," Locations"]}),a.jsx("span",{className:"w-px h-4 bg-white/30"}),a.jsxs("span",{children:[" ",f.duration," Days"]})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm font-bold text-dark mb-2",children:[a.jsx("span",{children:"Daily Budget"})," ",a.jsxs("span",{children:["",f.dailyBudget]})]}),a.jsx("input",{type:"range",min:"100",max:"5000",step:"50",value:f.dailyBudget,onChange:S=>m({...f,dailyBudget:parseInt(S.target.value)}),className:"w-full accent-green-500 h-2 bg-gray-100 rounded-lg appearance-none cursor-pointer"}),a.jsxs("div",{className:"flex justify-between text-[10px] text-gray-400 mt-2 font-bold",children:[a.jsx("span",{children:"100"}),a.jsx("span",{children:"5,000"})]})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm font-bold text-dark mb-2",children:[a.jsx("span",{children:"Duration"})," ",a.jsxs("span",{children:[f.duration," Days"]})]}),a.jsx("div",{className:"flex gap-2",children:[1,3,7,15,30].map(S=>a.jsxs("button",{onClick:()=>m({...f,duration:S}),className:`flex-1 py-2 rounded-lg text-xs font-bold border ${f.duration===S?"bg-primary text-white border-primary":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:[S,"d"]},S))})]})]})]});return a.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-md flex items-center justify-center z-[9999] p-4 animate-fade-in",children:[a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[35px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-white sticky top-0 z-10",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-black text-xl text-dark flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-rocket text-gold"})," Boost Center"]}),a.jsx("div",{className:"flex gap-1 mt-2",children:[1,2,3].map(S=>a.jsx("div",{className:`h-1.5 w-8 rounded-full transition-colors ${s>=S?"bg-primary":"bg-gray-200"}`},S))})]}),a.jsx("button",{onClick:e,className:"w-8 h-8 bg-gray-50 rounded-full flex items-center justify-center text-gray-400 hover:text-dark hover:bg-gray-100 transition-all",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 custom-scrollbar",children:[s===1&&a.jsx(j,{}),s===2&&a.jsx(y,{}),s===3&&a.jsx(k,{})]}),a.jsxs("div",{className:"p-5 border-t border-gray-100 bg-white flex gap-3 shadow-[0_-5px_20px_rgba(0,0,0,0.05)] z-10",children:[s>1&&a.jsx("button",{onClick:()=>r(S=>S-1),className:"px-6 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Back"}),s<3?a.jsx("button",{onClick:()=>{if(s===1&&!f.goal)return alert("Please select a goal.");r(S=>S+1)},className:"flex-1 bg-dark text-white py-3 rounded-xl font-bold hover:bg-primary transition-all shadow-lg",children:"Next Step"}):a.jsxs("button",{onClick:()=>o(!0),className:"flex-1 bg-gradient-to-r from-primary to-primary-dark text-white py-3 rounded-xl font-bold hover:shadow-primary/40 transition-all shadow-lg flex items-center justify-center gap-2 animate-pulse-slow",children:[a.jsxs("span",{children:["Pay ",w.toLocaleString()]})," ",a.jsx("i",{className:"fas fa-arrow-right"})]})]})]}),i&&a.jsx(Y0,{amount:w,itemName:`Boost: ${t.name} (${f.duration} Days)`,onClose:()=>o(!1),metadata:{type:"boost",...f,targetId:t.id,targetType:t.type},onSuccess:V})]})},BB=({src:t,placeholder:e,className:n,...s})=>{const[r,i]=g.useState(e||t),[o,l]=g.useState(!0);return g.useEffect(()=>{if(!e){i(t),l(!1);return}const c=new Image;c.src=t,c.onload=()=>{i(t),l(!1)}},[t,e]),a.jsx("img",{...s,src:r,className:`${n} transition-all duration-500 ${o?"blur-sm scale-105":"blur-0 scale-100"}`,alt:s.alt||""})},Al=({src:t,alt:e,className:n,isVerified:s,onClick:r})=>{const[i,o]=g.useState(!1);return!t||t.includes("via.placeholder.com")||t==="undefined"||t==="null"||i?a.jsxs("div",{onClick:r,className:`${n} bg-gradient-to-br from-gray-200 to-gray-300 flex items-center justify-center text-gray-500 relative cursor-pointer shadow-inner`,children:[a.jsx("i",{className:"fas fa-user text-xs opacity-50"}),s&&a.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white text-[8px] w-4 h-4 flex items-center justify-center rounded-full border-2 border-white",children:a.jsx("i",{className:"fas fa-check"})})]}):a.jsxs("div",{className:"relative inline-block",onClick:r,children:[a.jsx("img",{src:t,alt:e||"User",className:`${n} bg-gray-100 object-cover cursor-pointer`,onError:()=>o(!0),loading:"lazy"}),s&&a.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white text-[8px] w-4 h-4 flex items-center justify-center rounded-full border-2 border-white",children:a.jsx("i",{className:"fas fa-check"})})]})},$B=t=>new Promise(e=>{const n=document.createElement("canvas"),s=document.createElement("video");s.autoplay=!0,s.muted=!0,s.src=URL.createObjectURL(t),s.onloadeddata=()=>{n.width=s.videoWidth,n.height=s.videoHeight,s.currentTime=1},s.onseeked=()=>{n.getContext("2d").drawImage(s,0,0,s.videoWidth,s.videoHeight),n.toBlob(i=>{URL.revokeObjectURL(s.src),e(i)},"image/jpeg",.7)}}),zB=t=>{if(t.thumbnailURL)return t.thumbnailURL;if(t.mediaType==="image"&&t.mediaURL)try{return t.mediaURL.split("&token=")[0].replace(/(\.[a-zA-Z0-9]+)(\?alt=media)/,"_200x200$1$2")}catch{return null}return null},qB=t=>{const[e,n]=g.useState(null);return g.useEffect(()=>{if(!(!t||typeof t!="string"))try{const s=Fe(H(L,"users",t),r=>{r.exists()&&n(r.data())},r=>console.warn("Author fetch ignored:",r.code));return()=>s()}catch{console.warn("Invalid UID")}},[t]),e},EN=()=>a.jsxs("div",{className:"glass-panel rounded-[30px] p-6 mb-8 border border-white/40 animate-pulse",children:[a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx("div",{className:"w-12 h-12 rounded-2xl bg-gray-200/50"}),a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 bg-gray-200/50 rounded w-1/3"}),a.jsx("div",{className:"h-3 bg-gray-200/50 rounded w-1/4"})]})]}),a.jsx("div",{className:"h-4 bg-gray-200/50 rounded w-full mb-2"}),a.jsx("div",{className:"h-4 bg-gray-200/50 rounded w-3/4 mb-4"}),a.jsx("div",{className:"w-full h-64 bg-gray-200/50 rounded-[24px]"})]}),WB=({viewIds:t=[],reactions:e=[],onClose:n})=>{const[s,r]=g.useState([]),[i,o]=g.useState(!0);return g.useEffect(()=>{(async()=>{if(!Array.isArray(t)||t.length===0){o(!1);return}try{const c=t.filter(m=>typeof m=="string"&&m.trim()!=="");if(c.length===0){o(!1);return}const u=c.map(m=>jt(H(L,"users",m))),f=(await Promise.all(u)).map(m=>{if(!m.exists())return null;const x=m.data(),b=e.find(E=>E.uid===m.id),N=x.displayName||x.username||"Aristocrat";return{uid:m.id,displayName:N,photoURL:x.photoURL,reaction:b?b.emoji:null}}).filter(Boolean);r(f)}catch(c){console.error("Error fetching viewers:",c)}finally{o(!1)}})()},[t,e]),a.jsxs("div",{className:"absolute inset-0 z-[60] bg-black/95 flex flex-col animate-fade-in-up",children:[a.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-white/10",children:[a.jsxs("h3",{className:"text-white font-bold text-lg",children:["Views (",t.length,")"]}),a.jsx("button",{onClick:n,className:"text-white/70 hover:text-white",children:a.jsx("i",{className:"fas fa-times text-xl"})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar",children:i?a.jsx("p",{className:"text-white/50 text-center",children:"Loading..."}):s.length===0?a.jsx("p",{className:"text-white/50 text-center",children:"No views yet."}):a.jsx("div",{className:"space-y-4",children:s.map(l=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Al,{src:l.photoURL,className:"w-10 h-10 rounded-full border border-white/20 object-cover",alt:l.displayName}),a.jsx("span",{className:"text-white font-medium text-sm",children:l.displayName})]}),l.reaction&&a.jsx("span",{className:"text-2xl animate-bounce-short",children:l.reaction})]},l.uid))})})]})},GB=({moments:t,onClose:e,currentUser:n})=>{var P,C;const[s,r]=g.useState(0),[i,o]=g.useState(0),[l,c]=g.useState(""),[u,h]=g.useState(!1),[f,m]=g.useState(!1),[x,b]=g.useState(!1),[N,E]=g.useState(!1),[w,v]=g.useState(!1),[T,I]=g.useState(""),R=t[s],V=(n==null?void 0:n.uid)===R.uid;g.useEffect(()=>(document.body.style.overflow="hidden",()=>{document.body.style.overflow=""}),[]),g.useEffect(()=>{var q;R&&n&&!V&&!((q=R.views)!=null&&q.includes(n.uid))&&typeof n.uid=="string"&&he(H(L,"moments",R.id),{views:ut(n.uid)}).catch(Se=>console.warn("Moment view fail",Se))},[R,n,V]),g.useEffect(()=>{if(x||N||w)return;o(0);const q=setInterval(()=>{f||o(ue=>ue>=100?s<t.length-1?(r(Se=>Se+1),0):(clearInterval(q),e(),100):ue+1)},50);return()=>clearInterval(q)},[s,t.length,e,f,x,N,w]);const j=async q=>{const ue=document.createElement("div");ue.textContent=q,ue.className="fixed inset-0 flex items-center justify-center text-8xl animate-ping pointer-events-none z-[2000]",document.body.appendChild(ue),setTimeout(()=>ue.remove(),1e3);try{await he(H(L,"moments",R.id),{reactions:ut({uid:n.uid,emoji:q,timestamp:Date.now()})})}catch(Se){console.error("Error reacting:",Se)}},y=async q=>{if(q.preventDefault(),!!l.trim()){h(!0);try{const ue=[n.uid,R.uid].sort().join("_"),Se=H(L,"conversations",ue);await Ir(Se,{participants:[n.uid,R.uid],users:[{uid:n.uid,displayName:n.displayName,photoURL:n.photoURL},{uid:R.uid,displayName:R.userName,photoURL:R.userAvatar}],updatedAt:Ie(),isGroup:!1,lastMessage:`Replied to moment: ${l}`,lastSenderId:n.uid},{merge:!0}),await ze(ae(L,`conversations/${ue}/messages`),{text:l,senderId:n.uid,type:"reply",replyToMoment:R.mediaURL,timestamp:Ie()}),c(""),m(!1)}catch(ue){console.error(ue)}finally{h(!1)}}},k=async()=>{window.confirm("Delete this moment?")&&(await is(H(L,"moments",R.id)),t.length===1?e():(r(0),E(!1)))},S=()=>{I(R.caption||""),v(!0),E(!1),m(!0)},D=async()=>{try{await he(H(L,"moments",R.id),{caption:T}),v(!1),m(!1)}catch(q){console.error("Update failed",q),alert("Failed to save.")}};return a.jsxs("div",{className:"fixed inset-0 z-[99999] bg-black flex flex-col w-screen h-[100dvh] overflow-hidden overscroll-none touch-none",children:[x&&a.jsx(WB,{viewIds:R.views||[],reactions:R.reactions||[],onClose:()=>{b(!1),m(!1)}}),a.jsx("div",{className:"absolute top-4 left-4 right-4 flex gap-1 z-30",children:t.map((q,ue)=>a.jsx("div",{className:"h-1 bg-white/30 flex-1 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-full bg-white transition-all duration-100 ease-linear",style:{width:ue<s?"100%":ue===s?`${i}%`:"0%"}})},ue))}),a.jsxs("div",{className:"absolute top-8 left-4 right-4 z-30 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Al,{src:R.userAvatar,className:"w-10 h-10 rounded-full border-2 border-white/50",alt:"User"}),a.jsxs("div",{className:"flex flex-col text-left",children:[a.jsx("span",{className:"text-white font-bold text-sm shadow-black drop-shadow-md",children:R.userName||"Momento User"}),a.jsx("span",{className:"text-white/70 text-[10px]",children:(P=R.timestamp)!=null&&P.seconds?new Date(R.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"})]})]}),a.jsxs("div",{className:"flex items-center gap-4",children:[V&&a.jsxs("button",{onClick:q=>{q.stopPropagation(),b(!0),m(!0)},className:"flex items-center gap-2 bg-black/40 px-3 py-1.5 rounded-full backdrop-blur-md hover:bg-black/60 transition-colors",children:[a.jsx("i",{className:"fas fa-eye text-white text-xs"}),a.jsx("span",{className:"text-white text-xs font-bold",children:((C=R.views)==null?void 0:C.length)||0})]}),V&&a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:q=>{q.stopPropagation(),E(!N),m(!N)},className:"text-white text-lg w-8 h-8 flex items-center justify-center rounded-full hover:bg-white/20",children:a.jsx("i",{className:"fas fa-ellipsis-v"})}),N&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-32 bg-white rounded-xl shadow-xl overflow-hidden py-1 z-50 animate-fade-in",children:[a.jsxs("button",{onClick:S,className:"w-full text-left px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-100 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-pen text-xs"})," Edit"]}),a.jsxs("button",{onClick:k,className:"w-full text-left px-4 py-2.5 text-sm text-red-600 hover:bg-red-50 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-trash text-xs"})," Delete"]})]})]}),a.jsx("button",{onClick:e,className:"text-white text-3xl drop-shadow-md",children:a.jsx("i",{className:"fas fa-times"})})]})]}),a.jsxs("div",{className:"flex-1 relative flex items-center justify-center bg-gray-900",children:[R.mediaType==="video"?a.jsx("video",{src:R.mediaURL,autoPlay:!f&&!x&&!N&&!w,muted:!1,playsInline:!0,className:"max-h-full max-w-full object-contain"}):a.jsx("img",{src:R.mediaURL,className:"max-h-full max-w-full object-contain",alt:"Moment",loading:"lazy",decoding:"async"}),!x&&!N&&!w&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"absolute inset-y-0 left-0 w-1/3 z-20",onClick:q=>{q.stopPropagation(),s>0&&(r(ue=>ue-1),o(0))}}),a.jsx("div",{className:"absolute inset-y-0 right-0 w-1/3 z-20",onClick:q=>{q.stopPropagation(),s<t.length-1?(r(ue=>ue+1),o(0)):e()}})]}),a.jsx("div",{className:"absolute bottom-24 left-0 right-0 px-6 text-center z-40",children:w?a.jsxs("div",{className:"flex gap-2 animate-fade-in-up",children:[a.jsx("input",{autoFocus:!0,value:T,onChange:q=>I(q.target.value),className:"flex-1 bg-black/50 text-white border border-white/50 rounded-xl px-4 py-2 backdrop-blur-md outline-none",placeholder:"Add a caption..."}),a.jsx("button",{onClick:D,className:"bg-white text-black px-4 rounded-xl font-bold",children:"Save"})]}):R.caption&&a.jsx("p",{className:"text-white font-medium drop-shadow-md bg-black/30 inline-block px-3 py-1 rounded-xl backdrop-blur-sm",children:R.caption})})]}),!V&&!x&&a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 pb-8 bg-gradient-to-t from-black/80 to-transparent z-30 flex flex-col gap-4",children:[!f&&a.jsx("div",{className:"flex gap-4 overflow-x-auto no-scrollbar pb-2 justify-center animate-fade-in",children:["","","","","",""].map(q=>a.jsx("button",{onClick:()=>j(q),className:"text-3xl hover:scale-125 transition-transform active:scale-95",children:q},q))}),a.jsxs("form",{onSubmit:y,className:"flex gap-2 items-center",children:[a.jsx("input",{value:l,onChange:q=>c(q.target.value),onFocus:()=>m(!0),onBlur:()=>!l&&m(!1),placeholder:"Reply to story...",className:"flex-1 bg-transparent border border-white/50 rounded-full px-5 py-3 text-white placeholder-white/70 outline-none focus:border-white focus:bg-black/50 transition-all text-sm backdrop-blur-sm z-40"}),a.jsx("button",{type:"submit",disabled:!l.trim()||u,className:"text-white text-xl p-2 hover:text-primary transition-colors disabled:opacity-50 z-40",children:a.jsx("i",{className:"fas fa-paper-plane"})})]})]})]})},HB=({currentUser:t,onUpload:e})=>{const[n,s]=g.useState([]),[r,i]=g.useState(null),[o,l]=g.useState([]),c=g.useRef(null);g.useEffect(()=>{if(!t||!t.uid)return;const f=ae(L,`users/${t.uid}/following`),m=Fe(f,x=>{const b=x.docs.map(N=>N.id);l([...b,t.uid])},x=>console.log("Following fetch skipped:",x.code));return()=>m()},[t]),g.useEffect(()=>{if(o.length===0)return;const f=new Date(Date.now()-24*60*60*1e3),m=qe(ae(L,"moments"),rt("timestamp",">",f),_t("timestamp","desc")),x=Fe(m,b=>{const w=b.docs.map(T=>({id:T.id,...T.data()})).filter(T=>o.includes(T.uid)).reduce((T,I)=>(T[I.uid]||(T[I.uid]=[]),T[I.uid].push(I),T),{}),v=Object.entries(w).map(([T,I])=>({uid:T,items:I,userAvatar:I[0].userAvatar,userName:I[0].userName,latestTimestamp:I[0].timestamp})).sort((T,I)=>I.latestTimestamp-T.latestTimestamp);s(v)},b=>{console.warn("Moments fetch failed (likely network/adblock):",b.code)});return()=>x()},[o]);const u=f=>{const m=f.target.files[0];m&&e(m)},h=f=>{if(!f)return{};const m=Date.now(),x=f.seconds*1e3,b=m-x,N=24*60*60*1e3;return{background:`conic-gradient(#008080 ${100-b/N*100}%, #e5e7eb 0)`}};return a.jsxs("div",{className:"mb-8",children:[a.jsxs("h3",{className:"font-black text-transparent bg-clip-text bg-gradient-to-r from-yellow-500 via-orange-400 to-yellow-500 mb-4 flex items-center gap-2 text-2xl tracking-tighter animate-pulse",children:[a.jsx("i",{className:"fas fa-bolt text-yellow-500 animate-bounce"})," Momento"]}),a.jsxs("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar px-1",children:[a.jsxs("div",{className:"flex-shrink-0 cursor-pointer group relative",onClick:()=>c.current.click(),children:[a.jsx("div",{className:"w-[70px] h-[70px] rounded-full border-2 border-dashed border-gray-300 flex items-center justify-center bg-white group-hover:border-primary transition-all",children:a.jsx("i",{className:"fas fa-plus text-gray-400 group-hover:text-primary text-xl"})}),a.jsx("p",{className:"text-[11px] text-center font-bold text-gray-500 mt-1 group-hover:text-primary",children:"Add Yours"}),a.jsx("input",{type:"file",ref:c,className:"hidden",accept:"image/*,video/*",onChange:u})]}),n.map(f=>{const m=f.items[0],x=f.uid===(t==null?void 0:t.uid);return a.jsxs("div",{className:"flex-shrink-0 cursor-pointer group",onClick:()=>i(f.items),children:[a.jsxs("div",{className:"relative w-[74px] h-[74px] rounded-full flex items-center justify-center p-[2px]",style:h(m.timestamp),children:[a.jsx("div",{className:"w-[68px] h-[68px] bg-white rounded-full flex items-center justify-center overflow-hidden border-2 border-white relative",children:m.mediaType==="video"?a.jsx("video",{src:m.mediaURL,className:"w-full h-full object-cover",muted:!0}):a.jsx("img",{src:m.mediaURL,className:"w-full h-full object-cover group-hover:scale-110 transition-transform duration-700",alt:"Preview",loading:"lazy"})}),a.jsx(Al,{src:f.userAvatar,className:"absolute bottom-0 right-0 w-6 h-6 rounded-full border-2 border-white shadow-sm",alt:"Avatar"})]}),a.jsx("p",{className:"text-[11px] text-center font-bold text-dark mt-1 truncate w-16",children:x?"You":f.userName.split(" ")[0]})]},f.uid)})]}),r&&a.jsx(GB,{moments:r,currentUser:t,onClose:()=>i(null)})]})},KB=({src:t,poster:e,isPlaying:n,onFullscreen:s,isMuted:r,toggleMute:i})=>{const o=g.useRef(null),[l,c]=g.useState(0),[u,h]=g.useState(0),[f,m]=g.useState(0);g.useEffect(()=>{o.current&&(o.current.muted=r)},[r]),g.useEffect(()=>{if(o.current)if(n){const v=o.current.play();v!==void 0&&v.catch(()=>{})}else o.current.pause()},[n]);const x=()=>{const v=o.current;v&&(h(v.currentTime),c(v.currentTime/v.duration*100))},b=()=>{const v=o.current;v&&m(v.duration)},N=v=>{v.stopPropagation();const T=v.target.value/100*f;o.current&&(o.current.currentTime=T),c(v.target.value)},E=v=>{o.current&&(o.current.currentTime+=v)},w=v=>{if(!v)return"0:00";const T=Math.floor(v/60),I=Math.floor(v%60);return`${T}:${I<10?"0":""}${I}`};return a.jsxs("div",{className:"relative w-full bg-black rounded-[24px] overflow-hidden group",children:[a.jsx("video",{ref:o,src:t,poster:e,className:"w-full h-auto max-h-[600px] object-contain bg-black",loop:!0,playsInline:!0,preload:"metadata",onTimeUpdate:x,onLoadedMetadata:b,onClick:s}),a.jsx("button",{onClick:v=>{v.stopPropagation(),i()},className:"absolute top-4 right-4 z-20 w-9 h-9 bg-black/40 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-black/60 transition-all",children:a.jsx("i",{className:`fas ${r?"fa-volume-mute":"fa-volume-up"} text-xs`})}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-gradient-to-t from-black/80 to-transparent flex flex-col gap-2 z-20 opacity-100",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:"text-white text-[10px] font-medium w-8",children:w(u)}),a.jsx("input",{type:"range",min:"0",max:"100",value:l||0,onChange:N,onClick:v=>v.stopPropagation(),className:"flex-1 h-1 bg-white/20 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:bg-white [&::-webkit-slider-thumb]:rounded-full"}),a.jsx("span",{className:"text-white text-[10px] font-medium w-8 text-right",children:w(f)})]}),a.jsxs("div",{className:"flex items-center justify-between mt-1",children:[a.jsxs("div",{className:"flex items-center gap-6 text-white/90",children:[a.jsxs("button",{onClick:v=>{v.stopPropagation(),E(-10)},className:"hover:text-primary transition-colors flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-undo-alt text-xs"}),a.jsx("span",{className:"text-[9px] font-bold",children:"10s"})]}),a.jsxs("button",{onClick:v=>{v.stopPropagation(),E(10)},className:"hover:text-primary transition-colors flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-redo-alt text-xs"}),a.jsx("span",{className:"text-[9px] font-bold",children:"10s"})]})]}),a.jsx("button",{onClick:v=>{v.stopPropagation(),s()},className:"text-white hover:scale-110 transition-transform",children:a.jsx("i",{className:"fas fa-expand text-sm"})})]})]})]})},QB=g.memo(({post:t,user:e,isLikedByMe:n,playingPostId:s,videoContainerRefs:r,setActiveMenuPostId:i,activeMenuPostId:o,setBoostTarget:l,handleTogglePrivate:c,handleDelete:u,handleSavePost:h,setReportingPostId:f,setReportModalOpen:m,setFullscreenMedia:x,openVideoInWatch:b,handleLike:N,toggleCommentBox:E,handleShare:w,activeCommentBox:v,setActiveCommentBox:T,commentText:I,setCommentText:R,replyingToId:V,setReplyingToId:j,submitComment:y,toggleNav:k,navigate:S,isGlobalMuted:D,toggleGlobalMute:P})=>{var K;const C=qB(t==null?void 0:t.uid),q=(C==null?void 0:C.photoURL)||t.userAvatar,ue=(C==null?void 0:C.displayName)||t.userName||"Aristocrat",Se=(C==null?void 0:C.isVerified)||t.isVerified===!0,fe=zB(t);return a.jsxs("div",{className:`glass-panel rounded-[30px] p-6 hover:shadow-xl transition-all duration-300 border relative ${Se?"border-blue-100 shadow-blue-50":"border-white/60"}`,children:[t.isPromoted&&a.jsx("div",{className:"absolute top-4 right-16 text-[10px] font-bold text-gray-400 uppercase tracking-wider bg-gray-100 px-2 py-1 rounded",children:"Promoted"}),a.jsxs("div",{className:"flex justify-between items-start mb-5",children:[a.jsxs("div",{className:"flex items-center gap-4 cursor-pointer group",onClick:()=>S(`/profile/${t.uid}`),children:[a.jsx(Al,{src:q,className:`w-12 h-12 rounded-2xl object-cover ${Se?"ring-2 ring-offset-2 ring-blue-500":""}`,alt:"User Avatar",isVerified:Se}),a.jsxs("div",{children:[a.jsxs("h4",{className:`font-bold text-lg leading-tight flex items-center gap-1 ${Se?"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-blue-400":"text-dark group-hover:text-primary"}`,children:[ue,Se&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-sm ml-1",title:"Verified"}),t.isPrivate&&a.jsx("i",{className:"fas fa-lock text-xs text-gray-400 ml-1"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-medium",children:(K=t.timestamp)!=null&&K.seconds?new Date(t.timestamp.seconds*1e3).toLocaleString("en-US",{hour:"2-digit",minute:"2-digit",day:"2-digit",month:"short"}):"Just now"})]})]}),a.jsxs("div",{className:"relative post-menu-container",children:[a.jsx("button",{onClick:()=>i(o===t.id?null:t.id),className:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),o===t.id&&a.jsx("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white/95 backdrop-blur-xl rounded-2xl shadow-xl border border-white/50 overflow-hidden z-20 py-1 animate-fade-in",children:(e==null?void 0:e.uid)===t.uid?a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>{l({id:t.id,type:"post",name:"Your Post"}),i(null)},className:"w-full text-left px-4 py-3 text-sm text-yellow-600 hover:bg-gray-50 font-bold flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-rocket"})," Boost Post"]}),a.jsxs("button",{onClick:()=>c(t),className:"w-full text-left px-4 py-2.5 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-3",children:[a.jsx("i",{className:`fas ${t.isPrivate?"fa-globe":"fa-lock"} text-gray-500 w-4`})," ",t.isPrivate?"Make Public":"Make Private"]}),a.jsxs("button",{onClick:()=>u(t.id),className:"w-full text-left px-4 py-2.5 text-sm text-accent hover:bg-red-50 font-bold flex items-center gap-3",children:[a.jsx("i",{className:"fas fa-trash w-4"})," Delete"]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>h(t),className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[a.jsx("i",{className:"far fa-bookmark w-4 text-center"})," Save Post"]}),a.jsxs("button",{onClick:()=>{f(t.id),m(!0),i(null)},className:"w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-flag w-4 text-center"})," Report"]})]})})]})]}),a.jsx(YB,{text:t.text,hasMedia:!!t.mediaURL}),t.mediaURL&&a.jsx("div",{className:"rounded-[24px] overflow-hidden mb-5 shadow-md border border-white/50 group relative","data-id":t.id,"data-mediatype":t.mediaType,ref:se=>r.current[t.id]=se,children:t.mediaType==="video"?a.jsx(KB,{src:t.mediaURL,poster:fe,isPlaying:s===t.id,onFullscreen:()=>b(t),isMuted:D,toggleMute:P}):a.jsx("div",{className:"w-full h-auto cursor-pointer",onClick:()=>x({url:t.mediaURL,type:t.mediaType}),children:a.jsx(BB,{src:t.mediaURL,placeholder:fe,className:"w-full h-auto max-h-[650px] pointer-events-none"})})}),a.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-100/50",children:[a.jsxs("button",{onClick:()=>N(t),className:`h-10 px-5 rounded-xl border flex items-center gap-2 transition-all group shadow-sm ${n?"bg-accent/10 border-accent/20 text-accent":"bg-white/50 border-white text-gray-600 hover:text-accent hover:bg-white"}`,children:[a.jsx("i",{className:`${n?"fas":"far"} fa-heart group-hover:scale-110`}),a.jsx("span",{className:"font-bold text-sm",children:t.likes||0})]}),a.jsxs("button",{onClick:()=>E(t.id),className:"h-10 px-5 rounded-xl bg-white/50 border border-white flex items-center gap-2 text-gray-600 hover:text-primary hover:bg-white transition-all group shadow-sm",children:[a.jsx("i",{className:"far fa-comment group-hover:scale-110 transition-transform"}),a.jsx("span",{className:"font-bold text-sm",children:t.comments||0})]}),a.jsx("button",{onClick:()=>w(t),className:"h-10 w-10 rounded-xl bg-white/50 border border-white flex items-center justify-center text-gray-600 hover:text-dark hover:bg-white ml-auto transition-all shadow-sm",children:a.jsx("i",{className:"far fa-share-square"})})]}),v===t.id&&a.jsxs("div",{className:"mt-4 animate-fade-in",children:[a.jsx(XB,{postId:t.id,setCommentText:R,setActiveCommentBox:T,setReplyingToId:j}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsx("input",{type:"text",placeholder:V?"Replying...":"Write a comment...",className:"flex-1 bg-white/80 border border-white/50 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20 shadow-inner",value:I,onChange:se=>R(se.target.value),onKeyDown:se=>se.key==="Enter"&&y(t.id),onFocus:()=>k(!1),onBlur:()=>setTimeout(()=>k(!0),200),autoFocus:!0}),a.jsx("button",{onClick:()=>y(t.id),disabled:!I.trim(),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md hover:bg-primary-dark transition-colors disabled:opacity-50",children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})]})}),YB=({text:t,hasMedia:e})=>{const[n,s]=g.useState(!1),r=t||"",i=e?2:6,o=r.split(`
`),l=o.length>i||r.length>(e?100:300),c=n||!l?r:o.slice(0,i).join(`
`).slice(0,e?100:300)+"...",u=h=>h.split(/(#[a-zA-Z0-9_]+)/g).map((m,x)=>m.startsWith("#")?a.jsx("span",{className:"text-primary font-bold cursor-pointer hover:underline",children:m},x):m);return a.jsxs("div",{className:"text-gray-800 mb-3 text-[15px] leading-relaxed whitespace-pre-wrap transition-all",children:[u(c),l&&a.jsx("button",{onClick:h=>{h.stopPropagation(),s(!n)},className:"text-primary font-bold ml-1 hover:underline focus:outline-none text-sm",children:n?"Show Less":"Read More"})]})},XB=({postId:t,setCommentText:e,setActiveCommentBox:n,setReplyingToId:s})=>{const r=tt(),[i,o]=g.useState([]);g.useEffect(()=>{if(!t)return;const f=qe(ae(L,"posts",t,"comments"),_t("timestamp","asc")),m=Fe(f,x=>{o(x.docs.map(b=>({id:b.id,...b.data()})))},x=>{console.log("Comments fetch error:",x.code)});return()=>m()},[t]);const l=i.filter(f=>!f.parentId),c=f=>i.filter(m=>m.parentId===f),u=f=>{e(`@${f.userName} `),n(t),s(f.parentId||f.id)},h=({c:f,isReply:m})=>{var x;return a.jsxs("div",{className:`flex gap-3 items-start text-sm mb-3 ${m?"ml-10 mt-1":""}`,children:[a.jsx(Al,{src:f.userAvatar,className:"w-8 h-8 rounded-full object-cover flex-shrink-0 border border-gray-200 cursor-pointer",alt:f.userName,onClick:()=>r(`/profile/${f.uid}`)}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none border border-gray-100 inline-block",children:[a.jsxs("span",{className:"font-bold text-xs block text-dark flex items-center gap-1 cursor-pointer hover:underline mb-0.5",onClick:()=>r(`/profile/${f.uid}`),children:[f.userName,f.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-[10px]",title:"Verified"})]}),a.jsx("p",{className:"text-gray-700 leading-snug",children:f.text})]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1 ml-1",children:[a.jsx("span",{className:"text-[10px] text-gray-400",children:(x=f.timestamp)!=null&&x.seconds?new Date(f.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"}),!m&&a.jsx("button",{onClick:()=>u(f),className:"text-[10px] font-bold text-gray-500 hover:text-primary transition-colors",children:"Reply"})]})]})]})};return i.length===0?a.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"No comments yet."}):a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-50 max-h-[300px] overflow-y-auto custom-scrollbar px-1",children:l.map(f=>a.jsxs("div",{children:[a.jsx(h,{c:f,isReply:!1}),c(f.id).map(m=>a.jsx(h,{c:m,isReply:!0},m.id))]},f.id))})},JB=({posts:t,onTagClick:e})=>{const n=g.useMemo(()=>{const s={};return t.forEach(r=>{if(!r.text)return;const i=r.text.match(/#[a-zA-Z0-9_]+/g);i&&i.forEach(o=>{s[o]=(s[o]||0)+1})}),Object.entries(s).sort((r,i)=>i[1]-r[1]).slice(0,5).map(([r,i])=>({tag:r,count:i}))},[t]);return n.length===0?null:a.jsxs("div",{className:"glass-panel rounded-[30px] p-6 sticky top-6",children:[a.jsxs("h3",{className:"font-bold text-dark mb-6 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-chart-line text-primary"})," Trending"]}),n.map((s,r)=>a.jsxs("div",{className:"flex items-center gap-4 mb-4 last:mb-0 cursor-pointer group",onClick:()=>e(s.tag),children:[a.jsxs("span",{className:"text-3xl font-black text-gray-200 group-hover:text-primary/30",children:["0",r+1]}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-dark text-sm group-hover:text-primary",children:s.tag}),a.jsxs("p",{className:"text-xs text-gray-400",children:[s.count," posts"]})]})]},s.tag))]})},ZB=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState([]),[i,o]=g.useState(!0),[l,c]=g.useState(null),[u,h]=g.useState(null),[f,m]=g.useState(!0),x=g.useCallback(()=>m(X=>!X),[]),[b,N]=g.useState(""),[E,w]=g.useState(!1),[v,T]=g.useState(null),[I,R]=g.useState(null),[V,j]=g.useState(null),[y,k]=g.useState(0),S=g.useRef(null),[D,P]=g.useState(null),[C,q]=g.useState(""),[ue,Se]=g.useState(null),[fe,K]=g.useState(null),[se,ne]=g.useState(null),[F,G]=g.useState(!1),[J,we]=g.useState(null),[je,U]=g.useState(null),xe=g.useRef({}),re=g.useRef(null),Ee=X=>window.dispatchEvent(new CustomEvent("toggle-nav",{detail:{visible:X}}));g.useEffect(()=>{const X={root:null,rootMargin:"0px",threshold:.7},z=pe=>{let ye=0,ge=null;if(l){const Ce=pe.find(Et=>Et.target.dataset.id===l);Ce&&Ce.intersectionRatio<.7&&c(null)}pe.forEach(Ce=>{Ce.target.dataset.mediatype==="video"&&Ce.isIntersecting&&Ce.intersectionRatio>.7&&Ce.intersectionRatio>ye&&(ye=Ce.intersectionRatio,ge=Ce.target.dataset.id)}),ge&&c(ge)};return re.current||(re.current=new IntersectionObserver(z,X)),Object.entries(xe.current).forEach(([pe,ye])=>{ye&&re.current.observe(ye)}),()=>re.current.disconnect()},[s,l]),g.useEffect(()=>{const X=Pt(Ve,async ge=>{if(ge){const Ce=H(L,"users",ge.uid);try{(await jt(Ce)).exists()||(console.log("Creating missing user profile..."),await Ir(Ce,{uid:ge.uid,displayName:ge.displayName||ge.email.split("@")[0],email:ge.email,photoURL:ge.photoURL,createdAt:Ie(),followers:[],following:[],savedPosts:[]},{merge:!0}))}catch(Dn){console.warn("Error checking user doc:",Dn)}const Et=Fe(Ce,Dn=>{Dn.exists()?n({uid:ge.uid,...Dn.data()}):n({uid:ge.uid,...ge})},Dn=>{console.warn("User profile snapshot error:",Dn.code),n({uid:ge.uid,...ge})});return()=>Et()}else n(null)}),z=qe(ae(L,"posts"),_t("timestamp","desc")),pe=Fe(z,ge=>{r(ge.docs.map(Ce=>({id:Ce.id,...Ce.data()}))),o(!1)},ge=>{console.error("Posts snapshot error:",ge.message),o(!1)}),ye=ge=>{ge.target.closest(".post-menu-container")||K(null)};return document.addEventListener("click",ye),()=>{X(),pe(),document.removeEventListener("click",ye)}},[]);const be=async X=>{if(!e)return alert("Sign in to share moments.");w(!0);try{if(X.size>50*1024*1024)return w(!1),alert("File too large (Max 50MB)");const z=sn(rn,`moments/${e.uid}/${Date.now()}_${X.name}`),pe=bp(z,X);pe.on("state_changed",null,null,async()=>{var Ce;const ye=await nn(pe.snapshot.ref),ge=e.displayName||((Ce=e.email)==null?void 0:Ce.split("@")[0])||"Aristocrat";await ze(ae(L,"moments"),{uid:e.uid,userName:ge,userAvatar:e.photoURL,mediaURL:ye,mediaType:X.type.startsWith("video/")?"video":"image",timestamp:Ie(),views:[],reactions:[],caption:""}),w(!1),alert("Moment shared!")})}catch(z){console.error(z),w(!1),alert("Error uploading moment.")}},Q=async X=>{const z=X.target.files[0];if(!z)return;if(z.size>50*1024*1024)return alert("File is too large. Max size is 50MB.");T(z);const pe=z.type.startsWith("video/")?"video":"image";j(pe),R(URL.createObjectURL(z))},oe=async()=>{if(!(!b.trim()&&!v||!e)){w(!0),k(0);try{let X=null,z=null;if(v){const pe=sn(rn,`posts/${e.uid}/${Date.now()}_${v.name}`),ye=bp(pe,v);if(await new Promise((ge,Ce)=>{ye.on("state_changed",Et=>k(Et.bytesTransferred/Et.totalBytes*100),Ce,async()=>{X=await nn(ye.snapshot.ref),ge()})}),V==="video")try{const ge=await $B(v);if(ge){const Ce=sn(rn,`thumbnails/${e.uid}/${Date.now()}_thumb.jpg`);await bp(Ce,ge),z=await nn(Ce)}}catch(ge){console.error("Error generating thumbnail:",ge)}}await ze(ae(L,"posts"),{text:b,uid:e.uid,userName:e.displayName||"Aristocrat",userAvatar:e.photoURL,isVerified:e.isVerified||!1,mediaURL:X,thumbnailURL:z,mediaType:V,category:"General",timestamp:Ie(),likes:0,likedBy:[],comments:0,isPrivate:!1,isPromoted:!1}),N(""),T(null),R(null),k(0)}catch(X){console.error(X),alert("Upload failed.")}finally{w(!1)}}},Me=async X=>{if(!e)return alert("Sign in.");if(!X||!X.id)return;const z=H(L,"posts",X.id),pe=X.likedBy&&X.likedBy.includes(e.uid);try{if(pe)await he(z,{likes:pt(-1),likedBy:kt(e.uid)});else if(await he(z,{likes:pt(1),likedBy:ut(e.uid)}),X.uid!==e.uid){const ye=`like_${X.id}_${e.uid}`;await Ir(H(L,"notifications",ye),{recipientId:X.uid,senderId:e.uid,senderName:e.displayName||"User",senderAvatar:e.photoURL,type:"like",targetId:X.id,timestamp:Ie(),isRead:!1})}}catch(ye){console.error(ye)}},Ze=async X=>{if(!(!C.trim()||!e||!X))try{await ze(ae(L,"posts",X,"comments"),{text:C,uid:e.uid,userName:e.displayName||"Aristocrat",userAvatar:e.photoURL,isVerified:e.isVerified||!1,parentId:ue,timestamp:Ie()}),await he(H(L,"posts",X),{comments:pt(1)}),q(""),Se(null),Ee(!0)}catch(z){console.error("Comment failed",z)}},vt=async X=>{if(!e)return alert("Sign in to save.");if(!(!X||!X.id))try{await Ir(H(L,"users",e.uid),{savedPosts:ut(X.id)},{merge:!0}),alert("Post saved!"),K(null)}catch(z){console.error("Save failed:",z)}},Pn=async X=>{!J||!e||(await ze(ae(L,"reports"),{targetId:J,type:"post",reporter:e.uid,reason:X,timestamp:Ie()}),alert("Report submitted."),G(!1),we(null))},Yt=async X=>{await ze(ae(L,"boost_requests"),{...X,requesterId:e.uid,timestamp:Ie()}),await he(H(L,"posts",X.targetId),{isPromoted:!0}),U(null),alert("Boost activated! Your post is now being promoted.")},as=async X=>{X!=null&&X.id&&(await he(H(L,"posts",X.id),{isPrivate:!X.isPrivate}),K(null))},un=async X=>{X&&window.confirm("Are you sure you want to delete this post?")&&await is(H(L,"posts",X))},Nt=async X=>{if(!(X!=null&&X.id))return;const z=`${window.location.origin}/post/${X.id}`;navigator.share?navigator.share({title:X.userName,text:X.text,url:z}):navigator.clipboard.writeText(z).then(()=>{alert("Link copied!")})},Wn=X=>{D===X?(P(null),Se(null)):(P(X),q(""),Se(null))},bs=X=>{t("/watch",{state:{startVideoId:X.id}})},Z=u?s.filter(X=>{var z;return(z=X.text)==null?void 0:z.includes(u)}):s;return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1200px] mx-auto pb-24",children:[a.jsx(yn,{}),a.jsx(HB,{currentUser:e,onUpload:be}),a.jsx("div",{className:"flex justify-between items-center mb-8",children:a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-black text-dark tracking-tight",children:"The Feed"}),a.jsx("p",{className:"text-gray-500 font-medium",children:u?a.jsxs("span",{children:["Filtered by ",a.jsx("span",{className:"text-primary font-bold",children:u})," ",a.jsx("button",{onClick:()=>h(null),className:"ml-2 text-red-500 text-xs hover:underline",children:"(Clear)"})]}):"Curated for you"})]})}),a.jsxs("div",{className:"flex flex-col lg:flex-row gap-8 items-start",children:[a.jsxs("div",{className:"flex-1 w-full min-w-0 space-y-8",children:[a.jsx("div",{className:"glass-panel rounded-[30px] p-2 z-20 relative",children:a.jsxs("div",{className:"bg-white/60 rounded-[24px] p-5 backdrop-blur-sm",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsx(Al,{src:e==null?void 0:e.photoURL,className:"w-12 h-12 rounded-2xl object-cover",alt:"User Avatar"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("textarea",{placeholder:"Share your thoughts...",className:"w-full bg-transparent border-none outline-none text-lg resize-none mt-2 placeholder-gray-400",rows:"2",value:b,onChange:X=>N(X.target.value)}),I&&a.jsxs("div",{className:"relative mt-2 inline-block group",children:[V==="video"?a.jsx("video",{src:I,controls:!0,className:"h-32 rounded-xl bg-black"}):a.jsx("img",{src:I,className:"h-32 rounded-xl",alt:"Media Preview"}),a.jsx("button",{onClick:()=>{T(null),R(null),j(null)},className:"absolute top-1 right-1 bg-black/50 text-white rounded-full w-6 h-6 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times text-xs"})})]}),E&&v&&a.jsx("div",{className:"mt-3 w-full bg-gray-200 rounded-full h-2.5",children:a.jsx("div",{className:"bg-primary h-2.5 rounded-full transition-all duration-300",style:{width:`${y}%`}})})]})]}),a.jsxs("div",{className:"flex justify-between items-center mt-4 pt-4 border-t border-gray-200/50 relative",children:[a.jsxs("div",{className:"flex gap-1 items-center",children:[a.jsx("input",{type:"file",ref:S,className:"hidden",accept:"image/*,video/*",onChange:Q}),a.jsx("button",{onClick:()=>S.current.click(),className:"w-9 h-9 rounded-xl hover:bg-primary/10 text-primary flex items-center justify-center",children:a.jsx("i",{className:"fas fa-image"})})]}),a.jsx("button",{onClick:oe,disabled:E||!b.trim()&&!v,className:"bg-gradient-to-r from-primary to-primary-dark text-white px-6 py-2.5 rounded-xl font-bold hover:shadow-lg transition-all shadow-primary/20 disabled:opacity-50",children:E?`Uploading ${Math.round(y)}%`:"Tukumi"})]})]})}),i?a.jsxs(a.Fragment,{children:[a.jsx(EN,{}),a.jsx(EN,{})]}):Z.map(X=>{if(X.isPrivate&&X.uid!==(e==null?void 0:e.uid))return null;const z=e&&X.likedBy&&X.likedBy.includes(e.uid);return a.jsx(QB,{post:X,user:e,isLikedByMe:z,playingPostId:l,videoContainerRefs:xe,setActiveMenuPostId:K,activeMenuPostId:fe,setBoostTarget:U,handleTogglePrivate:as,handleDelete:un,handleSavePost:vt,setReportingPostId:we,setReportModalOpen:G,setFullscreenMedia:ne,openVideoInWatch:bs,handleLike:Me,toggleCommentBox:Wn,handleShare:Nt,activeCommentBox:D,setActiveCommentBox:P,commentText:C,setCommentText:q,replyingToId:ue,setReplyingToId:Se,submitComment:Ze,toggleNav:Ee,navigate:t,isGlobalMuted:f,toggleGlobalMute:x},X.id)})]}),a.jsx("div",{className:"hidden lg:block w-[340px] space-y-6 sticky top-6",children:a.jsx(JB,{posts:s,onTagClick:h})})]}),se&&a.jsxs("div",{className:"fixed inset-0 bg-black z-[5000] flex items-center justify-center p-0 overflow-hidden cursor-pointer",onClick:()=>ne(null),children:[a.jsx("img",{src:se.url,alt:"Fullscreen Media",className:"max-w-full max-h-full w-full h-auto object-contain",onClick:X=>X.stopPropagation()}),a.jsx("button",{onClick:()=>ne(null),className:"absolute top-6 right-6 text-white text-4xl drop-shadow-md z-[5001]",children:""})]}),F&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center animate-fade-in p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3 text-red-500 text-xl",children:a.jsx("i",{className:"fas fa-flag"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Report Post"})]}),a.jsx("div",{className:"space-y-2 mb-6",children:["Spam or Fraud","Harassment","Violence","False Information"].map(X=>a.jsx("button",{onClick:()=>Pn(X),className:"w-full text-left p-3 rounded-xl bg-gray-50 hover:bg-red-50 hover:text-red-600 text-gray-700 font-medium transition-colors",children:X},X))}),a.jsx("button",{onClick:()=>G(!1),className:"w-full py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancel"})]})}),je&&a.jsx(JI,{target:je,onClose:()=>U(null),onBoost:Yt})]})},e6=()=>{var Ml,Ll,no,so,Ol,Fl,od,Zi,Ul,ro,ei,Qs;const t=Hs(),e=tt(),{startCall:n,setViewingChatId:s}=Q0(),[r,i]=g.useState(null),[o,l]=g.useState([]),[c,u]=g.useState(null),[h,f]=g.useState([]),[m,x]=g.useState(""),[b,N]=g.useState(null),[E,w]=g.useState(null),[v,T]=g.useState(null),[I,R]=g.useState(!1),[V,j]=g.useState([]),[y,k]=g.useState("Shinobi"),[S,D]=g.useState(!1),[P,C]=g.useState(!1),[q,ue]=g.useState(!1),[Se,fe]=g.useState(!1),[K,se]=g.useState(""),[ne,F]=g.useState(""),[G,J]=g.useState(!1),[we,je]=g.useState(""),[U,xe]=g.useState(!1),[re,Ee]=g.useState(null),be=g.useRef([]),Q=g.useRef(null),[oe,Me]=g.useState(null),[Ze,vt]=g.useState(null),[Pn,Yt]=g.useState(!1),[as,un]=g.useState(!1),[Nt,Wn]=g.useState(!1),[bs,Z]=g.useState(!1),[X,z]=g.useState(!1),[pe,ye]=g.useState(!1),[ge,Ce]=g.useState(null),[Et,Dn]=g.useState(null),[Ds,Za]=g.useState([]),Xi=g.useRef(),Kr=g.useRef(),Qr=g.useRef(null),dn=M=>({uid:M.uid,displayName:M.displayName||"User",photoURL:M.photoURL||null,email:M.email||null});g.useEffect(()=>{const M=Pt(Ve,ee=>{if(!ee)e("/login");else{const le=Fe(H(L,"users",ee.uid),Ae=>{Ae.exists()?i({uid:ee.uid,...Ae.data()}):i(dn(ee))});return()=>le()}});return()=>M()},[e]),g.useEffect(()=>{if(!c||!r||h.length===0)return;const M=h.filter(ee=>ee.senderId!==r.uid&&(!ee.seenBy||!ee.seenBy.includes(r.uid)));if(M.length>0){const ee=xl(L);M.forEach(Ae=>{const Te=H(L,`conversations/${c.id}/messages`,Ae.id);ee.update(Te,{seenBy:ut(r.uid)})});const le=H(L,"conversations",c.id);ee.update(le,{[`unreadCounts.${r.uid}`]:0}),ee.commit().catch(console.error)}},[h,c,r]),g.useEffect(()=>{if(!(c!=null&&c.id))return;const M=Fe(H(L,"conversations",c.id),ee=>{if(ee.exists()){const le=ee.data(),Ae=le.typing||{},Ge=Object.keys(Ae).filter(Be=>Be!==(r==null?void 0:r.uid)&&Ae[Be]).map(Be=>{var Ys;const Vt=(Ys=le.users)==null?void 0:Ys.find(Vn=>Vn.uid===Be);return Vt?Vt.displayName.split(" ")[0]:"Someone"});j(Ge)}});return()=>M()},[c,r]);const vn=M=>{u(M),D(!0),C(!1),w(null),x(""),F(""),J(!1),window.dispatchEvent(new CustomEvent("toggle-nav",{detail:{visible:!1}}))},Yr=async M=>{if(M===(r==null?void 0:r.uid)){e("/profile");return}const ee=o.find(le=>!le.isGroup&&le.participants.includes(M));if(ee){vn(ee);return}try{const le=qe(ae(L,"conversations"),rt("participants","array-contains",r.uid)),Te=(await Zt(le)).docs.find(Ge=>{const Be=Ge.data();return!Be.isGroup&&Be.participants.includes(M)});if(Te){const Ge=Te.data();let Be=null;Ge.users&&(Be=Ge.users.find(Vt=>Vt.uid===M)),vn({id:Te.id,...Ge,otherUser:Be})}else{const Ge=await jt(H(L,"users",M)),Be=Ge.exists()?Ge.data():{displayName:"User",uid:M},Vt=await ze(ae(L,"conversations"),{participants:[r.uid,M],users:[dn(r),dn(Be)],isGroup:!1,updatedAt:Ie(),unreadCounts:{[r.uid]:0,[M]:0}});vn({id:Vt.id,participants:[r.uid,M],users:[dn(r),dn(Be)],isGroup:!1,otherUser:{uid:M,...Be}})}}catch(le){console.error("Chat Error",le)}};g.useEffect(()=>{var M,ee,le;if(r){if((ee=(M=t.state)==null?void 0:M.startChatWith)!=null&&ee.uid)Yr(t.state.startChatWith.uid),window.history.replaceState({},document.title);else if((le=t.state)!=null&&le.activeConversationId){const Ae=o.find(Te=>Te.id===t.state.activeConversationId);Ae&&vn(Ae),window.history.replaceState({},document.title)}}},[r,t.state,o.length]),g.useEffect(()=>{if(c){s(c.id);const M=setInterval(()=>{window.dispatchEvent(new CustomEvent("toggle-nav",{detail:{visible:!1}}))},500);return()=>{clearInterval(M),s(null),window.dispatchEvent(new CustomEvent("toggle-nav",{detail:{visible:!0}}))}}else s(null),window.dispatchEvent(new CustomEvent("toggle-nav",{detail:{visible:!0}}))},[c]),g.useEffect(()=>{if(!(r!=null&&r.uid))return;const M=qe(ae(L,"conversations"),rt("participants","array-contains",r.uid),_t("updatedAt","desc")),ee=Fe(M,le=>{l(le.docs.map(Ae=>{const Te=Ae.data();let Ge=null;if(!Te.isGroup){const Be=Te.participants.find(Vt=>Vt!==r.uid);Te.users&&(Ge=Te.users.find(Vt=>Vt.uid===Be)),Ge||(Ge={uid:Be,displayName:"User",photoURL:null})}return{id:Ae.id,...Te,otherUser:Ge}}))});return()=>ee()},[r]),g.useEffect(()=>{if(!(c!=null&&c.id))return;const M=qe(ae(L,`conversations/${c.id}/messages`),_t("timestamp","asc")),ee=Fe(M,async le=>{const Ae=le.docs.map(Te=>({id:Te.id,...Te.data()}));f(Ae),setTimeout(()=>{var Te;return(Te=Xi.current)==null?void 0:Te.scrollIntoView({behavior:"smooth"})},100)});return()=>ee()},[c]),g.useEffect(()=>{if(!r)return;(async()=>{try{const ee=await Zt(ae(L,"users"));Za(ee.docs.map(le=>({uid:le.id,...le.data()})).filter(le=>le.uid!==r.uid))}catch{}})()},[r]);const Xr=()=>{c&&(I||(R(!0),he(H(L,"conversations",c.id),{[`typing.${r.uid}`]:!0}).catch(()=>{})),Qr.current&&clearTimeout(Qr.current),Qr.current=setTimeout(()=>{R(!1),he(H(L,"conversations",c.id),{[`typing.${r.uid}`]:!1}).catch(()=>{})},2e3))},Gn=async(M="",ee="text",le=null,Ae=null)=>{const Te=Ae||(c==null?void 0:c.id);if(!Te||!M.trim()&&!le)return;if(b&&!Ae){try{await he(H(L,`conversations/${Te}/messages`,b.id),{text:M,isEdited:!0}),N(null),x("")}catch{alert("Update failed")}return}let Ge=null,Be=null,Vt=null;if(le){if(le.size>50*1024*1024){alert("File too large! Max 50MB.");return}try{const Vn=ee==="audio"?"mp4":le.name.split(".").pop();Vt=le.name,Be=(le.size/1024/1024).toFixed(2)+" MB";const Xs=sn(rn,`chat/${Te}/${Date.now()}_${ee}.${Vn}`);await An(Xs,le),Ge=await nn(Xs)}catch{alert("Upload failed");return}}const Ys={text:ee==="text"?M:"",mediaURL:Ge,mediaType:ee,fileName:Vt,fileSize:Be,senderId:r.uid,senderName:r.displayName,timestamp:Ie(),seenBy:[r.uid],replyTo:E?{id:E.id,text:E.text,sender:E.senderName}:null};try{await ze(ae(L,`conversations/${Te}/messages`),Ys);const Vn={lastMessage:ee==="text"?M:`Sent a ${ee}`,lastMessageSenderId:r.uid,lastSenderId:r.uid,updatedAt:Ie()},Xs=o.find(xr=>xr.id===Te)||c;Xs&&Xs.participants.forEach(xr=>{xr!==r.uid&&(Vn[`unreadCounts.${xr}`]=pt(1))}),await he(H(L,"conversations",Te),Vn),Ae||(x(""),ue(!1),w(null))}catch(Vn){console.error("Send failed",Vn)}},Jr=M=>{T(M),ye(!0),vt(null)},Zr=async M=>{var Ae;const ee=v.text,le=v.mediaType||"text";if(v.mediaURL){const Te={text:ee,mediaURL:v.mediaURL,mediaType:v.mediaType,fileName:v.fileName||null,fileSize:v.fileSize||null,senderId:r.uid,senderName:r.displayName,timestamp:Ie(),seenBy:[r.uid],isForwarded:!0};await ze(ae(L,`conversations/${M.id}/messages`),Te),await he(H(L,"conversations",M.id),{lastMessage:`Forwarded ${le}`,lastSenderId:r.uid,updatedAt:Ie(),[`unreadCounts.${((Ae=M.otherUser)==null?void 0:Ae.uid)||"group"}`]:pt(1)})}else await Gn(ee,"text",null,M.id);ye(!1),T(null),alert("Message forwarded!")},ws=(M,ee)=>{const le=M.target.files[0];le&&Gn("",ee,le)},O=async M=>{if(confirm("Delete this message?"))try{await is(H(L,`conversations/${c.id}/messages`,M)),vt(null)}catch{alert("Failed to delete")}},Le=async M=>{M&&M.preventDefault();try{const ee=await navigator.mediaDevices.getUserMedia({audio:!0});let le={mimeType:"audio/webm"};MediaRecorder.isTypeSupported("audio/mp4")&&(le={mimeType:"audio/mp4"});const Ae=new MediaRecorder(ee,le);Ee(Ae),be.current=[],Q.current=Date.now(),Ae.ondataavailable=Te=>{Te.data.size>0&&be.current.push(Te.data)},Ae.onstop=()=>{if(Date.now()-Q.current<1e3)return;const Te=le.mimeType,Ge=new Blob(be.current,{type:Te});Gn("","audio",new File([Ge],"voice_msg",{type:Te})),ee.getTracks().forEach(Be=>Be.stop())},Ae.start(),xe(!0)}catch{alert("Microphone access denied.")}},Ue=M=>{M&&M.preventDefault(),re&&U&&(re.stop(),xe(!1))},at=async(M,ee)=>{try{const le=[r.uid,...ee],Ae=await Promise.all(le.map(async Be=>{const Vt=await jt(H(L,"users",Be));return Vt.exists()?dn({uid:Be,...Vt.data()}):{uid:Be,displayName:"User"}})),Te={groupName:M,groupPhoto:null,isGroup:!0,guildMasterId:r.uid,participants:le,users:Ae,createdAt:Ie(),updatedAt:Ie(),lastMessage:"Guild created",unreadCounts:{}};le.forEach(Be=>Te.unreadCounts[Be]=0);const Ge=await ze(ae(L,"conversations"),Te);un(!1),vn({id:Ge.id,...Te})}catch{alert("Failed to create guild")}},qt=async M=>{const ee=M.target.files[0];if(!(!ee||!c.isGroup))try{const le=sn(rn,`guild_photos/${c.id}/${Date.now()}_${ee.name}`);await An(le,ee);const Ae=await nn(le);await he(H(L,"conversations",c.id),{groupPhoto:Ae}),u(Te=>({...Te,groupPhoto:Ae}))}catch{alert("Failed to upload photo")}},Ke=async()=>{if(!c.isGroup||c.guildMasterId!==r.uid)return;const M=prompt("Enter new guild name:",c.groupName);if(M&&M.trim()!=="")try{await he(H(L,"conversations",c.id),{groupName:M}),u(ee=>({...ee,groupName:M}))}catch{alert("Failed to rename.")}},eo=async()=>{if(c.isGroup&&confirm("Are you sure you want to leave this guild?"))try{const M=c.users.find(ee=>ee.uid===r.uid);await he(H(L,"conversations",c.id),{participants:kt(r.uid),users:kt(M)}),u(null),D(!1)}catch{alert("Failed to leave.")}},Ks=async M=>{const ee=ge?[ge]:M;if(!ee||ee.length===0)return;const le=await Promise.all(ee.map(async Ae=>{const Te=await jt(H(L,"users",Ae));return dn({uid:Ae,...Te.data()||{}})}));await he(H(L,"conversations",c.id),{participants:ut(...ee),users:ut(...le)}),Wn(!1),Ce(null)},pr=async M=>{if(!confirm("Remove this user?"))return;const ee=c.users.find(le=>le.uid===M);await he(H(L,"conversations",c.id),{participants:kt(M),users:kt(ee)})},Hn=async()=>{if(!c||c.isGroup)return;const ee=((r==null?void 0:r.blockedUsers)||[]).includes(c.otherUser.uid);try{ee?(await he(H(L,"users",r.uid),{blockedUsers:kt(c.otherUser.uid)}),alert("User unblocked.")):(await he(H(L,"users",r.uid),{blockedUsers:ut(c.otherUser.uid)}),alert("User blocked."))}catch(le){console.error(le),alert("Action failed.")}},os=async M=>{try{await ze(ae(L,"reports"),{reporterId:r.uid,targetId:c.isGroup?c.id:c.otherUser.uid,type:c.isGroup?"guild":"user",reason:M,timestamp:Ie()}),alert("Report submitted."),Z(!1)}catch{alert("Report failed.")}},bn=async M=>{if(confirm("Delete conversation?"))try{await is(H(L,"conversations",M)),Me(null),u(null)}catch{}},gr=async M=>{var Ae;const ee=o.find(Te=>Te.id===M),le=(Ae=ee==null?void 0:ee.mutedBy)==null?void 0:Ae[r.uid];try{await he(H(L,"conversations",M),{[`mutedBy.${r.uid}`]:!le})}catch{}},Wt=({src:M,name:ee,size:le="md",isGuild:Ae=!1,onClick:Te,canEdit:Ge=!1})=>{const Be=le==="xl"?"w-24 h-24 text-3xl":"w-12 h-12 text-sm";return a.jsxs("div",{onClick:Te,className:`${Be} rounded-full bg-gray-200 overflow-hidden flex-shrink-0 border border-gray-100 flex items-center justify-center relative ${Te?"cursor-pointer":""} group`,children:[M?a.jsx("img",{src:M,className:"w-full h-full object-cover"}):a.jsx("span",{className:"font-bold text-gray-500 uppercase",children:ee==null?void 0:ee[0]}),Ge&&a.jsxs("label",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 cursor-pointer transition-opacity z-10",children:[a.jsx("i",{className:"fas fa-camera text-white text-xl"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:qt})]})]})},Vs=M=>M!=null&&M.toDate?M.toDate().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"",Ji=({chat:M})=>{var Te,Ge,Be,Vt,Ys,Vn,Xs;const ee=xr=>{xr.preventDefault(),Me({chat:M})},le=((Te=M.unreadCounts)==null?void 0:Te[r==null?void 0:r.uid])||0,Ae=(Ge=M.mutedBy)==null?void 0:Ge[r==null?void 0:r.uid];return a.jsxs("div",{onClick:()=>vn(M),onContextMenu:ee,className:`flex items-center gap-3 p-3 mb-1 rounded-xl cursor-pointer transition-all select-none ${(c==null?void 0:c.id)===M.id?"bg-blue-50 border-blue-100":"hover:bg-gray-50 border-transparent"} border`,children:[a.jsx(Wt,{src:M.isGroup?M.groupPhoto:(Be=M.otherUser)==null?void 0:Be.photoURL,name:M.isGroup?M.groupName:(Vt=M.otherUser)==null?void 0:Vt.displayName,isGuild:M.isGroup}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-bold text-sm truncate text-gray-800",children:M.isGroup?M.groupName:(Ys=M.otherUser)==null?void 0:Ys.displayName}),a.jsxs("div",{className:"flex items-center gap-1",children:[Ae&&a.jsx("i",{className:"fas fa-volume-mute text-[10px] text-gray-400"}),a.jsx("span",{className:"text-[10px] text-gray-400",children:M.updatedAt?Vs(M.updatedAt):""})]})]}),a.jsx("p",{className:`text-xs truncate mt-0.5 ${le>0?"font-bold text-gray-900":"text-gray-500"}`,children:(Xs=M.typing)!=null&&Xs[(Vn=M.otherUser)==null?void 0:Vn.uid]?a.jsx("span",{className:"text-green-600 animate-pulse",children:"Typing..."}):M.lastMessage||"Start chatting"})]}),le>0&&a.jsx("div",{className:"w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-[10px] font-bold shadow-md animate-pulse",children:le})]})},Vl=({msg:M})=>{const ee=M.senderId===(r==null?void 0:r.uid),le=M.seenBy&&M.seenBy.length>1,Ae=ee?le?"bg-gradient-to-r from-indigo-500 to-purple-600 text-white":"bg-teal-600 text-white":"bg-white text-gray-800 border border-gray-100",Te=()=>vt(M);return a.jsx("div",{className:`flex ${ee?"justify-end":"justify-start"} mb-4 group select-none`,onContextMenu:Ge=>{Ge.preventDefault(),Te()},children:a.jsxs("div",{className:`max-w-[75%] px-4 py-2.5 rounded-2xl shadow-sm text-sm relative ${Ae} ${ee?"rounded-br-none":"rounded-bl-none"}`,children:[M.replyTo&&a.jsxs("div",{className:`mb-2 p-2 rounded-lg text-xs border-l-4 ${ee?"bg-white/20 border-white/50 text-white":"bg-gray-100 border-gray-300 text-gray-600"}`,children:[a.jsx("span",{className:"font-bold block",children:M.replyTo.sender}),a.jsx("span",{className:"truncate block opacity-80",children:M.replyTo.text})]}),M.mediaURL&&a.jsx("div",{className:"mb-2",children:M.mediaType==="audio"?a.jsx("audio",{src:M.mediaURL,controls:!0,className:"max-w-[200px]"}):M.mediaType==="video"?a.jsx("video",{src:M.mediaURL,controls:!0,className:"rounded-lg max-w-full max-h-60"}):M.mediaType==="file"?a.jsxs("div",{className:"flex items-center gap-2 bg-black/10 p-2 rounded-lg cursor-pointer hover:bg-black/20",onClick:()=>window.open(M.mediaURL),children:[a.jsx("i",{className:"fas fa-file-alt text-2xl"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold text-xs truncate w-32",children:M.fileName||"Document"}),a.jsx("p",{className:"text-[10px]",children:M.fileSize})]})]}):a.jsx("img",{src:M.mediaURL,className:"rounded-lg max-w-full max-h-60 cursor-pointer hover:opacity-90",onClick:()=>Dn(M.mediaURL)})}),a.jsx("p",{className:"leading-relaxed whitespace-pre-wrap",children:M.text}),a.jsxs("div",{className:`flex items-center justify-end gap-1 mt-1 text-[9px] ${ee?"text-blue-100":"text-gray-400"}`,children:[a.jsx("span",{children:Vs(M.timestamp)}),M.isForwarded&&a.jsx("span",{children:a.jsx("i",{className:"fas fa-share"})}),ee&&a.jsx("span",{title:le?"Seen":"Sent",children:le?a.jsx("i",{className:"fas fa-check-double text-blue-200"}):a.jsx("i",{className:"fas fa-check"})})]})]})})},to=!(c!=null&&c.isGroup)&&((Ll=r==null?void 0:r.blockedUsers)==null?void 0:Ll.includes((Ml=c==null?void 0:c.otherUser)==null?void 0:Ml.uid)),_s=(no=c==null?void 0:c.mutedBy)==null?void 0:no[r==null?void 0:r.uid];return a.jsxs("div",{className:"fixed top-0 left-0 w-full h-full bg-[#f0f4f8] flex overflow-hidden pt-[env(safe-area-inset-top)] md:left-[300px] md:w-[calc(100%-300px)]",children:[a.jsxs("div",{className:`${c?"hidden md:flex":"flex"} w-full md:w-80 lg:w-96 flex-col bg-white border-r border-gray-100 h-full shrink-0 z-20`,children:[a.jsxs("div",{className:"p-5 border-b border-gray-50",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h1",{className:"text-3xl font-black bg-gradient-to-r from-teal-400 via-blue-500 to-purple-600 bg-clip-text text-transparent tracking-wider",children:"SHINOBI"}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>fe(!Se),className:"w-9 h-9 bg-slate-100 text-slate-600 rounded-full hover:bg-slate-200 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-plus"})}),Se&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>fe(!1)}),a.jsxs("div",{className:"absolute right-0 top-10 bg-white shadow-xl rounded-xl p-2 z-40 w-48 border border-gray-100 flex flex-col gap-1 animate-fade-in",children:[a.jsxs("button",{onClick:()=>{Yt(!0),fe(!1)},className:"text-left px-3 py-2 hover:bg-gray-50 rounded-lg text-sm font-bold text-gray-700 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-comment text-blue-500"})," New Chat"]}),a.jsxs("button",{onClick:()=>{un(!0),fe(!1)},className:"text-left px-3 py-2 hover:bg-gray-50 rounded-lg text-sm font-bold text-gray-700 flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-users text-orange-500"})," Create Guild"]})]})]})]})]}),a.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl mb-3",children:[a.jsx("button",{onClick:()=>k("Shinobi"),className:`flex-1 py-1.5 text-xs font-bold rounded-lg transition-all ${y==="Shinobi"?"bg-white shadow-sm text-gray-900":"text-gray-500"}`,children:"Messages"}),a.jsx("button",{onClick:()=>k("Guild"),className:`flex-1 py-1.5 text-xs font-bold rounded-lg transition-all ${y==="Guild"?"bg-white shadow-sm text-gray-900":"text-gray-500"}`,children:"Guilds"})]}),a.jsxs("div",{className:"relative group",children:[a.jsx("i",{className:"fas fa-search absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search...",className:"w-full bg-gray-50 pl-9 pr-4 py-2.5 rounded-xl outline-none text-sm focus:ring-2 focus:ring-blue-100 transition-all",value:K,onChange:M=>se(M.target.value)})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto p-2 custom-scrollbar",children:o.filter(M=>y==="Shinobi"?!M.isGroup:M.isGroup).filter(M=>{var ee,le;return(le=M.isGroup?M.groupName:((ee=M.otherUser)==null?void 0:ee.displayName)||"User")==null?void 0:le.toLowerCase().includes(K.toLowerCase())}).map(M=>a.jsx(Ji,{chat:M},M.id))})]}),a.jsx("div",{className:`${c?"flex":"hidden md:flex"} flex-1 flex-col bg-[#f8fafc] relative min-w-0 h-full overflow-hidden`,children:c?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"h-16 bg-white/95 backdrop-blur-md border-b border-gray-100 flex items-center justify-between px-4 z-30 shrink-0 shadow-sm sticky top-0",children:[a.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[a.jsx("button",{onClick:()=>{u(null),D(!1)},className:"md:hidden w-9 h-9 rounded-full bg-gray-100 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-arrow-left text-sm"})}),a.jsx(Wt,{src:c.isGroup?c.groupPhoto:(so=c.otherUser)==null?void 0:so.photoURL,name:c.isGroup?c.groupName:(Ol=c.otherUser)==null?void 0:Ol.displayName,onClick:()=>C(!P)}),a.jsxs("div",{className:"min-w-0 cursor-pointer",onClick:()=>C(!P),children:[a.jsx("h3",{className:"font-bold text-gray-800 truncate",children:c.isGroup?c.groupName:(Fl=c.otherUser)==null?void 0:Fl.displayName}),a.jsx("p",{className:"text-xs text-blue-600 font-bold",children:V.length>0?`${V.join(", ")} typing...`:"Online"})]})]}),a.jsxs("div",{className:"flex gap-2 shrink-0",children:[G?a.jsxs("div",{className:"flex items-center bg-gray-100 rounded-xl px-2 animate-scale-in",children:[a.jsx("input",{autoFocus:!0,type:"text",placeholder:"Find...",className:"bg-transparent border-none outline-none text-xs w-24 py-2",value:ne,onChange:M=>F(M.target.value)}),a.jsx("button",{onClick:()=>{J(!1),F("")},className:"text-gray-400 hover:text-gray-600 px-2",children:a.jsx("i",{className:"fas fa-times"})})]}):!c.isGroup&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>n(c.otherUser.uid,c.otherUser.displayName,c.otherUser.photoURL,"audio",c.id),className:"h-9 w-9 rounded-xl bg-white border border-gray-200 text-gray-500 hover:text-blue-600 hover:shadow-md flex items-center justify-center",children:a.jsx("i",{className:"fas fa-phone"})}),a.jsx("button",{onClick:()=>n(c.otherUser.uid,c.otherUser.displayName,c.otherUser.photoURL,"video",c.id),className:"h-9 w-9 rounded-xl bg-white border border-gray-200 text-gray-500 hover:text-blue-600 hover:shadow-md flex items-center justify-center",children:a.jsx("i",{className:"fas fa-video"})})]}),a.jsx("button",{onClick:()=>C(!P),className:`h-9 w-9 rounded-xl border transition-all flex items-center justify-center ${P?"bg-blue-50 border-blue-200 text-blue-600":"bg-white border-gray-200 text-gray-500 hover:text-blue-600 hover:shadow-md"}`,children:a.jsx("i",{className:"fas fa-info-circle"})})]})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar bg-[#f8fafc] w-full",children:[h.filter(M=>!ne||(M.text||"").toLowerCase().includes(ne.toLowerCase())).map((M,ee)=>{var Te,Ge,Be;const le=h[ee-1],Ae=!le||new Date(((Te=M.timestamp)==null?void 0:Te.seconds)*1e3).toDateString()!==new Date(((Ge=le.timestamp)==null?void 0:Ge.seconds)*1e3).toDateString();return a.jsxs(Cf.Fragment,{children:[Ae&&a.jsx("div",{className:"flex justify-center my-4",children:a.jsx("span",{className:"bg-gray-200 text-gray-500 text-[10px] px-3 py-1 rounded-full font-bold",children:new Date(((Be=M.timestamp)==null?void 0:Be.seconds)*1e3).toLocaleDateString()})}),a.jsx(Vl,{msg:M})]},M.id)}),a.jsx("div",{ref:Xi})]}),a.jsx("div",{className:"w-full bg-[#f8fafc] p-2 shrink-0 border-t border-gray-100 z-20 mt-auto",children:to?a.jsxs("div",{className:"bg-gray-100 text-gray-500 text-center py-4 rounded-xl font-bold border border-gray-200",children:["You blocked this user. ",a.jsx("button",{onClick:Hn,className:"text-blue-600 underline hover:text-blue-800 ml-2",children:"Unblock"})]}):a.jsxs(a.Fragment,{children:[E&&a.jsxs("div",{className:"flex justify-between items-center bg-blue-50 p-2 rounded-t-xl text-xs text-blue-800 border-b border-blue-100 mx-2 animate-slide-up",children:[a.jsxs("span",{className:"truncate",children:["Replying to ",a.jsx("b",{children:E.senderName}),": ",E.text.substring(0,30),"..."]}),a.jsx("button",{onClick:()=>w(null),className:"text-blue-500 hover:text-blue-700",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:`bg-white p-1.5 rounded-full shadow-lg border border-gray-100 flex items-end gap-2 pl-2 ${b?"ring-2 ring-blue-400":""}`,children:[a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>ue(!q),className:"w-9 h-9 rounded-full bg-gray-50 text-gray-400 hover:bg-blue-50 hover:text-blue-600 transition-all flex items-center justify-center shrink-0 mb-0.5",children:a.jsx("i",{className:"fas fa-plus text-lg"})}),q&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 z-30",onClick:()=>ue(!1)}),a.jsx("div",{className:"absolute bottom-12 left-0 bg-white shadow-xl rounded-2xl p-2 flex flex-col gap-2 z-40 w-12 animate-fade-in-up",children:["image","video","file"].map(M=>a.jsxs("label",{className:"w-8 h-8 rounded-full bg-gray-50 flex items-center justify-center hover:bg-blue-50 cursor-pointer text-gray-600 hover:text-blue-600",children:[a.jsx("i",{className:`fas fa-${M==="image"?"image":M==="video"?"video":"file"}`}),a.jsx("input",{type:"file",accept:M==="image"?"image/*":M==="video"?"video/*":"*/*",className:"hidden",onChange:ee=>ws(ee,M)})]},M))})]})]}),a.jsx("textarea",{value:m,onChange:M=>{x(M.target.value),Xr()},onKeyDown:M=>M.key==="Enter"&&!M.shiftKey&&(M.preventDefault(),Gn(m)),placeholder:b?"Editing message...":"Type a message...",className:"flex-1 bg-transparent border-none outline-none text-gray-700 py-2.5 px-1 max-h-24 resize-none placeholder-gray-400 text-sm",rows:1}),m.trim()?a.jsx("button",{onClick:()=>Gn(m),className:"w-9 h-9 rounded-full bg-blue-600 text-white flex items-center justify-center shadow-md hover:scale-105 transition-all shrink-0 mb-0.5 mr-0.5",children:a.jsx("i",{className:`fas ${b?"fa-check":"fa-paper-plane"} text-xs`})}):a.jsx("button",{onMouseDown:Le,onMouseUp:Ue,onTouchStart:Le,onTouchEnd:Ue,className:`w-9 h-9 rounded-full flex items-center justify-center shadow-md transition-all shrink-0 mb-0.5 mr-0.5 ${U?"bg-red-500 text-white animate-pulse":"bg-blue-600 text-white"}`,children:a.jsx("i",{className:"fas fa-microphone text-xs"})}),b&&a.jsx("button",{onClick:()=>{N(null),x("")},className:"text-xs text-red-500 font-bold absolute top-[-20px] right-4 bg-white px-2 rounded shadow",children:"Cancel"})]})]})})]}):a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-gray-400 bg-[#f8fafc]",children:[a.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mb-4",children:a.jsx("i",{className:"fas fa-comments text-3xl text-gray-300"})}),a.jsx("p",{children:"Select a conversation"})]})}),P&&c&&a.jsx("div",{className:"absolute inset-y-0 right-0 w-80 bg-white shadow-2xl z-40 transform transition-transform duration-300 ease-in-out border-l border-gray-100 overflow-y-auto h-full pt-safe pt-12",children:a.jsxs("div",{className:"p-6",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h3",{className:"font-black text-lg text-gray-800",children:"Details"}),a.jsx("button",{onClick:()=>C(!1),className:"w-8 h-8 rounded-full bg-gray-100 hover:bg-gray-200 flex items-center justify-center text-gray-600",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"flex flex-col items-center mb-8",children:[a.jsx(Wt,{src:c.isGroup?c.groupPhoto:(od=c.otherUser)==null?void 0:od.photoURL,name:c.isGroup?c.groupName:(Zi=c.otherUser)==null?void 0:Zi.displayName,size:"xl",canEdit:c.isGroup&&c.guildMasterId===r.uid}),a.jsx("div",{className:"flex flex-col items-center mt-3",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("h2",{className:"text-xl font-bold text-gray-900 text-center",children:c.isGroup?c.groupName:(Ul=c.otherUser)==null?void 0:Ul.displayName}),c.isGroup&&c.guildMasterId===r.uid&&a.jsx("button",{onClick:Ke,className:"text-gray-400 hover:text-blue-500",children:a.jsx("i",{className:"fas fa-edit"})})]})})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-6",children:[a.jsxs("button",{onClick:()=>gr(c.id),className:`flex flex-col items-center gap-2 p-3 rounded-2xl transition-colors ${_s?"bg-red-50 text-red-600":"bg-gray-50 text-gray-600 hover:bg-gray-100"}`,children:[a.jsx("i",{className:`fas ${_s?"fa-volume-mute":"fa-bell"}`}),a.jsx("span",{className:"text-[10px] font-bold",children:_s?"Muted":"Mute"})]}),a.jsxs("button",{onClick:()=>{J(!0),C(!1),F("")},className:"flex flex-col items-center gap-2 p-3 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors",children:[a.jsx("i",{className:"fas fa-search"}),a.jsx("span",{className:"text-[10px] font-bold",children:"Search"})]}),a.jsxs("button",{onClick:()=>{var M;(M=Kr.current)==null||M.scrollIntoView({behavior:"smooth"})},className:"flex flex-col items-center gap-2 p-3 bg-gray-50 rounded-2xl hover:bg-gray-100 transition-colors",children:[a.jsx("i",{className:"fas fa-image"}),a.jsx("span",{className:"text-[10px] font-bold",children:"Media"})]})]}),c.isGroup&&a.jsxs("div",{className:"mb-6",children:[a.jsxs("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:["Members (",c.participants.length,")"]}),a.jsx("input",{type:"text",placeholder:"Search members...",className:"w-full bg-gray-50 p-2 rounded-lg text-sm mb-3 border border-gray-100 outline-none",value:we,onChange:M=>je(M.target.value)}),c.guildMasterId===r.uid&&a.jsxs("div",{className:"space-y-2 mb-3",children:[a.jsxs("label",{className:"w-full flex items-center justify-between p-3 rounded-xl bg-blue-50 hover:bg-blue-100 text-blue-600 cursor-pointer transition-colors",children:[a.jsx("span",{className:"text-sm font-bold",children:"Change Group Photo"}),a.jsx("i",{className:"fas fa-camera"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:qt})]}),a.jsxs("button",{onClick:()=>Wn(!0),className:"w-full flex items-center justify-between p-3 rounded-xl bg-blue-50 hover:bg-blue-100 text-blue-600",children:[a.jsx("span",{className:"text-sm font-bold",children:"Add Members"}),a.jsx("i",{className:"fas fa-plus"})]})]}),a.jsx("div",{className:"mt-2 space-y-1 max-h-40 overflow-y-auto custom-scrollbar",children:(ro=c.users)==null?void 0:ro.filter(M=>M.uid!==r.uid&&M.displayName.toLowerCase().includes(we.toLowerCase())).map(M=>a.jsxs("div",{className:"flex justify-between items-center p-2 hover:bg-gray-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Wt,{src:M.photoURL,name:M.displayName,size:"sm"}),a.jsx("span",{className:"text-sm font-medium text-gray-700",children:M.displayName})]}),c.guildMasterId===r.uid&&a.jsx("button",{onClick:()=>pr(M.uid),className:"text-red-500 text-xs font-bold bg-red-50 px-2 py-1 rounded hover:bg-red-100",children:"Remove"})]},M.uid))}),a.jsx("button",{onClick:eo,className:"w-full mt-3 p-3 text-red-500 bg-red-50 rounded-xl font-bold text-sm hover:bg-red-100 transition",children:"Leave Guild"})]}),a.jsxs("div",{ref:Kr,className:"mb-6",children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider mb-3",children:"Recent Media"}),a.jsx("div",{className:"grid grid-cols-3 gap-2",children:h.filter(M=>M.mediaURL&&["image","video"].includes(M.mediaType)).slice(0,6).map(M=>a.jsx("img",{src:M.mediaURL,className:"aspect-square object-cover rounded-lg bg-gray-100 cursor-pointer",onClick:()=>Dn(M.mediaURL)},M.id))})]}),!c.isGroup&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:Hn,className:"w-full p-3 rounded-xl bg-red-50 text-red-500 font-bold text-sm mt-4 hover:bg-red-100 transition",children:"Block User"}),a.jsx("button",{onClick:()=>Z(!0),className:"w-full p-3 rounded-xl bg-gray-100 text-gray-500 font-bold text-sm mt-2 hover:bg-gray-200 transition",children:"Report User"})]}),c.isGroup&&a.jsx("button",{onClick:()=>Z(!0),className:"w-full p-3 rounded-xl bg-gray-100 text-gray-500 font-bold text-sm mt-2 hover:bg-gray-200 transition",children:"Report Guild"})]})}),Ze&&a.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/50 flex items-center justify-center p-4",onClick:()=>vt(null),children:a.jsxs("div",{className:"bg-white rounded-2xl w-full max-w-xs overflow-hidden shadow-xl animate-scale-in",onClick:M=>M.stopPropagation(),children:[a.jsxs("button",{onClick:()=>{w(Ze),vt(null)},className:"w-full p-4 text-left hover:bg-gray-50 flex items-center gap-3 font-medium border-b border-gray-50",children:[a.jsx("i",{className:"fas fa-reply text-gray-500"})," Reply"]}),a.jsxs("button",{onClick:()=>Jr(Ze),className:"w-full p-4 text-left hover:bg-gray-50 flex items-center gap-3 font-medium border-b border-gray-50",children:[a.jsx("i",{className:"fas fa-share text-gray-500"})," Forward"]}),Ze.senderId===r.uid&&a.jsxs("button",{onClick:()=>{N(Ze),x(Ze.text),vt(null)},className:"w-full p-4 text-left hover:bg-gray-50 flex items-center gap-3 font-medium border-b border-gray-50",children:[a.jsx("i",{className:"fas fa-edit text-blue-500"})," Edit"]}),a.jsxs("button",{onClick:()=>O(Ze.id),className:"w-full p-4 text-left hover:bg-gray-50 flex items-center gap-3 font-medium text-red-500",children:[a.jsx("i",{className:"fas fa-trash"})," Delete"]})]})}),pe&&a.jsx("div",{className:"fixed inset-0 bg-black/60 z-[10000] flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-sm rounded-2xl p-6 shadow-2xl animate-scale-in",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Forward to..."}),a.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar",children:o.map(M=>{var ee,le,Ae;return a.jsxs("div",{onClick:()=>Zr(M),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-xl cursor-pointer",children:[a.jsx(Wt,{src:M.isGroup?M.groupPhoto:(ee=M.otherUser)==null?void 0:ee.photoURL,name:M.isGroup?M.groupName:(le=M.otherUser)==null?void 0:le.displayName}),a.jsx("span",{className:"font-medium",children:M.isGroup?M.groupName:(Ae=M.otherUser)==null?void 0:Ae.displayName})]},M.id)})}),a.jsx("button",{onClick:()=>ye(!1),className:"mt-4 w-full py-2 text-gray-500 font-bold hover:bg-gray-100 rounded-xl",children:"Cancel"})]})}),Et&&a.jsxs("div",{className:"fixed inset-0 bg-black/90 z-[10001] flex items-center justify-center p-4",onClick:()=>Dn(null),children:[a.jsx("img",{src:Et,className:"max-w-full max-h-full object-contain"}),a.jsx("button",{className:"absolute top-4 right-4 text-white text-3xl",children:""})]}),oe&&a.jsx("div",{className:"fixed inset-0 z-[9998] bg-black/50 flex items-center justify-center",onClick:()=>Me(null),children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-2 w-64 animate-scale-in",onClick:M=>M.stopPropagation(),children:[a.jsx("div",{className:"p-3 border-b border-gray-100 mb-1 font-bold text-gray-700 text-center truncate",children:oe.chat.isGroup?oe.chat.groupName:oe.chat.otherUser.displayName}),a.jsxs("button",{onClick:()=>{gr(oe.chat.id),Me(null)},className:"w-full text-left p-3 hover:bg-gray-50 rounded-xl font-medium flex items-center gap-3 text-gray-700",children:[a.jsx("i",{className:`fas ${(ei=oe.chat.mutedBy)!=null&&ei[r==null?void 0:r.uid]?"fa-volume-up":"fa-volume-mute"} w-5`}),(Qs=oe.chat.mutedBy)!=null&&Qs[r==null?void 0:r.uid]?"Unmute":"Mute"]}),!oe.chat.isGroup&&a.jsxs("button",{onClick:()=>{Ce(oe.chat.otherUser.uid),z(!0),Me(null)},className:"w-full text-left p-3 hover:bg-purple-50 rounded-xl font-medium flex items-center gap-3 text-purple-600",children:[a.jsx("i",{className:"fas fa-user-plus w-5"})," Add to Guild"]}),a.jsxs("button",{onClick:()=>{bn(oe.chat.id),Me(null)},className:"w-full text-left p-3 hover:bg-red-50 rounded-xl font-medium flex items-center gap-3 text-red-500",children:[a.jsx("i",{className:"fas fa-trash w-5"})," Delete"]}),a.jsx("button",{onClick:()=>Me(null),className:"w-full p-3 text-center text-gray-400 font-bold border-t mt-2",children:"Cancel"})]})}),Pn&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl animate-fade-in",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Start New Chat"}),a.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar",children:Ds.map(M=>a.jsxs("div",{onClick:()=>{Yr(M.uid),Yt(!1)},className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-xl cursor-pointer",children:[a.jsx(Wt,{src:M.photoURL,name:M.displayName}),a.jsx("span",{className:"font-medium",children:M.displayName})]},M.uid))}),a.jsx("button",{onClick:()=>Yt(!1),className:"mt-4 w-full py-2 text-gray-500 font-bold hover:bg-gray-100 rounded-xl",children:"Cancel"})]})}),bs&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl animate-fade-in",children:[a.jsx("h3",{className:"font-bold text-lg mb-4 text-red-500",children:"Report Content"}),a.jsx("div",{className:"space-y-2",children:["Spam or Fraud","Harassment","Inappropriate Content","Impersonation","Other"].map(M=>a.jsx("button",{onClick:()=>os(M),className:"w-full text-left p-3 bg-gray-50 rounded-xl hover:bg-red-50 hover:text-red-600 font-medium transition-colors",children:M},M))}),a.jsx("button",{onClick:()=>Z(!1),className:"mt-4 w-full py-2 text-gray-500 font-bold hover:bg-gray-100 rounded-xl",children:"Cancel"})]})}),as&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Create Guild"}),a.jsx("input",{id:"guildNameInput",type:"text",placeholder:"Guild Name",className:"w-full bg-gray-100 p-3 rounded-xl mb-4 outline-none focus:ring-2 focus:ring-blue-100"}),a.jsx("div",{className:"max-h-40 overflow-y-auto mb-4 custom-scrollbar",children:Ds.map(M=>a.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"accent-teal-600",value:M.uid}),a.jsx(Wt,{src:M.photoURL,name:M.displayName,size:"sm"}),a.jsx("span",{className:"text-sm font-medium",children:M.displayName})]},M.uid))}),a.jsx("button",{onClick:()=>{const M=document.getElementById("guildNameInput").value,ee=document.querySelectorAll('input[type="checkbox"]:checked'),le=Array.from(ee).map(Ae=>Ae.value);M&&le.length>0&&at(M,le)},className:"w-full bg-blue-600 text-white py-3 rounded-xl font-bold hover:bg-blue-700",children:"Create"}),a.jsx("button",{onClick:()=>un(!1),className:"mt-2 w-full py-2 text-gray-500 font-bold hover:bg-gray-100 rounded-xl",children:"Cancel"})]})}),X&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm animate-scale-in",children:[a.jsx("h3",{className:"font-bold mb-4",children:"Select Guild"}),a.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar",children:o.filter(M=>M.isGroup&&M.guildMasterId===r.uid).length>0?o.filter(M=>M.isGroup&&M.guildMasterId===r.uid).map(M=>a.jsxs("div",{onClick:()=>{Ks([ge]),z(!1)},className:"p-3 hover:bg-blue-50 rounded-xl cursor-pointer font-medium border-b border-gray-50 last:border-0 flex items-center gap-3",children:[a.jsx(Wt,{src:M.groupPhoto,name:M.groupName,size:"sm"}),M.groupName]},M.id)):a.jsx("p",{className:"text-gray-400 text-sm text-center py-4",children:"You don't own any guilds."})}),a.jsx("button",{onClick:()=>z(!1),className:"mt-4 w-full py-2 text-gray-500 font-bold hover:bg-gray-100 rounded-xl",children:"Cancel"})]})}),Nt&&a.jsx("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[a.jsx("h3",{className:"font-bold text-lg mb-4",children:"Add Members"}),a.jsx("div",{className:"max-h-60 overflow-y-auto custom-scrollbar",children:Ds.filter(M=>{var ee;return!((ee=c==null?void 0:c.participants)!=null&&ee.includes(M.uid))}).map(M=>a.jsxs("label",{className:"flex items-center gap-3 p-2 hover:bg-gray-50 rounded-lg cursor-pointer",children:[a.jsx("input",{type:"checkbox",className:"add-member-check accent-teal-600",value:M.uid}),a.jsx(Wt,{src:M.photoURL,name:M.displayName,size:"sm"}),a.jsx("span",{className:"text-sm font-medium",children:M.displayName})]},M.uid))}),a.jsx("button",{onClick:()=>{const M=document.querySelectorAll(".add-member-check:checked"),ee=Array.from(M).map(le=>le.value);ee.length>0&&Ks(ee)},className:"w-full bg-blue-600 text-white py-3 rounded-xl font-bold mt-4",children:"Add Selected"}),a.jsx("button",{onClick:()=>Wn(!1),className:"mt-2 w-full py-2 text-gray-500 font-bold hover:bg-gray-100 rounded-xl",children:"Cancel"})]})})]})},ZI=({onClose:t,target:e})=>{const n=(e==null?void 0:e.type)==="business",[s,r]=g.useState(1),[i,o]=g.useState(!1),[l,c]=g.useState(!1),[u,h]=g.useState(null),[f,m]=g.useState({fullName:n?e.name:"",category:n?"Retail & E-commerce":"Content Creator",documentType:"National ID",businessType:"Sole Proprietorship",regNumber:"",taxId:"",website:"",docFront:null,docBack:null}),x=(E,w)=>{E.target.files[0]&&m({...f,[w]:E.target.files[0]})},b=async()=>{if(!f.docFront||!f.docBack)return alert("Please upload required documents.");if(!f.fullName)return alert(n?"Enter business name.":"Enter full name.");if(n&&!f.regNumber)return alert("Registration/Trade License No. is required.");o(!0);try{const E=Ve.currentUser,w=n?`business_verification/${e.id}`:`verification/${E.uid}`,v=sn(rn,`${w}/doc1_${Date.now()}`),T=sn(rn,`${w}/doc2_${Date.now()}`);await An(v,f.docFront),await An(T,f.docBack);const I=await nn(v),R=await nn(T),V=await ze(ae(L,"verification_requests"),{uid:E.uid,targetId:n?e.id:E.uid,targetType:n?"business_page":"user_profile",name:f.fullName,category:f.category,details:n?{businessType:f.businessType,regNumber:f.regNumber,taxId:f.taxId,website:f.website}:{docType:f.documentType},frontURL:I,backURL:R,status:"pending",paymentStatus:"unpaid",timestamp:Ie()});h(V.id),o(!1),c(!0)}catch(E){console.error("Submission Error:",E),alert("Failed to save request. Please try again."),o(!1)}},N=({label:E,file:w,onUpload:v})=>a.jsxs("div",{className:"relative group",children:[a.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase mb-2",children:E}),a.jsxs("label",{className:`flex flex-col items-center justify-center w-full h-32 border-2 border-dashed rounded-2xl cursor-pointer transition-all overflow-hidden ${w?"border-primary bg-primary/5":"border-gray-200 hover:bg-gray-50 hover:border-gray-300"}`,children:[w?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:URL.createObjectURL(w),className:"w-full h-full object-cover",alt:"preview"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:a.jsxs("span",{className:"text-white font-bold text-sm",children:[a.jsx("i",{className:"fas fa-pen mr-1"})," Change"]})})]}):a.jsxs("div",{className:"text-center p-4",children:[a.jsx("div",{className:"w-10 h-10 bg-white rounded-full shadow-sm flex items-center justify-center mx-auto mb-2 text-gray-400",children:a.jsx("i",{className:"fas fa-camera"})}),a.jsx("span",{className:"text-xs text-gray-400 font-medium",children:"Click to Upload"})]}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:v})]})]});return a.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:[a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[35px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh] relative",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 z-20 w-8 h-8 bg-white/50 hover:bg-white rounded-full flex items-center justify-center text-gray-600 hover:text-dark transition-all shadow-sm backdrop-blur-md",children:a.jsx("i",{className:"fas fa-times"})}),a.jsxs("div",{className:"bg-gradient-to-br from-[#1DA1F2]/10 to-blue-50 p-8 text-center border-b border-blue-100/50 relative overflow-hidden",children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-[#1DA1F2] to-blue-400"}),a.jsx("div",{className:"w-16 h-16 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg text-3xl text-[#1DA1F2] animate-bounce-in",children:a.jsx("i",{className:n?"fas fa-briefcase":"fas fa-check-circle"})}),a.jsxs("h2",{className:"text-2xl font-black text-dark mb-1",children:["Verify ",n?"Business":"Profile"]}),a.jsx("p",{className:"text-sm text-gray-600 font-medium",children:"Apply for the blue badge"})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-8 custom-scrollbar",children:[s===1&&a.jsxs("div",{className:"space-y-6 animate-slide-in",children:[a.jsx("h3",{className:"font-bold text-lg text-dark",children:"Why Verify?"}),a.jsx("ul",{className:"space-y-4",children:[{icon:"fa-shield-alt",title:"Build Trust",desc:"Show customers you are a legitimate entity."},{icon:"fa-search",title:"Search Priority",desc:"Rank higher in marketplace and search."},{icon:"fa-check-circle",title:"Blue Badge",desc:"Get the exclusive checkmark on your profile."}].map((E,w)=>a.jsxs("li",{className:"flex items-start gap-4 p-3 rounded-2xl hover:bg-gray-50 transition-colors",children:[a.jsx("div",{className:"w-10 h-10 bg-blue-50 rounded-full flex items-center justify-center text-[#1DA1F2] shrink-0",children:a.jsx("i",{className:`fas ${E.icon}`})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-dark text-sm",children:E.title}),a.jsx("p",{className:"text-xs text-gray-500",children:E.desc})]})]},w))})]}),s===2&&a.jsxs("div",{className:"space-y-5 animate-slide-in",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"font-bold text-lg text-dark",children:"Business Details"}),a.jsx("span",{className:"text-xs font-bold text-gray-400 bg-gray-100 px-2 py-1 rounded-lg",children:"Step 2/3"})]}),n?a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Legal Business Name"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl border border-gray-200 outline-none focus:border-[#1DA1F2] font-medium text-sm",value:f.fullName,onChange:E=>m({...f,fullName:E.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Business Type"}),a.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-xl border border-gray-200 outline-none font-medium text-sm cursor-pointer",value:f.businessType,onChange:E=>m({...f,businessType:E.target.value}),children:[a.jsx("option",{children:"Sole Proprietorship"}),a.jsx("option",{children:"Partnership"}),a.jsx("option",{children:"Limited Company (Ltd)"}),a.jsx("option",{children:"Government Entity"})," ",a.jsx("option",{children:"Non-Profit / NGO"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Trade License No."}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl border border-gray-200 outline-none focus:border-[#1DA1F2] font-medium text-sm",placeholder:"Required",value:f.regNumber,onChange:E=>m({...f,regNumber:E.target.value})})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:["Tax ID (TIN/BIN) ",a.jsx("span",{className:"text-gray-400 font-normal lowercase",children:"(optional)"})]}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl border border-gray-200 outline-none font-medium text-sm",placeholder:"e.g. 123-456-789",value:f.taxId,onChange:E=>m({...f,taxId:E.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[a.jsx(N,{label:"Trade License / Registration",file:f.docFront,onUpload:E=>x(E,"docFront")}),a.jsx(N,{label:"Tax Cert / Other Proof",file:f.docBack,onUpload:E=>x(E,"docBack")})]})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Full Legal Name"}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl border border-gray-200 outline-none focus:border-[#1DA1F2] font-medium text-sm",value:f.fullName,onChange:E=>m({...f,fullName:E.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Category"}),a.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-xl border border-gray-200 outline-none font-medium text-sm",value:f.category,onChange:E=>m({...f,category:E.target.value}),children:[a.jsx("option",{children:"Content Creator"}),a.jsx("option",{children:"Public Figure"}),a.jsx("option",{children:"Journalist"}),a.jsx("option",{children:"Government Official"}),a.jsx("option",{children:"Other"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 uppercase mb-1.5 ml-1",children:"Document Type"}),a.jsx("div",{className:"grid grid-cols-3 gap-3",children:["National ID","Passport","Driving License"].map(E=>a.jsx("button",{onClick:()=>m({...f,documentType:E}),className:`py-2.5 rounded-xl text-xs font-bold border transition-all ${f.documentType===E?"bg-[#1DA1F2] text-white border-[#1DA1F2] shadow-md":"bg-white text-gray-500 border-gray-200 hover:bg-gray-50"}`,children:E},E))})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-2",children:[a.jsx(N,{label:"Front Side",file:f.docFront,onUpload:E=>x(E,"docFront")}),a.jsx(N,{label:"Back Side",file:f.docBack,onUpload:E=>x(E,"docBack")})]})]})]}),s===3&&a.jsxs("div",{className:"text-center space-y-8 animate-slide-in",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-black text-2xl text-dark mb-2",children:"Review & Payment"}),a.jsx("p",{className:"text-gray-500 text-sm",children:"Final step to submit your application."})]}),a.jsxs("div",{className:"bg-gray-50 p-6 rounded-3xl border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("span",{className:"text-gray-500 font-bold text-sm",children:"Processing Fee"}),a.jsx("span",{className:"text-2xl font-black text-dark",children:" 1"})]}),a.jsx("div",{className:"h-px bg-gray-200 mb-4"}),a.jsxs("div",{className:"flex gap-3 text-left",children:[a.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center text-[#1DA1F2] shrink-0",children:a.jsx("i",{className:"fas fa-clock"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-dark text-sm",children:"Estimated Time"}),a.jsx("p",{className:"text-xs text-gray-500",children:"3-4 Working Days"})]})]})]}),a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-yellow-50 border border-yellow-100 rounded-2xl text-left",children:[a.jsx("i",{className:"fas fa-info-circle text-yellow-600 mt-0.5"}),a.jsxs("p",{className:"text-xs text-yellow-800 font-medium leading-relaxed",children:["This fee covers the manual review process. It is ",a.jsx("strong",{children:"non-refundable"})," even if the application is rejected."]})]})]})]}),a.jsxs("div",{className:"p-6 border-t border-gray-100 bg-white flex gap-3",children:[s>1&&a.jsx("button",{onClick:()=>r(E=>E-1),className:"px-6 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100",children:"Back"}),s<3?a.jsx("button",{onClick:()=>r(E=>E+1),className:"flex-1 bg-dark text-white py-3 rounded-xl font-bold hover:bg-primary shadow-lg",children:"Next Step"}):a.jsx("button",{onClick:b,disabled:i,className:"flex-1 bg-[#1DA1F2] text-white py-3 rounded-xl font-bold hover:bg-[#0d8ddb] shadow-lg shadow-blue-200 flex items-center justify-center gap-2",children:i?a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-circle-notch fa-spin"})," Processing..."]}):"Pay & Submit"})]})]}),l&&a.jsx(Y0,{amount:1,itemName:"Verification Review Fee",onClose:()=>c(!1),metadata:{type:"verification",requestId:u},onSuccess:()=>{alert("Payment Success!"),window.location.reload()}})]})},ma="https://ui-avatars.com/api/?name=User&background=random",t6=({postId:t,currentUser:e,onReply:n})=>{const s=tt(),[r,i]=g.useState([]);if(g.useEffect(()=>{const u=qe(ae(L,"posts",t,"comments"),_t("timestamp","asc")),h=Fe(u,f=>{const m=f.docs.map(x=>({id:x.id,...x.data()}));i(m)});return()=>h()},[t]),r.length===0)return null;const o=r.filter(u=>!u.parentId),l=u=>r.filter(h=>h.parentId===u),c=({c:u,isReply:h})=>a.jsxs("div",{className:`flex gap-3 items-start text-sm mb-3 ${h?"ml-10":""}`,children:[a.jsx("img",{src:u.userAvatar||ma,className:"w-8 h-8 rounded-full object-cover flex-shrink-0 cursor-pointer border border-gray-100",alt:u.userName,onClick:()=>s(`/profile/${u.uid}`),onError:f=>{f.target.src=ma}}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none inline-block border border-gray-100",children:[a.jsxs("span",{className:"font-bold text-xs block text-dark cursor-pointer hover:underline flex items-center gap-1",onClick:()=>s(`/profile/${u.uid}`),children:[u.userName,u.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-[10px]",title:"Verified Commenter"})]}),a.jsx("p",{className:"text-gray-700 leading-tight",children:u.text})]}),!h&&a.jsx("button",{onClick:()=>n(u.id,u.userName),className:"text-[10px] font-bold text-gray-500 ml-2 mt-1 hover:text-primary",children:"Reply"})]})]});return a.jsx("div",{className:"mt-3 px-2 max-h-60 overflow-y-auto custom-scrollbar",children:o.map(u=>a.jsxs("div",{children:[a.jsx(c,{c:u,isReply:!1}),l(u.id).map(h=>a.jsx(c,{c:h,isReply:!0},h.id))]},u.id))})},TN=()=>{var bs;const{id:t}=Nl(),e=tt(),[n,s]=g.useState(null),[r,i]=g.useState(null),[o,l]=g.useState([]),[c,u]=g.useState(!1),[h,f]=g.useState(!1),[m,x]=g.useState(null),[b,N]=g.useState(!1),[E,w]=g.useState(!1),[v,T]=g.useState(null),[I,R]=g.useState(""),[V,j]=g.useState(null),[y,k]=g.useState(null),[S,D]=g.useState(null),[P,C]=g.useState(null),[q,ue]=g.useState(""),[Se,fe]=g.useState(!1),[K,se]=g.useState(null),[ne,F]=g.useState(!1),[G,J]=g.useState(!1);g.useEffect(()=>{const Z=Pt(Ve,z=>{if(z){x(z.uid);const pe=Fe(H(L,"users",z.uid),ge=>{ge.exists()&&i(ge.data())}),ye=t||z.uid;return u(ye===z.uid),we(ye),ye!==z.uid&&je(ye,z.uid),()=>pe()}else t&&we(t)}),X=z=>{z.target.closest(".post-menu-container")||D(null)};return document.addEventListener("click",X),()=>{Z(),document.removeEventListener("click",X)}},[t]);const we=Z=>{const X=Fe(H(L,"users",Z),ge=>{var Ce;ge.exists()?s(ge.data()):Z===((Ce=Ve.currentUser)==null?void 0:Ce.uid)?s({displayName:Ve.currentUser.displayName,handle:"user",photoURL:Ve.currentUser.photoURL,coverPhotoURL:null,bio:"New user",followers:0,following:0,followersList:[],followingList:[]}):s(null)}),z=ae(L,"posts"),pe=qe(z,rt("uid","==",Z),_t("timestamp","desc")),ye=Fe(pe,ge=>{l(ge.docs.map(Ce=>({id:Ce.id,...Ce.data()})))});return()=>{X(),ye()}},je=async(Z,X)=>{const z=H(L,"users",Z,"followers",X),pe=await jt(z);N(pe.exists())},U=async()=>{if(!m||E)return;w(!0);const Z=t||m;try{const X=xl(L),z=H(L,"users",Z),pe=H(L,"users",m),ye=H(L,"users",Z,"followers",m),ge=H(L,"users",m,"following",Z);b?(X.delete(ye),X.delete(ge),X.update(z,{followers:pt(-1),followersList:kt(m)}),X.update(pe,{following:pt(-1),followingList:kt(Z)}),N(!1)):(X.set(ye,{timestamp:Ie()}),X.set(ge,{timestamp:Ie()}),X.update(z,{followers:pt(1),followersList:ut(m)}),X.update(pe,{following:pt(1),followingList:ut(Z)}),N(!0),Z!==m&&await ze(ae(L,"notifications"),{recipientId:Z,senderId:m,senderName:Ve.currentUser.displayName,senderAvatar:Ve.currentUser.photoURL,type:"follow",targetId:m,timestamp:Ie(),isRead:!1})),await X.commit()}catch(X){console.error("Follow error:",X)}finally{w(!1)}},xe=((bs=n==null?void 0:n.followingList)==null?void 0:bs.includes(m))&&b,Ee=(()=>{const Z=n==null?void 0:n.gender;return Z==="Male"?"Amigo":Z==="Female"?"Amiga":"Amigos"})(),be=()=>{if(!m)return console.error("Please sign in.");e("/messages",{state:{startChatWith:{...n,uid:t||m}}})},Q=async Z=>{await ze(ae(L,"boost_requests"),{...Z,requesterId:m,timestamp:Ie()}),alert("Profile promotion requested!"),F(!1)},oe=async Z=>{if(!m)return console.error("Sign in.");const X=H(L,"posts",Z.id);Z.likedBy&&Z.likedBy.includes(m)?await he(X,{likes:pt(-1),likedBy:kt(m)}):await he(X,{likes:pt(1),likedBy:ut(m)})},Me=Z=>{if(!m)return console.error("Sign in to comment.");v===Z?T(null):(T(Z),R(""),j(null))},Ze=(Z,X)=>{var z;j(Z),R(`@${X} `),(z=document.querySelector(`#comment-input-${v}`))==null||z.focus()},vt=async Z=>{!I.trim()||!m||(await ze(ae(L,"posts",Z,"comments"),{text:I,uid:m,userName:(r==null?void 0:r.displayName)||Ve.currentUser.displayName,userAvatar:(r==null?void 0:r.photoURL)||Ve.currentUser.photoURL||ma,isVerified:(r==null?void 0:r.isVerified)||!1,parentId:V,timestamp:Ie()}),await he(H(L,"posts",Z),{comments:pt(1)}),R(""),j(null))},Pn=async Z=>{const X=`${window.location.origin}/post/${Z.id}`;navigator.clipboard&&navigator.clipboard.writeText(X).then(()=>alert("Link copied!"))},Yt=async Z=>{window.confirm("Delete this post?")&&await is(H(L,"posts",Z))},as=async Z=>{await he(H(L,"posts",Z.id),{isPrivate:!Z.isPrivate}),D(null)},un=async Z=>{!K||!m||(await ze(ae(L,"reports"),{targetId:K,type:"post",reporter:m,reason:Z,timestamp:Ie()}),fe(!1),se(null))},Nt=Z=>{C(Z.id),ue(Z.text),D(null)},Wn=async Z=>{q.trim()&&(await he(H(L,"posts",Z),{text:q}),C(null))};return n?a.jsxs("div",{className:"p-2 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm overflow-hidden mb-8 relative group transition-all hover:shadow-md",children:[a.jsx("div",{className:`h-48 md:h-80 w-full bg-gray-200 bg-cover bg-center relative ${n.isVerified?"ring-b-4 ring-blue-500":""}`,style:{backgroundImage:`url(${n.coverPhotoURL||"https://images.unsplash.com/photo-1579546929518-9e396f3cc809"})`},children:n.isVerified&&a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-blue-900/30 to-transparent"})}),a.jsxs("div",{className:"px-6 md:px-10 pb-8 relative",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end -mt-16 md:-mt-20 mb-6",children:[a.jsx("div",{className:"relative mx-auto md:mx-0",children:a.jsx("div",{className:`w-32 h-32 md:w-44 md:h-44 rounded-[2rem] p-1 bg-white shadow-2xl ${n.isVerified?"ring-4 ring-offset-4 ring-blue-500/50":""}`,children:a.jsx("img",{src:n.photoURL||ma,className:"w-full h-full rounded-[1.8rem] object-cover",alt:`${n.displayName} avatar`,onError:Z=>{Z.target.src=ma}})})}),a.jsxs("div",{className:"flex flex-col items-center w-full md:w-auto mt-4 md:mt-0 md:mb-4 gap-3",children:[a.jsxs("div",{className:"flex items-center gap-6 bg-white/90 backdrop-blur-md px-6 py-3 rounded-2xl shadow-sm border border-gray-100",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("span",{className:"block font-black text-lg text-dark",children:o.length}),a.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Posts"})]}),a.jsx("div",{className:"w-px h-8 bg-gray-200"}),a.jsxs("div",{className:"text-center cursor-pointer hover:opacity-70 transition-opacity",onClick:()=>e(`/profile/${t||m}/connections`),children:[a.jsx("span",{className:"block font-black text-lg text-dark",children:n.followers||0}),a.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Followers"})]}),a.jsx("div",{className:"w-px h-8 bg-gray-200"}),a.jsxs("div",{className:"text-center cursor-pointer hover:opacity-70 transition-opacity",onClick:()=>e(`/profile/${t||m}/connections`),children:[a.jsx("span",{className:"block font-black text-lg text-dark",children:n.following||0}),a.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Following"})]})]}),a.jsx("div",{className:"flex gap-2",children:c?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>f(!0),className:"bg-gray-100 text-dark border border-gray-200 px-6 py-2 rounded-2xl font-bold hover:bg-gray-200 transition-all",children:"Edit Profile"}),a.jsx("button",{onClick:()=>F(!0),className:"w-10 h-10 rounded-2xl bg-gradient-to-br from-yellow-400 to-orange-500 text-white shadow-md hover:shadow-lg hover:scale-105 transition-all flex items-center justify-center",title:"Promote Profile",children:a.jsx("i",{className:"fas fa-rocket"})}),!n.isVerified&&a.jsx("button",{onClick:()=>J(!0),className:"w-10 h-10 rounded-2xl bg-blue-500 text-white shadow-md hover:bg-blue-600 hover:scale-105 transition-all flex items-center justify-center",title:"Get Verified",children:a.jsx("i",{className:"fas fa-check-circle"})})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:U,disabled:E,className:`px-6 py-2 rounded-2xl font-bold shadow-md transition-all flex items-center gap-2 
                           ${xe?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-pink-500/30 border-none transform hover:scale-105":b?"bg-white text-dark border hover:bg-gray-100":"bg-primary text-white hover:bg-primary-dark"}`,children:E?a.jsx("i",{className:"fas fa-spinner fa-spin"}):xe?a.jsxs(a.Fragment,{children:[a.jsx("i",{className:"fas fa-check"})," ",Ee]}):b?"Following":"Follow"}),a.jsx("button",{onClick:be,className:`bg-white text-primary border px-4 py-2 rounded-2xl font-bold shadow-md transition-all 
                           ${xe?"animate-pulse ring-2 ring-primary/50 shadow-primary/30 border-primary":"hover:bg-primary-light/10"}`,title:"Send Message",children:a.jsx("i",{className:"fas fa-comment-alt text-xl"})})]})})]})]}),a.jsxs("div",{className:"text-center md:text-left",children:[a.jsxs("h1",{className:`text-3xl font-black mb-1 flex items-center justify-center md:justify-start gap-2 ${n.isVerified?"text-transparent bg-clip-text bg-gradient-to-r from-blue-700 to-blue-500":"text-dark"}`,children:[n.displayName,n.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-2xl",title:"Verified Account"})]}),a.jsxs("p",{className:"text-primary font-bold text-sm mb-4",children:["@",n.handle||"user"]}),a.jsx("p",{className:"text-gray-600 leading-relaxed text-lg",children:n.bio}),a.jsxs("div",{className:"flex flex-wrap gap-3 mt-4 justify-center md:justify-start",children:[n.profession&&a.jsxs("span",{className:"px-4 py-2 rounded-xl bg-[#F8FAFD] text-gray-600 text-sm font-bold flex items-center gap-2 border border-gray-100",children:[a.jsx("i",{className:"fas fa-briefcase text-primary"})," ",n.profession]}),n.location&&a.jsxs("span",{className:"px-4 py-2 rounded-xl bg-[#F8FAFD] text-gray-600 text-sm font-bold flex items-center gap-2 border border-gray-100",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-primary"})," ",n.location]})]})]})]})]}),a.jsxs("div",{className:"flex flex-col gap-6",children:[o.length===0&&a.jsx("div",{className:"text-center py-10 border-2 border-dashed border-gray-200 rounded-3xl",children:a.jsx("p",{className:"text-gray-400 font-bold",children:"No posts yet."})}),o.map(Z=>{var ye;const X=Z.likedBy&&Z.likedBy.includes(m),z=m===Z.uid;if(Z.isPrivate&&!z)return null;const pe=n.isVerified;return a.jsxs("div",{className:`bg-white rounded-[24px] p-6 shadow-sm border relative ${pe?"border-blue-100":"border-gray-100"}`,children:[Z.isPromoted&&a.jsx("div",{className:"absolute top-4 right-16 text-[10px] font-bold text-gray-400 uppercase tracking-wider bg-gray-100 px-2 py-1 rounded",children:"Promoted"}),a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:"relative",children:a.jsx("img",{src:Z.userAvatar||ma,className:`w-12 h-12 rounded-2xl object-cover ${pe?"ring-2 ring-blue-400":""}`,alt:`${Z.userName} avatar`,onError:ge=>{ge.target.src=ma}})}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-dark text-lg flex items-center gap-1",children:[Z.userName,pe&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-sm"}),Z.isPrivate&&a.jsx("i",{className:"fas fa-lock text-xs text-gray-400 ml-2",title:"Private Post"})]}),a.jsx("p",{className:"text-xs text-gray-400 font-bold",children:(ye=Z.timestamp)!=null&&ye.seconds?new Date(Z.timestamp.seconds*1e3).toLocaleDateString():"Just now"})]})]}),a.jsxs("div",{className:"relative post-menu-container",children:[a.jsx("button",{onClick:()=>D(S===Z.id?null:Z.id),className:"text-gray-300 hover:text-dark p-2 transition-colors",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),S===Z.id&&a.jsx("div",{className:"absolute right-0 top-8 w-40 bg-white rounded-xl shadow-xl z-10 overflow-hidden border",children:z?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>as(Z),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50",children:Z.isPrivate?"Make Public":"Make Private"}),a.jsx("button",{onClick:()=>Nt(Z),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50",children:"Edit"}),a.jsx("button",{onClick:()=>Yt(Z.id),className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-500",children:"Delete"})]}):a.jsx("button",{onClick:()=>{se(Z.id),fe(!0),D(null)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-red-500",children:"Report"})})]})]}),P===Z.id?a.jsxs("div",{className:"mb-4",children:[a.jsx("textarea",{value:q,onChange:ge=>ue(ge.target.value),className:"w-full p-3 bg-gray-50 rounded-xl border focus:border-primary focus:outline-none transition-colors",rows:"4"}),a.jsx("button",{onClick:()=>Wn(Z.id),className:"mt-2 bg-primary text-white px-4 py-2 rounded-xl font-bold hover:bg-primary-dark transition-colors",children:"Save Edit"})]}):a.jsx("p",{className:"text-gray-800 mb-4 whitespace-pre-wrap",children:Z.text}),Z.mediaURL&&a.jsx("div",{className:"rounded-2xl overflow-hidden mb-4 shadow-sm cursor-pointer transition-all hover:opacity-90",onClick:()=>k({url:Z.mediaURL,type:Z.mediaType}),children:Z.mediaType==="video"?a.jsx("video",{src:Z.mediaURL,controls:!0,className:"w-full max-h-[500px] bg-black"}):a.jsx("img",{src:Z.mediaURL,className:"w-full max-h-[500px] object-cover",alt:"Post Media"})}),a.jsxs("div",{className:"flex gap-6 text-gray-500 font-bold text-sm pt-2 border-t border-gray-100/50 items-center",children:[a.jsxs("button",{onClick:()=>oe(Z),className:`flex items-center gap-2 transition-colors ${X?"text-red-500":"hover:text-red-500"}`,children:[a.jsx("i",{className:`${X?"fas":"far"} fa-heart text-lg`})," ",Z.likes||0]}),a.jsxs("button",{onClick:()=>Me(Z.id),className:"flex items-center gap-2 hover:text-primary transition-colors",children:[a.jsx("i",{className:"far fa-comment text-lg"})," ",Z.comments||0]}),a.jsx("button",{onClick:()=>Pn(Z),className:"ml-auto hover:text-dark transition-colors",children:a.jsx("i",{className:"far fa-share-square text-lg"})})]}),v===Z.id&&a.jsxs("div",{className:"mt-4 animate-fade-in",children:[a.jsx(t6,{postId:Z.id,currentUser:Ve.currentUser,onReply:Ze}),a.jsxs("div",{className:"flex gap-2 mt-3",children:[a.jsx("input",{id:`comment-input-${Z.id}`,type:"text",placeholder:V?"Replying to comment...":"Write a comment...",className:"flex-1 bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-primary transition-colors",value:I,onChange:ge=>R(ge.target.value),onKeyDown:ge=>ge.key==="Enter"&&vt(Z.id),autoFocus:!0}),a.jsx("button",{onClick:()=>vt(Z.id),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md hover:bg-primary-dark transition-colors disabled:opacity-50",disabled:!I.trim(),children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})]},Z.id)})]}),h&&n&&a.jsx(XI,{user:n,onClose:()=>f(!1),onSave:()=>we(m)}),ne&&a.jsx(JI,{target:{id:m,type:"profile",name:n.displayName},onClose:()=>F(!1),onBoost:Q}),G&&a.jsx(ZI,{onClose:()=>J(!1)}),y&&a.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4 transition-opacity duration-300",onClick:()=>k(null),children:[a.jsx("button",{onClick:()=>k(null),className:"absolute top-4 right-4 text-white text-3xl z-[101]",children:""}),y.type==="video"?a.jsx("video",{src:y.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-full object-contain",onClick:Z=>Z.stopPropagation()}):a.jsx("img",{src:y.url,alt:"Fullscreen Media",className:"max-w-full max-h-full object-contain",onClick:Z=>Z.stopPropagation()})]}),Se&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center animate-fade-in p-4",children:a.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[a.jsx("div",{className:"text-center mb-4",children:a.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Report Post"})}),a.jsx("div",{className:"space-y-2 mb-6",children:["Spam or Fraud","Harassment","Violence","False Information","Inappropriate Content"].map(Z=>a.jsx("button",{onClick:()=>un(Z),className:"w-full text-left p-3 rounded-xl bg-gray-50 hover:bg-red-50 hover:text-red-600 text-gray-700 font-medium transition-colors",children:Z},Z))}),a.jsx("button",{onClick:()=>fe(!1),className:"w-full py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancel"})]})})]}):a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading profile..."})},n6=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState([]),[i,o]=g.useState([]),[l,c]=g.useState(!1),[u,h]=g.useState(!1),[f,m]=g.useState(""),[x,b]=g.useState(""),[N,E]=g.useState("Social"),[w,v]=g.useState(!1),[T,I]=g.useState(null),R=["Social","Science","Technology","Entertainment","Business","Lifestyle","Art","Gaming"];g.useEffect(()=>{const y=Pt(Ve,D=>n(D)),k=qe(ae(L,"circles"),_t("memberCount","desc")),S=Fe(k,D=>{const P=D.docs.map(C=>({id:C.id,...C.data()}));r(P)});return()=>{y(),S()}},[]),g.useEffect(()=>{e&&s.length>0&&o(s.filter(y=>y.members&&y.members.includes(e.uid)))},[e,s]);const V=async y=>{if(y.preventDefault(),!e)return alert("Please sign in.");h(!0);try{let k=`https://ui-avatars.com/api/?name=${f}&background=random`;if(T){const S=sn(rn,`circles/${Date.now()}_${T.name}`);await An(S,T),k=await nn(S)}await ze(ae(L,"circles"),{name:f,description:x,category:N,isPrivate:w,image:k,createdBy:e.uid,createdAt:Ie(),members:[e.uid],admins:[e.uid],joinRequests:[],memberCount:1}),c(!1),m(""),b(""),I(null),alert("Circle Created Successfully!")}catch(k){console.error(k),alert("Failed to create circle.")}finally{h(!1)}},j=async y=>{if(!e)return alert("Sign in required.");const k=H(L,"circles",y.id);y.isPrivate?y.joinRequests&&y.joinRequests.includes(e.uid)?alert("Request already sent."):(await he(k,{joinRequests:ut(e.uid)}),alert("Join request sent to admins.")):await he(k,{members:ut(e.uid),memberCount:pt(1)})};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-black text-dark tracking-tight flex items-center gap-3",children:[a.jsx("i",{className:"fas fa-dot-circle text-primary"})," Circles"]}),a.jsx("p",{className:"text-gray-500 font-medium",children:"Find your tribe. Join the elite."})]}),a.jsxs("button",{onClick:()=>c(!0),className:"bg-gradient-to-r from-primary to-primary-light text-white px-6 py-3 rounded-full font-bold shadow-lg hover:shadow-primary/30 transition-all flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-plus"})," Create Circle"]})]}),i.length>0&&a.jsxs("div",{className:"mb-10",children:[a.jsx("h3",{className:"text-xl font-bold text-dark mb-4 px-2",children:"My Circles"}),a.jsx("div",{className:"flex gap-4 overflow-x-auto pb-4 no-scrollbar",children:i.map(y=>a.jsxs("div",{onClick:()=>t(`/circles/${y.id}`),className:"flex-shrink-0 w-64 glass-panel rounded-[30px] p-4 hover:scale-105 transition-transform cursor-pointer border border-white/60 relative overflow-hidden group",children:[a.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-20 group-hover:opacity-30 transition-opacity",style:{backgroundImage:`url(${y.image})`}}),a.jsxs("div",{className:"relative z-10 flex flex-col items-center text-center",children:[a.jsx("img",{src:y.image,className:"w-20 h-20 rounded-full border-4 border-white shadow-md mb-3 object-cover"}),a.jsx("h4",{className:"font-bold text-dark text-lg leading-tight mb-1 truncate w-full",children:y.name}),a.jsxs("span",{className:"text-xs font-bold text-primary bg-primary/10 px-3 py-1 rounded-full",children:[y.memberCount," Members"]})]})]},y.id))})]}),a.jsx("h3",{className:"text-xl font-bold text-dark mb-6 px-2",children:"Discover"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(y=>{const k=e&&y.members&&y.members.includes(e.uid),S=e&&y.joinRequests&&y.joinRequests.includes(e.uid);return a.jsxs("div",{className:"glass-panel rounded-[30px] p-6 flex items-center gap-5 hover:shadow-xl transition-all border border-white/50 cursor-pointer",onClick:()=>t(`/circles/${y.id}`),children:[a.jsx("img",{src:y.image,className:"w-24 h-24 rounded-full object-cover shadow-lg border-4 border-white/50"}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("span",{className:"bg-gray-100 text-[10px] font-bold px-2 py-0.5 rounded-md text-gray-500 mb-1",children:y.category}),y.isPrivate&&a.jsx("i",{className:"fas fa-lock text-gray-400 text-xs"})]}),a.jsx("h4",{className:"font-black text-xl text-dark truncate",children:y.name}),a.jsx("p",{className:"text-sm text-gray-500 line-clamp-2 mb-4",children:y.description}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:"text-xs font-bold text-gray-400",children:[a.jsx("i",{className:"fas fa-users mr-1"})," ",y.memberCount]}),a.jsx("button",{onClick:D=>{D.stopPropagation(),!k&&!S&&j(y)},className:`text-xs font-bold px-5 py-2 rounded-full transition-colors shadow-sm
                        ${k?"bg-gray-100 text-gray-400":S?"bg-yellow-100 text-yellow-600":"bg-dark text-white hover:bg-primary"}`,children:k?"Joined":S?"Pending":"Join"})]})]})]},y.id)})}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-[30px] shadow-2xl w-full max-w-md overflow-hidden",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Create Circle"}),a.jsx("button",{onClick:()=>c(!1),children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),a.jsxs("form",{onSubmit:V,className:"p-6 space-y-4",children:[a.jsx("input",{type:"text",required:!0,placeholder:"Circle Name",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3",value:f,onChange:y=>m(y.target.value)}),a.jsx("textarea",{required:!0,placeholder:"Description",rows:"3",className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3",value:x,onChange:y=>b(y.target.value)}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("select",{className:"w-full bg-gray-50 border border-gray-200 rounded-xl px-4 py-3",value:N,onChange:y=>E(y.target.value),children:R.map(y=>a.jsx("option",{value:y,children:y},y))}),a.jsx("div",{className:"flex items-center justify-center bg-gray-50 border border-gray-200 rounded-xl px-4",children:a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer text-sm text-gray-600 font-bold",children:[a.jsx("input",{type:"checkbox",checked:w,onChange:y=>v(y.target.checked)})," Private"]})})]}),a.jsxs("div",{className:"border-dashed border-2 border-gray-200 rounded-xl p-4 text-center",children:[a.jsxs("label",{className:"cursor-pointer",children:[a.jsx("span",{className:"text-primary font-bold text-sm",children:"Upload Cover Image"}),a.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:y=>I(y.target.files[0])})]}),T&&a.jsx("p",{className:"text-xs text-gray-500 mt-2",children:T.name})]}),a.jsx("button",{type:"submit",disabled:u,className:"w-full bg-primary text-white font-bold py-4 rounded-xl hover:bg-primary-dark transition-all shadow-lg",children:u?"Creating...":"Launch Circle"})]})]})})]})},_f=({src:t,name:e,size:n="md",className:s=""})=>{const r={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base",xl:"w-16 h-16 text-xl"};let i=t;(!t||t.includes("via.placeholder")||t.includes("ui-avatars.com/api/?name=null"))&&(i=`https://ui-avatars.com/api/?name=${e||"User"}&background=random&color=fff`);const o=l=>{l.target.src=`https://ui-avatars.com/api/?name=${e||"User"}&background=random&color=fff`,l.target.onerror=null};return a.jsx("img",{src:i,className:`${r[n]} rounded-full object-cover border border-gray-200 ${s}`,alt:e||"User",onError:o})},s6=({circleId:t,postId:e,onReply:n})=>{const s=tt(),[r,i]=g.useState([]);if(g.useEffect(()=>{const u=qe(ae(L,`circles/${t}/posts/${e}/comments`),_t("timestamp","asc")),h=Fe(u,f=>{i(f.docs.map(m=>({id:m.id,...m.data()})))});return()=>h()},[t,e]),r.length===0)return null;const o=r.filter(u=>!u.parentId),l=u=>r.filter(h=>h.parentId===u),c=({c:u,isReply:h})=>{var f;return a.jsxs("div",{className:`flex gap-3 items-start mb-3 ${h?"ml-10 mt-2":""}`,children:[a.jsx("div",{onClick:()=>s(`/profile/${u.uid}`),className:"cursor-pointer flex-shrink-0",children:a.jsx(_f,{src:u.userAvatar,name:u.userName,size:"sm"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none border border-gray-100 inline-block",children:[a.jsxs("div",{className:"flex items-center gap-1 mb-0.5",children:[a.jsx("span",{className:"font-bold text-xs text-dark cursor-pointer hover:underline",onClick:()=>s(`/profile/${u.uid}`),children:u.userName}),u.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-[10px]"})]}),a.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:u.text})]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1 ml-1",children:[a.jsx("span",{className:"text-[10px] text-gray-400",children:(f=u.timestamp)!=null&&f.seconds?new Date(u.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"}),!u.parentId&&a.jsx("button",{onClick:()=>n(u),className:"text-[10px] font-bold text-gray-500 hover:text-primary transition-colors",children:"Reply"})]})]})]})};return a.jsx("div",{className:"mt-3 pt-3 border-t border-gray-50 max-h-60 overflow-y-auto custom-scrollbar px-1",children:o.map(u=>a.jsxs("div",{children:[a.jsx(c,{c:u,isReply:!1}),l(u.id).map(h=>a.jsx(c,{c:h,isReply:!0},h.id))]},u.id))})},r6=({uid:t,isAdminView:e,onRemove:n})=>{const[s,r]=g.useState(null);return g.useEffect(()=>{jt(H(L,"users",t)).then(i=>r(i.exists()?i.data():{displayName:"Unknown",photoURL:null}))},[t]),s?a.jsxs("div",{className:"flex justify-between items-center p-3 bg-white/60 rounded-xl border border-white/50 mb-2",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(_f,{src:s.photoURL,name:s.displayName,size:"sm"}),a.jsxs("span",{className:"text-sm font-bold text-gray-700 flex items-center gap-1",children:[s.displayName,s.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]})]}),e&&a.jsx("button",{onClick:()=>n(t),className:"text-red-500 hover:bg-red-50 p-2 rounded-lg text-xs font-bold",children:"Remove"})]}):a.jsx("div",{className:"p-3 text-xs text-gray-400",children:"Loading..."})},i6=()=>{var X;const{circleId:t}=Nl(),e=tt(),[n,s]=g.useState(null),[r,i]=g.useState(null),[o,l]=g.useState(null),[c,u]=g.useState([]),[h,f]=g.useState("feed"),[m,x]=g.useState(""),[b,N]=g.useState(null),[E,w]=g.useState(!1),[v,T]=g.useState(null),[I,R]=g.useState(null),[V,j]=g.useState(""),[y,k]=g.useState(null),[S,D]=g.useState(""),[P,C]=g.useState(null),[q,ue]=g.useState(null),[Se,fe]=g.useState(!1),[K,se]=g.useState(""),[ne,F]=g.useState(null),[G,J]=g.useState("");if(g.useEffect(()=>{const z=Pt(Ve,Ce=>{Ce?(s(Ce),jt(H(L,"users",Ce.uid)).then(Et=>i(Et.data()))):(s(null),i(null))}),pe=Fe(H(L,"circles",t),Ce=>Ce.exists()?l({id:Ce.id,...Ce.data()}):e("/circles")),ye=Fe(qe(ae(L,`circles/${t}/posts`),_t("timestamp","desc")),Ce=>u(Ce.docs.map(Et=>({id:Et.id,...Et.data()})))),ge=Ce=>{Ce.target.closest(".post-menu-container")||T(null),Ce.target.closest(".circle-menu-container")||fe(!1)};return document.addEventListener("click",ge),()=>{z(),pe(),ye(),document.removeEventListener("click",ge)}},[t,e]),!o)return a.jsx("div",{className:"p-10 text-center",children:"Loading Circle..."});const we=n&&o.members&&o.members.includes(n.uid),je=n&&o.admins&&o.admins.includes(n.uid),U=n&&o.createdBy===n.uid,xe=n&&o.joinRequests&&o.joinRequests.includes(n.uid),re=async()=>{if(!n)return alert("Sign in required.");const z=H(L,"circles",t);if(o.isPrivate){if(xe)return alert("Request already sent.");await he(z,{joinRequests:ut(n.uid)}),alert("Join request sent to admins.")}else await he(z,{members:ut(n.uid),memberCount:pt(1)}),alert("Welcome to the Circle!")},Ee=async()=>{if(!(!m.trim()&&!b||!n)){w(!0);try{let z=null,pe=null;if(b){const ye=sn(rn,`circles/${t}/posts/${Date.now()}_${b.name}`);await An(ye,b),z=await nn(ye),pe=b.type.startsWith("video/")?"video":"image"}await ze(ae(L,`circles/${t}/posts`),{text:m,uid:n.uid,userName:n.displayName,userAvatar:(r==null?void 0:r.photoURL)||null,isVerified:(r==null?void 0:r.isVerified)||!1,mediaURL:z,mediaType:pe,timestamp:Ie(),likes:0,comments:0,likedBy:[]}),x(""),N(null)}catch(z){console.error(z)}finally{w(!1)}}},be=async z=>{var ye;if(!n)return alert("Sign in required.");const pe=H(L,`circles/${t}/posts`,z.id);(ye=z.likedBy)!=null&&ye.includes(n.uid)?await he(pe,{likes:pt(-1),likedBy:kt(n.uid)}):await he(pe,{likes:pt(1),likedBy:ut(n.uid)})},Q=z=>{y===z?(k(null),C(null)):(k(z),D(""),C(null))},oe=z=>{C(z.id),D(`@${z.userName} `);const pe=document.getElementById(`circle-comment-${y}`);pe&&pe.focus()},Me=async z=>{var ge,Ce;if(!S.trim()||!n)return;let pe=S;const ye=(Ce=(ge=c.find(Et=>Et.id===z))==null?void 0:ge.commentsData)==null?void 0:Ce.find(Et=>Et.id===P);ye&&pe.startsWith(`@${ye.userName} `)&&pe.trim()!==`@${ye.userName}`&&(pe=pe.substring(`@${ye.userName} `.length)),await ze(ae(L,`circles/${t}/posts/${z}/comments`),{text:pe,uid:n.uid,userName:n.displayName,userAvatar:(r==null?void 0:r.photoURL)||null,isVerified:(r==null?void 0:r.isVerified)||!1,parentId:P,timestamp:Ie()}),await he(H(L,`circles/${t}/posts`,z),{comments:pt(1)}),D(""),C(null)},Ze=async z=>{confirm("Remove this member?")&&await he(H(L,"circles",t),{members:kt(z),admins:kt(z),memberCount:pt(-1)})},vt=async()=>{if(U)return alert("Owner cannot leave.");confirm("Are you sure you want to leave?")&&(await he(H(L,"circles",t),{members:kt(n.uid),admins:kt(n.uid),memberCount:pt(-1)}),e("/circles"))},Pn=async()=>{confirm("Delete permanently?")&&(await is(H(L,"circles",t)),e("/circles"))},Yt=async()=>{try{let z=o.image;if(ne){const pe=sn(rn,`circles/${t}/cover_${Date.now()}`);await An(pe,ne),z=await nn(pe)}await he(H(L,"circles",t),{name:K,image:z}),alert("Updated!"),F(null)}catch(z){console.error(z)}},as=async()=>{if(!G)return alert("Select reason");await ze(ae(L,"reports"),{targetId:t,type:"circle",reporter:n.uid,reason:G,timestamp:Ie()}),alert("Reported."),J("")},un=async z=>{confirm("Delete post?")&&await is(H(L,`circles/${t}/posts`,z))},Nt=z=>{R(z.id),j(z.text),T(null)},Wn=async z=>{await he(H(L,`circles/${t}/posts`,z),{text:V}),R(null)},bs=async z=>{await ze(ae(L,"reports"),{postId:z,circleId:t,reporter:n.uid,reason:"Flagged in Circle",timestamp:Ie()}),alert("Post reported."),T(null)},Z=z=>{const pe={title:`Post in ${o.name}`,text:z.text,url:window.location.href};navigator.share?navigator.share(pe):(navigator.clipboard.writeText(window.location.href),alert("Link copied!"))};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("button",{onClick:()=>e("/circles"),className:"mb-4 font-bold flex items-center gap-2 text-gray-500 hover:text-dark",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back to Circles"]}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm overflow-hidden mb-8 relative",children:[a.jsx("div",{className:"h-60 w-full bg-gray-200 bg-cover bg-center",style:{backgroundImage:`url(${o.image})`},children:a.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-end p-8 text-white",children:a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end gap-4 w-full",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("span",{className:"bg-primary px-3 py-1 rounded-lg text-xs font-bold uppercase tracking-wider",children:o.category||"Social"}),o.isPrivate&&a.jsxs("span",{className:"bg-white/20 backdrop-blur-md px-3 py-1 rounded-lg text-xs font-bold",children:[a.jsx("i",{className:"fas fa-lock mr-1"})," Private"]})]}),a.jsx("h1",{className:"text-4xl font-black mb-2",children:o.name}),a.jsx("p",{className:"text-white/80 max-w-2xl text-sm",children:o.description})]}),a.jsx("div",{className:"flex items-center gap-3",children:we?a.jsxs("div",{className:"relative circle-menu-container",children:[a.jsx("button",{onClick:()=>fe(!Se),className:"w-10 h-10 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white hover:text-dark transition-all",children:a.jsx("i",{className:"fas fa-cog text-lg"})}),Se&&a.jsxs("div",{className:"absolute right-0 bottom-12 w-48 bg-white rounded-xl shadow-xl border border-gray-100 z-50 overflow-hidden animate-fade-in p-1",children:[je&&a.jsxs("button",{onClick:()=>{f("settings"),fe(!1)},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-700 hover:bg-gray-50 rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-sliders-h text-primary"})," Settings"]}),!U&&a.jsxs("button",{onClick:()=>{vt(),fe(!1)},className:"w-full text-left px-4 py-3 text-sm font-bold text-red-500 hover:bg-red-50 rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-sign-out-alt"})," Leave Circle"]}),!je&&a.jsxs("button",{onClick:()=>{f("report"),fe(!1)},className:"w-full text-left px-4 py-3 text-sm font-bold text-gray-500 hover:bg-gray-50 rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-flag"})," Report"]})]})]}):a.jsx("button",{onClick:re,className:`px-6 py-2 rounded-xl font-bold text-sm shadow-lg transition-all ${xe?"bg-yellow-100 text-yellow-700":"bg-white text-dark hover:bg-primary hover:text-white"}`,disabled:xe,children:xe?"Request Pending":"Join Circle"})})]})})}),a.jsxs("div",{className:"px-8 py-4 flex gap-8 text-sm font-bold text-gray-500 border-b border-gray-100",children:[a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-users mr-2"}),o.memberCount," Members"]}),a.jsxs("span",{children:[a.jsx("i",{className:"fas fa-layer-group mr-2"}),c.length," Posts"]})]})]}),we?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex gap-2 mb-6 overflow-x-auto pb-2",children:[a.jsx("button",{onClick:()=>f("feed"),className:`px-6 py-2 font-bold text-sm rounded-full transition-colors ${h==="feed"?"bg-dark text-white":"bg-white text-gray-500 hover:bg-gray-100"}`,children:"Feed"}),a.jsx("button",{onClick:()=>f("members"),className:`px-6 py-2 font-bold text-sm rounded-full transition-colors ${h==="members"?"bg-dark text-white":"bg-white text-gray-500 hover:bg-gray-100"}`,children:"Members"}),je&&o.isPrivate&&a.jsxs("button",{onClick:()=>f("requests"),className:`px-6 py-2 font-bold text-sm rounded-full transition-colors ${h==="requests"?"bg-dark text-white":"bg-white text-gray-500 hover:bg-gray-100"}`,children:["Requests ",((X=o.joinRequests)==null?void 0:X.length)>0&&a.jsx("span",{className:"ml-2 bg-red-500 text-white text-[10px] px-1.5 py-0.5 rounded-full",children:o.joinRequests.length})]})]}),a.jsx("div",{className:"flex flex-col lg:flex-row gap-8",children:a.jsxs("div",{className:"flex-1",children:[h==="feed"&&a.jsxs("div",{className:"space-y-6 max-w-2xl mx-auto",children:[a.jsxs("div",{className:"glass-panel rounded-[24px] p-4",children:[a.jsxs("div",{className:"flex gap-3 items-start mb-3",children:[a.jsx(_f,{src:r==null?void 0:r.photoURL,name:r==null?void 0:r.displayName}),a.jsx("textarea",{value:m,onChange:z=>x(z.target.value),placeholder:`Post to ${o.name}...`,className:"flex-1 bg-white/60 rounded-xl p-3 outline-none resize-none text-sm focus:ring-2 focus:ring-primary/20",rows:"2"})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 border-t border-gray-100",children:[a.jsx("input",{type:"file",onChange:z=>N(z.target.files[0]),className:"text-sm text-gray-500"}),a.jsx("button",{onClick:Ee,disabled:E||!m.trim()&&!b,className:"bg-dark text-white px-6 py-2 rounded-xl font-bold text-sm hover:bg-primary shadow-lg disabled:opacity-50",children:E?"Posting...":"Post"})]})]}),c.map(z=>{var ye;const pe=z.likedBy&&z.likedBy.includes(n.uid);return a.jsxs("div",{className:"glass-panel rounded-[24px] p-6 border border-white/60",children:[a.jsxs("div",{className:"flex justify-between items-start mb-4",children:[a.jsxs("div",{className:"flex items-center gap-3 cursor-pointer",onClick:()=>e(`/profile/${z.uid}`),children:[a.jsx(_f,{src:z.userAvatar,name:z.userName}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-dark text-sm flex items-center gap-1",children:[z.userName," ",z.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]}),a.jsx("p",{className:"text-xs text-gray-400",children:(ye=z.timestamp)!=null&&ye.seconds?new Date(z.timestamp.seconds*1e3).toLocaleDateString():"Just now"})]})]}),a.jsxs("div",{className:"relative post-menu-container",children:[a.jsx("button",{onClick:()=>T(v===z.id?null:z.id),className:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),v===z.id&&a.jsx("div",{className:"absolute right-0 top-full mt-2 w-40 bg-white rounded-xl shadow-xl border border-gray-100 z-20 overflow-hidden py-1",children:(n==null?void 0:n.uid)===z.uid||je?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>Nt(z),className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Edit"}),a.jsx("button",{onClick:()=>un(z.id),className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 font-bold",children:"Delete"})]}):a.jsx("button",{onClick:()=>bs(z.id),className:"w-full text-left px-4 py-2 text-sm text-gray-500 hover:bg-gray-50",children:"Report"})})]})]}),I===z.id?a.jsxs("div",{className:"mb-4 space-y-2",children:[a.jsx("textarea",{value:V,onChange:ge=>j(ge.target.value),className:"w-full bg-white/60 rounded-xl p-3 outline-none resize-none text-sm focus:ring-2 focus:ring-primary/20",rows:"3"}),a.jsxs("div",{className:"flex justify-end gap-2",children:[a.jsx("button",{onClick:()=>R(null),className:"px-4 py-2 text-sm rounded-lg border border-gray-300",children:"Cancel"}),a.jsx("button",{onClick:()=>Wn(z.id),className:"px-4 py-2 text-sm rounded-lg bg-primary text-white",children:"Save"})]})]}):a.jsx("p",{className:"text-gray-800 mb-4 leading-relaxed",children:z.text}),z.mediaURL&&a.jsx("div",{className:"rounded-xl overflow-hidden mb-4 shadow-sm cursor-pointer",onClick:()=>ue({url:z.mediaURL,type:z.mediaType}),children:z.mediaType==="video"?a.jsx("video",{src:z.mediaURL,controls:!0,className:"w-full max-h-[400px] bg-black"}):a.jsx("img",{src:z.mediaURL,className:"w-full max-h-[400px] object-cover",alt:"Post media"})}),a.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-100/50",children:[a.jsxs("button",{onClick:()=>be(z),className:`h-10 px-5 rounded-xl border flex items-center gap-2 transition-all ${pe?"bg-accent/10 border-accent/20 text-accent":"bg-white/50 border-white text-gray-600"}`,children:[a.jsx("i",{className:`${pe?"fas":"far"} fa-heart`})," ",a.jsx("span",{className:"font-bold text-sm",children:z.likes||0})]}),a.jsxs("button",{onClick:()=>Q(z.id),className:"h-10 px-5 rounded-xl bg-white/50 border border-white flex items-center gap-2 text-gray-600",children:[a.jsx("i",{className:"far fa-comment"})," ",a.jsx("span",{className:"font-bold text-sm",children:z.comments||0})]}),a.jsx("button",{onClick:()=>Z(z),className:"h-10 w-10 rounded-xl bg-white/50 border border-white flex items-center justify-center text-gray-600 ml-auto",children:a.jsx("i",{className:"far fa-share-square"})})]}),y===z.id&&a.jsxs("div",{className:"animate-fade-in",children:[a.jsx(s6,{circleId:t,postId:z.id,onReply:oe}),a.jsxs("div",{className:"mt-4 flex gap-2",children:[a.jsx("input",{id:`circle-comment-${z.id}`,type:"text",placeholder:P?"Replying...":"Write a comment...",className:"flex-1 bg-white/80 border border-white/50 rounded-xl px-4 py-2 text-sm focus:outline-none",value:S,onChange:ge=>D(ge.target.value),onKeyDown:ge=>ge.key==="Enter"&&Me(z.id),autoFocus:!0}),a.jsx("button",{onClick:()=>Me(z.id),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md",children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]}),P&&a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Replying to a comment. Clear text to post a new root comment."})]})]},z.id)})]}),h==="members"&&a.jsxs("div",{className:"glass-panel rounded-[24px] p-6",children:[a.jsx("h3",{className:"font-bold text-dark mb-4",children:"Members"}),je&&o.members&&o.members.length>0?a.jsx("div",{className:"space-y-1",children:o.members.map(z=>a.jsx(r6,{uid:z,isAdminView:!0,onRemove:Ze},z))}):a.jsx("div",{className:"text-center py-10 bg-gray-50/50 rounded-xl border border-gray-100",children:a.jsx("p",{className:"text-xs text-gray-500",children:je?"No members yet.":"Only admins can view the full member list."})})]}),h==="settings"&&je&&a.jsxs("div",{className:"glass-panel rounded-[24px] p-6 space-y-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-dark mb-2",children:"Edit Details"}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("input",{type:"text",value:K||o.name,onChange:z=>se(z.target.value),className:"w-full bg-white border border-gray-200 rounded-xl px-4 py-2 text-sm",placeholder:"Circle Name"}),a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx("input",{type:"file",onChange:z=>F(z.target.files[0]),className:"text-sm text-gray-500"}),a.jsx("button",{onClick:Yt,className:"bg-dark text-white px-4 py-2 rounded-lg text-xs font-bold",children:"Save Changes"})]})]})]}),a.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[a.jsx("h3",{className:"font-bold text-red-500 mb-2",children:"Danger Zone"}),a.jsx("button",{onClick:Pn,className:"w-full bg-red-50 text-red-500 border border-red-200 py-3 rounded-xl font-bold text-sm hover:bg-red-100",children:"Delete Circle Permanently"})]})]}),h==="report"&&!je&&a.jsxs("div",{className:"glass-panel rounded-[24px] p-6",children:[a.jsx("h3",{className:"font-bold text-dark mb-4",children:"Report Circle"}),a.jsx("textarea",{className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-3 border border-gray-200",rows:"3",placeholder:"Reason...",value:G,onChange:z=>J(z.target.value)}),a.jsx("button",{onClick:as,className:"w-full bg-red-500 text-white py-3 rounded-xl font-bold text-sm hover:bg-red-600",children:"Submit Report"})]})]})})]}):a.jsxs("div",{className:"text-center py-20 text-gray-400 bg-white rounded-[30px] shadow-sm",children:[a.jsx("i",{className:"fas fa-lock text-4xl mb-4 text-gray-300"}),a.jsx("h3",{className:"text-lg font-bold text-dark",children:"Private Content"}),a.jsx("p",{children:"Join this circle to view posts."})]}),q&&a.jsx("div",{className:"fixed inset-0 z-[100] bg-black/95 backdrop-blur-sm flex items-center justify-center p-4",onClick:()=>ue(null),children:a.jsx("img",{src:q.url,className:"max-w-full max-h-full object-contain",alt:"Fullscreen media"})})]})},a6=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState([]),[i,o]=g.useState(!0),[l,c]=g.useState("browse"),[u,h]=g.useState("All"),[f,m]=g.useState(""),[x,b]=g.useState([]),[N,E]=g.useState(!1),[w,v]=g.useState(!1),[T,I]=g.useState(null),[R,V]=g.useState(!1),[j,y]=g.useState({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),[k,S]=g.useState([]),[D,P]=g.useState([]),[C,q]=g.useState(null),ue=["All","Food & Beverage","Digital Products","Fashion & Apparel","Electronics & Gadgets","Home & Garden","Handmade & Crafts","Vehicles & Parts","Sports","Books","Baby & Kids","Beauty & Health","Real Estate","Services"],Se=["Shop Pickup","Free Shipping","Collection Point","Local Delivery"],fe=["No Return","7 Days Return","15 Days Return","30 Days Return"];g.useEffect(()=>{const U=Pt(Ve,be=>{if(n(be),be){const Q=H(L,"users",be.uid),oe=Fe(Q,Me=>{Me.exists()&&b(Me.data().savedProducts||[])});return()=>oe()}else b([])}),xe=qe(ae(L,"marketplace"),_t("timestamp","desc")),re=Fe(xe,be=>{r(be.docs.map(Q=>({id:Q.id,...Q.data()}))),o(!1)}),Ee=be=>{be.target.closest(".menu-trigger")||q(null)};return document.addEventListener("click",Ee),()=>{U(),re(),document.removeEventListener("click",Ee)}},[]);const K=()=>{y({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),S([]),P([]),v(!1),I(null)},se=async U=>{var xe;if(U.preventDefault(),!e)return alert("Sign in required.");if(k.length===0&&D.length===0)return alert("At least one photo/video required.");if(Number(j.price)<=0)return alert("Price must be greater than zero.");V(!0);try{const re=await Promise.all(k.map(async oe=>{const Me=sn(rn,`marketplace/${e.uid}/${Date.now()}_${oe.name}`);return await An(Me,oe),{url:await nn(Me),type:oe.type.startsWith("video")?"video":"image"}})),be=[...D.map(oe=>typeof oe=="string"?{url:oe,type:"image"}:oe),...re],Q={...j,image:((xe=be[0])==null?void 0:xe.url)||null,media:be,price:Number(j.price),boost:null};w&&T?(await he(H(L,"marketplace",T.id),Q),alert("Item Updated Successfully!")):(await ze(ae(L,"marketplace"),{...Q,sellerId:e.uid,sellerName:e.displayName,sellerAvatar:e.photoURL,sellerVerified:e.isVerified||!1,timestamp:Ie(),sold:!1,reviews:[],questions:[]}),alert("Item Listed Successfully!"),c("selling")),E(!1),K()}catch(re){console.error("Listing Error:",re),alert(`Failed to ${w?"update":"list"} item.`)}finally{V(!1)}},ne=U=>{y({title:U.title,price:U.price.toString(),currency:U.currency||"BDT",condition:U.condition||"New",description:U.description,category:U.category,location:U.location||"Dhaka",address:U.address||"",stock:U.stock||1,shippingType:U.shippingType||"Shop Pickup",returnPolicy:U.returnPolicy||"No Return"});const xe=Array.isArray(U.media)?U.media:U.image?[{url:U.image,type:"image"}]:[];P(xe),S([]),I(U),v(!0),E(!0),q(null)},F=async U=>{if(!(!e||!window.confirm(`Delete "${U.title}"? This cannot be undone.`)))try{await is(H(L,"marketplace",U.id)),alert("Product deleted.")}catch(xe){console.error(xe),alert("Failed to delete.")}},G=async U=>{await he(H(L,"marketplace",U.id),{sold:!U.sold}),q(null)},J=async(U,xe)=>{if(U.stopPropagation(),!e)return alert("Sign in to save.");const Ee=x.includes(xe.id)?kt(xe.id):ut(xe.id);await he(H(L,"users",e.uid),{savedProducts:Ee})},je=(()=>{let U=s;if(l==="selling"){if(!e)return[];U=U.filter(xe=>xe.sellerId===e.uid)}else U=U.filter(xe=>(u==="All"||xe.category===u)&&xe.title.toLowerCase().includes(f.toLowerCase()));return U})();return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-6 gap-4",children:[a.jsxs("div",{children:[a.jsxs("h2",{className:"text-3xl font-black text-dark tracking-tight flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-store text-primary"})," Marketplace"]}),a.jsx("p",{className:"text-gray-500 font-medium text-sm md:text-base",children:"Buy & Sell everything."})]}),a.jsxs("div",{className:"flex gap-2 md:gap-3 flex-wrap w-full md:w-auto",children:[a.jsxs("button",{onClick:()=>t("/business"),className:"flex-1 md:flex-none bg-white border border-gray-200 text-dark px-4 py-2.5 rounded-xl font-bold hover:bg-gray-50 transition-all shadow-sm text-xs md:text-sm",children:[a.jsx("i",{className:"fas fa-briefcase mr-2"})," Business"]}),a.jsxs("button",{onClick:()=>t("/saved-items"),className:"flex-1 md:flex-none bg-white border border-gray-200 text-dark px-4 py-2.5 rounded-xl font-bold hover:bg-gray-50 transition-all shadow-sm text-xs md:text-sm",children:[a.jsx("i",{className:"far fa-heart mr-2"})," Saved"]}),a.jsxs("button",{onClick:()=>c(l==="selling"?"browse":"selling"),className:`flex-1 md:flex-none px-4 py-2.5 rounded-xl font-bold transition-all shadow-sm text-xs md:text-sm flex items-center justify-center gap-2 ${l==="selling"?"bg-dark text-white":"bg-white border border-gray-200 text-dark hover:bg-gray-50"}`,children:[a.jsx("i",{className:"fas fa-box-open"})," ",l==="selling"?"Market":"My Items"]}),a.jsxs("button",{onClick:()=>{K(),E(!0)},className:"flex-1 md:flex-none bg-gradient-to-r from-primary to-primary-dark text-white px-5 py-2.5 rounded-xl font-bold shadow-lg hover:shadow-primary/30 transition-all text-xs md:text-sm flex items-center justify-center gap-2",children:[a.jsx("i",{className:"fas fa-plus"})," Sell"]})]})]}),a.jsx("hr",{className:"mb-6 border-gray-200"}),l==="browse"&&a.jsxs("div",{className:"mb-6 flex flex-col md:flex-row gap-4",children:[a.jsxs("div",{className:"relative flex-1",children:[a.jsx("i",{className:"fas fa-search absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search items...",className:"w-full bg-white border-none rounded-xl pl-10 pr-4 py-3 shadow-sm focus:ring-2 focus:ring-primary/20",value:f,onChange:U=>m(U.target.value)})]}),a.jsx("select",{value:u,onChange:U=>h(U.target.value),className:"bg-white font-bold text-dark px-4 py-3 rounded-xl shadow-sm outline-none appearance-none border-r-8 border-transparent cursor-pointer w-full md:w-auto",children:ue.map(U=>a.jsx("option",{value:U,children:U},U))})]}),l==="selling"&&a.jsxs("div",{className:"mb-6 flex items-center gap-2",children:[a.jsx("h3",{className:"text-xl font-bold text-dark",children:"Your Active Listings"}),a.jsxs("span",{className:"bg-primary/10 text-primary px-3 py-1 rounded-full text-xs font-bold",children:[je.length," Items"]})]}),i?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading Market..."}):a.jsx(a.Fragment,{children:je.length===0?a.jsxs("div",{className:"text-center py-20 bg-white rounded-[30px] border border-dashed border-gray-200",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-400 text-2xl",children:a.jsx("i",{className:`fas ${l==="selling"?"fa-box-open":"fa-search"}`})}),a.jsx("h3",{className:"font-bold text-gray-500 text-lg",children:l==="selling"?"You haven't listed anything yet.":"No items found."}),l==="selling"&&a.jsx("button",{onClick:()=>{K(),E(!0)},className:"mt-4 text-primary font-bold hover:underline",children:"Start Selling Now"})]}):a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-6",children:je.map(U=>{var be,Q;const xe=e&&e.uid===U.sellerId,re=x.includes(U.id),Ee=U.sellerVerified;return a.jsxs("div",{className:`rounded-2xl md:rounded-[24px] shadow-sm hover:shadow-xl transition-all relative group p-2 md:p-3 border 
                                ${Ee?"bg-gradient-to-br from-white to-yellow-50 border-yellow-400 shadow-yellow-200/50 ring-1 ring-yellow-400/50":"bg-white border-gray-50"}`,children:[a.jsxs("div",{onClick:()=>t(`/product/${U.id}`),className:"cursor-pointer",children:[a.jsxs("div",{className:"h-40 md:h-56 rounded-xl overflow-hidden relative mb-2 md:mb-3",children:[((Q=(be=U.media)==null?void 0:be[0])==null?void 0:Q.type)==="video"?a.jsx("video",{src:U.media[0].url,className:"w-full h-full object-cover"}):a.jsx("img",{src:U.image,alt:U.title,className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-500"}),Ee&&a.jsxs("div",{className:"absolute top-2 left-2 bg-yellow-100/90 backdrop-blur-md px-1.5 py-0.5 rounded-md flex items-center gap-1 shadow-md border border-yellow-500 z-10",children:[a.jsx("i",{className:"fas fa-certificate text-yellow-600 text-[8px] md:text-xs"}),a.jsx("span",{className:"text-[8px] md:text-[10px] font-black text-yellow-800 uppercase tracking-wider",children:"Verified"})]}),U.sold&&a.jsx("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center",children:a.jsx("span",{className:"text-white text-xl md:text-3xl font-black rotate-[-15deg] border-2 md:border-4 border-white px-2 md:px-4 py-1 md:py-2 rounded-lg",children:"SOLD"})}),U.boost&&a.jsx("span",{className:"absolute top-2 right-2 bg-gradient-to-r from-gold to-yellow-400 text-white text-[8px] md:text-[10px] font-black px-1.5 py-0.5 rounded uppercase tracking-wider shadow-sm",children:"Ad"}),a.jsxs("span",{className:"absolute bottom-2 right-2 bg-white/90 backdrop-blur-md text-dark font-black px-2 py-0.5 md:px-3 md:py-1 rounded-lg shadow-sm text-xs md:text-sm",children:[U.currency==="BDT"?"":U.currency," ",Number(U.price).toLocaleString()]})]}),a.jsx("h3",{className:"font-bold text-dark text-sm md:text-lg leading-tight line-clamp-1 mb-1",children:U.title}),a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between text-[10px] md:text-xs text-gray-400 mb-2 md:mb-3 gap-0.5 md:gap-0",children:[a.jsxs("span",{className:"flex items-center gap-1 font-medium truncate",children:[a.jsx("i",{className:"fas fa-map-marker-alt"})," ",U.location]}),a.jsxs("span",{className:"flex items-center gap-1 font-medium text-primary truncate",children:[a.jsx("i",{className:"fas fa-truck"})," ",U.shippingType||"N/A"]})]}),a.jsxs("div",{className:"flex items-center gap-1.5 md:gap-2 text-[10px] md:text-xs font-bold text-gray-600 pt-2 md:pt-3 border-t border-gray-200",children:[U.sellerAvatar&&a.jsx("img",{src:U.sellerAvatar,alt:U.sellerName,className:`w-5 h-5 md:w-6 md:h-6 rounded-full object-cover ${Ee?"border border-yellow-400":""}`}),a.jsxs("span",{className:"flex items-center gap-1 truncate max-w-[80px] md:max-w-none",children:[U.sellerName,Ee&&a.jsx("i",{className:"fas fa-check-circle text-yellow-500 text-[10px] md:text-[12px]",title:"Verified"})]})]})]}),a.jsx("div",{className:"absolute top-3 right-3 z-20",children:xe?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:oe=>{oe.stopPropagation(),q(C===U.id?null:U.id)},className:"menu-trigger w-7 h-7 md:w-8 md:h-8 bg-white/90 backdrop-blur-sm rounded-full flex items-center justify-center text-gray-500 hover:text-dark transition-all shadow-md",children:a.jsx("i",{className:"fas fa-ellipsis-v text-xs"})}),C===U.id&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-40 md:w-48 bg-white rounded-xl shadow-xl border border-gray-100 py-1 text-xs md:text-sm font-medium z-30 animate-fade-in",children:[a.jsxs("button",{onClick:oe=>{oe.stopPropagation(),ne(U)},className:"flex items-center gap-2 w-full px-3 md:px-4 py-2 md:py-3 text-dark hover:bg-gray-50",children:[a.jsx("i",{className:"fas fa-edit text-blue-500 w-3 md:w-4"})," Edit"]}),a.jsxs("button",{onClick:oe=>{oe.stopPropagation(),G(U)},className:"flex items-center gap-2 w-full px-3 md:px-4 py-2 md:py-3 text-dark hover:bg-gray-50",children:[a.jsx("i",{className:`fas ${U.sold?"fa-check-circle text-green-500":"fa-times-circle text-gray-500"} w-3 md:w-4`})," ",U.sold?"Available":"Sold"]}),a.jsxs("button",{onClick:oe=>{oe.stopPropagation(),F(U)},className:"flex items-center gap-2 w-full px-3 md:px-4 py-2 md:py-3 text-red-600 hover:bg-red-50",children:[a.jsx("i",{className:"fas fa-trash-alt w-3 md:w-4"})," Delete"]})]})]}):a.jsx("button",{onClick:oe=>J(oe,U),className:"w-7 h-7 md:w-8 md:h-8 bg-white/80 backdrop-blur-md rounded-full flex items-center justify-center transition-all shadow-sm",children:a.jsx("i",{className:`${re?"fas text-red-500":"far text-gray-500 hover:text-red-500"} fa-heart text-sm`})})})]},U.id)})})}),N&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden max-h-[90vh] overflow-y-auto",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:w?"Edit Listing":"Sell Item"}),a.jsx("button",{onClick:()=>{E(!1),K()},children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark text-xl"})})]}),a.jsxs("form",{onSubmit:se,className:"p-6 space-y-4",children:[a.jsx("input",{required:!0,className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"Product Title",value:j.title,onChange:U=>y({...j,title:U.target.value})}),a.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"Product Address / Pickup Point",value:j.address,onChange:U=>y({...j,address:U.target.value})}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{className:"bg-gray-50 rounded-xl px-2 font-bold text-sm",value:j.currency,onChange:U=>y({...j,currency:U.target.value}),children:[a.jsx("option",{value:"BDT",children:"BDT "}),a.jsx("option",{value:"USD",children:"USD $"}),a.jsx("option",{value:"EUR",children:"EUR "})]}),a.jsx("input",{required:!0,type:"number",min:"0",step:"0.01",className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"Price",value:j.price,onChange:U=>y({...j,price:U.target.value})})]}),a.jsx("input",{className:"bg-gray-50 p-3 rounded-xl font-bold text-sm",placeholder:"City/Area",value:j.location,onChange:U=>y({...j,location:U.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:j.category,onChange:U=>y({...j,category:U.target.value}),children:ue.slice(1).map(U=>a.jsx("option",{value:U,children:U},U))}),a.jsxs("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:j.condition,onChange:U=>y({...j,condition:U.target.value}),children:[a.jsx("option",{children:"New"}),a.jsx("option",{children:"Used"}),a.jsx("option",{children:"Refurbished"}),a.jsx("option",{children:"Fresh"}),a.jsx("option",{children:"Frozen"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:j.shippingType,onChange:U=>y({...j,shippingType:U.target.value}),children:Se.map(U=>a.jsx("option",{value:U,children:U},U))}),a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm",value:j.returnPolicy,onChange:U=>y({...j,returnPolicy:U.target.value}),children:fe.map(U=>a.jsx("option",{value:U,children:U},U))})]}),a.jsx("textarea",{required:!0,rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl text-sm",placeholder:"Detailed product description...",value:j.description,onChange:U=>y({...j,description:U.target.value})}),a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center hover:bg-gray-50 transition-colors cursor-pointer",children:[a.jsxs("label",{className:"cursor-pointer block",children:[a.jsx("i",{className:"fas fa-cloud-upload-alt text-3xl text-gray-300 mb-2"}),a.jsx("p",{className:"text-sm font-bold text-gray-500",children:"Select Photos & Videos (Max 5)"}),a.jsx("input",{type:"file",multiple:!0,accept:"image/*,video/*",className:"hidden",onChange:U=>{const xe=Array.from(U.target.files).slice(0,5-D.length-k.length);S(re=>[...re,...xe])}})]}),a.jsxs("div",{className:"flex gap-2 overflow-x-auto mt-4 pb-2",children:[D.map((U,xe)=>a.jsxs("div",{className:"w-16 h-16 flex-shrink-0 relative rounded-lg overflow-hidden border shadow-sm",children:[U.type==="video"?a.jsx("div",{className:"w-full h-full bg-black flex items-center justify-center text-white",children:a.jsx("i",{className:"fas fa-video"})}):a.jsx("img",{src:U.url,className:"w-full h-full object-cover",alt:"preview"}),a.jsx("button",{type:"button",onClick:()=>P(D.filter((re,Ee)=>Ee!==xe)),className:"absolute top-0 right-0 bg-red-500 text-white w-4 h-4 text-[10px] flex items-center justify-center rounded-full",children:a.jsx("i",{className:"fas fa-times"})})]},"ex"+xe)),k.map((U,xe)=>a.jsxs("div",{className:"w-16 h-16 flex-shrink-0 relative rounded-lg overflow-hidden border shadow-sm",children:[a.jsxs("div",{className:"w-full h-full bg-gray-100 flex flex-col items-center justify-center text-[8px] text-gray-600 break-all p-1",children:[a.jsx("i",{className:`fas ${U.type.startsWith("video")?"fa-video":"fa-image"} text-sm mb-1 text-primary`}),U.name.slice(0,10)+"..."]}),a.jsx("button",{type:"button",onClick:()=>S(k.filter((re,Ee)=>Ee!==xe)),className:"absolute top-0 right-0 bg-red-500 text-white w-4 h-4 text-[10px] flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]},"new"+xe))]})]}),a.jsx("button",{type:"submit",disabled:R,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg",children:R?`${w?"Updating":"Listing"}...`:w?"Save Changes":"Publish Listing"})]})]})})]})},o6=()=>{var je,U,xe;const{id:t}=Nl(),e=tt(),n=Hs(),[s,r]=g.useState(null),[i,o]=g.useState(null),[l,c]=g.useState(null),[u,h]=g.useState(!0),[f,m]=g.useState(null),[x,b]=g.useState(((je=n.state)==null?void 0:je.activeTab)||"details"),[N,E]=g.useState(!1),[w,v]=g.useState([]),[T,I]=g.useState(""),[R,V]=g.useState(5),[j,y]=g.useState(0),[k,S]=g.useState(""),[D,P]=g.useState(""),[C,q]=g.useState(null),ue=async(re,Ee)=>{try{const be=qe(ae(L,"marketplace"),rt("category","==",re),Ur(10)),oe=(await Zt(be)).docs.map(Me=>({id:Me.id,...Me.data()})).filter(Me=>Me.id!==Ee).slice(0,5);v(oe)}catch(be){console.error("Error fetching recommendations:",be)}};g.useEffect(()=>{var re;return(re=n.state)!=null&&re.activeTab&&b(n.state.activeTab),()=>{n.state&&(n.state.activeTab=void 0)}},[n.state]),g.useEffect(()=>{h(!0),m(null);const re=Pt(Ve,async be=>{if(c(be),be)try{const Q=await jt(H(L,"users",be.uid));if(Q.exists()){const oe=Q.data().savedProducts||[];E(oe.includes(t))}}catch(Q){console.error("Error checking saved status:",Q)}else E(!1)});return(async()=>{const be=H(L,"marketplace",t);try{const Q=await jt(be);if(Q.exists()){const oe=Q.data();r({id:Q.id,...oe}),ue(oe.category,Q.id);try{const Me=oe.isBusiness?"business_pages":"users",Ze=await jt(H(L,Me,oe.sellerId));Ze.exists()&&o(Ze.data())}catch(Me){console.error("Error fetching seller details:",Me)}}else m("Product not found.")}catch(Q){console.error("Error fetching product:",Q),m("Failed to load product details.")}finally{h(!1)}})(),()=>re()},[t]);const Se=async(re,Ee)=>{if(!s||!l)return;let be=s.sellerId;if(s.isBusiness)try{const Q=await jt(H(L,"business_pages",s.sellerId));Q.exists()&&Q.data().ownerId&&(be=Q.data().ownerId)}catch(Q){console.error("Failed to find business owner for notification:",Q)}if(be!==l.uid)try{await ze(ae(L,"notifications"),{recipientId:be,senderId:l.uid,senderName:l.displayName,senderAvatar:l.photoURL,type:re,targetId:s.id,message:Ee,businessId:s.isBusiness?s.sellerId:null,timestamp:Ie(),isRead:!1})}catch(Q){console.error("Notification creation failed:",Q)}},fe=()=>{if(!l)return alert("Sign in required to message the seller.");e("/messages",{state:{startChatWith:{uid:s.sellerId,displayName:s.sellerName,photoURL:s.sellerAvatar},productContext:{id:s.id,title:s.title,image:s.image}}})},K=async()=>{if(!l)return alert("Sign in required to save products.");const re=H(L,"users",l.uid);try{N?(await he(re,{savedProducts:kt(s.id)}),E(!1)):(await he(re,{savedProducts:ut(s.id)}),E(!0))}catch(Ee){console.error("Failed to update saved status:",Ee),alert("Could not update saved status. Please try again.")}},se=async()=>{if(!l)return alert("Sign in is required to report a product.");try{await ze(ae(L,"reports"),{targetId:s.id,type:"product",reporter:l.uid,timestamp:Ie()}),alert("Thank you. The product has been successfully reported for review.")}catch(re){console.error("Failed to submit report:",re),alert("Failed to submit report. Please try again.")}},ne=async()=>{if(!T||!l)return;const re={uid:l.uid,name:l.displayName||"Anonymous User",avatar:l.photoURL,text:T,rating:R,date:new Date().toISOString()};try{await he(H(L,"marketplace",t),{reviews:ut(re)}),r(Ee=>({...Ee,reviews:[...Ee.reviews||[],re]})),await Se("review",`reviewed your product "${s.title}"`),I(""),V(5)}catch(Ee){console.error("Review submission error:",Ee),alert("Failed to post review. Please try again.")}},F=async()=>{if(!k||!l)return;const re={id:Date.now(),uid:l.uid,name:l.displayName||"Anonymous User",text:k,date:new Date().toISOString(),answer:null};try{await he(H(L,"marketplace",t),{questions:ut(re)}),r(Ee=>({...Ee,questions:[...Ee.questions||[],re]})),await Se("question",`asked a question on "${s.title}"`),S("")}catch(Ee){console.error("Question submission error:",Ee),alert("Failed to post question. Please try again.")}},G=async re=>{if(!(!D.trim()||!l))try{const Ee=H(L,"marketplace",t),be=await jt(Ee);if(!be.exists())return;const oe=(be.data().questions||[]).find(Ze=>Ze.id===re.id);if(!oe)return;await he(Ee,{questions:kt(oe)});const Me={...oe,answer:D,answerDate:new Date().toISOString(),answererId:l.uid};await he(Ee,{questions:ut(Me)}),r(Ze=>({...Ze,questions:Ze.questions.map(vt=>vt.id===oe.id?Me:vt)})),await Se("answer",`answered a question on your product "${s.title}"`),P(""),q(null)}catch(Ee){console.error("Reply submission error:",Ee),alert("Failed to submit reply. Please try again.")}};if(u)return a.jsx("div",{className:"p-20 text-center text-xl font-bold text-primary",children:"Loading Product Details..."});if(f)return a.jsxs("div",{className:"p-20 text-center text-xl font-bold text-red-600",children:[" ",f]});if(!s)return a.jsx("div",{className:"p-20 text-center text-xl font-bold text-gray-500",children:"Product data unavailable."});const J=l&&l.uid===s.sellerId,we=(i==null?void 0:i.isVerified)||s.sellerVerified;return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("button",{onClick:()=>e("/marketplace"),className:"mb-4 text-gray-500 font-bold flex items-center gap-2 transition hover:text-dark",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back"]}),a.jsxs("div",{className:`bg-white rounded-[30px] shadow-2xl overflow-hidden flex flex-col lg:flex-row ${we?"border-2 border-yellow-400/50 shadow-yellow-100":""}`,children:[a.jsxs("div",{className:"lg:w-1/2 bg-gray-50 p-6 flex items-center justify-center relative",children:[a.jsx("img",{src:s.image,className:"w-full h-96 object-contain rounded-xl shadow-lg",alt:s.title}),we&&a.jsxs("div",{className:"absolute top-4 left-4 bg-white/90 backdrop-blur-md px-3 py-1.5 rounded-full flex items-center gap-2 shadow-md border border-yellow-400/30",children:[a.jsx("i",{className:"fas fa-certificate text-yellow-500"}),a.jsx("span",{className:"text-xs font-bold text-dark",children:"Verified Business"})]})]}),a.jsxs("div",{className:"lg:w-1/2 p-8 flex flex-col",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsx("h1",{className:"text-3xl font-black text-dark",children:s.title}),a.jsxs("h2",{className:"text-3xl font-black text-primary ml-4",children:[s.currency==="BDT"?"":s.currency," ",s.price]})]}),a.jsxs("div",{className:"flex flex-wrap gap-3 text-sm text-gray-500 font-bold mb-6",children:[a.jsxs("span",{className:"bg-gray-100 px-3 py-1 rounded-lg",children:[a.jsx("i",{className:"fas fa-map-marker-alt mr-1"})," ",s.location]}),a.jsxs("span",{className:"bg-gray-100 px-3 py-1 rounded-lg",children:[a.jsx("i",{className:"fas fa-box mr-1"})," Stock: ",s.stock]}),a.jsxs("span",{className:`px-3 py-1 rounded-lg ${s.returnPolicy==="No Return"?"bg-red-50 text-red-500":"bg-green-50 text-green-600"}`,children:[a.jsx("i",{className:"fas fa-undo mr-1"})," ",s.returnPolicy||"N/A"]}),s.condition&&a.jsxs("span",{className:"bg-blue-50 text-blue-600 px-3 py-1 rounded-lg",children:[a.jsx("i",{className:"fas fa-tag mr-1"})," ",s.condition]})]}),a.jsx("div",{className:"flex border-b border-gray-100 mb-6",children:["details","reviews","qa"].map(re=>a.jsx("button",{onClick:()=>b(re),className:`px-6 py-3 font-bold capitalize transition-colors ${x===re?"border-b-2 border-primary text-primary":"text-gray-400 hover:text-dark"}`,children:re==="qa"?"Q&A":re},re))}),a.jsxs("div",{className:"flex-1 overflow-y-auto max-h-60 mb-6 pr-2 custom-scrollbar",children:[x==="details"&&a.jsx("div",{className:"text-gray-600 whitespace-pre-wrap text-sm leading-relaxed",children:s.description}),x==="reviews"&&a.jsxs("div",{className:"space-y-4",children:[((U=s.reviews)==null?void 0:U.length)>0?s.reviews.map((re,Ee)=>a.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl text-sm border border-gray-100",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("span",{className:"font-bold text-dark",children:re.name}),a.jsxs("span",{className:"text-gold flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-star text-yellow-500"})," ",re.rating]})]}),a.jsx("p",{className:"text-gray-600",children:re.text})]},Ee)):a.jsx("div",{className:"text-gray-400 text-center p-4 border border-dashed rounded-lg",children:"Be the first to leave a review!"}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("textarea",{placeholder:l?"Write a review...":"Sign in to write a review.",className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-2 outline-none border border-gray-200 focus:ring-2 focus:ring-primary/50",value:T,onChange:re=>I(re.target.value),disabled:!l}),l?a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("div",{className:"flex gap-1",onMouseLeave:()=>y(0),children:[1,2,3,4,5].map(re=>a.jsx("button",{type:"button",className:"text-2xl transition-transform hover:scale-125 focus:outline-none",onClick:()=>V(re),onMouseEnter:()=>y(re),children:a.jsx("i",{className:`fas fa-star ${re<=(j||R)?"text-yellow-500":"text-gray-300"}`})},re))}),a.jsx("button",{onClick:ne,disabled:!T,className:"bg-dark text-white px-6 py-2 rounded-xl text-xs font-bold hover:bg-primary transition-colors disabled:opacity-50",children:"Post Review"})]}):a.jsx("p",{className:"text-red-500 text-sm font-bold",children:"Sign in to review."})]})]}),x==="qa"&&a.jsxs("div",{className:"space-y-4",children:[((xe=s.questions)==null?void 0:xe.length)>0?s.questions.map((re,Ee)=>a.jsxs("div",{className:"bg-gray-50 p-3 rounded-xl text-sm border border-gray-100",children:[a.jsxs("p",{className:"font-bold text-dark",children:["Q: ",re.text]}),re.answer?a.jsxs("p",{className:"text-primary mt-1 pl-2 border-l-2 border-primary",children:["A: ",re.answer]}):a.jsxs(a.Fragment,{children:[a.jsx("p",{className:"text-xs text-gray-400 italic mt-1",children:"Waiting for seller response..."}),J&&(C==null?void 0:C.id)!==re.id&&a.jsx("button",{onClick:()=>q(re),className:"text-xs text-blue-500 font-bold mt-1 hover:underline",children:"Reply"})]}),J&&(C==null?void 0:C.id)===re.id&&a.jsxs("div",{className:"mt-2 flex gap-2",children:[a.jsx("input",{value:D,onChange:be=>P(be.target.value),placeholder:"Type your answer...",className:"flex-1 bg-white border px-2 py-1 rounded text-xs focus:ring-primary/50 focus:border-primary"}),a.jsx("button",{onClick:()=>G(re),disabled:!D.trim(),className:"bg-primary text-white px-3 py-1 rounded text-xs font-bold hover:bg-primary/90 disabled:opacity-50",children:"Send"}),a.jsx("button",{onClick:()=>q(null),className:"bg-gray-300 text-dark px-3 py-1 rounded text-xs font-bold hover:bg-gray-400",children:"Cancel"})]})]},Ee)):a.jsx("div",{className:"text-gray-400 text-center p-4 border border-dashed rounded-lg",children:"No questions asked yet. Be the first!"}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("input",{placeholder:l?"Ask a question...":"Sign in to ask a question.",className:"w-full bg-gray-50 p-3 rounded-xl text-sm mb-2 outline-none border border-gray-200 focus:ring-2 focus:ring-primary/50",value:k,onChange:re=>S(re.target.value),disabled:!l}),l?a.jsx("button",{onClick:F,disabled:!k,className:"bg-dark text-white px-4 py-2 rounded-lg text-xs font-bold hover:bg-primary transition-colors disabled:opacity-50",children:"Ask"}):a.jsx("p",{className:"text-red-500 text-sm font-bold",children:"Sign in to ask."})]})]})]}),a.jsxs("div",{className:`p-4 rounded-2xl flex items-center justify-between mb-8 border shadow-inner cursor-pointer transition hover:opacity-90 ${we?"bg-gradient-to-r from-yellow-50 to-white border-yellow-400/30":"bg-[#F8FAFD] border-gray-100"}`,onClick:()=>{s.isBusiness?e(`/business/${s.sellerId}`):e(`/profile/${s.sellerId}`)},children:[a.jsxs("div",{className:"flex items-center gap-3",children:[s.sellerAvatar&&!s.sellerAvatar.includes("via.placeholder")&&a.jsx("img",{src:s.sellerAvatar,className:`w-12 h-12 rounded-full object-cover border ${we?"border-yellow-400":"border-gray-200"}`,alt:`${s.sellerName}'s avatar`}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-400 font-bold uppercase",children:"Sold by"}),a.jsxs("h4",{className:"font-bold text-dark flex items-center gap-1",children:[s.sellerName,we&&a.jsx("i",{className:"fas fa-check-circle text-yellow-500 text-sm ml-1",title:"Verified"})]})]})]}),a.jsxs("button",{onClick:se,className:"text-gray-400 hover:text-red-500 text-sm transition-colors",children:[a.jsx("i",{className:"fas fa-flag mr-1"})," Report"]})]}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("button",{onClick:fe,className:"flex-1 bg-dark text-white py-4 rounded-xl font-bold hover:bg-primary transition-all shadow-lg flex items-center justify-center gap-2",children:[a.jsx("i",{className:"fas fa-comment-alt"})," Message Seller"]}),a.jsxs("button",{onClick:K,className:`px-6 py-4 border-2 rounded-xl font-bold transition-all flex items-center gap-2 ${N?"bg-primary border-primary text-white shadow-lg shadow-primary/30":"border-gray-200 text-gray-500 hover:border-primary hover:text-primary"}`,children:[a.jsx("i",{className:`${N?"fas":"far"} fa-heart`})," ",N?"Saved":"Save"]})]})]})]}),a.jsxs("div",{className:"mt-12 border-t pt-8",children:[a.jsxs("h3",{className:"text-2xl font-bold text-dark mb-6",children:["More from ",s.category]}),w.length>0?a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4",children:w.map(re=>a.jsxs("div",{onClick:()=>e(`/product/${re.id}`),className:"bg-white border border-gray-100 p-3 rounded-xl cursor-pointer transition-shadow hover:shadow-lg",children:[a.jsx("img",{src:re.image,className:"w-full h-32 object-cover rounded-lg mb-2",alt:re.title}),a.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:re.title}),a.jsxs("p",{className:"text-primary font-bold text-xs",children:[re.currency==="BDT"?"":re.currency," ",re.price]})]},re.id))}):a.jsx("div",{className:"text-gray-400 p-6 border border-dashed border-gray-300 rounded-xl text-center",children:a.jsx("p",{children:"No other products found in this category."})})]})]})},l6=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState([]),[i,o]=g.useState(!1),[l,c]=g.useState(!1),[u,h]=g.useState(null),[f,m]=g.useState(null),[x,b]=g.useState({name:"",category:"Retail & E-commerce",description:"",email:"",phone:"",website:"",address:""}),N=["Retail & E-commerce","Technology & Software","Professional Services","Food & Beverage","Health & Wellness","Education & Training","Real Estate & Construction","Arts & Entertainment","Automotive","Travel & Hospitality","Manufacturing & Industrial","Fashion & Lifestyle","Legal & Finance","Agriculture","Non-Profit"];g.useEffect(()=>{const w=Pt(Ve,v=>{if(v){n(v);const T=qe(ae(L,"business_pages"),rt("teamIds","array-contains",v.uid)),I=Fe(T,R=>{r(R.docs.map(V=>({id:V.id,...V.data()})))});return()=>I()}else n(null),r([])});return()=>w()},[]);const E=async w=>{if(w.preventDefault(),!e)return alert("Sign in required.");if(!x.name||!u)return alert("Name and Logo are required.");o(!0);try{let v=null,T=null;if(u){const V=sn(rn,`business/${e.uid}/${Date.now()}_logo`);await An(V,u),v=await nn(V)}if(f){const V=sn(rn,`business/${e.uid}/${Date.now()}_cover`);await An(V,f),T=await nn(V)}const I={...x,ownerId:e.uid,teamIds:[e.uid],team:[{uid:e.uid,name:e.displayName,role:"Admin",avatar:e.photoURL}],logo:v,coverImage:T||"https://images.unsplash.com/photo-1497366216548-37526070297c",isVerified:!1,followers:0,rating:0,createdAt:Ie()},R=await ze(ae(L,"business_pages"),I);c(!1),t(`/business/${R.id}`)}catch(v){console.error(v),alert("Failed to create page.")}finally{o(!1)}};return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm min-h-[80vh] overflow-hidden",children:[a.jsxs("div",{className:"h-60 bg-gradient-to-r from-dark to-gray-900 flex items-center justify-between p-10 text-white relative overflow-hidden",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsx("h1",{className:"text-4xl font-black mb-2",children:"Business Hub"}),a.jsx("p",{className:"text-white/70",children:"Manage your empire."})]}),a.jsxs("button",{onClick:()=>c(!0),className:"relative z-10 bg-primary hover:bg-primary-light text-white px-6 py-3 rounded-xl font-bold shadow-lg flex items-center gap-2 transition-all",children:[a.jsx("i",{className:"fas fa-plus-circle"})," Create Page"]})]}),a.jsxs("div",{className:"p-8",children:[a.jsx("h3",{className:"text-xl font-bold text-dark mb-6",children:"Your Businesses"}),s.length===0?a.jsxs("div",{className:"text-center py-20 border-2 border-dashed border-gray-200 rounded-3xl",children:[a.jsx("i",{className:"fas fa-briefcase text-4xl text-gray-300 mb-4"}),a.jsx("p",{className:"text-gray-500 mb-4",children:"You haven't created any business pages yet."}),a.jsx("button",{onClick:()=>c(!0),className:"text-primary font-bold",children:"Create one now"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:s.map(w=>a.jsxs("div",{onClick:()=>t(`/business/${w.id}`),className:"bg-white border border-gray-100 rounded-[24px] overflow-hidden shadow-sm hover:shadow-xl transition-all group cursor-pointer",children:[a.jsxs("div",{className:"h-24 bg-gray-200 relative",children:[a.jsx("img",{src:w.coverImage,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute -bottom-8 left-6 w-16 h-16 rounded-xl bg-white p-1 shadow-md",children:a.jsx("img",{src:w.logo,className:"w-full h-full rounded-lg object-cover"})})]}),a.jsxs("div",{className:"pt-10 p-6",children:[a.jsxs("h3",{className:"font-bold text-dark text-lg mb-1 flex items-center gap-2",children:[w.name," ",w.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold uppercase mb-4",children:w.category}),a.jsx("button",{className:"w-full bg-gray-50 text-dark font-bold py-2 rounded-lg hover:bg-dark hover:text-white transition-colors text-sm",children:"Manage Page"})]})]},w.id))})]})]}),l&&a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-[80] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsx("h3",{className:"font-black text-xl text-dark",children:"Create Business Page"}),a.jsx("button",{onClick:()=>c(!1),children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),a.jsxs("form",{onSubmit:E,className:"p-6 space-y-6 overflow-y-auto",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Business Name"}),a.jsx("input",{required:!0,className:"w-full bg-gray-50 p-3 rounded-xl font-bold outline-none",value:x.name,onChange:w=>b({...x,name:w.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Category"}),a.jsx("select",{className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:x.category,onChange:w=>b({...x,category:w.target.value}),children:N.map(w=>a.jsx("option",{value:w,children:w},w))})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Description"}),a.jsx("textarea",{required:!0,rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:x.description,onChange:w=>b({...x,description:w.target.value})})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Email"}),a.jsx("input",{type:"email",className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:x.email,onChange:w=>b({...x,email:w.target.value})})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Website"}),a.jsx("input",{type:"url",className:"w-full bg-gray-50 p-3 rounded-xl outline-none",value:x.website,onChange:w=>b({...x,website:w.target.value})})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-bold text-gray-500 mb-1",children:"Logo"}),a.jsx("input",{type:"file",required:!0,accept:"image/*",onChange:w=>h(w.target.files[0])})]}),a.jsx("button",{type:"submit",disabled:i,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all",children:i?"Creating...":"Launch Page"})]})]})})]})},po=({src:t,name:e,size:n="md",className:s=""})=>{const r=e?e.split(" ").map(l=>l[0]).join("").substring(0,2).toUpperCase():"??",i={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-14 h-14 text-base",xl:"w-32 h-32 text-4xl"},o=t&&t.includes("via.placeholder.com");return t&&!o?a.jsx("img",{src:t,className:`${i[n]} rounded-full object-cover border border-gray-200 ${s}`,alt:e}):a.jsx("div",{className:`${i[n]} rounded-full bg-gradient-to-tr from-primary to-primary-light text-white flex items-center justify-center font-bold shadow-inner ${s}`,children:r})},c6=()=>{var Gn,Jr,Zr,ws;const{id:t}=Nl(),e=tt(),[n,s]=g.useState(null),[r,i]=g.useState(null),[o,l]=g.useState(!0),[c,u]=g.useState("products"),[h,f]=g.useState(null),[m,x]=g.useState([]),[b,N]=g.useState([]),[E,w]=g.useState([]),[v,T]=g.useState(0),[I,R]=g.useState("All"),[V,j]=g.useState(!1),[y,k]=g.useState(!1),[S,D]=g.useState(null),[P,C]=g.useState(!1),[q,ue]=g.useState({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),[Se,fe]=g.useState([]),[K,se]=g.useState([]),[ne,F]=g.useState(!1),[G,J]=g.useState({}),[we,je]=g.useState({logo:null,cover:null}),[U,xe]=g.useState(!1),[re,Ee]=g.useState(""),[be,Q]=g.useState([]),[oe,Me]=g.useState(null),[Ze,vt]=g.useState("Support"),[Pn,Yt]=g.useState(null),[as,un]=g.useState(!1),Nt=["Food & Beverage","Digital Products","Fashion & Apparel","Electronics & Gadgets","Home & Garden","Handmade & Crafts","Vehicles & Parts","Sports","Books","Baby & Kids","Beauty & Health","Real Estate","Services"],Wn=["Shop Pickup","Free Shipping","Collection Point","Local Delivery"],bs=["No Return","7 Days Return","15 Days Return","30 Days Return"],Z=["New","Used","Like New","Refurbished","For Parts"];g.useEffect(()=>{const O=Pt(Ve,Ue=>{i(Ue),t&&X(t,Ue)}),Le=Ue=>{Ue.target.closest(".menu-trigger")||Ue.target.closest(".search-results")||Yt(null)};return document.addEventListener("click",Le),()=>{O(),document.removeEventListener("click",Le)}},[t]);const X=(O,Le)=>{const Ue=Fe(H(L,"business_pages",O),Hn=>{var os;if(Hn.exists()){const bn=Hn.data();if(s({id:Hn.id,...bn}),J(bn),Le){const gr=(os=bn.team)==null?void 0:os.find(Wt=>Wt.uid===Le.uid);f(gr?gr.role:bn.ownerId===Le.uid?"Admin":null)}l(!1)}}),at=qe(ae(L,"marketplace"),rt("sellerId","==",O)),qt=Fe(at,Hn=>x(Hn.docs.map(os=>({id:os.id,...os.data()})))),Ke=qe(ae(L,"conversations"),rt("participants","array-contains",O)),eo=Fe(Ke,Hn=>{const bn=Hn.docs.map(Wt=>({id:Wt.id,...Wt.data()})).filter(Wt=>Wt.users.some(Vs=>Vs.uid!==O));N(bn);const gr=bn.reduce((Wt,Vs)=>{var Ji;return Wt+(((Ji=Vs.unreadCounts)==null?void 0:Ji[O])||0)},0);T(gr)}),Ks=qe(ae(L,"notifications"),rt("businessId","==",O),_t("timestamp","desc")),pr=Fe(Ks,Hn=>{w(Hn.docs.map(os=>({id:os.id,...os.data()})))});return()=>{Ue(),qt(),eo(),pr()}},z=async O=>{if(Ee(O),Me(null),O.length<2){Q([]);return}const Le=qe(ae(L,"users"),rt("displayName",">=",""),Ur(50)),Ue=await Zt(Le),at=O.toLowerCase(),qt=Ue.docs.map(Ke=>({uid:Ke.id,...Ke.data()})).filter(Ke=>Ke.displayName&&Ke.displayName.toLowerCase().includes(at)||Ke.handle&&Ke.handle.toLowerCase().includes(at)||Ke.email&&Ke.email.toLowerCase().includes(at)).slice(0,5);Q(qt)},pe=async()=>{var O;if(oe){if((O=n.team)!=null&&O.some(Le=>Le.uid===oe.uid)||n.ownerId===oe.uid)return alert("User is already a member or owner.");await ze(ae(L,"notifications"),{recipientId:oe.uid,senderId:r.uid,senderName:n.name,senderAvatar:n.logo,type:"team_invite",pageId:t,pageName:n.name,role:Ze,timestamp:Ie(),isRead:!1}),alert(`Invite sent to ${oe.displayName||oe.email}!`),Me(null),Ee(""),Q([])}},ye=async O=>{await he(H(L,"notifications",O.id),{isRead:!0}),O.targetId&&e(`/product/${O.targetId}`)},ge=async()=>{var Ue;if(!r)return alert("Please sign in.");const O=H(L,"business_pages",t);((Ue=n.followersList)==null?void 0:Ue.includes(r.uid))?await he(O,{followers:(n.followers||1)-1,followersList:kt(r.uid)}):(await he(O,{followers:(n.followers||0)+1,followersList:ut(r.uid)}),n.ownerId!==r.uid&&await ze(ae(L,"notifications"),{recipientId:n.ownerId,senderId:r.uid,senderName:r.displayName,senderAvatar:r.photoURL,type:"follow_business",targetId:t,message:`started following your business ${n.name}`,timestamp:Ie(),isRead:!1}))},Ce=async O=>{try{await he(H(L,"marketplace",O.id),{sold:!O.sold}),Yt(null)}catch(Le){console.error(Le)}},Et=()=>{k(!1),ue({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),fe([]),se([]),j(!0)},Dn=O=>{k(!0),D(O.id),ue({...O});const Le=Array.isArray(O.media)?O.media:O.image?[{url:O.image,type:"image"}]:[];se(Le),fe([]),j(!0),Yt(null)},Ds=async O=>{confirm("Are you sure you want to delete this product?")&&(await is(H(L,"marketplace",O.id)),Yt(null))},Za=async()=>{var O;if(Se.length===0&&K.length===0)return alert("Image required.");C(!0);try{const Le=await Promise.all(Se.map(async qt=>{const Ke=sn(rn,`business/${t}/products/${Date.now()}_${qt.name}`);return await An(Ke,qt),{url:await nn(Ke),type:qt.type.startsWith("video")?"video":"image"}})),Ue=[...K.map(qt=>typeof qt=="string"?{url:qt,type:"image"}:qt),...Le],at={...q,price:Number(q.price),stock:Number(q.stock),media:Ue,image:(O=Ue[0])==null?void 0:O.url,sellerId:t,sellerName:n.name,sellerAvatar:n.logo,sellerVerified:n.isVerified||!1,isBusiness:!0,timestamp:Ie()};y?await he(H(L,"marketplace",S),at):await ze(ae(L,"marketplace"),{...at,boost:null,reviews:[],questions:[],sold:!1}),j(!1)}catch(Le){console.error("Product Save Failed:",Le),alert("Failed to save product. Check console for details.")}finally{C(!1)}},Xi=async()=>{xe(!0);try{let O=n.logo,Le=n.coverImage;if(we.logo){const Ue=sn(rn,`business/${t}/logo_${Date.now()}`);await An(Ue,we.logo),O=await nn(Ue)}if(we.cover){const Ue=sn(rn,`business/${t}/cover_${Date.now()}`);await An(Ue,we.cover),Le=await nn(Ue)}await he(H(L,"business_pages",t),{...G,logo:O,coverImage:Le}),alert("Updated!"),F(!1)}catch(O){console.error(O),alert("Error updating page.")}finally{xe(!1)}},Kr=async O=>{confirm(`Remove ${O.name}?`)&&await he(H(L,"business_pages",t),{team:kt(O),teamIds:kt(O.uid)})};if(o)return a.jsx("div",{className:"p-20 text-center",children:"Loading..."});const Qr=["Admin","Editor"].includes(h),dn=h==="Admin",vn=!!h,Yr=r&&((Gn=n.followersList)==null?void 0:Gn.includes(r.uid)),Xr=m.filter(O=>I==="All"||O.category===I);return a.jsxs("div",{className:"p-0 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:`bg-white md:rounded-[30px] shadow-sm mb-6 relative group overflow-hidden ${n.isVerified?"border-2 border-gold shadow-gold/20":""}`,children:[a.jsxs("div",{className:"h-48 md:h-72 bg-gray-200 relative group",children:[a.jsx("img",{src:n.coverImage,className:"w-full h-full object-cover",alt:"Business cover"}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),dn&&a.jsxs("button",{onClick:()=>F(!0),className:"absolute top-4 right-4 bg-white/20 backdrop-blur-md text-white px-4 py-2 rounded-full text-sm font-bold flex items-center gap-2 transition hover:bg-white/40",children:[a.jsx("i",{className:"fas fa-pen"})," Edit Page"]})]}),a.jsxs("div",{className:"px-6 md:px-10 pb-6 -mt-16 relative z-10 flex flex-col md:flex-row items-end gap-6",children:[a.jsx("div",{className:"w-32 h-32 bg-white rounded-2xl p-1 shadow-xl flex-shrink-0",children:a.jsx("img",{src:n.logo,className:"w-full h-full rounded-xl object-cover",alt:"Business logo"})}),a.jsxs("div",{className:"flex-1 text-center md:text-left mb-2",children:[a.jsxs("h1",{className:"text-3xl font-black text-dark flex items-center justify-center md:justify-start",children:[n.name,n.isVerified&&a.jsx("i",{className:"fas fa-check-circle text-gold text-2xl ml-2",title:"Verified Business"})]}),a.jsxs("p",{className:"text-gray-500 font-bold text-sm",children:[n.category," ",a.jsxs("span",{className:"text-primary mx-2",children:[n.followers||0," Followers"]})]})]}),a.jsx("div",{className:"flex gap-3 mb-2 justify-center w-full md:w-auto",children:vn?a.jsxs(a.Fragment,{children:[dn&&!n.isVerified&&a.jsxs("button",{onClick:()=>un(!0),className:"bg-blue-500 text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-check-circle"})," Verify Page"]}),dn&&a.jsxs("button",{onClick:()=>e("/boost",{state:{targetId:t,targetType:"page",targetName:n.name}}),className:"bg-gold text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-yellow-600 transition",children:[a.jsx("i",{className:"fas fa-rocket mr-2"})," Boost"]}),a.jsxs("button",{onClick:()=>e("/messages",{state:{asBusiness:!0,businessId:t}}),className:"bg-dark text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-gray-700 transition",children:[a.jsx("i",{className:"fas fa-inbox mr-2"})," Inbox"]})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:ge,className:`px-6 py-3 rounded-xl font-bold shadow-lg transition-all ${Yr?"bg-white text-dark border hover:bg-gray-50":"bg-primary text-white hover:bg-primary-dark"}`,children:Yr?"Following":"Follow Shop"}),a.jsx("button",{onClick:()=>e("/messages",{state:{startChatWith:{uid:n.id,displayName:n.name,photoURL:n.logo,isBusiness:!0}}}),className:"bg-gray-100 text-dark px-4 py-3 rounded-xl font-bold hover:bg-gray-200 transition",children:a.jsx("i",{className:"fas fa-comment-alt"})})]})})]}),a.jsxs("div",{className:"flex border-t border-gray-100 px-6 gap-8 overflow-x-auto no-scrollbar mt-4",children:[a.jsx("button",{onClick:()=>u("products"),className:`py-4 font-bold capitalize border-b-4 transition-all ${c==="products"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:"Products"}),vn&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>u("inbox"),className:`py-4 font-bold capitalize border-b-4 transition-all flex items-center gap-2 ${c==="inbox"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Inbox ",v>0&&a.jsx("span",{className:"bg-red-500 text-white text-[10px] px-2 py-0.5 rounded-full",children:v})]}),a.jsxs("button",{onClick:()=>u("notifications"),className:`py-4 font-bold capitalize border-b-4 flex items-center gap-2 ${c==="notifications"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Notifications ",E.length>0&&a.jsx("span",{className:"bg-orange-500 text-white text-[10px] px-2 py-0.5 rounded-full",children:E.length})]}),a.jsx("button",{onClick:()=>u("team"),className:`py-4 font-bold capitalize border-b-4 ${c==="team"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:"Team"}),dn&&a.jsxs("button",{onClick:()=>u("growth"),className:`py-4 font-bold capitalize border-b-4 flex items-center gap-2 ${c==="growth"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:[a.jsx("i",{className:"fas fa-chart-line"})," Growth"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[c==="products"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-50",children:[a.jsx("h3",{className:"font-bold text-xl mb-2 text-dark",children:"About"}),a.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap",children:n.description})]}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[a.jsxs("h3",{className:"font-bold text-xl text-dark",children:["Inventory (",Xr.length,")"]}),a.jsxs("div",{className:"flex gap-3 items-center",children:[a.jsxs("select",{value:I,onChange:O=>R(O.target.value),className:"bg-gray-100 p-3 rounded-xl font-bold text-sm border border-gray-200",children:[a.jsx("option",{value:"All",children:"All"}),Nt.map(O=>a.jsx("option",{value:O,children:O},O))]}),Qr&&a.jsxs("button",{onClick:Et,className:"bg-dark text-white px-4 py-3 rounded-xl font-bold text-sm flex items-center gap-1 hover:bg-primary transition",children:[a.jsx("i",{className:"fas fa-plus"})," Add"]})]})]}),a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:Xr.map(O=>{var Le,Ue;return a.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-sm border border-gray-100 relative group",children:[a.jsxs("div",{onClick:()=>e(`/product/${O.id}`),className:"cursor-pointer",children:[a.jsxs("div",{className:"relative rounded-xl overflow-hidden mb-3 aspect-square",children:[((Ue=(Le=O.media)==null?void 0:Le[0])==null?void 0:Ue.type)==="video"?a.jsx("video",{src:O.media[0].url,className:"w-full h-full object-cover",controls:!0}):a.jsx("img",{src:O.image,className:"w-full h-full object-cover",alt:O.title}),O.sold&&a.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-white font-black text-lg",children:"SOLD OUT"})]}),a.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:O.title}),a.jsxs("p",{className:"text-primary font-black text-sm",children:[O.currency==="BDT"?"":O.currency," ",O.price]})]}),Qr&&a.jsxs("div",{className:"absolute top-3 right-3",children:[a.jsx("button",{onClick:at=>{at.stopPropagation(),Yt(Pn===O.id?null:O.id)},className:"menu-trigger w-8 h-8 bg-white/90 rounded-full flex items-center justify-center shadow-sm text-dark hover:bg-white transition",children:a.jsx("i",{className:"fas fa-ellipsis-v"})}),Pn===O.id&&a.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl z-50 overflow-hidden p-1 border border-gray-100",children:[a.jsx("button",{onClick:()=>Dn(O),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-gray-50 rounded-lg",children:"Edit"}),a.jsxs("button",{onClick:()=>Ce(O),className:`w-full text-left px-3 py-2 text-xs font-bold hover:bg-gray-50 rounded-lg flex items-center gap-2 ${O.sold?"text-green-600":"text-red-600"}`,children:[a.jsx("i",{className:`fas ${O.sold?"fa-check":"fa-times"}`})," ",O.sold?"Mark Available":"Mark Sold"]}),a.jsx("button",{onClick:()=>Ds(O),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-red-50 text-red-500 rounded-lg",children:"Delete"}),a.jsxs("button",{onClick:()=>e("/boost",{state:{targetId:O.id,targetType:"product",targetName:O.title}}),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-yellow-50 text-gold rounded-lg flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-rocket"})," Boost Product"]})]})]})]},O.id)})}),Xr.length===0&&a.jsx("div",{className:"p-10 text-center text-gray-400 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:a.jsxs("p",{className:"font-bold",children:["No products found in ",I==="All"?"inventory":I,"."]})})]}),c==="inbox"&&vn&&a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[a.jsxs("h3",{className:"text-lg font-bold mb-4 border-b pb-2 flex justify-between",children:["Business Inbox ",v>0&&a.jsxs("span",{className:"text-red-500 text-xs flex items-center gap-1",children:[a.jsx("i",{className:"fas fa-envelope"})," ",v," new"]})]}),b.length===0?a.jsx("p",{className:"text-gray-400",children:"No messages yet."}):a.jsx("div",{className:"space-y-3",children:b.map(O=>{var at,qt;const Le=O.users.find(Ke=>Ke.uid!==n.id)||{displayName:"Customer",photoURL:null},Ue=((at=O.unreadCounts)==null?void 0:at[n.id])>0;return a.jsxs("div",{onClick:()=>e("/messages",{state:{activeConversationId:O.id,asBusiness:!0,businessId:t,businessName:n.name}}),className:`flex justify-between items-center p-4 rounded-2xl cursor-pointer border transition-all ${Ue?"bg-gradient-to-r from-[#E0F2F1] to-white border-primary/30 shadow-sm scale-[1.01]":"bg-white hover:bg-gray-50 border-gray-100"}`,children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(po,{src:Le.photoURL,name:Le.displayName,size:"md"}),a.jsxs("div",{children:[a.jsx("h4",{className:`text-sm ${Ue?"font-black":"font-bold"}`,children:Le.displayName}),a.jsx("p",{className:`text-xs truncate w-48 ${Ue?"font-bold text-dark":"text-gray-500"}`,children:O.lastMessage})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("span",{className:"text-[10px] text-gray-400 block",children:(qt=O.updatedAt)!=null&&qt.seconds?new Date(O.updatedAt.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}),Ue&&a.jsx("span",{className:"inline-block bg-primary text-white text-[10px] font-bold px-2.5 py-0.5 rounded-full mt-1",children:"New"})]})]},O.id)})})]}),c==="notifications"&&vn&&a.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"text-lg font-bold mb-4 text-dark",children:"Page Activity (Reviews & Questions)"}),E.length===0?a.jsx("div",{className:"text-center py-10 text-gray-400",children:"No new activity."}):a.jsx("div",{className:"space-y-3",children:E.map(O=>{var Ue;const Le=m.find(at=>at.id===O.targetId);return a.jsxs("div",{onClick:()=>ye(O),className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-colors border border-gray-100",children:[a.jsx(po,{src:O.senderAvatar,name:O.senderName}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"text-sm text-gray-800 leading-tight",children:[a.jsx("span",{className:"font-bold",children:O.senderName}),O.type==="review"&&" wrote a review on ",O.type==="question"&&" asked a question about ",a.jsx("span",{className:"text-primary font-bold",children:(Le==null?void 0:Le.title)||"a product"}),":"]}),a.jsxs("p",{className:"text-gray-600 italic text-sm mt-1",children:['"',O.message,'"']}),a.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(Ue=O.timestamp)!=null&&Ue.seconds?new Date(O.timestamp.seconds*1e3).toLocaleString():"Just now"})]}),a.jsxs("button",{className:"bg-primary text-white px-3 py-1 rounded-lg text-xs font-bold hover:bg-primary-dark transition-all flex-shrink-0",onClick:at=>{at.stopPropagation(),ye(O)},children:[a.jsx("i",{className:"fas fa-reply mr-1"})," View/Reply"]})]},O.id)})})]}),c==="team"&&vn&&a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"font-bold text-xl text-dark mb-6",children:"Team"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-50 rounded-2xl border border-yellow-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(po,{src:n.logo,name:n.name,size:"md"}),a.jsxs("div",{children:[a.jsxs("p",{className:"font-bold",children:[n.name," (Owner)"]}),a.jsx("p",{className:"text-xs text-gray-500",children:n.email||"N/A"})]})]}),a.jsx("div",{className:"flex items-center gap-3",children:a.jsx("span",{className:"text-primary font-bold text-sm ml-2",children:"Admin/Owner"})})]},n.ownerId),(Jr=n.team)==null?void 0:Jr.filter(O=>O.uid!==n.ownerId).map(O=>a.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-2xl border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(po,{src:O.avatar,name:O.name,size:"md"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:O.name}),a.jsx("p",{className:"text-xs text-gray-500",children:O.email})]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("span",{className:`text-xs font-bold px-3 py-1 rounded-full ${O.role==="Admin"?"bg-red-100 text-red-700":O.role==="Editor"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:O.role}),dn&&a.jsx("button",{onClick:()=>Kr(O),className:"text-red-500 hover:bg-red-50 p-2 rounded-full transition",children:a.jsx("i",{className:"fas fa-trash"})})]})]},O.uid)),((Zr=n.team)==null?void 0:Zr.filter(O=>O.uid!==n.ownerId).length)===0&&n.ownerId&&a.jsx("p",{className:"text-gray-400 text-center py-4",children:"No team members yet (only owner listed)."})]}),dn&&a.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[a.jsx("h4",{className:"font-bold text-dark mb-4",children:"Invite New Member"}),a.jsxs("div",{className:"relative mb-3",children:[a.jsx("input",{placeholder:"Search (Name, @handle, Email)...",value:re,onChange:O=>z(O.target.value),className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm border border-gray-200 focus:border-primary focus:ring-primary"}),be.length>0&&!oe&&a.jsx("div",{className:"search-results absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-xl shadow-lg z-30 max-h-40 overflow-y-auto p-2",children:be.map(O=>a.jsxs("div",{onClick:()=>{Me(O),Ee(O.displayName||O.email),Q([])},className:"p-2 hover:bg-gray-50 rounded-lg cursor-pointer flex items-center gap-3",children:[a.jsx(po,{src:O.photoURL,name:O.displayName,size:"sm"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-bold text-sm",children:O.displayName}),a.jsx("p",{className:"text-xs text-gray-400",children:O.email})]})]},O.uid))})]}),a.jsxs("div",{className:"flex gap-3 items-center",children:[a.jsxs("select",{value:Ze,onChange:O=>vt(O.target.value),className:"bg-gray-50 p-3 rounded-xl font-bold text-sm border border-gray-200 flex-1",children:[a.jsx("option",{value:"Support",children:"Support"}),a.jsx("option",{value:"Editor",children:"Editor"}),a.jsx("option",{value:"Viewer",children:"Viewer"})]}),a.jsx("button",{onClick:pe,disabled:!oe,className:"bg-dark text-white px-6 py-3 rounded-xl font-bold hover:bg-primary transition disabled:opacity-50",children:"Send Invite"})]}),oe&&a.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-3 rounded-xl border border-green-100 mt-3 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(po,{src:oe.photoURL,name:oe.displayName,size:"sm"}),a.jsxs("span",{className:"font-bold text-green-800",children:["Selected: ",oe.displayName||oe.email]})]}),a.jsxs("button",{onClick:()=>Me(null),className:"text-red-500 hover:text-red-700",children:[a.jsx("i",{className:"fas fa-times"})," Clear"]})]})]})]}),c==="growth"&&dn&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Followers"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:n.followers||0})]}),a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Leads"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:b.length})]}),a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Inventory"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:m.length})]}),a.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Rating"}),a.jsx("div",{className:"text-2xl font-black text-dark",children:((ws=n.rating)==null?void 0:ws.toFixed(1))||"N/A"})]})]}),a.jsxs("div",{className:"bg-gradient-to-br from-dark to-gray-900 p-6 rounded-[24px] text-white shadow-lg",children:[a.jsx("h3",{className:"font-bold text-lg mb-2",children:"Boost Sales"}),a.jsx("p",{className:"text-sm mb-4 text-gray-300",children:"Promote your business page to reach thousands of potential customers in your area."}),a.jsxs("button",{onClick:()=>e("/boost",{state:{targetId:t,targetType:"page",targetName:n.name}}),className:"w-full bg-white text-dark font-bold py-3 rounded-xl hover:bg-gold transition-colors",children:[a.jsx("i",{className:"fas fa-rocket mr-2"})," Promote Page"]})]})]})]}),a.jsx("div",{className:"space-y-6",children:a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-50",children:[a.jsx("h3",{className:"font-bold text-dark mb-4 border-b border-gray-100 pb-2",children:"Contact & Info"}),a.jsxs("div",{className:"space-y-4 text-sm",children:[n.address&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-map-pin mr-2 text-gray-400"})," ",n.address]}),n.email&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-envelope mr-2 text-gray-400"})," ",n.email]}),n.phone&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-phone mr-2 text-gray-400"})," ",n.phone]}),n.website&&a.jsxs("p",{children:[a.jsx("i",{className:"fas fa-globe mr-2 text-gray-400"})," ",a.jsx("a",{href:n.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:n.website})]})]})]})})]}),ne&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[30px] flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b flex justify-between",children:[a.jsx("h3",{className:"font-bold text-xl",children:"Edit Page Info"}),a.jsx("button",{onClick:()=>F(!1),className:"text-gray-500 hover:text-red-500 text-2xl",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("label",{className:"block",children:["Logo ",a.jsx("input",{type:"file",onChange:O=>je({...we,logo:O.target.files[0]}),className:"block w-full text-sm text-gray-500"})]}),a.jsxs("label",{className:"block",children:["Cover ",a.jsx("input",{type:"file",onChange:O=>je({...we,cover:O.target.files[0]}),className:"block w-full text-sm text-gray-500"})]})]}),a.jsx("input",{value:G.name||"",onChange:O=>J({...G,name:O.target.value}),placeholder:"Name",className:"w-full border p-3 rounded-xl"}),a.jsx("textarea",{value:G.description||"",onChange:O=>J({...G,description:O.target.value}),placeholder:"Description",className:"w-full border p-3 rounded-xl h-24"}),a.jsx("input",{value:G.address||"",onChange:O=>J({...G,address:O.target.value}),placeholder:"Address",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:G.website||"",onChange:O=>J({...G,website:O.target.value}),placeholder:"Website",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:G.email||"",onChange:O=>J({...G,email:O.target.value}),placeholder:"Email",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:G.phone||"",onChange:O=>J({...G,phone:O.target.value}),placeholder:"Phone",className:"w-full border p-3 rounded-xl"})]}),a.jsx("div",{className:"p-6 border-t",children:a.jsx("button",{onClick:Xi,disabled:U,className:"w-full bg-primary text-white p-3 rounded-xl font-bold hover:bg-primary-dark transition disabled:opacity-50",children:U?a.jsx("i",{className:"fas fa-spinner fa-spin"}):"Save Changes"})})]})}),V&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:a.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] p-6 max-h-[90vh] overflow-y-auto",children:[a.jsx("h3",{className:"font-bold text-xl mb-4",children:y?"Edit Product":"Add Product"}),a.jsx("input",{value:q.title,onChange:O=>ue({...q,title:O.target.value}),placeholder:"Title",className:"w-full border p-3 rounded-xl mb-2"}),a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-2",children:[a.jsx("input",{value:q.price,onChange:O=>ue({...q,price:O.target.value}),placeholder:"Price",type:"number",className:"w-full border p-3 rounded-xl"}),a.jsx("input",{value:q.stock,onChange:O=>ue({...q,stock:O.target.value}),placeholder:"Stock",type:"number",className:"w-full border p-3 rounded-xl"}),a.jsxs("select",{value:q.currency,onChange:O=>ue({...q,currency:O.target.value}),className:"w-full border p-3 rounded-xl",children:[a.jsx("option",{value:"BDT",children:"BDT"}),a.jsx("option",{value:"USD",children:"USD"})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[a.jsx("select",{value:q.category,onChange:O=>ue({...q,category:O.target.value}),className:"w-full border p-3 rounded-xl",children:Nt.map(O=>a.jsx("option",{value:O,children:O},O))}),a.jsx("select",{value:q.condition,onChange:O=>ue({...q,condition:O.target.value}),className:"w-full border p-3 rounded-xl",children:Z.map(O=>a.jsx("option",{value:O,children:O},O))})]}),a.jsx("input",{value:q.location,onChange:O=>ue({...q,location:O.target.value}),placeholder:"City/Location",className:"w-full border p-3 rounded-xl mb-2"}),a.jsx("input",{value:q.address,onChange:O=>ue({...q,address:O.target.value}),placeholder:"Full Address / Pickup Point",className:"w-full border p-3 rounded-xl mb-2"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[a.jsx("select",{value:q.shippingType,onChange:O=>ue({...q,shippingType:O.target.value}),className:"w-full border p-3 rounded-xl",children:Wn.map(O=>a.jsx("option",{children:O},O))}),a.jsx("select",{value:q.returnPolicy,onChange:O=>ue({...q,returnPolicy:O.target.value}),className:"w-full border p-3 rounded-xl",children:bs.map(O=>a.jsx("option",{children:O},O))})]}),a.jsx("textarea",{value:q.description,onChange:O=>ue({...q,description:O.target.value}),placeholder:"Description",className:"w-full border p-3 rounded-xl h-24 mb-2"}),a.jsxs("label",{className:"block mb-4",children:["Media (Images/Videos) ",a.jsx("input",{type:"file",multiple:!0,onChange:O=>fe([...Se,...Array.from(O.target.files)]),className:"block w-full text-sm text-gray-500"})]}),a.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:[...K,...Se.map(O=>({url:URL.createObjectURL(O),file:O,isNew:!0}))].map((O,Le)=>a.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border border-gray-300",children:[O.type==="video"?a.jsx("video",{src:O.url,className:"w-full h-full object-cover"}):a.jsx("img",{src:O.url,className:"w-full h-full object-cover",alt:"product media"}),a.jsx("button",{onClick:()=>{O.isNew?fe(Se.filter(Ue=>Ue!==O.file)):se(K.filter((Ue,at)=>at!==Le))},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-4 h-4 text-[8px] flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]},Le))}),a.jsx("button",{onClick:Za,disabled:P,className:"w-full bg-primary text-white p-3 rounded-xl font-bold hover:bg-primary-dark transition disabled:opacity-50",children:P?a.jsx("i",{className:"fas fa-spinner fa-spin"}):y?"Update Product":"Publish Product"}),a.jsx("button",{onClick:()=>j(!1),className:"w-full mt-2 text-gray-500 p-2 rounded-xl border border-gray-200 hover:bg-gray-50 transition",children:"Cancel"})]})}),as&&a.jsx(ZI,{onClose:()=>un(!1),target:{id:n.id,type:"business",name:n.name}})]})},u6=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState(!0),[i,o]=g.useState("posts"),[l,c]=g.useState([]),[u,h]=g.useState([]);g.useEffect(()=>{const x=Pt(Ve,async b=>{n(b),b?await f(b.uid):r(!1)});return()=>x()},[]);const f=async x=>{try{const b=await jt(H(L,"users",x));if(b.exists()){const N=b.data(),E=N.savedPosts||[],w=N.savedProducts||[];if(E.length>0){const v=E.map(I=>jt(H(L,"posts",I))),T=await Promise.all(v);c(T.filter(I=>I.exists()).map(I=>({id:I.id,...I.data()})))}else c([]);if(w.length>0){const v=w.map(I=>jt(H(L,"marketplace",I))),T=await Promise.all(v);h(T.filter(I=>I.exists()).map(I=>({id:I.id,...I.data()})))}else h([])}}catch(b){console.error("Error fetching saved items:",b)}finally{r(!1)}},m=async(x,b,N)=>{if(x.stopPropagation(),!!confirm("Remove from saved?"))try{const E=b==="posts"?"savedPosts":"savedProducts";await he(H(L,"users",e.uid),{[E]:kt(N)}),b==="posts"?c(w=>w.filter(v=>v.id!==N)):h(w=>w.filter(v=>v.id!==N))}catch(E){console.error("Error unsaving:",E)}};return s?a.jsx("div",{className:"p-10 text-center text-gray-400",children:"Loading saved items..."}):a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[a.jsx("button",{onClick:()=>t(-1),className:"md:hidden w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-dark",children:a.jsx("i",{className:"fas fa-arrow-left"})}),a.jsx("h1",{className:"text-2xl font-black text-dark",children:"Saved Collection"})]}),a.jsxs("div",{className:"flex bg-white rounded-2xl p-1 shadow-sm border border-gray-100 mb-6 max-w-md",children:[a.jsx("button",{onClick:()=>o("posts"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${i==="posts"?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:"Posts & Videos"}),a.jsx("button",{onClick:()=>o("products"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${i==="products"?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:"Products"})]}),a.jsxs("div",{className:"space-y-4",children:[i==="posts"&&(l.length===0?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"No saved posts yet."}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:l.map(x=>a.jsxs("div",{onClick:()=>t(`/post/${x.id}`),className:"bg-white rounded-[20px] p-3 shadow-sm border border-gray-50 cursor-pointer group hover:shadow-md transition-all",children:[x.mediaURL?a.jsxs("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-100 relative mb-3",children:[x.mediaType==="video"?a.jsx("video",{src:x.mediaURL,className:"w-full h-full object-cover"}):a.jsx("img",{src:x.mediaURL,className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute top-2 right-2",children:a.jsx("button",{onClick:b=>m(b,"posts",x.id),className:"w-8 h-8 bg-white/90 rounded-full flex items-center justify-center text-red-500 shadow-sm hover:bg-red-50",children:a.jsx("i",{className:"fas fa-trash text-xs"})})}),x.mediaType==="video"&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsx("i",{className:"fas fa-play text-white text-3xl drop-shadow-lg"})})]}):a.jsxs("div",{className:"aspect-square rounded-xl bg-gray-50 p-4 flex items-center justify-center text-center text-xs text-gray-500 relative mb-3",children:['"',x.text.slice(0,100),'..."',a.jsx("button",{onClick:b=>m(b,"posts",x.id),className:"absolute top-2 right-2 w-8 h-8 bg-white rounded-full flex items-center justify-center text-red-500 shadow-sm",children:a.jsx("i",{className:"fas fa-trash text-xs"})})]}),a.jsx("h4",{className:"font-bold text-sm text-dark truncate px-1",children:x.userName}),a.jsx("p",{className:"text-xs text-gray-400 px-1 truncate",children:x.text})]},x.id))})),i==="products"&&(u.length===0?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"No saved products yet."}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:u.map(x=>a.jsxs("div",{onClick:()=>t(`/product/${x.id}`),className:"bg-white rounded-[20px] p-3 shadow-sm border border-gray-50 cursor-pointer group hover:shadow-md transition-all",children:[a.jsxs("div",{className:"aspect-square rounded-xl overflow-hidden bg-gray-100 relative mb-3",children:[a.jsx("img",{src:x.image,className:"w-full h-full object-cover",alt:x.title}),a.jsx("button",{onClick:b=>m(b,"marketplace",x.id),className:"absolute top-2 right-2 w-8 h-8 bg-white/90 rounded-full flex items-center justify-center text-red-500 shadow-sm hover:bg-red-50",children:a.jsx("i",{className:"fas fa-trash text-xs"})})]}),a.jsx("h4",{className:"font-bold text-sm text-dark truncate px-1",children:x.title}),a.jsxs("p",{className:"text-primary font-black text-xs px-1",children:[x.currency," ",x.price]})]},x.id))}))]})]})},fx=({uid:t,size:e="md",className:n=""})=>{const[s,r]=g.useState(null);g.useEffect(()=>{jt(H(L,"users",t)).then(l=>{l.exists()?r(l.data()):r({displayName:"User",photoURL:null,isVerified:!1})})},[t]);const i={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-12 h-12 text-base",xl:"w-16 h-16 text-xl"},o=(s==null?void 0:s.photoURL)||`https://ui-avatars.com/api/?name=${(s==null?void 0:s.displayName)||"User"}&background=random`;return s?a.jsxs("div",{className:"relative inline-block",children:[a.jsx("img",{src:o,className:`${i[e]} rounded-full object-cover border border-gray-200 ${n}`,alt:"avatar"}),s.isVerified&&a.jsx("div",{className:"absolute -bottom-1 -right-1 bg-blue-500 text-white text-[8px] w-3 h-3 flex items-center justify-center rounded-full border border-white",children:a.jsx("i",{className:"fas fa-check"})})]}):a.jsx("div",{className:`${i[e]} bg-gray-200 rounded-full animate-pulse ${n}`})},SN=({postId:t,user:e,isDesktop:n})=>{const[s,r]=g.useState([]),[i,o]=g.useState(""),[l,c]=g.useState(null),u=g.useRef(null);g.useEffect(()=>{e?jt(H(L,"users",e.uid)).then(m=>m.exists()&&c(m.data())):c(null)},[e]),g.useEffect(()=>{if(t)return Fe(qe(ae(L,"posts",t,"comments"),_t("timestamp","asc")),m=>r(m.docs.map(x=>({id:x.id,...x.data()}))))},[t]),g.useEffect(()=>{u.current&&(u.current.scrollTop=u.current.scrollHeight)},[s]);const h=async()=>{!i.trim()||!e||(await ze(ae(L,"posts",t,"comments"),{text:i,uid:e.uid,userName:e.displayName,userAvatar:e.photoURL,isVerified:(l==null?void 0:l.isVerified)||!1,timestamp:Ie()}),await he(H(L,"posts",t),{comments:pt(1)}),o(""))},f=m=>window.dispatchEvent(new CustomEvent("toggle-nav",{detail:{visible:m}}));return a.jsxs("div",{className:`flex flex-col h-full ${n?"bg-white":""}`,children:[a.jsxs("div",{ref:u,className:"flex-1 overflow-y-auto p-4 space-y-3 custom-scrollbar pb-2",children:[s.length===0&&a.jsx("p",{className:"text-center text-gray-400 text-sm mt-10",children:"No comments yet."}),s.map(m=>a.jsxs("div",{className:"flex gap-3 items-start",children:[a.jsx(fx,{uid:m.uid,size:"sm"}),a.jsxs("div",{className:"bg-gray-50 p-2 px-3 rounded-2xl rounded-tl-none",children:[a.jsx("p",{className:"text-xs font-bold text-dark flex items-center gap-1",children:m.userName}),a.jsx("p",{className:"text-sm text-gray-700",children:m.text})]})]},m.id))]}),a.jsx("div",{className:`p-4 border-t border-gray-100 bg-white absolute bottom-0 w-full ${n?"":"pb-16"}`,children:a.jsxs("div",{className:"flex gap-2 items-center",children:[a.jsx("input",{value:i,onChange:m=>o(m.target.value),placeholder:"Add a comment...",className:"flex-1 bg-gray-100 border-none rounded-full px-5 py-3 text-sm outline-none focus:ring-2 focus:ring-primary/50",onKeyDown:m=>m.key==="Enter"&&h(),onFocus:()=>f(!1),onBlur:()=>setTimeout(()=>f(!0),200)}),a.jsx("button",{onClick:h,className:"text-primary font-bold text-sm px-2",children:"Post"})]})})]})},d6=()=>{var se,ne;const t=tt(),e=Hs(),[n,s]=g.useState(null),[r,i]=g.useState([]),[o,l]=g.useState(!0),[c,u]=g.useState(0),[h,f]=g.useState(null),[m,x]=g.useState(!1),[b,N]=g.useState(window.innerWidth>1024),[E,w]=g.useState(null),[v,T]=g.useState("For You"),[I,R]=g.useState(!1),[V,j]=g.useState(""),[y,k]=g.useState(!1),S=g.useRef(null),D=["For You","Trending","Music","Gaming","Comedy","Tech","Sports","Food","Dance"];g.useEffect(()=>{const F=()=>N(window.innerWidth>1024);return window.addEventListener("resize",F),()=>window.removeEventListener("resize",F)},[]),g.useEffect(()=>{const F=Pt(Ve,we=>s(we)),G=qe(ae(L,"posts"),rt("mediaType","==","video"),_t("timestamp","desc"),Ur(50)),J=Fe(G,we=>{const je=we.docs.map(U=>({id:U.id,...U.data()}));i(je),l(!1)});return()=>{F(),J()}},[]),g.useEffect(()=>{var F;if(r.length>0&&((F=e.state)!=null&&F.startVideoId)){const G=e.state.startVideoId,J=r.findIndex(we=>we.id===G);J!==-1&&(u(J),setTimeout(()=>{S.current&&S.current.scrollTo({top:J*window.innerHeight,behavior:"instant"})},100))}},[r,e.state]);const C=(()=>{let F=[...r];return V?F=F.filter(G=>{var J,we;return((J=G.text)==null?void 0:J.toLowerCase().includes(V.toLowerCase()))||((we=G.userName)==null?void 0:we.toLowerCase().includes(V.toLowerCase()))}):v==="Trending"?F.sort((G,J)=>(J.likes||0)-(G.likes||0)):v!=="For You"&&(F=F.filter(G=>{var J;return G.category===v||((J=G.text)==null?void 0:J.toLowerCase().includes(`#${v.toLowerCase()}`))})),F})();g.useEffect(()=>{if(b||C.length===0)return;const F=()=>{if(!S.current)return;const J=Math.round(S.current.scrollTop/window.innerHeight);J!==c&&J<C.length&&u(J)},G=S.current;return G.addEventListener("scroll",F),()=>G.removeEventListener("scroll",F)},[C,b,c]);const q=async F=>{var we;if(!n)return alert("Sign in");const G=F||E,J=H(L,"posts",G.id);(we=G.likedBy)!=null&&we.includes(n.uid)?await he(J,{likes:pt(-1),likedBy:kt(n.uid)}):await he(J,{likes:pt(1),likedBy:ut(n.uid)})},ue=async F=>{const G=`${window.location.origin}/post/${F.id}`;if(navigator.share)try{await navigator.share({title:"Tukumi Watch",text:F.text,url:G})}catch{}else navigator.clipboard.writeText(G),alert("Link copied!")},Se=F=>{w(F),x(!1)},fe=()=>{w(null)},K=({video:F,isActive:G})=>{var Ee;const J=g.useRef(null),[we,je]=g.useState(0);g.useEffect(()=>{G?J.current&&(J.current.currentTime=0,J.current.play().catch(()=>{})):J.current&&J.current.pause()},[G]);const U=(Ee=F.likedBy)==null?void 0:Ee.includes(n==null?void 0:n.uid),xe=()=>{if(J.current){const be=J.current.currentTime/J.current.duration*100;je(isNaN(be)?0:be)}},re=be=>{if(J.current){const Q=be.target.value/100*J.current.duration;J.current.currentTime=Q,je(be.target.value)}};return a.jsx("div",{className:"snap-start h-[100vh] w-full relative flex items-center justify-center bg-black overflow-hidden shrink-0 py-20 px-0",children:a.jsxs("div",{className:"w-full h-full relative md:rounded-[35px] overflow-hidden shadow-2xl border-y md:border border-white/10 bg-gray-900",children:[a.jsx("video",{ref:J,src:F.mediaURL,className:"w-full h-full object-contain bg-black",loop:!0,playsInline:!0,onClick:be=>be.target.paused?be.target.play():be.target.pause(),onTimeUpdate:xe}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-b from-black/10 via-transparent to-black/60 pointer-events-none"}),a.jsxs("div",{className:"absolute right-3 bottom-24 flex flex-col gap-6 items-center z-20 pointer-events-auto",children:[a.jsx("div",{className:"relative",onClick:()=>t(`/profile/${F.uid}`),children:a.jsx(fx,{uid:F.uid,size:"md",className:"border-2 border-white shadow-md"})}),a.jsxs("button",{onClick:()=>q(F),className:"flex flex-col items-center gap-1",children:[a.jsx("div",{className:`w-12 h-12 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-2xl transition-all ${U?"text-primary":"text-white"}`,children:a.jsx("i",{className:`${U?"fas":"far"} fa-heart drop-shadow-md`})}),a.jsx("span",{className:"text-white text-[10px] font-bold drop-shadow-md",children:F.likes})]}),a.jsxs("button",{onClick:()=>f(F.id),className:"flex flex-col items-center gap-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-white text-2xl",children:a.jsx("i",{className:"fas fa-comment-dots drop-shadow-md"})}),a.jsx("span",{className:"text-white text-[10px] font-bold drop-shadow-md",children:F.comments})]}),a.jsxs("button",{onClick:()=>ue(F),className:"flex flex-col items-center gap-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-white text-2xl",children:a.jsx("i",{className:"fas fa-share drop-shadow-md"})}),a.jsx("span",{className:"text-white text-[10px] font-bold drop-shadow-md",children:"Share"})]})]}),a.jsxs("div",{className:"absolute bottom-8 left-5 right-20 z-10 text-left text-white pointer-events-auto",children:[a.jsxs("h3",{className:"font-black text-xl shadow-black drop-shadow-md mb-1 cursor-pointer",onClick:()=>t(`/profile/${F.uid}`),children:["@",F.userName]}),a.jsx("p",{className:"text-sm opacity-95 line-clamp-2 font-medium leading-relaxed text-shadow",children:F.text}),a.jsxs("div",{className:"flex items-center gap-2 mt-2 opacity-80 pointer-events-none",children:[a.jsx("i",{className:"fas fa-music text-xs"}),a.jsxs("p",{className:"text-xs font-bold",children:[v,"  Tukumi"]})]})]}),a.jsx("div",{className:"absolute bottom-0 left-0 w-full z-40 px-0 pb-0",onClick:be=>be.stopPropagation(),children:a.jsx("input",{type:"range",min:"0",max:"100",value:we,onChange:re,className:"w-full h-1 bg-white/30 appearance-none cursor-pointer accent-primary hover:h-2 transition-all",style:{background:`linear-gradient(to right, #008080 ${we}%, rgba(255,255,255,0.3) ${we}%)`}})})]})})};return b?a.jsxs("div",{className:"min-h-screen bg-[#f0f4f8] p-8 pl-10",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsxs("h1",{className:"text-3xl font-black text-dark flex items-center gap-3",children:[a.jsx("div",{className:"w-10 h-10 bg-gradient-to-tr from-primary to-gold rounded-xl flex items-center justify-center text-white",children:a.jsx("i",{className:"fas fa-play"})}),"Tukumi Watch"]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>k(!y),className:"w-10 h-10 rounded-full bg-white flex items-center justify-center text-gray-500 hover:text-dark transition-all shadow-md",children:a.jsx("i",{className:"fas fa-search"})}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>R(!I),className:"w-10 h-10 rounded-full bg-white flex items-center justify-center text-gray-500 hover:text-dark transition-all shadow-md",children:a.jsx("i",{className:"fas fa-sliders-h"})}),I&&a.jsx("div",{className:"absolute right-0 top-full mt-2 bg-white rounded-2xl p-2 shadow-2xl border border-gray-100 flex flex-col gap-1 w-40 animate-scale-in text-dark origin-top-right z-10",children:D.map(F=>a.jsx("button",{onClick:()=>{T(F),R(!1)},className:`text-left px-3 py-2 rounded-xl text-sm font-bold transition-all ${v===F?"bg-primary text-white":"hover:bg-gray-100 text-dark"}`,children:F},F))})]})]})]}),y&&a.jsx("div",{className:"mb-6 animate-fade-in",children:a.jsx("input",{type:"text",value:V,onChange:F=>j(F.target.value),placeholder:"Search videos by caption or user name...",className:"w-full bg-white border border-gray-200 rounded-xl px-5 py-3 text-lg outline-none focus:ring-2 focus:ring-primary/20 transition-all shadow-sm"})}),o?a.jsx("div",{className:"flex h-[300px] items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-4 border-gray-300 border-t-primary rounded-full animate-spin"})}):a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:[C.map(F=>a.jsx("div",{onClick:()=>Se(F),className:"bg-white rounded-[24px] overflow-hidden shadow-sm cursor-pointer group hover:shadow-xl transition-all duration-300",children:a.jsxs("div",{className:"aspect-[9/16] bg-black relative",children:[a.jsx("video",{src:F.mediaURL,className:"w-full h-full object-contain opacity-90 group-hover:opacity-100 transition-opacity"}),a.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent flex flex-col justify-end p-4",children:[a.jsx("h3",{className:"text-white font-bold text-lg leading-tight line-clamp-2",children:F.text}),a.jsxs("p",{className:"text-white/80 text-sm mt-1 flex items-center gap-2",children:["@",F.userName," ",a.jsxs("span",{className:"text-xs",children:[" ",F.likes," likes"]})]})]})]})},F.id)),C.length===0&&a.jsx("p",{className:"col-span-4 text-center text-gray-400 mt-10",children:"No videos found for this filter/search."})]}),E&&a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-50 flex items-center justify-center p-8 animate-fade-in",onClick:fe,children:a.jsxs("div",{className:"flex w-full max-w-6xl h-[85vh] bg-white rounded-[35px] shadow-2xl overflow-hidden",onClick:F=>F.stopPropagation(),children:[a.jsxs("div",{className:"flex-1 min-w-0 bg-gray-900 flex items-center justify-center relative",children:[a.jsx("video",{src:E.mediaURL,controls:!0,autoPlay:!0,className:"max-w-full max-h-full object-contain"}),a.jsx("button",{onClick:fe,className:"absolute top-4 left-4 w-10 h-10 bg-black/40 backdrop-blur-md rounded-full text-white text-xl flex items-center justify-center hover:bg-black/60 transition-colors",children:a.jsx("i",{className:"fas fa-times"})}),a.jsxs("div",{className:"absolute right-4 bottom-4 flex flex-col gap-4 items-center z-10 text-white",children:[a.jsx("div",{className:"relative",onClick:()=>t(`/profile/${E.uid}`),children:a.jsx(fx,{uid:E.uid,size:"md",className:"border-2 border-white shadow-md"})}),a.jsxs("button",{onClick:()=>q(E),className:"flex flex-col items-center gap-1",children:[a.jsx("div",{className:`w-12 h-12 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-2xl transition-all ${(se=E.likedBy)!=null&&se.includes(n==null?void 0:n.uid)?"text-primary":"text-white"}`,children:a.jsx("i",{className:`${(ne=E.likedBy)!=null&&ne.includes(n==null?void 0:n.uid)?"fas":"far"} fa-heart`})}),a.jsx("span",{className:"text-[10px] font-bold drop-shadow-md",children:E.likes})]}),a.jsxs("button",{onClick:()=>x(!m),className:"flex flex-col items-center gap-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-white text-2xl",children:a.jsx("i",{className:"fas fa-comment-dots"})}),a.jsx("span",{className:"text-[10px] font-bold drop-shadow-md",children:E.comments})]}),a.jsxs("button",{onClick:()=>ue(E),className:"flex flex-col items-center gap-1",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-black/20 backdrop-blur-md flex items-center justify-center text-white text-2xl",children:a.jsx("i",{className:"fas fa-share"})}),a.jsx("span",{className:"text-[10px] font-bold drop-shadow-md",children:"Share"})]})]})]}),a.jsx("div",{className:`w-[400px] flex flex-col border-l transition-all duration-300 ${m?"opacity-100":"opacity-0 pointer-events-none"}`,children:a.jsx(SN,{postId:E.id,user:n,isDesktop:!0})})]})})]}):a.jsxs("div",{className:"fixed inset-0 bg-black text-white z-0 w-full h-full overflow-hidden",children:[a.jsxs("div",{className:"absolute top-0 left-0 right-0 z-30 p-4 pt-safe-top flex justify-between items-start pointer-events-none",children:[a.jsxs("button",{onClick:()=>t(-1),className:"pointer-events-auto bg-black/20 backdrop-blur-md px-3 py-1.5 rounded-full flex items-center gap-2 border border-white/10 hover:bg-white/10 transition-all",children:[a.jsx("i",{className:"fas fa-arrow-left text-white text-sm"}),a.jsx("span",{className:"font-bold text-xs",children:"Back"})]}),a.jsxs("div",{className:"pointer-events-auto flex flex-col items-end gap-2",children:[a.jsx("button",{onClick:()=>R(!I),className:"w-10 h-10 bg-black/20 backdrop-blur-md rounded-full flex items-center justify-center text-white hover:bg-white/10 border border-white/10 shadow-lg transition-all",children:a.jsx("i",{className:"fas fa-sliders-h"})}),I&&a.jsx("div",{className:"bg-white/90 backdrop-blur-xl rounded-2xl p-2 shadow-2xl border border-white/20 flex flex-col gap-1 w-40 animate-scale-in text-dark origin-top-right",children:D.map(F=>a.jsx("button",{onClick:()=>{T(F),R(!1),u(0)},className:`text-left px-3 py-2 rounded-xl text-sm font-bold transition-all ${v===F?"bg-primary text-white":"hover:bg-gray-100 text-dark"}`,children:F},F))})]})]}),o?a.jsx("div",{className:"flex h-full items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 border-4 border-white/30 border-t-white rounded-full animate-spin"})}):a.jsx("div",{ref:S,className:"h-full overflow-y-scroll snap-y snap-mandatory no-scrollbar",onScroll:F=>{const G=Math.round(F.target.scrollTop/window.innerHeight);G!==c&&G<C.length&&u(G)},children:C.map((F,G)=>a.jsx(K,{video:F,isActive:G===c},F.id))}),h&&a.jsxs("div",{className:"fixed inset-0 z-50",children:[a.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:()=>f(null)}),a.jsxs("div",{className:"absolute bottom-0 w-full h-[80vh] bg-white rounded-t-[35px] flex flex-col animate-slide-up text-dark shadow-2xl overflow-hidden pb-safe",children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[a.jsx("span",{className:"font-bold text-lg",children:"Comments"}),a.jsx("button",{onClick:()=>f(null),className:"w-8 h-8 bg-gray-100 rounded-full flex items-center justify-center",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsx(SN,{postId:h,user:n,isDesktop:!1})]})]})]})},h6=({currentFilters:t,onClose:e,onApply:n,onDeactivate:s})=>{const[r,i]=g.useState(t),o=(c,u)=>{i(h=>({...h,[c]:u}))},l=()=>{n(r),e()};return a.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-end md:items-center justify-center z-[9999] p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-md rounded-[30px] md:rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#fff0f5]",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"font-black text-xl text-dark flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-sliders-h text-pink-500"})," Dating Filters"]}),a.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Find your perfect match"})]}),a.jsx("button",{onClick:e,children:a.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark text-xl"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"I'm interested in"}),a.jsx("div",{className:"flex bg-gray-100 rounded-xl p-1",children:["Men","Women","Everyone"].map(c=>a.jsx("button",{onClick:()=>o("gender",c),className:`flex-1 py-3 rounded-lg text-sm font-bold transition-all ${r.gender===c?"bg-white text-pink-500 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:c},c))})]}),a.jsxs("section",{children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Age Range"}),a.jsxs("span",{className:"text-pink-500 font-bold text-sm",children:[r.ageRange[0]," - ",r.ageRange[1]]})]}),a.jsxs("div",{className:"px-2",children:[a.jsx("input",{type:"range",min:"18",max:"65",value:r.ageRange[1],onChange:c=>o("ageRange",[r.ageRange[0],parseInt(c.target.value)]),className:"w-full accent-pink-500 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),a.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2 font-bold",children:[a.jsx("span",{children:"18"}),a.jsx("span",{children:"65+"})]})]})]}),a.jsxs("section",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Location"}),a.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-gray-100 rounded-xl px-4 py-3",children:[a.jsx("i",{className:"fas fa-map-marker-alt text-pink-400"}),a.jsx("input",{type:"text",placeholder:"e.g. Dhaka, Gulshan",className:"bg-transparent outline-none w-full text-sm font-bold text-dark placeholder-gray-300",value:r.location,onChange:c=>o("location",c.target.value)})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Profession"}),a.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-gray-100 rounded-xl px-4 py-3",children:[a.jsx("i",{className:"fas fa-briefcase text-pink-400"}),a.jsx("input",{type:"text",placeholder:"e.g. Doctor, Engineer",className:"bg-transparent outline-none w-full text-sm font-bold text-dark placeholder-gray-300",value:r.profession,onChange:c=>o("profession",c.target.value)})]})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Relationship Goals"}),a.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"Long-term",icon:"fa-ring",label:"Long-term"},{id:"Casual",icon:"fa-glass-cheers",label:"Fun / Casual"},{id:"Friendship",icon:"fa-user-friends",label:"Friendship"},{id:"Not Sure",icon:"fa-question",label:"Figuring it out"}].map(c=>a.jsxs("button",{onClick:()=>o("goal",c.id),className:`p-3 rounded-xl border-2 text-left transition-all flex items-center gap-3 ${r.goal===c.id?"border-pink-500 bg-pink-50 text-pink-600":"border-gray-100 text-gray-500 hover:border-pink-200"}`,children:[a.jsx("i",{className:`fas ${c.icon}`}),a.jsx("span",{className:"text-sm font-bold",children:c.label})]},c.id))})]}),s&&a.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[a.jsxs("button",{onClick:s,className:"w-full py-3 rounded-xl border border-red-100 text-red-500 font-bold text-sm bg-red-50 hover:bg-red-100 transition-colors flex items-center justify-center gap-2",children:[a.jsx("i",{className:"fas fa-eye-slash"})," Turn Off Dating Mode"]}),a.jsx("p",{className:"text-[10px] text-gray-400 text-center mt-2",children:"Your dating profile will be hidden. You can turn it back on anytime."})]})]}),a.jsx("div",{className:"p-4 border-t border-gray-100 bg-white",children:a.jsx("button",{onClick:l,className:"w-full bg-gradient-to-r from-pink-500 to-red-500 text-white font-bold py-4 rounded-2xl shadow-lg shadow-pink-500/30 hover:scale-[1.02] transition-transform",children:"Apply Filters"})})]})})},X0=g.createContext({});function nd(t){const e=g.useRef(null);return e.current===null&&(e.current=t()),e.current}const J0=typeof window<"u",Z0=J0?g.useLayoutEffect:g.useEffect,bm=g.createContext(null);function ev(t,e){t.indexOf(e)===-1&&t.push(e)}function tv(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}const Br=(t,e,n)=>n>e?e:n<t?t:n;let nv=()=>{};const $r={},eC=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function tC(t){return typeof t=="object"&&t!==null}const nC=t=>/^0[^.\s]+$/u.test(t);function sv(t){let e;return()=>(e===void 0&&(e=t()),e)}const Cs=t=>t,f6=(t,e)=>n=>e(t(n)),sd=(...t)=>t.reduce(f6),wu=(t,e,n)=>{const s=e-t;return s===0?1:(n-t)/s};class rv{constructor(){this.subscriptions=[]}add(e){return ev(this.subscriptions,e),()=>tv(this.subscriptions,e)}notify(e,n,s){const r=this.subscriptions.length;if(r)if(r===1)this.subscriptions[0](e,n,s);else for(let i=0;i<r;i++){const o=this.subscriptions[i];o&&o(e,n,s)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const ur=t=>t*1e3,js=t=>t/1e3;function sC(t,e){return e?t*(1e3/e):0}const rC=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,m6=1e-7,p6=12;function g6(t,e,n,s,r){let i,o,l=0;do o=e+(n-e)/2,i=rC(o,s,r)-t,i>0?n=o:e=o;while(Math.abs(i)>m6&&++l<p6);return o}function rd(t,e,n,s){if(t===e&&n===s)return Cs;const r=i=>g6(i,0,1,t,n);return i=>i===0||i===1?i:rC(r(i),e,s)}const iC=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,aC=t=>e=>1-t(1-e),oC=rd(.33,1.53,.69,.99),iv=aC(oC),lC=iC(iv),cC=t=>(t*=2)<1?.5*iv(t):.5*(2-Math.pow(2,-10*(t-1))),av=t=>1-Math.sin(Math.acos(t)),uC=aC(av),dC=iC(av),x6=rd(.42,0,1,1),y6=rd(0,0,.58,1),hC=rd(.42,0,.58,1),v6=t=>Array.isArray(t)&&typeof t[0]!="number",fC=t=>Array.isArray(t)&&typeof t[0]=="number",b6={linear:Cs,easeIn:x6,easeInOut:hC,easeOut:y6,circIn:av,circInOut:dC,circOut:uC,backIn:iv,backInOut:lC,backOut:oC,anticipate:cC},w6=t=>typeof t=="string",jN=t=>{if(fC(t)){nv(t.length===4);const[e,n,s,r]=t;return rd(e,n,s,r)}else if(w6(t))return b6[t];return t},Wd=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function _6(t,e){let n=new Set,s=new Set,r=!1,i=!1;const o=new WeakSet;let l={delta:0,timestamp:0,isProcessing:!1};function c(h){o.has(h)&&(u.schedule(h),t()),h(l)}const u={schedule:(h,f=!1,m=!1)=>{const b=m&&r?n:s;return f&&o.add(h),b.has(h)||b.add(h),h},cancel:h=>{s.delete(h),o.delete(h)},process:h=>{if(l=h,r){i=!0;return}r=!0,[n,s]=[s,n],n.forEach(c),n.clear(),r=!1,i&&(i=!1,u.process(h))}};return u}const N6=40;function mC(t,e){let n=!1,s=!0;const r={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,o=Wd.reduce((T,I)=>(T[I]=_6(i),T),{}),{setup:l,read:c,resolveKeyframes:u,preUpdate:h,update:f,preRender:m,render:x,postRender:b}=o,N=()=>{const T=$r.useManualTiming?r.timestamp:performance.now();n=!1,$r.useManualTiming||(r.delta=s?1e3/60:Math.max(Math.min(T-r.timestamp,N6),1)),r.timestamp=T,r.isProcessing=!0,l.process(r),c.process(r),u.process(r),h.process(r),f.process(r),m.process(r),x.process(r),b.process(r),r.isProcessing=!1,n&&e&&(s=!1,t(N))},E=()=>{n=!0,s=!0,r.isProcessing||t(N)};return{schedule:Wd.reduce((T,I)=>{const R=o[I];return T[I]=(V,j=!1,y=!1)=>(n||E(),R.schedule(V,j,y)),T},{}),cancel:T=>{for(let I=0;I<Wd.length;I++)o[Wd[I]].cancel(T)},state:r,steps:o}}const{schedule:xt,cancel:zr,state:mn,steps:wp}=mC(typeof requestAnimationFrame<"u"?requestAnimationFrame:Cs,!0);let wh;function E6(){wh=void 0}const es={now:()=>(wh===void 0&&es.set(mn.isProcessing||$r.useManualTiming?mn.timestamp:performance.now()),wh),set:t=>{wh=t,queueMicrotask(E6)}},pC=t=>e=>typeof e=="string"&&e.startsWith(t),ov=pC("--"),T6=pC("var(--"),lv=t=>T6(t)?S6.test(t.split("/*")[0].trim()):!1,S6=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Rl={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},_u={...Rl,transform:t=>Br(0,1,t)},Gd={...Rl,default:1},Oc=t=>Math.round(t*1e5)/1e5,cv=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function j6(t){return t==null}const k6=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,uv=(t,e)=>n=>!!(typeof n=="string"&&k6.test(n)&&n.startsWith(t)||e&&!j6(n)&&Object.prototype.hasOwnProperty.call(n,e)),gC=(t,e,n)=>s=>{if(typeof s!="string")return s;const[r,i,o,l]=s.match(cv);return{[t]:parseFloat(r),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},I6=t=>Br(0,255,t),_p={...Rl,transform:t=>Math.round(I6(t))},ya={test:uv("rgb","red"),parse:gC("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:s=1})=>"rgba("+_p.transform(t)+", "+_p.transform(e)+", "+_p.transform(n)+", "+Oc(_u.transform(s))+")"};function C6(t){let e="",n="",s="",r="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),s=t.substring(5,7),r=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),s=t.substring(3,4),r=t.substring(4,5),e+=e,n+=n,s+=s,r+=r),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(s,16),alpha:r?parseInt(r,16)/255:1}}const mx={test:uv("#"),parse:C6,transform:ya.transform},id=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),oi=id("deg"),dr=id("%"),Pe=id("px"),A6=id("vh"),R6=id("vw"),kN={...dr,parse:t=>dr.parse(t)/100,transform:t=>dr.transform(t*100)},Do={test:uv("hsl","hue"),parse:gC("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:s=1})=>"hsla("+Math.round(t)+", "+dr.transform(Oc(e))+", "+dr.transform(Oc(n))+", "+Oc(_u.transform(s))+")"},Ht={test:t=>ya.test(t)||mx.test(t)||Do.test(t),parse:t=>ya.test(t)?ya.parse(t):Do.test(t)?Do.parse(t):mx.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?ya.transform(t):Do.transform(t),getAnimatableNone:t=>{const e=Ht.parse(t);return e.alpha=0,Ht.transform(e)}},P6=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function D6(t){var e,n;return isNaN(t)&&typeof t=="string"&&(((e=t.match(cv))==null?void 0:e.length)||0)+(((n=t.match(P6))==null?void 0:n.length)||0)>0}const xC="number",yC="color",V6="var",M6="var(",IN="${}",L6=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Nu(t){const e=t.toString(),n=[],s={color:[],number:[],var:[]},r=[];let i=0;const l=e.replace(L6,c=>(Ht.test(c)?(s.color.push(i),r.push(yC),n.push(Ht.parse(c))):c.startsWith(M6)?(s.var.push(i),r.push(V6),n.push(c)):(s.number.push(i),r.push(xC),n.push(parseFloat(c))),++i,IN)).split(IN);return{values:n,split:l,indexes:s,types:r}}function vC(t){return Nu(t).values}function bC(t){const{split:e,types:n}=Nu(t),s=e.length;return r=>{let i="";for(let o=0;o<s;o++)if(i+=e[o],r[o]!==void 0){const l=n[o];l===xC?i+=Oc(r[o]):l===yC?i+=Ht.transform(r[o]):i+=r[o]}return i}}const O6=t=>typeof t=="number"?0:Ht.test(t)?Ht.getAnimatableNone(t):t;function F6(t){const e=vC(t);return bC(t)(e.map(O6))}const Fi={test:D6,parse:vC,createTransformer:bC,getAnimatableNone:F6};function Np(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function U6({hue:t,saturation:e,lightness:n,alpha:s}){t/=360,e/=100,n/=100;let r=0,i=0,o=0;if(!e)r=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;r=Np(c,l,t+1/3),i=Np(c,l,t),o=Np(c,l,t-1/3)}return{red:Math.round(r*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:s}}function Nf(t,e){return n=>n>0?e:t}const It=(t,e,n)=>t+(e-t)*n,Ep=(t,e,n)=>{const s=t*t,r=n*(e*e-s)+s;return r<0?0:Math.sqrt(r)},B6=[mx,ya,Do],$6=t=>B6.find(e=>e.test(t));function CN(t){const e=$6(t);if(!e)return!1;let n=e.parse(t);return e===Do&&(n=U6(n)),n}const AN=(t,e)=>{const n=CN(t),s=CN(e);if(!n||!s)return Nf(t,e);const r={...n};return i=>(r.red=Ep(n.red,s.red,i),r.green=Ep(n.green,s.green,i),r.blue=Ep(n.blue,s.blue,i),r.alpha=It(n.alpha,s.alpha,i),ya.transform(r))},px=new Set(["none","hidden"]);function z6(t,e){return px.has(t)?n=>n<=0?t:e:n=>n>=1?e:t}function q6(t,e){return n=>It(t,e,n)}function dv(t){return typeof t=="number"?q6:typeof t=="string"?lv(t)?Nf:Ht.test(t)?AN:H6:Array.isArray(t)?wC:typeof t=="object"?Ht.test(t)?AN:W6:Nf}function wC(t,e){const n=[...t],s=n.length,r=t.map((i,o)=>dv(i)(i,e[o]));return i=>{for(let o=0;o<s;o++)n[o]=r[o](i);return n}}function W6(t,e){const n={...t,...e},s={};for(const r in n)t[r]!==void 0&&e[r]!==void 0&&(s[r]=dv(t[r])(t[r],e[r]));return r=>{for(const i in s)n[i]=s[i](r);return n}}function G6(t,e){const n=[],s={color:0,var:0,number:0};for(let r=0;r<e.values.length;r++){const i=e.types[r],o=t.indexes[i][s[i]],l=t.values[o]??0;n[r]=l,s[i]++}return n}const H6=(t,e)=>{const n=Fi.createTransformer(e),s=Nu(t),r=Nu(e);return s.indexes.var.length===r.indexes.var.length&&s.indexes.color.length===r.indexes.color.length&&s.indexes.number.length>=r.indexes.number.length?px.has(t)&&!r.values.length||px.has(e)&&!s.values.length?z6(t,e):sd(wC(G6(s,r),r.values),n):Nf(t,e)};function _C(t,e,n){return typeof t=="number"&&typeof e=="number"&&typeof n=="number"?It(t,e,n):dv(t)(t,e)}const K6=t=>{const e=({timestamp:n})=>t(n);return{start:(n=!0)=>xt.update(e,n),stop:()=>zr(e),now:()=>mn.isProcessing?mn.timestamp:es.now()}},NC=(t,e,n=10)=>{let s="";const r=Math.max(Math.round(e/n),2);for(let i=0;i<r;i++)s+=Math.round(t(i/(r-1))*1e4)/1e4+", ";return`linear(${s.substring(0,s.length-2)})`},Ef=2e4;function hv(t){let e=0;const n=50;let s=t.next(e);for(;!s.done&&e<Ef;)e+=n,s=t.next(e);return e>=Ef?1/0:e}function Q6(t,e=100,n){const s=n({...t,keyframes:[0,e]}),r=Math.min(hv(s),Ef);return{type:"keyframes",ease:i=>s.next(r*i).value/e,duration:js(r)}}const Y6=5;function EC(t,e,n){const s=Math.max(e-Y6,0);return sC(n-t(s),e-s)}const Ot={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Tp=.001;function X6({duration:t=Ot.duration,bounce:e=Ot.bounce,velocity:n=Ot.velocity,mass:s=Ot.mass}){let r,i,o=1-e;o=Br(Ot.minDamping,Ot.maxDamping,o),t=Br(Ot.minDuration,Ot.maxDuration,js(t)),o<1?(r=u=>{const h=u*o,f=h*t,m=h-n,x=gx(u,o),b=Math.exp(-f);return Tp-m/x*b},i=u=>{const f=u*o*t,m=f*n+n,x=Math.pow(o,2)*Math.pow(u,2)*t,b=Math.exp(-f),N=gx(Math.pow(u,2),o);return(-r(u)+Tp>0?-1:1)*((m-x)*b)/N}):(r=u=>{const h=Math.exp(-u*t),f=(u-n)*t+1;return-Tp+h*f},i=u=>{const h=Math.exp(-u*t),f=(n-u)*(t*t);return h*f});const l=5/t,c=Z6(r,i,l);if(t=ur(t),isNaN(c))return{stiffness:Ot.stiffness,damping:Ot.damping,duration:t};{const u=Math.pow(c,2)*s;return{stiffness:u,damping:o*2*Math.sqrt(s*u),duration:t}}}const J6=12;function Z6(t,e,n){let s=n;for(let r=1;r<J6;r++)s=s-t(s)/e(s);return s}function gx(t,e){return t*Math.sqrt(1-e*e)}const e$=["duration","bounce"],t$=["stiffness","damping","mass"];function RN(t,e){return e.some(n=>t[n]!==void 0)}function n$(t){let e={velocity:Ot.velocity,stiffness:Ot.stiffness,damping:Ot.damping,mass:Ot.mass,isResolvedFromDuration:!1,...t};if(!RN(t,t$)&&RN(t,e$))if(t.visualDuration){const n=t.visualDuration,s=2*Math.PI/(n*1.2),r=s*s,i=2*Br(.05,1,1-(t.bounce||0))*Math.sqrt(r);e={...e,mass:Ot.mass,stiffness:r,damping:i}}else{const n=X6(t);e={...e,...n,mass:Ot.mass},e.isResolvedFromDuration=!0}return e}function Tf(t=Ot.visualDuration,e=Ot.bounce){const n=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:s,restDelta:r}=n;const i=n.keyframes[0],o=n.keyframes[n.keyframes.length-1],l={done:!1,value:i},{stiffness:c,damping:u,mass:h,duration:f,velocity:m,isResolvedFromDuration:x}=n$({...n,velocity:-js(n.velocity||0)}),b=m||0,N=u/(2*Math.sqrt(c*h)),E=o-i,w=js(Math.sqrt(c/h)),v=Math.abs(E)<5;s||(s=v?Ot.restSpeed.granular:Ot.restSpeed.default),r||(r=v?Ot.restDelta.granular:Ot.restDelta.default);let T;if(N<1){const R=gx(w,N);T=V=>{const j=Math.exp(-N*w*V);return o-j*((b+N*w*E)/R*Math.sin(R*V)+E*Math.cos(R*V))}}else if(N===1)T=R=>o-Math.exp(-w*R)*(E+(b+w*E)*R);else{const R=w*Math.sqrt(N*N-1);T=V=>{const j=Math.exp(-N*w*V),y=Math.min(R*V,300);return o-j*((b+N*w*E)*Math.sinh(y)+R*E*Math.cosh(y))/R}}const I={calculatedDuration:x&&f||null,next:R=>{const V=T(R);if(x)l.done=R>=f;else{let j=R===0?b:0;N<1&&(j=R===0?ur(b):EC(T,R,V));const y=Math.abs(j)<=s,k=Math.abs(o-V)<=r;l.done=y&&k}return l.value=l.done?o:V,l},toString:()=>{const R=Math.min(hv(I),Ef),V=NC(j=>I.next(R*j).value,R,30);return R+"ms "+V},toTransition:()=>{}};return I}Tf.applyToOptions=t=>{const e=Q6(t,100,Tf);return t.ease=e.ease,t.duration=ur(e.duration),t.type="keyframes",t};function xx({keyframes:t,velocity:e=0,power:n=.8,timeConstant:s=325,bounceDamping:r=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:h}){const f=t[0],m={done:!1,value:f},x=y=>l!==void 0&&y<l||c!==void 0&&y>c,b=y=>l===void 0?c:c===void 0||Math.abs(l-y)<Math.abs(c-y)?l:c;let N=n*e;const E=f+N,w=o===void 0?E:o(E);w!==E&&(N=w-f);const v=y=>-N*Math.exp(-y/s),T=y=>w+v(y),I=y=>{const k=v(y),S=T(y);m.done=Math.abs(k)<=u,m.value=m.done?w:S};let R,V;const j=y=>{x(m.value)&&(R=y,V=Tf({keyframes:[m.value,b(m.value)],velocity:EC(T,y,m.value),damping:r,stiffness:i,restDelta:u,restSpeed:h}))};return j(0),{calculatedDuration:null,next:y=>{let k=!1;return!V&&R===void 0&&(k=!0,I(y),j(y)),R!==void 0&&y>=R?V.next(y-R):(!k&&I(y),m)}}}function s$(t,e,n){const s=[],r=n||$r.mix||_C,i=t.length-1;for(let o=0;o<i;o++){let l=r(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||Cs:e;l=sd(c,l)}s.push(l)}return s}function TC(t,e,{clamp:n=!0,ease:s,mixer:r}={}){const i=t.length;if(nv(i===e.length),i===1)return()=>e[0];if(i===2&&e[0]===e[1])return()=>e[1];const o=t[0]===t[1];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const l=s$(e,s,r),c=l.length,u=h=>{if(o&&h<t[0])return e[0];let f=0;if(c>1)for(;f<t.length-2&&!(h<t[f+1]);f++);const m=wu(t[f],t[f+1],h);return l[f](m)};return n?h=>u(Br(t[0],t[i-1],h)):u}function r$(t,e){const n=t[t.length-1];for(let s=1;s<=e;s++){const r=wu(0,e,s);t.push(It(n,1,r))}}function i$(t){const e=[0];return r$(e,t.length-1),e}function a$(t,e){return t.map(n=>n*e)}function o$(t,e){return t.map(()=>e||hC).splice(0,t.length-1)}function Fc({duration:t=300,keyframes:e,times:n,ease:s="easeInOut"}){const r=v6(s)?s.map(jN):jN(s),i={done:!1,value:e[0]},o=a$(n&&n.length===e.length?n:i$(e),t),l=TC(o,e,{ease:Array.isArray(r)?r:o$(e,r)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}const l$=t=>t!==null;function fv(t,{repeat:e,repeatType:n="loop"},s,r=1){const i=t.filter(l$),l=r<0||e&&n!=="loop"&&e%2===1?0:i.length-1;return!l||s===void 0?i[l]:s}const c$={decay:xx,inertia:xx,tween:Fc,keyframes:Fc,spring:Tf};function SC(t){typeof t.type=="string"&&(t.type=c$[t.type])}class mv{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,n){return this.finished.then(e,n)}}const u$=t=>t/100;class pv extends mv{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var s,r;const{motionValue:n}=this.options;n&&n.updatedAt!==es.now()&&this.tick(es.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(r=(s=this.options).onStop)==null||r.call(s))},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;SC(e);const{type:n=Fc,repeat:s=0,repeatDelay:r=0,repeatType:i,velocity:o=0}=e;let{keyframes:l}=e;const c=n||Fc;c!==Fc&&typeof l[0]!="number"&&(this.mixKeyframes=sd(u$,_C(l[0],l[1])),l=[0,100]);const u=c({...e,keyframes:l});i==="mirror"&&(this.mirroredGenerator=c({...e,keyframes:[...l].reverse(),velocity:-o})),u.calculatedDuration===null&&(u.calculatedDuration=hv(u));const{calculatedDuration:h}=u;this.calculatedDuration=h,this.resolvedDuration=h+r,this.totalDuration=this.resolvedDuration*(s+1)-r,this.generator=u}updateTime(e){const n=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(e,n=!1){const{generator:s,totalDuration:r,mixKeyframes:i,mirroredGenerator:o,resolvedDuration:l,calculatedDuration:c}=this;if(this.startTime===null)return s.next(0);const{delay:u=0,keyframes:h,repeat:f,repeatType:m,repeatDelay:x,type:b,onUpdate:N,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-r/this.speed,this.startTime)),n?this.currentTime=e:this.updateTime(e);const w=this.currentTime-u*(this.playbackSpeed>=0?1:-1),v=this.playbackSpeed>=0?w<0:w>r;this.currentTime=Math.max(w,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=r);let T=this.currentTime,I=s;if(f){const y=Math.min(this.currentTime,r)/l;let k=Math.floor(y),S=y%1;!S&&y>=1&&(S=1),S===1&&k--,k=Math.min(k,f+1),!!(k%2)&&(m==="reverse"?(S=1-S,x&&(S-=x/l)):m==="mirror"&&(I=o)),T=Br(0,1,S)*l}const R=v?{done:!1,value:h[0]}:I.next(T);i&&(R.value=i(R.value));let{done:V}=R;!v&&c!==null&&(V=this.playbackSpeed>=0?this.currentTime>=r:this.currentTime<=0);const j=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&V);return j&&b!==xx&&(R.value=fv(h,this.options,E,this.speed)),N&&N(R.value),j&&this.finish(),R}then(e,n){return this.finished.then(e,n)}get duration(){return js(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+js(e)}get time(){return js(this.currentTime)}set time(e){var n;e=ur(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),(n=this.driver)==null||n.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(es.now());const n=this.playbackSpeed!==e;this.playbackSpeed=e,n&&(this.time=js(this.currentTime))}play(){var r,i;if(this.isStopped)return;const{driver:e=K6,startTime:n}=this.options;this.driver||(this.driver=e(o=>this.tick(o))),(i=(r=this.options).onPlay)==null||i.call(r);const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=n??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(es.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var e,n;this.notifyFinished(),this.teardown(),this.state="finished",(n=(e=this.options).onComplete)==null||n.call(e)}cancel(){var e,n;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(n=(e=this.options).onCancel)==null||n.call(e)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){var n;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(n=this.driver)==null||n.stop(),e.observe(this)}}function d$(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const va=t=>t*180/Math.PI,yx=t=>{const e=va(Math.atan2(t[1],t[0]));return vx(e)},h$={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:yx,rotateZ:yx,skewX:t=>va(Math.atan(t[1])),skewY:t=>va(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},vx=t=>(t=t%360,t<0&&(t+=360),t),PN=yx,DN=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),VN=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),f$={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:DN,scaleY:VN,scale:t=>(DN(t)+VN(t))/2,rotateX:t=>vx(va(Math.atan2(t[6],t[5]))),rotateY:t=>vx(va(Math.atan2(-t[2],t[0]))),rotateZ:PN,rotate:PN,skewX:t=>va(Math.atan(t[4])),skewY:t=>va(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function bx(t){return t.includes("scale")?1:0}function wx(t,e){if(!t||t==="none")return bx(e);const n=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let s,r;if(n)s=f$,r=n;else{const l=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);s=h$,r=l}if(!r)return bx(e);const i=s[e],o=r[1].split(",").map(p$);return typeof i=="function"?i(o):o[i]}const m$=(t,e)=>{const{transform:n="none"}=getComputedStyle(t);return wx(n,e)};function p$(t){return parseFloat(t.trim())}const Pl=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Dl=new Set(Pl),MN=t=>t===Rl||t===Pe,g$=new Set(["x","y","z"]),x$=Pl.filter(t=>!g$.has(t));function y$(t){const e=[];return x$.forEach(n=>{const s=t.getValue(n);s!==void 0&&(e.push([n,s.get()]),s.set(n.startsWith("scale")?1:0))}),e}const Sa={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>wx(e,"x"),y:(t,{transform:e})=>wx(e,"y")};Sa.translateX=Sa.x;Sa.translateY=Sa.y;const ja=new Set;let _x=!1,Nx=!1,Ex=!1;function jC(){if(Nx){const t=Array.from(ja).filter(s=>s.needsMeasurement),e=new Set(t.map(s=>s.element)),n=new Map;e.forEach(s=>{const r=y$(s);r.length&&(n.set(s,r),s.render())}),t.forEach(s=>s.measureInitialState()),e.forEach(s=>{s.render();const r=n.get(s);r&&r.forEach(([i,o])=>{var l;(l=s.getValue(i))==null||l.set(o)})}),t.forEach(s=>s.measureEndState()),t.forEach(s=>{s.suspendedScrollY!==void 0&&window.scrollTo(0,s.suspendedScrollY)})}Nx=!1,_x=!1,ja.forEach(t=>t.complete(Ex)),ja.clear()}function kC(){ja.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Nx=!0)})}function v$(){Ex=!0,kC(),jC(),Ex=!1}class gv{constructor(e,n,s,r,i,o=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=n,this.name=s,this.motionValue=r,this.element=i,this.isAsync=o}scheduleResolve(){this.state="scheduled",this.isAsync?(ja.add(this),_x||(_x=!0,xt.read(kC),xt.resolveKeyframes(jC))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:n,element:s,motionValue:r}=this;if(e[0]===null){const i=r==null?void 0:r.get(),o=e[e.length-1];if(i!==void 0)e[0]=i;else if(s&&n){const l=s.readValue(n,o);l!=null&&(e[0]=l)}e[0]===void 0&&(e[0]=o),r&&i===void 0&&r.set(e[0])}d$(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),ja.delete(this)}cancel(){this.state==="scheduled"&&(ja.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const b$=t=>t.startsWith("--");function w$(t,e,n){b$(e)?t.style.setProperty(e,n):t.style[e]=n}const _$=sv(()=>window.ScrollTimeline!==void 0),N$={};function E$(t,e){const n=sv(t);return()=>N$[e]??n()}const IC=E$(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),bc=([t,e,n,s])=>`cubic-bezier(${t}, ${e}, ${n}, ${s})`,LN={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:bc([0,.65,.55,1]),circOut:bc([.55,0,1,.45]),backIn:bc([.31,.01,.66,-.59]),backOut:bc([.33,1.53,.69,.99])};function CC(t,e){if(t)return typeof t=="function"?IC()?NC(t,e):"ease-out":fC(t)?bc(t):Array.isArray(t)?t.map(n=>CC(n,e)||LN.easeOut):LN[t]}function T$(t,e,n,{delay:s=0,duration:r=300,repeat:i=0,repeatType:o="loop",ease:l="easeOut",times:c}={},u=void 0){const h={[e]:n};c&&(h.offset=c);const f=CC(l,r);Array.isArray(f)&&(h.easing=f);const m={delay:s,duration:r,easing:Array.isArray(f)?"linear":f,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"};return u&&(m.pseudoElement=u),t.animate(h,m)}function AC(t){return typeof t=="function"&&"applyToOptions"in t}function S$({type:t,...e}){return AC(t)&&IC()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class j$ extends mv{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,!e)return;const{element:n,name:s,keyframes:r,pseudoElement:i,allowFlatten:o=!1,finalKeyframe:l,onComplete:c}=e;this.isPseudoElement=!!i,this.allowFlatten=o,this.options=e,nv(typeof e.type!="string");const u=S$(e);this.animation=T$(n,s,r,u,i),u.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const h=fv(r,this.options,l,this.speed);this.updateMotionValue?this.updateMotionValue(h):w$(n,s,h),this.animation.cancel()}c==null||c(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var e,n;(n=(e=this.animation).finish)==null||n.call(e)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var e,n;this.isPseudoElement||(n=(e=this.animation).commitStyles)==null||n.call(e)}get duration(){var n,s;const e=((s=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:s.call(n).duration)||0;return js(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+js(e)}get time(){return js(Number(this.animation.currentTime)||0)}set time(e){this.finishedTime=null,this.animation.currentTime=ur(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(e){this.animation.startTime=e}attachTimeline({timeline:e,observe:n}){var s;return this.allowFlatten&&((s=this.animation.effect)==null||s.updateTiming({easing:"linear"})),this.animation.onfinish=null,e&&_$()?(this.animation.timeline=e,Cs):n(this)}}const RC={anticipate:cC,backInOut:lC,circInOut:dC};function k$(t){return t in RC}function I$(t){typeof t.ease=="string"&&k$(t.ease)&&(t.ease=RC[t.ease])}const ON=10;class C$ extends j${constructor(e){I$(e),SC(e),super(e),e.startTime&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:n,onUpdate:s,onComplete:r,element:i,...o}=this.options;if(!n)return;if(e!==void 0){n.set(e);return}const l=new pv({...o,autoplay:!1}),c=ur(this.finishedTime??this.time);n.setWithVelocity(l.sample(c-ON).value,l.sample(c).value,ON),l.stop()}}const FN=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(Fi.test(t)||t==="0")&&!t.startsWith("url("));function A$(t){const e=t[0];if(t.length===1)return!0;for(let n=0;n<t.length;n++)if(t[n]!==e)return!0}function R$(t,e,n,s){const r=t[0];if(r===null)return!1;if(e==="display"||e==="visibility")return!0;const i=t[t.length-1],o=FN(r,e),l=FN(i,e);return!o||!l?!1:A$(t)||(n==="spring"||AC(n))&&s}function Tx(t){t.duration=0,t.type="keyframes"}const P$=new Set(["opacity","clipPath","filter","transform"]),D$=sv(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function V$(t){var h;const{motionValue:e,name:n,repeatDelay:s,repeatType:r,damping:i,type:o}=t;if(!(((h=e==null?void 0:e.owner)==null?void 0:h.current)instanceof HTMLElement))return!1;const{onUpdate:c,transformTemplate:u}=e.owner.getProps();return D$()&&n&&P$.has(n)&&(n!=="transform"||!u)&&!c&&!s&&r!=="mirror"&&i!==0&&o!=="inertia"}const M$=40;class L$ extends mv{constructor({autoplay:e=!0,delay:n=0,type:s="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:o="loop",keyframes:l,name:c,motionValue:u,element:h,...f}){var b;super(),this.stop=()=>{var N,E;this._animation&&(this._animation.stop(),(N=this.stopTimeline)==null||N.call(this)),(E=this.keyframeResolver)==null||E.cancel()},this.createdAt=es.now();const m={autoplay:e,delay:n,type:s,repeat:r,repeatDelay:i,repeatType:o,name:c,motionValue:u,element:h,...f},x=(h==null?void 0:h.KeyframeResolver)||gv;this.keyframeResolver=new x(l,(N,E,w)=>this.onKeyframesResolved(N,E,m,!w),c,u,h),(b=this.keyframeResolver)==null||b.scheduleResolve()}onKeyframesResolved(e,n,s,r){this.keyframeResolver=void 0;const{name:i,type:o,velocity:l,delay:c,isHandoff:u,onUpdate:h}=s;this.resolvedAt=es.now(),R$(e,i,o,l)||(($r.instantAnimations||!c)&&(h==null||h(fv(e,s,n))),e[0]=e[e.length-1],Tx(s),s.repeat=0);const m={startTime:r?this.resolvedAt?this.resolvedAt-this.createdAt>M$?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...s,keyframes:e},x=!u&&V$(m)?new C$({...m,element:m.motionValue.owner.current}):new pv(m);x.finished.then(()=>this.notifyFinished()).catch(Cs),this.pendingTimeline&&(this.stopTimeline=x.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=x}get finished(){return this._animation?this.animation.finished:this._finished}then(e,n){return this.finished.finally(e).then(()=>{})}get animation(){var e;return this._animation||((e=this.keyframeResolver)==null||e.resume(),v$()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var e;this._animation&&this.animation.cancel(),(e=this.keyframeResolver)==null||e.cancel()}}const O$=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function F$(t){const e=O$.exec(t);if(!e)return[,];const[,n,s,r]=e;return[`--${n??s}`,r]}function PC(t,e,n=1){const[s,r]=F$(t);if(!s)return;const i=window.getComputedStyle(e).getPropertyValue(s);if(i){const o=i.trim();return eC(o)?parseFloat(o):o}return lv(r)?PC(r,e,n+1):r}function xv(t,e){return(t==null?void 0:t[e])??(t==null?void 0:t.default)??t}const DC=new Set(["width","height","top","left","right","bottom",...Pl]),U$={test:t=>t==="auto",parse:t=>t},VC=t=>e=>e.test(t),MC=[Rl,Pe,dr,oi,R6,A6,U$],UN=t=>MC.find(VC(t));function B$(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||nC(t):!0}const $$=new Set(["brightness","contrast","saturate","opacity"]);function z$(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[s]=n.match(cv)||[];if(!s)return t;const r=n.replace(s,"");let i=$$.has(e)?1:0;return s!==n&&(i*=100),e+"("+i+r+")"}const q$=/\b([a-z-]*)\(.*?\)/gu,Sx={...Fi,getAnimatableNone:t=>{const e=t.match(q$);return e?e.map(z$).join(" "):t}},BN={...Rl,transform:Math.round},W$={rotate:oi,rotateX:oi,rotateY:oi,rotateZ:oi,scale:Gd,scaleX:Gd,scaleY:Gd,scaleZ:Gd,skew:oi,skewX:oi,skewY:oi,distance:Pe,translateX:Pe,translateY:Pe,translateZ:Pe,x:Pe,y:Pe,z:Pe,perspective:Pe,transformPerspective:Pe,opacity:_u,originX:kN,originY:kN,originZ:Pe},yv={borderWidth:Pe,borderTopWidth:Pe,borderRightWidth:Pe,borderBottomWidth:Pe,borderLeftWidth:Pe,borderRadius:Pe,radius:Pe,borderTopLeftRadius:Pe,borderTopRightRadius:Pe,borderBottomRightRadius:Pe,borderBottomLeftRadius:Pe,width:Pe,maxWidth:Pe,height:Pe,maxHeight:Pe,top:Pe,right:Pe,bottom:Pe,left:Pe,padding:Pe,paddingTop:Pe,paddingRight:Pe,paddingBottom:Pe,paddingLeft:Pe,margin:Pe,marginTop:Pe,marginRight:Pe,marginBottom:Pe,marginLeft:Pe,backgroundPositionX:Pe,backgroundPositionY:Pe,...W$,zIndex:BN,fillOpacity:_u,strokeOpacity:_u,numOctaves:BN},G$={...yv,color:Ht,backgroundColor:Ht,outlineColor:Ht,fill:Ht,stroke:Ht,borderColor:Ht,borderTopColor:Ht,borderRightColor:Ht,borderBottomColor:Ht,borderLeftColor:Ht,filter:Sx,WebkitFilter:Sx},LC=t=>G$[t];function OC(t,e){let n=LC(t);return n!==Sx&&(n=Fi),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const H$=new Set(["auto","none","0"]);function K$(t,e,n){let s=0,r;for(;s<t.length&&!r;){const i=t[s];typeof i=="string"&&!H$.has(i)&&Nu(i).values.length&&(r=t[s]),s++}if(r&&n)for(const i of e)t[i]=OC(n,r)}class Q$ extends gv{constructor(e,n,s,r,i){super(e,n,s,r,i,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:n,name:s}=this;if(!n||!n.current)return;super.readKeyframes();for(let c=0;c<e.length;c++){let u=e[c];if(typeof u=="string"&&(u=u.trim(),lv(u))){const h=PC(u,n.current);h!==void 0&&(e[c]=h),c===e.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!DC.has(s)||e.length!==2)return;const[r,i]=e,o=UN(r),l=UN(i);if(o!==l)if(MN(o)&&MN(l))for(let c=0;c<e.length;c++){const u=e[c];typeof u=="string"&&(e[c]=parseFloat(u))}else Sa[s]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:n}=this,s=[];for(let r=0;r<e.length;r++)(e[r]===null||B$(e[r]))&&s.push(r);s.length&&K$(e,s,n)}measureInitialState(){const{element:e,unresolvedKeyframes:n,name:s}=this;if(!e||!e.current)return;s==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=Sa[s](e.measureViewportBox(),window.getComputedStyle(e.current)),n[0]=this.measuredOrigin;const r=n[n.length-1];r!==void 0&&e.getValue(s,r).jump(r,!1)}measureEndState(){var l;const{element:e,name:n,unresolvedKeyframes:s}=this;if(!e||!e.current)return;const r=e.getValue(n);r&&r.jump(this.measuredOrigin,!1);const i=s.length-1,o=s[i];s[i]=Sa[n](e.measureViewportBox(),window.getComputedStyle(e.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),(l=this.removedTransforms)!=null&&l.length&&this.removedTransforms.forEach(([c,u])=>{e.getValue(c).set(u)}),this.resolveNoneKeyframes()}}function Y$(t,e,n){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let s=document;const r=(n==null?void 0:n[t])??s.querySelectorAll(t);return r?Array.from(r):[]}return Array.from(t)}const FC=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function UC(t){return tC(t)&&"offsetHeight"in t}const $N=30,X$=t=>!isNaN(parseFloat(t)),Uc={current:void 0};class J${constructor(e,n={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=s=>{var i;const r=es.now();if(this.updatedAt!==r&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(s),this.current!==this.prev&&((i=this.events.change)==null||i.notify(this.current),this.dependents))for(const o of this.dependents)o.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=n.owner}setCurrent(e){this.current=e,this.updatedAt=es.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=X$(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new rv);const s=this.events[e].add(n);return e==="change"?()=>{s(),xt.read(()=>{this.events.change.getSize()||this.stop()})}:s}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,n,s){this.set(n),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-s}jump(e,n=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var e;(e=this.events.change)==null||e.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return Uc.current&&Uc.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=es.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>$N)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,$N);return sC(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var e,n;(e=this.dependents)==null||e.clear(),(n=this.events.destroy)==null||n.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Wa(t,e){return new J$(t,e)}const{schedule:vv}=mC(queueMicrotask,!1),Fs={x:!1,y:!1};function BC(){return Fs.x||Fs.y}function Z$(t){return t==="x"||t==="y"?Fs[t]?null:(Fs[t]=!0,()=>{Fs[t]=!1}):Fs.x||Fs.y?null:(Fs.x=Fs.y=!0,()=>{Fs.x=Fs.y=!1})}function $C(t,e){const n=Y$(t),s=new AbortController,r={passive:!0,...e,signal:s.signal};return[n,r,()=>s.abort()]}function zN(t){return!(t.pointerType==="touch"||BC())}function e9(t,e,n={}){const[s,r,i]=$C(t,n),o=l=>{if(!zN(l))return;const{target:c}=l,u=e(c,l);if(typeof u!="function"||!c)return;const h=f=>{zN(f)&&(u(f),c.removeEventListener("pointerleave",h))};c.addEventListener("pointerleave",h,r)};return s.forEach(l=>{l.addEventListener("pointerenter",o,r)}),i}const zC=(t,e)=>e?t===e?!0:zC(t,e.parentElement):!1,bv=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,t9=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function n9(t){return t9.has(t.tagName)||t.tabIndex!==-1}const _h=new WeakSet;function qN(t){return e=>{e.key==="Enter"&&t(e)}}function Sp(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const s9=(t,e)=>{const n=t.currentTarget;if(!n)return;const s=qN(()=>{if(_h.has(n))return;Sp(n,"down");const r=qN(()=>{Sp(n,"up")}),i=()=>Sp(n,"cancel");n.addEventListener("keyup",r,e),n.addEventListener("blur",i,e)});n.addEventListener("keydown",s,e),n.addEventListener("blur",()=>n.removeEventListener("keydown",s),e)};function WN(t){return bv(t)&&!BC()}function r9(t,e,n={}){const[s,r,i]=$C(t,n),o=l=>{const c=l.currentTarget;if(!WN(l))return;_h.add(c);const u=e(c,l),h=(x,b)=>{window.removeEventListener("pointerup",f),window.removeEventListener("pointercancel",m),_h.has(c)&&_h.delete(c),WN(x)&&typeof u=="function"&&u(x,{success:b})},f=x=>{h(x,c===window||c===document||n.useGlobalTarget||zC(c,x.target))},m=x=>{h(x,!1)};window.addEventListener("pointerup",f,r),window.addEventListener("pointercancel",m,r)};return s.forEach(l=>{(n.useGlobalTarget?window:l).addEventListener("pointerdown",o,r),UC(l)&&(l.addEventListener("focus",u=>s9(u,r)),!n9(l)&&!l.hasAttribute("tabindex")&&(l.tabIndex=0))}),i}function qC(t){return tC(t)&&"ownerSVGElement"in t}function i9(t){return qC(t)&&t.tagName==="svg"}function a9(...t){const e=!Array.isArray(t[0]),n=e?0:-1,s=t[0+n],r=t[1+n],i=t[2+n],o=t[3+n],l=TC(r,i,o);return e?l(s):l}const In=t=>!!(t&&t.getVelocity),o9=[...MC,Ht,Fi],l9=t=>o9.find(VC(t)),wm=g.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function GN(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function c9(...t){return e=>{let n=!1;const s=t.map(r=>{const i=GN(r,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let r=0;r<s.length;r++){const i=s[r];typeof i=="function"?i():GN(t[r],null)}}}}function u9(...t){return g.useCallback(c9(...t),t)}class d9 extends g.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const s=n.offsetParent,r=UC(s)&&s.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=r-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function h9({children:t,isPresent:e,anchorX:n,root:s}){const r=g.useId(),i=g.useRef(null),o=g.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:l}=g.useContext(wm),c=u9(i,t==null?void 0:t.ref);return g.useInsertionEffect(()=>{const{width:u,height:h,top:f,left:m,right:x}=o.current;if(e||!i.current||!u||!h)return;const b=n==="left"?`left: ${m}`:`right: ${x}`;i.current.dataset.motionPopId=r;const N=document.createElement("style");l&&(N.nonce=l);const E=s??document.head;return E.appendChild(N),N.sheet&&N.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${u}px !important;
            height: ${h}px !important;
            ${b}px !important;
            top: ${f}px !important;
          }
        `),()=>{E.contains(N)&&E.removeChild(N)}},[e]),a.jsx(d9,{isPresent:e,childRef:i,sizeRef:o,children:g.cloneElement(t,{ref:c})})}const f9=({children:t,initial:e,isPresent:n,onExitComplete:s,custom:r,presenceAffectsLayout:i,mode:o,anchorX:l,root:c})=>{const u=nd(m9),h=g.useId();let f=!0,m=g.useMemo(()=>(f=!1,{id:h,initial:e,isPresent:n,custom:r,onExitComplete:x=>{u.set(x,!0);for(const b of u.values())if(!b)return;s&&s()},register:x=>(u.set(x,!1),()=>u.delete(x))}),[n,u,s]);return i&&f&&(m={...m}),g.useMemo(()=>{u.forEach((x,b)=>u.set(b,!1))},[n]),g.useEffect(()=>{!n&&!u.size&&s&&s()},[n]),o==="popLayout"&&(t=a.jsx(h9,{isPresent:n,anchorX:l,root:c,children:t})),a.jsx(bm.Provider,{value:m,children:t})};function m9(){return new Map}function WC(t=!0){const e=g.useContext(bm);if(e===null)return[!0,null];const{isPresent:n,onExitComplete:s,register:r}=e,i=g.useId();g.useEffect(()=>{if(t)return r(i)},[t]);const o=g.useCallback(()=>t&&s&&s(i),[i,s,t]);return!n&&s?[!1,o]:[!0]}const Hd=t=>t.key||"";function HN(t){const e=[];return g.Children.forEach(t,n=>{g.isValidElement(n)&&e.push(n)}),e}const p9=({children:t,custom:e,initial:n=!0,onExitComplete:s,presenceAffectsLayout:r=!0,mode:i="sync",propagate:o=!1,anchorX:l="left",root:c})=>{const[u,h]=WC(o),f=g.useMemo(()=>HN(t),[t]),m=o&&!u?[]:f.map(Hd),x=g.useRef(!0),b=g.useRef(f),N=nd(()=>new Map),[E,w]=g.useState(f),[v,T]=g.useState(f);Z0(()=>{x.current=!1,b.current=f;for(let V=0;V<v.length;V++){const j=Hd(v[V]);m.includes(j)?N.delete(j):N.get(j)!==!0&&N.set(j,!1)}},[v,m.length,m.join("-")]);const I=[];if(f!==E){let V=[...f];for(let j=0;j<v.length;j++){const y=v[j],k=Hd(y);m.includes(k)||(V.splice(j,0,y),I.push(y))}return i==="wait"&&I.length&&(V=I),T(HN(V)),w(f),null}const{forceRender:R}=g.useContext(X0);return a.jsx(a.Fragment,{children:v.map(V=>{const j=Hd(V),y=o&&!u?!1:f===v||m.includes(j),k=()=>{if(N.has(j))N.set(j,!0);else return;let S=!0;N.forEach(D=>{D||(S=!1)}),S&&(R==null||R(),T(b.current),o&&(h==null||h()),s&&s())};return a.jsx(f9,{isPresent:y,initial:!x.current||n?void 0:!1,custom:e,presenceAffectsLayout:r,mode:i,root:c,onExitComplete:y?void 0:k,anchorX:l,children:V},j)})})},GC=g.createContext({strict:!1}),KN={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},yl={};for(const t in KN)yl[t]={isEnabled:e=>KN[t].some(n=>!!e[n])};function g9(t){for(const e in t)yl[e]={...yl[e],...t[e]}}const x9=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Sf(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||x9.has(t)}let HC=t=>!Sf(t);function y9(t){typeof t=="function"&&(HC=e=>e.startsWith("on")?!Sf(e):t(e))}try{y9(require("@emotion/is-prop-valid").default)}catch{}function v9(t,e,n){const s={};for(const r in t)r==="values"&&typeof t.values=="object"||(HC(r)||n===!0&&Sf(r)||!e&&!Sf(r)||t.draggable&&r.startsWith("onDrag"))&&(s[r]=t[r]);return s}const _m=g.createContext({});function Nm(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Eu(t){return typeof t=="string"||Array.isArray(t)}const wv=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],_v=["initial",...wv];function Em(t){return Nm(t.animate)||_v.some(e=>Eu(t[e]))}function KC(t){return!!(Em(t)||t.variants)}function b9(t,e){if(Em(t)){const{initial:n,animate:s}=t;return{initial:n===!1||Eu(n)?n:void 0,animate:Eu(s)?s:void 0}}return t.inherit!==!1?e:{}}function w9(t){const{initial:e,animate:n}=b9(t,g.useContext(_m));return g.useMemo(()=>({initial:e,animate:n}),[QN(e),QN(n)])}function QN(t){return Array.isArray(t)?t.join(" "):t}const Tu={};function _9(t){for(const e in t)Tu[e]=t[e],ov(e)&&(Tu[e].isCSSVariable=!0)}function QC(t,{layout:e,layoutId:n}){return Dl.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!Tu[t]||t==="opacity")}const N9={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},E9=Pl.length;function T9(t,e,n){let s="",r=!0;for(let i=0;i<E9;i++){const o=Pl[i],l=t[o];if(l===void 0)continue;let c=!0;if(typeof l=="number"?c=l===(o.startsWith("scale")?1:0):c=parseFloat(l)===0,!c||n){const u=FC(l,yv[o]);if(!c){r=!1;const h=N9[o]||o;s+=`${h}(${u}) `}n&&(e[o]=u)}}return s=s.trim(),n?s=n(e,r?"":s):r&&(s="none"),s}function Nv(t,e,n){const{style:s,vars:r,transformOrigin:i}=t;let o=!1,l=!1;for(const c in e){const u=e[c];if(Dl.has(c)){o=!0;continue}else if(ov(c)){r[c]=u;continue}else{const h=FC(u,yv[c]);c.startsWith("origin")?(l=!0,i[c]=h):s[c]=h}}if(e.transform||(o||n?s.transform=T9(e,t.transform,n):s.transform&&(s.transform="none")),l){const{originX:c="50%",originY:u="50%",originZ:h=0}=i;s.transformOrigin=`${c} ${u} ${h}`}}const Ev=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function YC(t,e,n){for(const s in e)!In(e[s])&&!QC(s,n)&&(t[s]=e[s])}function S9({transformTemplate:t},e){return g.useMemo(()=>{const n=Ev();return Nv(n,e,t),Object.assign({},n.vars,n.style)},[e])}function j9(t,e){const n=t.style||{},s={};return YC(s,n,t),Object.assign(s,S9(t,e)),s}function k9(t,e){const n={},s=j9(t,e);return t.drag&&t.dragListener!==!1&&(n.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(n.tabIndex=0),n.style=s,n}const I9={offset:"stroke-dashoffset",array:"stroke-dasharray"},C9={offset:"strokeDashoffset",array:"strokeDasharray"};function A9(t,e,n=1,s=0,r=!0){t.pathLength=1;const i=r?I9:C9;t[i.offset]=Pe.transform(-s);const o=Pe.transform(e),l=Pe.transform(n);t[i.array]=`${o} ${l}`}function XC(t,{attrX:e,attrY:n,attrScale:s,pathLength:r,pathSpacing:i=1,pathOffset:o=0,...l},c,u,h){if(Nv(t,l,u),c){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:f,style:m}=t;f.transform&&(m.transform=f.transform,delete f.transform),(m.transform||f.transformOrigin)&&(m.transformOrigin=f.transformOrigin??"50% 50%",delete f.transformOrigin),m.transform&&(m.transformBox=(h==null?void 0:h.transformBox)??"fill-box",delete f.transformBox),e!==void 0&&(f.x=e),n!==void 0&&(f.y=n),s!==void 0&&(f.scale=s),r!==void 0&&A9(f,r,i,o,!1)}const JC=()=>({...Ev(),attrs:{}}),ZC=t=>typeof t=="string"&&t.toLowerCase()==="svg";function R9(t,e,n,s){const r=g.useMemo(()=>{const i=JC();return XC(i,e,ZC(s),t.transformTemplate,t.style),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};YC(i,t.style,t),r.style={...i,...r.style}}return r}const P9=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Tv(t){return typeof t!="string"||t.includes("-")?!1:!!(P9.indexOf(t)>-1||/[A-Z]/u.test(t))}function D9(t,e,n,{latestValues:s},r,i=!1){const l=(Tv(t)?R9:k9)(e,s,r,t),c=v9(e,typeof t=="string",i),u=t!==g.Fragment?{...c,...l,ref:n}:{},{children:h}=e,f=g.useMemo(()=>In(h)?h.get():h,[h]);return g.createElement(t,{...u,children:f})}function YN(t){const e=[{},{}];return t==null||t.values.forEach((n,s)=>{e[0][s]=n.get(),e[1][s]=n.getVelocity()}),e}function Sv(t,e,n,s){if(typeof e=="function"){const[r,i]=YN(s);e=e(n!==void 0?n:t.custom,r,i)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[r,i]=YN(s);e=e(n!==void 0?n:t.custom,r,i)}return e}function Nh(t){return In(t)?t.get():t}function V9({scrapeMotionValuesFromProps:t,createRenderState:e},n,s,r){return{latestValues:M9(n,s,r,t),renderState:e()}}function M9(t,e,n,s){const r={},i=s(t,{});for(const m in i)r[m]=Nh(i[m]);let{initial:o,animate:l}=t;const c=Em(t),u=KC(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let h=n?n.initial===!1:!1;h=h||o===!1;const f=h?l:o;if(f&&typeof f!="boolean"&&!Nm(f)){const m=Array.isArray(f)?f:[f];for(let x=0;x<m.length;x++){const b=Sv(t,m[x]);if(b){const{transitionEnd:N,transition:E,...w}=b;for(const v in w){let T=w[v];if(Array.isArray(T)){const I=h?T.length-1:0;T=T[I]}T!==null&&(r[v]=T)}for(const v in N)r[v]=N[v]}}}return r}const eA=t=>(e,n)=>{const s=g.useContext(_m),r=g.useContext(bm),i=()=>V9(t,e,s,r);return n?i():nd(i)};function jv(t,e,n){var i;const{style:s}=t,r={};for(const o in s)(In(s[o])||e.style&&In(e.style[o])||QC(o,t)||((i=n==null?void 0:n.getValue(o))==null?void 0:i.liveStyle)!==void 0)&&(r[o]=s[o]);return r}const L9=eA({scrapeMotionValuesFromProps:jv,createRenderState:Ev});function tA(t,e,n){const s=jv(t,e,n);for(const r in t)if(In(t[r])||In(e[r])){const i=Pl.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;s[i]=t[r]}return s}const O9=eA({scrapeMotionValuesFromProps:tA,createRenderState:JC}),F9=Symbol.for("motionComponentSymbol");function Vo(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function U9(t,e,n){return g.useCallback(s=>{s&&t.onMount&&t.onMount(s),e&&(s?e.mount(s):e.unmount()),n&&(typeof n=="function"?n(s):Vo(n)&&(n.current=s))},[e])}const kv=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),B9="framerAppearId",nA="data-"+kv(B9),sA=g.createContext({});function $9(t,e,n,s,r){var N,E;const{visualElement:i}=g.useContext(_m),o=g.useContext(GC),l=g.useContext(bm),c=g.useContext(wm).reducedMotion,u=g.useRef(null);s=s||o.renderer,!u.current&&s&&(u.current=s(t,{visualState:e,parent:i,props:n,presenceContext:l,blockInitialAnimation:l?l.initial===!1:!1,reducedMotionConfig:c}));const h=u.current,f=g.useContext(sA);h&&!h.projection&&r&&(h.type==="html"||h.type==="svg")&&z9(u.current,n,r,f);const m=g.useRef(!1);g.useInsertionEffect(()=>{h&&m.current&&h.update(n,l)});const x=n[nA],b=g.useRef(!!x&&!((N=window.MotionHandoffIsComplete)!=null&&N.call(window,x))&&((E=window.MotionHasOptimisedAnimation)==null?void 0:E.call(window,x)));return Z0(()=>{h&&(m.current=!0,window.MotionIsMounted=!0,h.updateFeatures(),h.scheduleRenderMicrotask(),b.current&&h.animationState&&h.animationState.animateChanges())}),g.useEffect(()=>{h&&(!b.current&&h.animationState&&h.animationState.animateChanges(),b.current&&(queueMicrotask(()=>{var w;(w=window.MotionHandoffMarkAsComplete)==null||w.call(window,x)}),b.current=!1),h.enteringChildren=void 0)}),h}function z9(t,e,n,s){const{layoutId:r,layout:i,drag:o,dragConstraints:l,layoutScroll:c,layoutRoot:u,layoutCrossfade:h}=e;t.projection=new n(t.latestValues,e["data-framer-portal-id"]?void 0:rA(t.parent)),t.projection.setOptions({layoutId:r,layout:i,alwaysMeasureLayout:!!o||l&&Vo(l),visualElement:t,animationType:typeof i=="string"?i:"both",initialPromotionConfig:s,crossfade:h,layoutScroll:c,layoutRoot:u})}function rA(t){if(t)return t.options.allowProjection!==!1?t.projection:rA(t.parent)}function jp(t,{forwardMotionProps:e=!1}={},n,s){n&&g9(n);const r=Tv(t)?O9:L9;function i(l,c){let u;const h={...g.useContext(wm),...l,layoutId:q9(l)},{isStatic:f}=h,m=w9(l),x=r(l,f);if(!f&&J0){W9();const b=G9(h);u=b.MeasureLayout,m.visualElement=$9(t,x,h,s,b.ProjectionNode)}return a.jsxs(_m.Provider,{value:m,children:[u&&m.visualElement?a.jsx(u,{visualElement:m.visualElement,...h}):null,D9(t,l,U9(x,m.visualElement,c),x,f,e)]})}i.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const o=g.forwardRef(i);return o[F9]=t,o}function q9({layoutId:t}){const e=g.useContext(X0).id;return e&&t!==void 0?e+"-"+t:t}function W9(t,e){g.useContext(GC).strict}function G9(t){const{drag:e,layout:n}=yl;if(!e&&!n)return{};const s={...e,...n};return{MeasureLayout:e!=null&&e.isEnabled(t)||n!=null&&n.isEnabled(t)?s.MeasureLayout:void 0,ProjectionNode:s.ProjectionNode}}function H9(t,e){if(typeof Proxy>"u")return jp;const n=new Map,s=(i,o)=>jp(i,o,t,e),r=(i,o)=>s(i,o);return new Proxy(r,{get:(i,o)=>o==="create"?s:(n.has(o)||n.set(o,jp(o,void 0,t,e)),n.get(o))})}function iA({top:t,left:e,right:n,bottom:s}){return{x:{min:e,max:n},y:{min:t,max:s}}}function K9({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function Q9(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),s=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:s.y,right:s.x}}function kp(t){return t===void 0||t===1}function jx({scale:t,scaleX:e,scaleY:n}){return!kp(t)||!kp(e)||!kp(n)}function la(t){return jx(t)||aA(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function aA(t){return XN(t.x)||XN(t.y)}function XN(t){return t&&t!=="0%"}function jf(t,e,n){const s=t-n,r=e*s;return n+r}function JN(t,e,n,s,r){return r!==void 0&&(t=jf(t,r,s)),jf(t,n,s)+e}function kx(t,e=0,n=1,s,r){t.min=JN(t.min,e,n,s,r),t.max=JN(t.max,e,n,s,r)}function oA(t,{x:e,y:n}){kx(t.x,e.translate,e.scale,e.originPoint),kx(t.y,n.translate,n.scale,n.originPoint)}const ZN=.999999999999,eE=1.0000000000001;function Y9(t,e,n,s=!1){const r=n.length;if(!r)return;e.x=e.y=1;let i,o;for(let l=0;l<r;l++){i=n[l],o=i.projectionDelta;const{visualElement:c}=i.options;c&&c.props.style&&c.props.style.display==="contents"||(s&&i.options.layoutScroll&&i.scroll&&i!==i.root&&Lo(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,oA(t,o)),s&&la(i.latestValues)&&Lo(t,i.latestValues))}e.x<eE&&e.x>ZN&&(e.x=1),e.y<eE&&e.y>ZN&&(e.y=1)}function Mo(t,e){t.min=t.min+e,t.max=t.max+e}function tE(t,e,n,s,r=.5){const i=It(t.min,t.max,r);kx(t,e,n,i,s)}function Lo(t,e){tE(t.x,e.x,e.scaleX,e.scale,e.originX),tE(t.y,e.y,e.scaleY,e.scale,e.originY)}function lA(t,e){return iA(Q9(t.getBoundingClientRect(),e))}function X9(t,e,n){const s=lA(t,n),{scroll:r}=e;return r&&(Mo(s.x,r.offset.x),Mo(s.y,r.offset.y)),s}const nE=()=>({translate:0,scale:1,origin:0,originPoint:0}),Oo=()=>({x:nE(),y:nE()}),sE=()=>({min:0,max:0}),Xt=()=>({x:sE(),y:sE()}),Ix={current:null},cA={current:!1};function J9(){if(cA.current=!0,!!J0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Ix.current=t.matches;t.addEventListener("change",e),e()}else Ix.current=!1}const Z9=new WeakMap;function ez(t,e,n){for(const s in e){const r=e[s],i=n[s];if(In(r))t.addValue(s,r);else if(In(i))t.addValue(s,Wa(r,{owner:t}));else if(i!==r)if(t.hasValue(s)){const o=t.getValue(s);o.liveStyle===!0?o.jump(r):o.hasAnimated||o.set(r)}else{const o=t.getStaticValue(s);t.addValue(s,Wa(o!==void 0?o:r,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const rE=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class tz{scrapeMotionValuesFromProps(e,n,s){return{}}constructor({parent:e,props:n,presenceContext:s,reducedMotionConfig:r,blockInitialAnimation:i,visualState:o},l={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=gv,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=es.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,xt.render(this.render,!1,!0))};const{latestValues:c,renderState:u}=o;this.latestValues=c,this.baseTarget={...c},this.initialValues=n.initial?{...c}:{},this.renderState=u,this.parent=e,this.props=n,this.presenceContext=s,this.depth=e?e.depth+1:0,this.reducedMotionConfig=r,this.options=l,this.blockInitialAnimation=!!i,this.isControllingVariants=Em(n),this.isVariantNode=KC(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:h,...f}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in f){const x=f[m];c[m]!==void 0&&In(x)&&x.set(c[m])}}mount(e){var n;this.current=e,Z9.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((s,r)=>this.bindToMotionValue(r,s)),cA.current||J9(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Ix.current,(n=this.parent)==null||n.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var e;this.projection&&this.projection.unmount(),zr(this.notifyUpdate),zr(this.render),this.valueSubscriptions.forEach(n=>n()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(e=this.parent)==null||e.removeChild(this);for(const n in this.events)this.events[n].clear();for(const n in this.features){const s=this.features[n];s&&(s.unmount(),s.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,n){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const s=Dl.has(e);s&&this.onBindTransform&&this.onBindTransform();const r=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&xt.preRender(this.notifyUpdate),s&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let i;window.MotionCheckAppearSync&&(i=window.MotionCheckAppearSync(this,e,n)),this.valueSubscriptions.set(e,()=>{r(),i&&i(),n.owner&&n.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in yl){const n=yl[e];if(!n)continue;const{isEnabled:s,Feature:r}=n;if(!this.features[e]&&r&&s(this.props)&&(this.features[e]=new r(this)),this.features[e]){const i=this.features[e];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Xt()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let s=0;s<rE.length;s++){const r=rE[s];this.propEventSubscriptions[r]&&(this.propEventSubscriptions[r](),delete this.propEventSubscriptions[r]);const i="on"+r,o=e[i];o&&(this.propEventSubscriptions[r]=this.on(r,o))}this.prevMotionValues=ez(this,this.scrapeMotionValuesFromProps(e,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){const s=this.values.get(e);n!==s&&(s&&this.removeValue(e),this.bindToMotionValue(e,n),this.values.set(e,n),this.latestValues[e]=n.get())}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let s=this.values.get(e);return s===void 0&&n!==void 0&&(s=Wa(n===null?void 0:n,{owner:this}),this.addValue(e,s)),s}readValue(e,n){let s=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return s!=null&&(typeof s=="string"&&(eC(s)||nC(s))?s=parseFloat(s):!l9(s)&&Fi.test(n)&&(s=OC(e,n)),this.setBaseTarget(e,In(s)?s.get():s)),In(s)?s.get():s}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var i;const{initial:n}=this.props;let s;if(typeof n=="string"||typeof n=="object"){const o=Sv(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);o&&(s=o[e])}if(n&&s!==void 0)return s;const r=this.getBaseTargetFromProps(this.props,e);return r!==void 0&&!In(r)?r:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new rv),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}scheduleRenderMicrotask(){vv.render(this.render)}}class uA extends tz{constructor(){super(...arguments),this.KeyframeResolver=Q$}sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:s}){delete n[e],delete s[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;In(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function dA(t,{style:e,vars:n},s,r){const i=t.style;let o;for(o in e)i[o]=e[o];r==null||r.applyProjectionStyles(i,s);for(o in n)i.setProperty(o,n[o])}function nz(t){return window.getComputedStyle(t)}class sz extends uA{constructor(){super(...arguments),this.type="html",this.renderInstance=dA}readValueFromInstance(e,n){var s;if(Dl.has(n))return(s=this.projection)!=null&&s.isProjecting?bx(n):m$(e,n);{const r=nz(e),i=(ov(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(e,{transformPagePoint:n}){return lA(e,n)}build(e,n,s){Nv(e,n,s.transformTemplate)}scrapeMotionValuesFromProps(e,n,s){return jv(e,n,s)}}const hA=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function rz(t,e,n,s){dA(t,e,void 0,s);for(const r in e.attrs)t.setAttribute(hA.has(r)?r:kv(r),e.attrs[r])}class iz extends uA{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Xt}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(Dl.has(n)){const s=LC(n);return s&&s.default||0}return n=hA.has(n)?n:kv(n),e.getAttribute(n)}scrapeMotionValuesFromProps(e,n,s){return tA(e,n,s)}build(e,n,s){XC(e,n,this.isSVGTag,s.transformTemplate,s.style)}renderInstance(e,n,s,r){rz(e,n,s,r)}mount(e){this.isSVGTag=ZC(e.tagName),super.mount(e)}}const az=(t,e)=>Tv(t)?new iz(e):new sz(e,{allowProjection:t!==g.Fragment});function Yo(t,e,n){const s=t.getProps();return Sv(s,e,n!==void 0?n:s.custom,t)}const Cx=t=>Array.isArray(t);function oz(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Wa(n))}function lz(t){return Cx(t)?t[t.length-1]||0:t}function cz(t,e){const n=Yo(t,e);let{transitionEnd:s={},transition:r={},...i}=n||{};i={...i,...s};for(const o in i){const l=lz(i[o]);oz(t,o,l)}}function uz(t){return!!(In(t)&&t.add)}function Ax(t,e){const n=t.getValue("willChange");if(uz(n))return n.add(e);if(!n&&$r.WillChange){const s=new $r.WillChange("auto");t.addValue("willChange",s),s.add(e)}}function fA(t){return t.props[nA]}const dz=t=>t!==null;function hz(t,{repeat:e,repeatType:n="loop"},s){const r=t.filter(dz),i=e&&n!=="loop"&&e%2===1?0:r.length-1;return r[i]}const fz={type:"spring",stiffness:500,damping:25,restSpeed:10},mz=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),pz={type:"keyframes",duration:.8},gz={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},xz=(t,{keyframes:e})=>e.length>2?pz:Dl.has(t)?t.startsWith("scale")?mz(e[1]):fz:gz;function yz({when:t,delay:e,delayChildren:n,staggerChildren:s,staggerDirection:r,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...h}){return!!Object.keys(h).length}const Iv=(t,e,n,s={},r,i)=>o=>{const l=xv(s,t)||{},c=l.delay||s.delay||0;let{elapsed:u=0}=s;u=u-ur(c);const h={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:e.getVelocity(),...l,delay:-u,onUpdate:m=>{e.set(m),l.onUpdate&&l.onUpdate(m)},onComplete:()=>{o(),l.onComplete&&l.onComplete()},name:t,motionValue:e,element:i?void 0:r};yz(l)||Object.assign(h,xz(t,h)),h.duration&&(h.duration=ur(h.duration)),h.repeatDelay&&(h.repeatDelay=ur(h.repeatDelay)),h.from!==void 0&&(h.keyframes[0]=h.from);let f=!1;if((h.type===!1||h.duration===0&&!h.repeatDelay)&&(Tx(h),h.delay===0&&(f=!0)),($r.instantAnimations||$r.skipAnimations)&&(f=!0,Tx(h),h.delay=0),h.allowFlatten=!l.type&&!l.ease,f&&!i&&e.get()!==void 0){const m=hz(h.keyframes,l);if(m!==void 0){xt.update(()=>{h.onUpdate(m),h.onComplete()});return}}return l.isSync?new pv(h):new L$(h)};function vz({protectedKeys:t,needsAnimating:e},n){const s=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,s}function mA(t,e,{delay:n=0,transitionOverride:s,type:r}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=e;s&&(i=s);const c=[],u=r&&t.animationState&&t.animationState.getState()[r];for(const h in l){const f=t.getValue(h,t.latestValues[h]??null),m=l[h];if(m===void 0||u&&vz(u,h))continue;const x={delay:n,...xv(i||{},h)},b=f.get();if(b!==void 0&&!f.isAnimating&&!Array.isArray(m)&&m===b&&!x.velocity)continue;let N=!1;if(window.MotionHandoffAnimation){const w=fA(t);if(w){const v=window.MotionHandoffAnimation(w,h,xt);v!==null&&(x.startTime=v,N=!0)}}Ax(t,h),f.start(Iv(h,f,m,t.shouldReduceMotion&&DC.has(h)?{type:!1}:x,t,N));const E=f.animation;E&&c.push(E)}return o&&Promise.all(c).then(()=>{xt.update(()=>{o&&cz(t,o)})}),c}function pA(t,e,n,s=0,r=1){const i=Array.from(t).sort((u,h)=>u.sortNodePosition(h)).indexOf(e),o=t.size,l=(o-1)*s;return typeof n=="function"?n(i,o):r===1?i*s:l-i*s}function Rx(t,e,n={}){var c;const s=Yo(t,e,n.type==="exit"?(c=t.presenceContext)==null?void 0:c.custom:void 0);let{transition:r=t.getDefaultTransition()||{}}=s||{};n.transitionOverride&&(r=n.transitionOverride);const i=s?()=>Promise.all(mA(t,s,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(u=0)=>{const{delayChildren:h=0,staggerChildren:f,staggerDirection:m}=r;return bz(t,e,u,h,f,m,n)}:()=>Promise.resolve(),{when:l}=r;if(l){const[u,h]=l==="beforeChildren"?[i,o]:[o,i];return u().then(()=>h())}else return Promise.all([i(),o(n.delay)])}function bz(t,e,n=0,s=0,r=0,i=1,o){const l=[];for(const c of t.variantChildren)c.notify("AnimationStart",e),l.push(Rx(c,e,{...o,delay:n+(typeof s=="function"?0:s)+pA(t.variantChildren,c,s,r,i)}).then(()=>c.notify("AnimationComplete",e)));return Promise.all(l)}function wz(t,e,n={}){t.notify("AnimationStart",e);let s;if(Array.isArray(e)){const r=e.map(i=>Rx(t,i,n));s=Promise.all(r)}else if(typeof e=="string")s=Rx(t,e,n);else{const r=typeof e=="function"?Yo(t,e,n.custom):e;s=Promise.all(mA(t,r,n))}return s.then(()=>{t.notify("AnimationComplete",e)})}function gA(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let s=0;s<n;s++)if(e[s]!==t[s])return!1;return!0}const _z=_v.length;function xA(t){if(!t)return;if(!t.isControllingVariants){const n=t.parent?xA(t.parent)||{}:{};return t.props.initial!==void 0&&(n.initial=t.props.initial),n}const e={};for(let n=0;n<_z;n++){const s=_v[n],r=t.props[s];(Eu(r)||r===!1)&&(e[s]=r)}return e}const Nz=[...wv].reverse(),Ez=wv.length;function Tz(t){return e=>Promise.all(e.map(({animation:n,options:s})=>wz(t,n,s)))}function Sz(t){let e=Tz(t),n=iE(),s=!0;const r=c=>(u,h)=>{var m;const f=Yo(t,h,c==="exit"?(m=t.presenceContext)==null?void 0:m.custom:void 0);if(f){const{transition:x,transitionEnd:b,...N}=f;u={...u,...N,...b}}return u};function i(c){e=c(t)}function o(c){const{props:u}=t,h=xA(t.parent)||{},f=[],m=new Set;let x={},b=1/0;for(let E=0;E<Ez;E++){const w=Nz[E],v=n[w],T=u[w]!==void 0?u[w]:h[w],I=Eu(T),R=w===c?v.isActive:null;R===!1&&(b=E);let V=T===h[w]&&T!==u[w]&&I;if(V&&s&&t.manuallyAnimateOnMount&&(V=!1),v.protectedKeys={...x},!v.isActive&&R===null||!T&&!v.prevProp||Nm(T)||typeof T=="boolean")continue;const j=jz(v.prevProp,T);let y=j||w===c&&v.isActive&&!V&&I||E>b&&I,k=!1;const S=Array.isArray(T)?T:[T];let D=S.reduce(r(w),{});R===!1&&(D={});const{prevResolvedValues:P={}}=v,C={...P,...D},q=fe=>{y=!0,m.has(fe)&&(k=!0,m.delete(fe)),v.needsAnimating[fe]=!0;const K=t.getValue(fe);K&&(K.liveStyle=!1)};for(const fe in C){const K=D[fe],se=P[fe];if(x.hasOwnProperty(fe))continue;let ne=!1;Cx(K)&&Cx(se)?ne=!gA(K,se):ne=K!==se,ne?K!=null?q(fe):m.add(fe):K!==void 0&&m.has(fe)?q(fe):v.protectedKeys[fe]=!0}v.prevProp=T,v.prevResolvedValues=D,v.isActive&&(x={...x,...D}),s&&t.blockInitialAnimation&&(y=!1);const ue=V&&j;y&&(!ue||k)&&f.push(...S.map(fe=>{const K={type:w};if(typeof fe=="string"&&s&&!ue&&t.manuallyAnimateOnMount&&t.parent){const{parent:se}=t,ne=Yo(se,fe);if(se.enteringChildren&&ne){const{delayChildren:F}=ne.transition||{};K.delay=pA(se.enteringChildren,t,F)}}return{animation:fe,options:K}}))}if(m.size){const E={};if(typeof u.initial!="boolean"){const w=Yo(t,Array.isArray(u.initial)?u.initial[0]:u.initial);w&&w.transition&&(E.transition=w.transition)}m.forEach(w=>{const v=t.getBaseTarget(w),T=t.getValue(w);T&&(T.liveStyle=!0),E[w]=v??null}),f.push({animation:E})}let N=!!f.length;return s&&(u.initial===!1||u.initial===u.animate)&&!t.manuallyAnimateOnMount&&(N=!1),s=!1,N?e(f):Promise.resolve()}function l(c,u){var f;if(n[c].isActive===u)return Promise.resolve();(f=t.variantChildren)==null||f.forEach(m=>{var x;return(x=m.animationState)==null?void 0:x.setActive(c,u)}),n[c].isActive=u;const h=o(c);for(const m in n)n[m].protectedKeys={};return h}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n,reset:()=>{n=iE()}}}function jz(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!gA(e,t):!1}function sa(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function iE(){return{animate:sa(!0),whileInView:sa(),whileHover:sa(),whileTap:sa(),whileDrag:sa(),whileFocus:sa(),exit:sa()}}class Qi{constructor(e){this.isMounted=!1,this.node=e}update(){}}class kz extends Qi{constructor(e){super(e),e.animationState||(e.animationState=Sz(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Nm(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){var e;this.node.animationState.reset(),(e=this.unmountControls)==null||e.call(this)}}let Iz=0;class Cz extends Qi{constructor(){super(...arguments),this.id=Iz++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const r=this.node.animationState.setActive("exit",!e);n&&!e&&r.then(()=>{n(this.id)})}mount(){const{register:e,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const Az={animation:{Feature:kz},exit:{Feature:Cz}};function Su(t,e,n,s={passive:!0}){return t.addEventListener(e,n,s),()=>t.removeEventListener(e,n)}function ad(t){return{point:{x:t.pageX,y:t.pageY}}}const Rz=t=>e=>bv(e)&&t(e,ad(e));function Bc(t,e,n,s){return Su(t,e,Rz(n),s)}const yA=1e-4,Pz=1-yA,Dz=1+yA,vA=.01,Vz=0-vA,Mz=0+vA;function On(t){return t.max-t.min}function Lz(t,e,n){return Math.abs(t-e)<=n}function aE(t,e,n,s=.5){t.origin=s,t.originPoint=It(e.min,e.max,t.origin),t.scale=On(n)/On(e),t.translate=It(n.min,n.max,t.origin)-t.originPoint,(t.scale>=Pz&&t.scale<=Dz||isNaN(t.scale))&&(t.scale=1),(t.translate>=Vz&&t.translate<=Mz||isNaN(t.translate))&&(t.translate=0)}function $c(t,e,n,s){aE(t.x,e.x,n.x,s?s.originX:void 0),aE(t.y,e.y,n.y,s?s.originY:void 0)}function oE(t,e,n){t.min=n.min+e.min,t.max=t.min+On(e)}function Oz(t,e,n){oE(t.x,e.x,n.x),oE(t.y,e.y,n.y)}function lE(t,e,n){t.min=e.min-n.min,t.max=t.min+On(e)}function kf(t,e,n){lE(t.x,e.x,n.x),lE(t.y,e.y,n.y)}function Ns(t){return[t("x"),t("y")]}const bA=({current:t})=>t?t.ownerDocument.defaultView:null,cE=(t,e)=>Math.abs(t-e);function Fz(t,e){const n=cE(t.x,e.x),s=cE(t.y,e.y);return Math.sqrt(n**2+s**2)}class wA{constructor(e,n,{transformPagePoint:s,contextWindow:r=window,dragSnapToOrigin:i=!1,distanceThreshold:o=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const m=Cp(this.lastMoveEventInfo,this.history),x=this.startEvent!==null,b=Fz(m.offset,{x:0,y:0})>=this.distanceThreshold;if(!x&&!b)return;const{point:N}=m,{timestamp:E}=mn;this.history.push({...N,timestamp:E});const{onStart:w,onMove:v}=this.handlers;x||(w&&w(this.lastMoveEvent,m),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,m)},this.handlePointerMove=(m,x)=>{this.lastMoveEvent=m,this.lastMoveEventInfo=Ip(x,this.transformPagePoint),xt.update(this.updatePoint,!0)},this.handlePointerUp=(m,x)=>{this.end();const{onEnd:b,onSessionEnd:N,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Cp(m.type==="pointercancel"?this.lastMoveEventInfo:Ip(x,this.transformPagePoint),this.history);this.startEvent&&b&&b(m,w),N&&N(m,w)},!bv(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=s,this.distanceThreshold=o,this.contextWindow=r||window;const l=ad(e),c=Ip(l,this.transformPagePoint),{point:u}=c,{timestamp:h}=mn;this.history=[{...u,timestamp:h}];const{onSessionStart:f}=n;f&&f(e,Cp(c,this.history)),this.removeListeners=sd(Bc(this.contextWindow,"pointermove",this.handlePointerMove),Bc(this.contextWindow,"pointerup",this.handlePointerUp),Bc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),zr(this.updatePoint)}}function Ip(t,e){return e?{point:e(t.point)}:t}function uE(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Cp({point:t},e){return{point:t,delta:uE(t,_A(e)),offset:uE(t,Uz(e)),velocity:Bz(e,.1)}}function Uz(t){return t[0]}function _A(t){return t[t.length-1]}function Bz(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,s=null;const r=_A(t);for(;n>=0&&(s=t[n],!(r.timestamp-s.timestamp>ur(e)));)n--;if(!s)return{x:0,y:0};const i=js(r.timestamp-s.timestamp);if(i===0)return{x:0,y:0};const o={x:(r.x-s.x)/i,y:(r.y-s.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function $z(t,{min:e,max:n},s){return e!==void 0&&t<e?t=s?It(e,t,s.min):Math.max(t,e):n!==void 0&&t>n&&(t=s?It(n,t,s.max):Math.min(t,n)),t}function dE(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function zz(t,{top:e,left:n,bottom:s,right:r}){return{x:dE(t.x,n,r),y:dE(t.y,e,s)}}function hE(t,e){let n=e.min-t.min,s=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,s]=[s,n]),{min:n,max:s}}function qz(t,e){return{x:hE(t.x,e.x),y:hE(t.y,e.y)}}function Wz(t,e){let n=.5;const s=On(t),r=On(e);return r>s?n=wu(e.min,e.max-s,t.min):s>r&&(n=wu(t.min,t.max-r,e.min)),Br(0,1,n)}function Gz(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const Px=.35;function Hz(t=Px){return t===!1?t=0:t===!0&&(t=Px),{x:fE(t,"left","right"),y:fE(t,"top","bottom")}}function fE(t,e,n){return{min:mE(t,e),max:mE(t,n)}}function mE(t,e){return typeof t=="number"?t:t[e]||0}const Kz=new WeakMap;class Qz{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Xt(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:n=!1,distanceThreshold:s}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=f=>{const{dragSnapToOrigin:m}=this.getProps();m?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(ad(f).point)},o=(f,m)=>{const{drag:x,dragPropagation:b,onDragStart:N}=this.getProps();if(x&&!b&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Z$(x),!this.openDragLock))return;this.latestPointerEvent=f,this.latestPanInfo=m,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ns(w=>{let v=this.getAxisMotionValue(w).get()||0;if(dr.test(v)){const{projection:T}=this.visualElement;if(T&&T.layout){const I=T.layout.layoutBox[w];I&&(v=On(I)*(parseFloat(v)/100))}}this.originPoint[w]=v}),N&&xt.postRender(()=>N(f,m)),Ax(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},l=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m;const{dragPropagation:x,dragDirectionLock:b,onDirectionLock:N,onDrag:E}=this.getProps();if(!x&&!this.openDragLock)return;const{offset:w}=m;if(b&&this.currentDirection===null){this.currentDirection=Yz(w),this.currentDirection!==null&&N&&N(this.currentDirection);return}this.updateAxis("x",m.point,w),this.updateAxis("y",m.point,w),this.visualElement.render(),E&&E(f,m)},c=(f,m)=>{this.latestPointerEvent=f,this.latestPanInfo=m,this.stop(f,m),this.latestPointerEvent=null,this.latestPanInfo=null},u=()=>Ns(f=>{var m;return this.getAnimationState(f)==="paused"&&((m=this.getAxisMotionValue(f).animation)==null?void 0:m.play())}),{dragSnapToOrigin:h}=this.getProps();this.panSession=new wA(e,{onSessionStart:i,onStart:o,onMove:l,onSessionEnd:c,resumeAnimation:u},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:h,distanceThreshold:s,contextWindow:bA(this.visualElement)})}stop(e,n){const s=e||this.latestPointerEvent,r=n||this.latestPanInfo,i=this.isDragging;if(this.cancel(),!i||!r||!s)return;const{velocity:o}=r;this.startAnimation(o);const{onDragEnd:l}=this.getProps();l&&xt.postRender(()=>l(s,r))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:s}=this.getProps();!s&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,s){const{drag:r}=this.getProps();if(!s||!Kd(e,r,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+s[e];this.constraints&&this.constraints[e]&&(o=$z(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var i;const{dragConstraints:e,dragElastic:n}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,r=this.constraints;e&&Vo(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&s?this.constraints=zz(s.layoutBox,e):this.constraints=!1,this.elastic=Hz(n),r!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Ns(o=>{this.constraints!==!1&&this.getAxisMotionValue(o)&&(this.constraints[o]=Gz(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!Vo(e))return!1;const s=e.current,{projection:r}=this.visualElement;if(!r||!r.layout)return!1;const i=X9(s,r.root,this.visualElement.getTransformPagePoint());let o=qz(r.layout.layoutBox,i);if(n){const l=n(K9(o));this.hasMutatedConstraints=!!l,l&&(o=iA(l))}return o}startAnimation(e){const{drag:n,dragMomentum:s,dragElastic:r,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Ns(h=>{if(!Kd(h,n,this.currentDirection))return;let f=c&&c[h]||{};o&&(f={min:0,max:0});const m=r?200:1e6,x=r?40:1e7,b={type:"inertia",velocity:s?e[h]:0,bounceStiffness:m,bounceDamping:x,timeConstant:750,restDelta:1,restSpeed:10,...i,...f};return this.startAxisValueAnimation(h,b)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const s=this.getAxisMotionValue(e);return Ax(this.visualElement,e),s.start(Iv(e,s,0,n,this.visualElement,!1))}stopAnimation(){Ns(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ns(e=>{var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)==null?void 0:n.state}getAxisMotionValue(e){const n=`_drag${e.toUpperCase()}`,s=this.visualElement.getProps(),r=s[n];return r||this.visualElement.getValue(e,(s.initial?s.initial[e]:void 0)||0)}snapToCursor(e){Ns(n=>{const{drag:s}=this.getProps();if(!Kd(n,s,this.currentDirection))return;const{projection:r}=this.visualElement,i=this.getAxisMotionValue(n);if(r&&r.layout){const{min:o,max:l}=r.layout.layoutBox[n];i.set(e[n]-It(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:s}=this.visualElement;if(!Vo(n)||!s||!this.constraints)return;this.stopAnimation();const r={x:0,y:0};Ns(o=>{const l=this.getAxisMotionValue(o);if(l&&this.constraints!==!1){const c=l.get();r[o]=Wz({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",s.root&&s.root.updateScroll(),s.updateLayout(),this.resolveConstraints(),Ns(o=>{if(!Kd(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(It(c,u,r[o]))})}addListeners(){if(!this.visualElement.current)return;Kz.set(this.visualElement,this);const e=this.visualElement.current,n=Bc(e,"pointerdown",c=>{const{drag:u,dragListener:h=!0}=this.getProps();u&&h&&this.start(c)}),s=()=>{const{dragConstraints:c}=this.getProps();Vo(c)&&c.current&&(this.constraints=this.resolveRefConstraints())},{projection:r}=this.visualElement,i=r.addEventListener("measure",s);r&&!r.layout&&(r.root&&r.root.updateScroll(),r.updateLayout()),xt.read(s);const o=Su(window,"resize",()=>this.scalePositionWithinConstraints()),l=r.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Ns(h=>{const f=this.getAxisMotionValue(h);f&&(this.originPoint[h]+=c[h].translate,f.set(f.get()+c[h].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:s=!1,dragPropagation:r=!1,dragConstraints:i=!1,dragElastic:o=Px,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:s,dragPropagation:r,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Kd(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Yz(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Xz extends Qi{constructor(e){super(e),this.removeGroupControls=Cs,this.removeListeners=Cs,this.controls=new Qz(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Cs}unmount(){this.removeGroupControls(),this.removeListeners()}}const pE=t=>(e,n)=>{t&&xt.postRender(()=>t(e,n))};class Jz extends Qi{constructor(){super(...arguments),this.removePointerDownListener=Cs}onPointerDown(e){this.session=new wA(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:bA(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:s,onPanEnd:r}=this.node.getProps();return{onSessionStart:pE(e),onStart:pE(n),onMove:s,onEnd:(i,o)=>{delete this.session,r&&xt.postRender(()=>r(i,o))}}}mount(){this.removePointerDownListener=Bc(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Eh={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function gE(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const lc={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Pe.test(t))t=parseFloat(t);else return t;const n=gE(t,e.target.x),s=gE(t,e.target.y);return`${n}% ${s}%`}},Zz={correct:(t,{treeScale:e,projectionDelta:n})=>{const s=t,r=Fi.parse(t);if(r.length>5)return s;const i=Fi.createTransformer(t),o=typeof r[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;r[0+o]/=l,r[1+o]/=c;const u=It(l,c,.5);return typeof r[2+o]=="number"&&(r[2+o]/=u),typeof r[3+o]=="number"&&(r[3+o]/=u),i(r)}};let Ap=!1;class e8 extends g.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s,layoutId:r}=this.props,{projection:i}=e;_9(t8),i&&(n.group&&n.group.add(i),s&&s.register&&r&&s.register(i),Ap&&i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),Eh.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:s,drag:r,isPresent:i}=this.props,{projection:o}=s;return o&&(o.isPresent=i,Ap=!0,r||e.layoutDependency!==n||n===void 0||e.isPresent!==i?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||xt.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),vv.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:s}=this.props,{projection:r}=e;Ap=!0,r&&(r.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(r),s&&s.deregister&&s.deregister(r))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function NA(t){const[e,n]=WC(),s=g.useContext(X0);return a.jsx(e8,{...t,layoutGroup:s,switchLayoutGroup:g.useContext(sA),isPresent:e,safeToRemove:n})}const t8={borderRadius:{...lc,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:lc,borderTopRightRadius:lc,borderBottomLeftRadius:lc,borderBottomRightRadius:lc,boxShadow:Zz};function n8(t,e,n){const s=In(t)?t:Wa(t);return s.start(Iv("",s,e,n)),s.animation}const s8=(t,e)=>t.depth-e.depth;class r8{constructor(){this.children=[],this.isDirty=!1}add(e){ev(this.children,e),this.isDirty=!0}remove(e){tv(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(s8),this.isDirty=!1,this.children.forEach(e)}}function i8(t,e){const n=es.now(),s=({timestamp:r})=>{const i=r-n;i>=e&&(zr(s),t(i-e))};return xt.setup(s,!0),()=>zr(s)}const EA=["TopLeft","TopRight","BottomLeft","BottomRight"],a8=EA.length,xE=t=>typeof t=="string"?parseFloat(t):t,yE=t=>typeof t=="number"||Pe.test(t);function o8(t,e,n,s,r,i){r?(t.opacity=It(0,n.opacity??1,l8(s)),t.opacityExit=It(e.opacity??1,0,c8(s))):i&&(t.opacity=It(e.opacity??1,n.opacity??1,s));for(let o=0;o<a8;o++){const l=`border${EA[o]}Radius`;let c=vE(e,l),u=vE(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||yE(c)===yE(u)?(t[l]=Math.max(It(xE(c),xE(u),s),0),(dr.test(u)||dr.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=It(e.rotate||0,n.rotate||0,s))}function vE(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const l8=TA(0,.5,uC),c8=TA(.5,.95,Cs);function TA(t,e,n){return s=>s<t?0:s>e?1:n(wu(t,e,s))}function bE(t,e){t.min=e.min,t.max=e.max}function Os(t,e){bE(t.x,e.x),bE(t.y,e.y)}function wE(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}function _E(t,e,n,s,r){return t-=e,t=jf(t,1/n,s),r!==void 0&&(t=jf(t,1/r,s)),t}function u8(t,e=0,n=1,s=.5,r,i=t,o=t){if(dr.test(e)&&(e=parseFloat(e),e=It(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=It(i.min,i.max,s);t===i&&(l-=e),t.min=_E(t.min,e,n,l,r),t.max=_E(t.max,e,n,l,r)}function NE(t,e,[n,s,r],i,o){u8(t,e[n],e[s],e[r],e.scale,i,o)}const d8=["x","scaleX","originX"],h8=["y","scaleY","originY"];function EE(t,e,n,s){NE(t.x,e,d8,n?n.x:void 0,s?s.x:void 0),NE(t.y,e,h8,n?n.y:void 0,s?s.y:void 0)}function TE(t){return t.translate===0&&t.scale===1}function SA(t){return TE(t.x)&&TE(t.y)}function SE(t,e){return t.min===e.min&&t.max===e.max}function f8(t,e){return SE(t.x,e.x)&&SE(t.y,e.y)}function jE(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function jA(t,e){return jE(t.x,e.x)&&jE(t.y,e.y)}function kE(t){return On(t.x)/On(t.y)}function IE(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}class m8{constructor(){this.members=[]}add(e){ev(this.members,e),e.scheduleRender()}remove(e){if(tv(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(r=>e===r);if(n===0)return!1;let s;for(let r=n;r>=0;r--){const i=this.members[r];if(i.isPresent!==!1){s=i;break}}return s?(this.promote(s),!0):!1}promote(e,n){const s=this.lead;if(e!==s&&(this.prevLead=s,this.lead=e,e.show(),s)){s.instance&&s.scheduleRender(),e.scheduleRender(),e.resumeFrom=s,n&&(e.resumeFrom.preserveOpacity=!0),s.snapshot&&(e.snapshot=s.snapshot,e.snapshot.latestValues=s.animationValues||s.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:r}=e.options;r===!1&&s.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:s}=e;n.onExitComplete&&n.onExitComplete(),s&&s.options.onExitComplete&&s.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function p8(t,e,n){let s="";const r=t.x.translate/e.x,i=t.y.translate/e.y,o=(n==null?void 0:n.z)||0;if((r||i||o)&&(s=`translate3d(${r}px, ${i}px, ${o}px) `),(e.x!==1||e.y!==1)&&(s+=`scale(${1/e.x}, ${1/e.y}) `),n){const{transformPerspective:u,rotate:h,rotateX:f,rotateY:m,skewX:x,skewY:b}=n;u&&(s=`perspective(${u}px) ${s}`),h&&(s+=`rotate(${h}deg) `),f&&(s+=`rotateX(${f}deg) `),m&&(s+=`rotateY(${m}deg) `),x&&(s+=`skewX(${x}deg) `),b&&(s+=`skewY(${b}deg) `)}const l=t.x.scale*e.x,c=t.y.scale*e.y;return(l!==1||c!==1)&&(s+=`scale(${l}, ${c})`),s||"none"}const Rp=["","X","Y","Z"],g8=1e3;let x8=0;function Pp(t,e,n,s){const{latestValues:r}=e;r[t]&&(n[t]=r[t],e.setStaticValue(t,0),s&&(s[t]=0))}function kA(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const n=fA(e);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:r,layoutId:i}=t.options;window.MotionCancelOptimisedAnimation(n,"transform",xt,!(r||i))}const{parent:s}=t;s&&!s.hasCheckedOptimisedAppear&&kA(s)}function IA({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:s,resetTransform:r}){return class{constructor(o={},l=e==null?void 0:e()){this.id=x8++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(b8),this.nodes.forEach(E8),this.nodes.forEach(T8),this.nodes.forEach(w8)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new r8)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new rv),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o){if(this.instance)return;this.isSVG=qC(o)&&!i9(o),this.instance=o;const{layoutId:l,layout:c,visualElement:u}=this.options;if(u&&!u.current&&u.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(c||l)&&(this.isLayoutDirty=!0),t){let h,f=0;const m=()=>this.root.updateBlockedByResize=!1;xt.read(()=>{f=window.innerWidth}),t(o,()=>{const x=window.innerWidth;x!==f&&(f=x,this.root.updateBlockedByResize=!0,h&&h(),h=i8(m,250),Eh.hasAnimatedSinceResize&&(Eh.hasAnimatedSinceResize=!1,this.nodes.forEach(RE)))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&u&&(l||c)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeLayoutChanged:m,layout:x})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const b=this.options.transition||u.getDefaultTransition()||C8,{onLayoutAnimationStart:N,onLayoutAnimationComplete:E}=u.getProps(),w=!this.targetLayout||!jA(this.targetLayout,x),v=!f&&m;if(this.options.layoutRoot||this.resumeFrom||v||f&&(w||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const T={...xv(b,"layout"),onPlay:N,onComplete:E};(u.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T),this.setAnimationOrigin(h,v)}else f||RE(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=x})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),zr(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(S8),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&kA(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let h=0;h<this.path.length;h++){const f=this.path[h];f.shouldResetTransform=!0,f.updateScroll("snapshot"),f.options.layoutRoot&&f.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(CE);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(AE);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(N8),this.nodes.forEach(y8),this.nodes.forEach(v8)):this.nodes.forEach(AE),this.clearAllSnapshots();const l=es.now();mn.delta=Br(0,1e3/60,l-mn.timestamp),mn.timestamp=l,mn.isProcessing=!0,wp.update.process(mn),wp.preRender.process(mn),wp.render.process(mn),mn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,vv.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(_8),this.sharedNodes.forEach(j8)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,xt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){xt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!On(this.snapshot.measuredBox.x)&&!On(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=Xt(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&this.instance){const c=s(this.instance);this.scroll={animationId:this.root.animationId,phase:o,isRoot:c,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:c}}}resetTransform(){if(!r)return;const o=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,l=this.projectionDelta&&!SA(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,h=u!==this.prevTransformTemplateValue;o&&this.instance&&(l||la(this.latestValues)||h)&&(r(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),A8(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){var u;const{visualElement:o}=this.options;if(!o)return Xt();const l=o.measureViewportBox();if(!(((u=this.scroll)==null?void 0:u.wasRoot)||this.path.some(R8))){const{scroll:h}=this.root;h&&(Mo(l.x,h.offset.x),Mo(l.y,h.offset.y))}return l}removeElementScroll(o){var c;const l=Xt();if(Os(l,o),(c=this.scroll)!=null&&c.wasRoot)return l;for(let u=0;u<this.path.length;u++){const h=this.path[u],{scroll:f,options:m}=h;h!==this.root&&f&&m.layoutScroll&&(f.wasRoot&&Os(l,o),Mo(l.x,f.offset.x),Mo(l.y,f.offset.y))}return l}applyTransform(o,l=!1){const c=Xt();Os(c,o);for(let u=0;u<this.path.length;u++){const h=this.path[u];!l&&h.options.layoutScroll&&h.scroll&&h!==h.root&&Lo(c,{x:-h.scroll.offset.x,y:-h.scroll.offset.y}),la(h.latestValues)&&Lo(c,h.latestValues)}return la(this.latestValues)&&Lo(c,this.latestValues),c}removeTransform(o){const l=Xt();Os(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!la(u.latestValues))continue;jx(u.latestValues)&&u.updateSnapshot();const h=Xt(),f=u.measurePageBox();Os(h,f),EE(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,h)}return la(this.latestValues)&&EE(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==mn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var x;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const c=!!this.resumingFrom||this!==l;if(!(o||c&&this.isSharedProjectionDirty||this.isProjectionDirty||(x=this.parent)!=null&&x.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:f}=this.options;if(!this.layout||!(h||f))return;this.resolvedRelativeTargetAt=mn.timestamp;const m=this.getClosestProjectingParent();m&&this.linkedParentVersion!==m.layoutVersion&&!m.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(m&&m.layout?this.createRelativeTarget(m,this.layout.layoutBox,m.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Xt(),this.targetWithTransforms=Xt()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),Oz(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Os(this.target,this.layout.layoutBox),oA(this.target,this.targetDelta)):Os(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?this.createRelativeTarget(m,this.target,m.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||jx(this.parent.latestValues)||aA(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(o,l,c){this.relativeParent=o,this.linkedParentVersion=o.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Xt(),this.relativeTargetOrigin=Xt(),kf(this.relativeTargetOrigin,l,c),Os(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){var b;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let c=!0;if((this.isProjectionDirty||(b=this.parent)!=null&&b.isProjectionDirty)&&(c=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(c=!1),this.resolvedRelativeTargetAt===mn.timestamp&&(c=!1),c)return;const{layout:u,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(u||h))return;Os(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;Y9(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=Xt());const{target:x}=o;if(!x){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(wE(this.prevProjectionDelta.x,this.projectionDelta.x),wE(this.prevProjectionDelta.y,this.projectionDelta.y)),$c(this.projectionDelta,this.layoutCorrected,x,this.latestValues),(this.treeScale.x!==f||this.treeScale.y!==m||!IE(this.projectionDelta.x,this.prevProjectionDelta.x)||!IE(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",x))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){var l;if((l=this.options.visualElement)==null||l.scheduleRender(),o){const c=this.getStack();c&&c.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=Oo(),this.projectionDelta=Oo(),this.projectionDeltaWithTransform=Oo()}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},h={...this.latestValues},f=Oo();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const m=Xt(),x=c?c.source:void 0,b=this.layout?this.layout.source:void 0,N=x!==b,E=this.getStack(),w=!E||E.members.length<=1,v=!!(N&&!w&&this.options.crossfade===!0&&!this.path.some(I8));this.animationProgress=0;let T;this.mixTargetDelta=I=>{const R=I/1e3;PE(f.x,o.x,R),PE(f.y,o.y,R),this.setTargetDelta(f),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(kf(m,this.layout.layoutBox,this.relativeParent.layout.layoutBox),k8(this.relativeTarget,this.relativeTargetOrigin,m,R),T&&f8(this.relativeTarget,T)&&(this.isProjectionDirty=!1),T||(T=Xt()),Os(T,this.relativeTarget)),N&&(this.animationValues=h,o8(h,u,this.latestValues,R,v,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){var l,c,u;this.notifyListeners("animationStart"),(l=this.currentAnimation)==null||l.stop(),(u=(c=this.resumingFrom)==null?void 0:c.currentAnimation)==null||u.stop(),this.pendingAnimation&&(zr(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=xt.update(()=>{Eh.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Wa(0)),this.currentAnimation=n8(this.motionValue,[0,1e3],{...o,velocity:0,isSync:!0,onUpdate:h=>{this.mixTargetDelta(h),o.onUpdate&&o.onUpdate(h)},onStop:()=>{},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(g8),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:h}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&CA(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Xt();const f=On(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+f;const m=On(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+m}Os(l,c),Lo(l,h),$c(this.projectionDeltaWithTransform,this.layoutCorrected,l,h)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new m8),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var l;const{layoutId:o}=this.options;return o?((l=this.getStack())==null?void 0:l.lead)||this:this}getPrevLead(){var l;const{layoutId:o}=this.options;return o?(l=this.getStack())==null?void 0:l.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetSkewAndRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.z||c.rotate||c.rotateX||c.rotateY||c.rotateZ||c.skewX||c.skewY)&&(l=!0),!l)return;const u={};c.z&&Pp("z",o,u,this.animationValues);for(let h=0;h<Rp.length;h++)Pp(`rotate${Rp[h]}`,o,u,this.animationValues),Pp(`skew${Rp[h]}`,o,u,this.animationValues);o.render();for(const h in u)o.setStaticValue(h,u[h]),this.animationValues&&(this.animationValues[h]=u[h]);o.scheduleRender()}applyProjectionStyles(o,l){if(!this.instance||this.isSVG)return;if(!this.isVisible){o.visibility="hidden";return}const c=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,o.visibility="",o.opacity="",o.pointerEvents=Nh(l==null?void 0:l.pointerEvents)||"",o.transform=c?c(this.latestValues,""):"none";return}const u=this.getLead();if(!this.projectionDelta||!this.layout||!u.target){this.options.layoutId&&(o.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,o.pointerEvents=Nh(l==null?void 0:l.pointerEvents)||""),this.hasProjected&&!la(this.latestValues)&&(o.transform=c?c({},""):"none",this.hasProjected=!1);return}o.visibility="";const h=u.animationValues||u.latestValues;this.applyTransformsToTarget();let f=p8(this.projectionDeltaWithTransform,this.treeScale,h);c&&(f=c(h,f)),o.transform=f;const{x:m,y:x}=this.projectionDelta;o.transformOrigin=`${m.origin*100}% ${x.origin*100}% 0`,u.animationValues?o.opacity=u===this?h.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:h.opacityExit:o.opacity=u===this?h.opacity!==void 0?h.opacity:"":h.opacityExit!==void 0?h.opacityExit:0;for(const b in Tu){if(h[b]===void 0)continue;const{correct:N,applyTo:E,isCSSVariable:w}=Tu[b],v=f==="none"?h[b]:N(h[b],u);if(E){const T=E.length;for(let I=0;I<T;I++)o[E[I]]=v}else w?this.options.visualElement.renderState.vars[b]=v:o[b]=v}this.options.layoutId&&(o.pointerEvents=u===this?Nh(l==null?void 0:l.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)==null?void 0:l.stop()}),this.root.nodes.forEach(CE),this.root.sharedNodes.clear()}}}function y8(t){t.updateLayout()}function v8(t){var n;const e=((n=t.resumeFrom)==null?void 0:n.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:s,measuredBox:r}=t.layout,{animationType:i}=t.options,o=e.source!==t.layout.source;i==="size"?Ns(f=>{const m=o?e.measuredBox[f]:e.layoutBox[f],x=On(m);m.min=s[f].min,m.max=m.min+x}):CA(i,e.layoutBox,s)&&Ns(f=>{const m=o?e.measuredBox[f]:e.layoutBox[f],x=On(s[f]);m.max=m.min+x,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[f].max=t.relativeTarget[f].min+x)});const l=Oo();$c(l,s,e.layoutBox);const c=Oo();o?$c(c,t.applyTransform(r,!0),e.measuredBox):$c(c,s,e.layoutBox);const u=!SA(l);let h=!1;if(!t.resumeFrom){const f=t.getClosestProjectingParent();if(f&&!f.resumeFrom){const{snapshot:m,layout:x}=f;if(m&&x){const b=Xt();kf(b,e.layoutBox,m.layoutBox);const N=Xt();kf(N,s,x.layoutBox),jA(b,N)||(h=!0),f.options.layoutRoot&&(t.relativeTarget=N,t.relativeTargetOrigin=b,t.relativeParent=f)}}}t.notifyListeners("didUpdate",{layout:s,snapshot:e,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeLayoutChanged:h})}else if(t.isLead()){const{onExitComplete:s}=t.options;s&&s()}t.options.transition=void 0}function b8(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function w8(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function _8(t){t.clearSnapshot()}function CE(t){t.clearMeasurements()}function AE(t){t.isLayoutDirty=!1}function N8(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function RE(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function E8(t){t.resolveTargetDelta()}function T8(t){t.calcProjection()}function S8(t){t.resetSkewAndRotation()}function j8(t){t.removeLeadSnapshot()}function PE(t,e,n){t.translate=It(e.translate,0,n),t.scale=It(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function DE(t,e,n,s){t.min=It(e.min,n.min,s),t.max=It(e.max,n.max,s)}function k8(t,e,n,s){DE(t.x,e.x,n.x,s),DE(t.y,e.y,n.y,s)}function I8(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const C8={duration:.45,ease:[.4,0,.1,1]},VE=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),ME=VE("applewebkit/")&&!VE("chrome/")?Math.round:Cs;function LE(t){t.min=ME(t.min),t.max=ME(t.max)}function A8(t){LE(t.x),LE(t.y)}function CA(t,e,n){return t==="position"||t==="preserve-aspect"&&!Lz(kE(e),kE(n),.2)}function R8(t){var e;return t!==t.root&&((e=t.scroll)==null?void 0:e.wasRoot)}const P8=IA({attachResizeListener:(t,e)=>Su(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),Dp={current:void 0},AA=IA({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!Dp.current){const t=new P8({});t.mount(window),t.setOptions({layoutScroll:!0}),Dp.current=t}return Dp.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),D8={pan:{Feature:Jz},drag:{Feature:Xz,ProjectionNode:AA,MeasureLayout:NA}};function OE(t,e,n){const{props:s}=t;t.animationState&&s.whileHover&&t.animationState.setActive("whileHover",n==="Start");const r="onHover"+n,i=s[r];i&&xt.postRender(()=>i(e,ad(e)))}class V8 extends Qi{mount(){const{current:e}=this.node;e&&(this.unmount=e9(e,(n,s)=>(OE(this.node,s,"Start"),r=>OE(this.node,r,"End"))))}unmount(){}}class M8 extends Qi{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=sd(Su(this.node.current,"focus",()=>this.onFocus()),Su(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function FE(t,e,n){const{props:s}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&s.whileTap&&t.animationState.setActive("whileTap",n==="Start");const r="onTap"+(n==="End"?"":n),i=s[r];i&&xt.postRender(()=>i(e,ad(e)))}class L8 extends Qi{mount(){const{current:e}=this.node;e&&(this.unmount=r9(e,(n,s)=>(FE(this.node,s,"Start"),(r,{success:i})=>FE(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Dx=new WeakMap,Vp=new WeakMap,O8=t=>{const e=Dx.get(t.target);e&&e(t)},F8=t=>{t.forEach(O8)};function U8({root:t,...e}){const n=t||document;Vp.has(n)||Vp.set(n,{});const s=Vp.get(n),r=JSON.stringify(e);return s[r]||(s[r]=new IntersectionObserver(F8,{root:t,...e})),s[r]}function B8(t,e,n){const s=U8(e);return Dx.set(t,n),s.observe(t),()=>{Dx.delete(t),s.unobserve(t)}}const $8={some:0,all:1};class z8 extends Qi{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:s,amount:r="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:s,threshold:typeof r=="number"?r:$8[r]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:h,onViewportLeave:f}=this.node.getProps(),m=u?h:f;m&&m(c)};return B8(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(q8(e,n))&&this.startObserver()}unmount(){}}function q8({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const W8={inView:{Feature:z8},tap:{Feature:L8},focus:{Feature:M8},hover:{Feature:V8}},G8={layout:{ProjectionNode:AA,MeasureLayout:NA}},H8={...Az,...W8,...D8,...G8},Mp=H9(H8,az);function RA(t){const e=nd(()=>Wa(t)),{isStatic:n}=g.useContext(wm);if(n){const[,s]=g.useState(t);g.useEffect(()=>e.on("change",s),[])}return e}function PA(t,e){const n=RA(e()),s=()=>n.set(e());return s(),Z0(()=>{const r=()=>xt.preRender(s,!1,!0),i=t.map(o=>o.on("change",r));return()=>{i.forEach(o=>o()),zr(s)}}),n}function K8(t){Uc.current=[],t();const e=PA(Uc.current,t);return Uc.current=void 0,e}function Qd(t,e,n,s){if(typeof t=="function")return K8(t);const r=typeof e=="function"?e:a9(e,n,s);return Array.isArray(t)?UE(t,r):UE([t],([i])=>r(i))}function UE(t,e){const n=nd(()=>[]);return PA(t,()=>{n.length=0;const s=t.length;for(let r=0;r<s;r++)n[r]=t[r].get();return e(n)})}const BE=["Star Gazer","Night Owl","Coffee Lover","Dream Chaser","Music Soul","Ocean Child","Mountain Hiker","City Light","Book Worm","Artistic Spirit"],Q8=({candidate:t,index:e,isBlindDate:n,onSwipe:s})=>{const r=RA(0),i=Qd(r,[-200,200],[-18,18]),o=Qd(r,[20,150],[0,1]),l=Qd(r,[-20,-150],[0,1]),c=Qd(r,[-200,0,200],[1.05,1,1.05]),u=(h,f)=>{f.offset.x>100?s("right",t):f.offset.x<-100&&s("left",t)};return a.jsxs(Mp.div,{style:{x:r,rotate:i,scale:c,zIndex:50-e,position:"absolute",top:0,bottom:0,left:0,right:0},initial:{scale:.95,opacity:0,y:20},animate:{scale:1-e*.04,y:e*15,opacity:1-e*.2,filter:e>0?"blur(2px)":"none"},exit:{x:r.get()<0?-500:500,opacity:0,transition:{duration:.2}},drag:e===0?"x":!1,dragConstraints:{left:0,right:0},onDragEnd:u,whileDrag:{cursor:"grabbing"},className:"w-full h-full rounded-[35px] shadow-2xl bg-white overflow-hidden cursor-grab origin-bottom touch-none border-4 border-white",children:[e===0&&a.jsxs(a.Fragment,{children:[a.jsx(Mp.div,{style:{opacity:o},className:"absolute top-8 left-8 z-50 border-4 border-green-500 text-green-500 font-black text-4xl px-4 py-2 rounded-xl transform -rotate-12 bg-black/20 backdrop-blur-sm",children:"LIKE"}),a.jsx(Mp.div,{style:{opacity:l},className:"absolute top-8 right-8 z-50 border-4 border-red-500 text-red-500 font-black text-4xl px-4 py-2 rounded-xl transform rotate-12 bg-black/20 backdrop-blur-sm",children:"NOPE"})]}),a.jsxs("div",{className:"absolute inset-0 bg-gray-900 pointer-events-none",children:[a.jsx("img",{src:t.photoURL||"https://images.unsplash.com/photo-1534528741775-53994a69daeb",className:`w-full h-full object-cover pointer-events-none ${n?"blur-xl scale-110 opacity-70":""}`,alt:"Candidate"}),n&&a.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/20",children:a.jsx("div",{className:"w-24 h-24 bg-white/10 backdrop-blur-md rounded-full border border-white/30 flex items-center justify-center shadow-[0_0_40px_rgba(255,255,255,0.2)]",children:a.jsx("i",{className:"fas fa-user-secret text-5xl text-white"})})})]}),a.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/30 to-transparent flex flex-col justify-end p-8 text-white pointer-events-none",children:[a.jsxs("div",{className:"flex items-end gap-3 mb-2",children:[a.jsx("h2",{className:"text-4xl font-black tracking-tighter drop-shadow-lg",children:n?t.mysteryName:t.displayName.split(" ")[0]}),a.jsx("span",{className:"text-xl font-bold opacity-90 mb-1 bg-white/20 px-2 rounded-lg backdrop-blur-md",children:t.age||24})]}),t.datingHeadline&&a.jsxs("p",{className:"text-pink-300 font-bold text-sm mb-4 italic shadow-black drop-shadow-md",children:['"',t.datingHeadline,'"']}),a.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.profession&&a.jsx("span",{className:"bg-black/30 backdrop-blur px-3 py-1 rounded-full text-xs font-bold border border-white/20",children:t.profession}),t.location&&a.jsx("span",{className:"bg-black/30 backdrop-blur px-3 py-1 rounded-full text-xs font-bold border border-white/20",children:t.location})]})]})]})},Y8=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState(null),[i,o]=g.useState([]),[l,c]=g.useState(!0),[u,h]=g.useState(!1),[f,m]=g.useState(!1),[x,b]=g.useState(!1),[N,E]=g.useState(null),[w,v]=g.useState(!1),[T,I]=g.useState(""),[R,V]=g.useState(null),[j,y]=g.useState(!1),[k,S]=g.useState(""),[D,P]=g.useState({gender:"Everyone",ageRange:[18,50],location:"",profession:"",goal:"Long-term"});g.useEffect(()=>{const F=Pt(Ve,async G=>{if(G){n(G);const J=H(L,"users",G.uid),we=await jt(J);if(we.exists()){const je=we.data();if(r(je),S(je.datingHeadline||""),je.isDatingActive){const U=je.gender==="Male"?"Women":je.gender==="Female"?"Men":"Everyone";P(xe=>({...xe,gender:U})),C(G.uid,{...D,gender:U})}else c(!1)}}});return()=>F()},[]);const C=async(F,G)=>{c(!0);try{const J=qe(ae(L,"users"),rt("isDatingActive","==",!0));let je=(await Zt(J)).docs.map(U=>({id:U.id,...U.data()}));je=je.filter(U=>{if(U.id===F)return!1;if(G.gender!=="Everyone"){const re=G.gender==="Men"?"Male":"Female";if(U.gender!==re)return!1}let xe=U.age||24;return!(xe<G.ageRange[0]||xe>G.ageRange[1])}),je=je.map(U=>({...U,mysteryName:BE[Math.floor(Math.random()*BE.length)]})),o(je.sort(()=>.5-Math.random()))}catch(J){console.error("Error:",J)}finally{c(!1)}},q=(F,G)=>{o(J=>J.slice(1)),F==="right"?(V(G),ue(null,G)):fe(G)},ue=async(F=null,G=null)=>{const J=G||R;v(!1),G||o(xe=>xe.filter(re=>re.id!==J.id));const we=`${e.uid}_${J.id}`;if(await Ir(H(L,"dating_swipes",we),{from:e.uid,to:J.id,type:"like",timestamp:Ie(),message:F}),F){const xe=[e.uid,J.id].sort().join("_");await Ir(H(L,"conversations",xe),{participants:[e.uid,J.id],users:[{uid:e.uid,displayName:s.displayName,photoURL:s.photoURL},{uid:J.id,displayName:J.displayName,photoURL:J.photoURL}],lastMessage:F,isMatch:!1,updatedAt:Ie()},{merge:!0}),await ze(ae(L,`conversations/${xe}/messages`),{text:F,senderId:e.uid,timestamp:Ie()})}const je=H(L,"dating_swipes",`${J.id}_${e.uid}`),U=await jt(je);U.exists()&&["like","superlike"].includes(U.data().type)&&K(J)},Se=async()=>{if(i.length===0)return;const F=i[0];o(J=>J.slice(1));const G=`${e.uid}_${F.id}`;await Ir(H(L,"dating_swipes",G),{from:e.uid,to:F.id,type:"superlike",timestamp:Ie()}),await ze(ae(L,"notifications"),{recipientId:F.id,senderId:e.uid,senderName:u?"Mystery Admirer":s.displayName,senderAvatar:u?null:s.photoURL,type:"dating_interest",message:"super liked you! ",timestamp:Ie(),isRead:!1})},fe=async F=>{if(!F){if(i.length===0)return;F=i[0],o(G=>G.slice(1))}await Ir(H(L,"dating_swipes",`${e.uid}_${F.id}`),{from:e.uid,to:F.id,type:"pass",timestamp:Ie()})},K=async F=>{E(F),b(!0);const G=[e.uid,F.id].sort().join("_");await he(H(L,"conversations",G),{isMatch:!0})},se=async()=>{e&&(await he(H(L,"users",e.uid),{datingHeadline:k}),r(F=>({...F,datingHeadline:k})),y(!1))},ne=async()=>{await he(H(L,"users",e.uid),{isDatingActive:!0}),window.location.reload()};return l?a.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-900",children:a.jsx("div",{className:"w-16 h-16 border-t-4 border-pink-500 rounded-full animate-spin"})}):s!=null&&s.isDatingActive?a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto pb-28 relative min-h-screen bg-gradient-to-br from-gray-50 to-gray-200 overflow-hidden",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex flex-col gap-4 mb-8 px-2 z-10 relative",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-2 bg-white/80 backdrop-blur-md p-1.5 rounded-2xl shadow-sm border border-white/50",children:[a.jsx("button",{onClick:()=>h(!1),className:`px-5 py-2.5 rounded-xl text-sm font-bold transition-all ${u?"text-gray-400 hover:bg-gray-100":"bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-md"}`,children:"Classic"}),a.jsxs("button",{onClick:()=>h(!0),className:`px-5 py-2.5 rounded-xl text-sm font-bold transition-all flex items-center gap-2 ${u?"bg-black text-white shadow-md":"text-gray-400 hover:bg-gray-100"}`,children:[a.jsx("i",{className:"fas fa-user-secret"})," Blind"]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>y(!0),className:"w-11 h-11 bg-white rounded-xl shadow-sm border border-gray-100 flex items-center justify-center text-gray-500 hover:text-pink-600 hover:scale-105 transition-all",children:a.jsx("i",{className:"fas fa-pen"})}),a.jsx("button",{onClick:()=>m(!0),className:"w-11 h-11 bg-white rounded-xl shadow-sm border border-gray-100 flex items-center justify-center text-gray-500 hover:text-purple-600 hover:scale-105 transition-all",children:a.jsx("i",{className:"fas fa-sliders-h"})})]})]}),j?a.jsxs("div",{className:"bg-white/80 backdrop-blur p-4 rounded-2xl shadow-sm flex gap-2 border border-pink-100",children:[a.jsx("input",{value:k,onChange:F=>S(F.target.value),placeholder:"Headline...",className:"flex-1 bg-transparent px-2 outline-none text-sm font-bold text-gray-800",maxLength:50,autoFocus:!0}),a.jsx("button",{onClick:se,className:"bg-black text-white px-4 py-2 rounded-lg font-bold text-xs",children:"Save"})]}):s.datingHeadline&&a.jsxs("div",{className:"text-center text-gray-600 text-sm font-bold italic",children:['"',s.datingHeadline,'"']})]}),a.jsx("div",{className:"relative w-full max-w-sm md:max-w-md mx-auto h-[62vh] perspective-1000",children:a.jsx(p9,{children:i.length>0?i.slice(0,3).map((F,G)=>a.jsx(Q8,{candidate:F,index:G,isBlindDate:u,onSwipe:q},F.id)):a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-white/80 backdrop-blur-xl rounded-[35px] border border-white shadow-xl",children:[a.jsx("div",{className:"w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center text-pink-400 mb-4 animate-pulse",children:a.jsx("i",{className:"fas fa-search text-3xl"})}),a.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Searching..."}),a.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Try adjusting your filters."}),a.jsx("button",{onClick:()=>m(!0),className:"mt-6 bg-black text-white px-6 py-3 rounded-xl font-bold text-sm",children:"Filters"})]})})}),i.length>0&&a.jsxs("div",{className:"flex justify-center items-center gap-6 mt-8 z-20 relative",children:[a.jsx("button",{onClick:()=>fe(),className:"w-16 h-16 bg-white rounded-full shadow-lg border border-gray-100 text-gray-400 text-2xl flex items-center justify-center hover:bg-red-50 hover:text-red-500 hover:scale-110 active:scale-95 transition-all",children:a.jsx("i",{className:"fas fa-times"})}),a.jsx("button",{onClick:Se,className:"w-12 h-12 bg-white rounded-full shadow-md border border-gray-100 text-blue-400 text-lg flex items-center justify-center hover:bg-blue-50 hover:text-blue-600 hover:scale-110 active:scale-95 transition-all transform -translate-y-3",children:a.jsx("i",{className:"fas fa-star"})}),a.jsx("button",{onClick:()=>{V(i[0]),v(!0)},className:"w-16 h-16 bg-gradient-to-tr from-pink-500 to-rose-600 rounded-full shadow-lg shadow-pink-500/30 text-white text-3xl flex items-center justify-center hover:scale-110 active:scale-95 transition-all",children:a.jsx("i",{className:"fas fa-heart"})})]}),w&&R&&a.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in",children:a.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[30px] p-6 shadow-2xl",children:[a.jsxs("h3",{className:"text-lg font-black text-center mb-4",children:["Message ",u?R.mysteryName:R.displayName]}),a.jsx("textarea",{value:T,onChange:F=>I(F.target.value),placeholder:"Say something nice...",className:"w-full bg-gray-50 rounded-2xl p-4 text-sm mb-4 outline-none resize-none font-medium",rows:"3"}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>ue(null),className:"flex-1 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-50",children:"Just Like"}),a.jsx("button",{onClick:()=>ue(T),className:"flex-1 bg-pink-500 text-white py-3 rounded-xl font-bold hover:shadow-lg",children:"Send"})]})]})}),x&&N&&a.jsxs("div",{className:"fixed inset-0 z-[10000] bg-black/95 backdrop-blur-xl flex flex-col items-center justify-center p-6 animate-pop-in text-center",children:[a.jsx("h1",{className:"text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-purple-400 italic mb-8",children:"MATCH!"}),a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("img",{src:s.photoURL,className:"w-24 h-24 rounded-full border-4 border-white"}),a.jsx("img",{src:N.photoURL,className:"w-24 h-24 rounded-full border-4 border-white"})]}),a.jsx("button",{onClick:()=>t("/messages",{state:{startChatWith:N}}),className:"bg-white text-black px-8 py-4 rounded-full font-bold shadow-xl mb-4",children:"Chat Now"}),a.jsx("button",{onClick:()=>b(!1),className:"text-white/70 font-bold",children:"Keep Swiping"})]}),f&&a.jsx(h6,{currentFilters:D,onClose:()=>m(!1),onApply:F=>{P(F),C(e.uid,F)}})]}):a.jsxs("div",{className:"p-6 min-h-screen flex flex-col items-center justify-center bg-gray-900",children:[a.jsx(yn,{}),a.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Dating Profile Inactive"}),a.jsx("button",{onClick:ne,className:"bg-pink-500 text-white px-8 py-3 rounded-full font-bold",children:"Activate Now"})]})},X8=({name:t,url:e})=>{const n=t?t.split(" ").map(s=>s[0]).join("").substring(0,2).toUpperCase():"??";return e&&!e.includes("via.placeholder")?a.jsx("img",{src:e,className:"w-12 h-12 rounded-full object-cover border border-gray-200",alt:t}):a.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-tr from-primary to-primary-light text-white flex items-center justify-center font-bold text-sm shadow-sm",children:n})},J8=()=>{const t=tt(),[e,n]=g.useState(null),[s,r]=g.useState([]),[i,o]=g.useState(!0);g.useEffect(()=>{const h=Pt(Ve,f=>{if(f){n(f);const m=qe(ae(L,"notifications"),rt("recipientId","==",f.uid),_t("timestamp","desc"));return Fe(m,x=>{r(x.docs.map(b=>({id:b.id,...b.data()}))),o(!1)})}else t("/")});return()=>h()},[t]);const l=async(h,f)=>{h.stopPropagation();try{const m={uid:e.uid,name:e.displayName,avatar:e.photoURL,role:f.role,email:e.email};await he(H(L,"business_pages",f.pageId),{team:ut(m),teamIds:ut(e.uid)}),await is(H(L,"notifications",f.id)),t(`/business/${f.pageId}`)}catch{alert("Failed to accept.")}},c=async h=>{if(h.isRead||await he(H(L,"notifications",h.id),{isRead:!0}),h.type!=="team_invite"){if(["like","comment","mention"].includes(h.type)){h.targetId?t(`/post/${h.targetId}`):console.error("Notification missing targetId",h);return}if(["review","question","answer"].includes(h.type)){t(`/product/${h.targetId}`,{state:{activeTab:h.type==="review"?"reviews":"qa"}});return}if(["follow","circle_join"].includes(h.type)){t(`/profile/${h.senderId}`);return}if(["follow_business"].includes(h.type)){t(`/business/${h.targetId}`);return}t("/")}},u=async()=>{if(!confirm("Clear all?"))return;const h=xl(L);s.forEach(f=>h.delete(H(L,"notifications",f.id))),await h.commit()};return i?a.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading..."}):a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("button",{onClick:()=>t(-1),className:"md:hidden w-10 h-10 bg-white rounded-full flex items-center justify-center shadow-sm text-dark",children:a.jsx("i",{className:"fas fa-arrow-left"})}),a.jsx("h1",{className:"text-2xl font-black text-dark",children:"Notifications"})]}),s.length>0&&a.jsx("button",{onClick:u,className:"text-xs font-bold text-red-500 hover:bg-red-50 px-3 py-2 rounded-lg",children:"Clear all"})]}),a.jsx("div",{className:"space-y-3",children:s.length===0?a.jsxs("div",{className:"text-center py-20 text-gray-400",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-2xl",children:a.jsx("i",{className:"far fa-bell"})}),a.jsx("p",{children:"No notifications yet."})]}):s.map(h=>{var f;return a.jsxs("div",{onClick:()=>c(h),className:`flex gap-4 p-4 rounded-2xl cursor-pointer transition-all border ${h.isRead?"bg-gray-50/50 border-transparent":"bg-white border-primary/20 shadow-sm"}`,children:[a.jsx(X8,{name:h.senderName,url:h.senderAvatar}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"text-sm text-gray-800 leading-snug",children:[a.jsx("span",{className:"font-bold",children:h.senderName}),h.type==="like"&&" liked your post.",h.type==="comment"&&" commented on your post.",h.type==="follow"&&" started following you.",!["like","comment","follow"].includes(h.type)&&` ${h.message}`]}),h.type==="team_invite"&&a.jsx("div",{className:"flex gap-2 mt-2",children:a.jsx("button",{onClick:m=>l(m,h),className:"bg-primary text-white px-4 py-1.5 rounded-lg text-xs font-bold",children:"Accept"})}),a.jsx("span",{className:"text-[10px] text-gray-400 mt-1 block",children:(f=h.timestamp)!=null&&f.seconds?new Date(h.timestamp.seconds*1e3).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"}):"Just now"})]}),!h.isRead&&a.jsx("div",{className:"w-2.5 h-2.5 bg-primary rounded-full mt-1 shrink-0"})]},h.id)})})]})},Z8=()=>{const{id:t}=Nl(),e=tt(),[n,s]=g.useState("followers"),[r,i]=g.useState([]),[o,l]=g.useState(!0),[c,u]=g.useState(null);return g.useEffect(()=>{const h=Pt(Ve,f=>{f||e("/")});return()=>h()},[]),g.useEffect(()=>{t&&(async()=>{l(!0);try{const f=await jt(H(L,"users",t));f.exists()&&u(f.data());const m=ae(L,"users",t,n),b=(await Zt(m)).docs.map(async E=>{const w=E.id,v=await jt(H(L,"users",w));return v.exists()?v.data():null}),N=await Promise.all(b);i(N.filter(E=>E!==null))}catch(f){console.error("Error fetching connections:",f)}finally{l(!1)}})()},[t,n]),a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[a.jsx("button",{onClick:()=>e(-1),className:"w-10 h-10 bg-white rounded-full shadow-sm flex items-center justify-center text-dark hover:bg-gray-50",children:a.jsx("i",{className:"fas fa-arrow-left"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-black text-dark",children:(c==null?void 0:c.displayName)||"User"}),a.jsxs("p",{className:"text-gray-500 text-sm",children:["@",(c==null?void 0:c.handle)||"username"]})]})]}),a.jsxs("div",{className:"flex bg-white rounded-2xl p-1 shadow-sm border border-gray-100 mb-6 max-w-md",children:[a.jsx("button",{onClick:()=>s("followers"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${n==="followers"?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:"Followers"}),a.jsx("button",{onClick:()=>s("following"),className:`flex-1 py-3 rounded-xl font-bold text-sm transition-all ${n==="following"?"bg-dark text-white shadow-md":"text-gray-500 hover:bg-gray-50"}`,children:"Following"})]}),a.jsx("div",{className:"bg-white rounded-[30px] shadow-sm min-h-[500px] p-6",children:o?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"Loading..."}):r.length===0?a.jsxs("div",{className:"text-center py-20",children:[a.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4 text-gray-300 text-2xl",children:a.jsx("i",{className:"fas fa-users-slash"})}),a.jsxs("p",{className:"text-gray-500 font-bold",children:["No ",n," found."]})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:r.map(h=>a.jsxs("div",{onClick:()=>e(`/profile/${h.uid}`),className:"flex items-center gap-4 p-4 rounded-2xl border border-gray-50 hover:bg-gray-50 hover:border-gray-200 cursor-pointer transition-all group",children:[a.jsx("img",{src:h.photoURL||"https://via.placeholder.com/150",className:"w-14 h-14 rounded-xl object-cover shadow-sm",alt:h.displayName}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-bold text-dark truncate",children:h.displayName}),a.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:["@",h.handle]}),h.profession&&a.jsxs("p",{className:"text-xs text-primary mt-1 truncate",children:[a.jsx("i",{className:"fas fa-briefcase mr-1"})," ",h.profession]})]}),a.jsx("button",{className:"w-10 h-10 rounded-full bg-white border border-gray-100 text-gray-400 flex items-center justify-center group-hover:bg-primary group-hover:text-white group-hover:border-primary transition-colors shadow-sm",children:a.jsx("i",{className:"fas fa-angle-right"})})]},h.uid))})})]})},eq=()=>{const t=tt(),[e,n]=g.useState([]),[s,r]=g.useState(!0),i=["from-[#FF9A9E] to-[#FECFEF]","from-[#a18cd1] to-[#fbc2eb]","from-[#84fab0] to-[#8fd3f4]","from-[#e0c3fc] to-[#8ec5fc]","from-[#ffecd2] to-[#fcb69f]","from-[#ff9a9e] to-[#fecfef]","from-[#f6d365] to-[#fda085]","from-[#a8edea] to-[#fed6e3]"];return g.useEffect(()=>{(async()=>{var l;try{const c=qe(ae(L,"users"),Ur(20)),u=await Zt(c),h=(l=Ve.currentUser)==null?void 0:l.uid,f=u.docs.map(m=>m.data()).filter(m=>m.uid!==h);n(f)}catch(c){console.error(c)}finally{r(!1)}})()},[]),a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"mb-8 text-center md:text-left",children:[a.jsx("h1",{className:"text-4xl font-black text-transparent bg-clip-text bg-gradient-to-r from-purple-600 to-pink-600 mb-2 animate-pulse",children:"Explore Tukumi"}),a.jsx("p",{className:"text-gray-500 font-bold",children:"Discover interesting people & colorful souls."})]}),s?a.jsx("div",{className:"grid grid-cols-3 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-6",children:[1,2,3,4,5,6].map(o=>a.jsx("div",{className:"h-40 md:h-64 bg-gray-100 rounded-2xl md:rounded-[30px] animate-pulse"},o))}):a.jsx("div",{className:"grid grid-cols-3 md:grid-cols-3 lg:grid-cols-4 gap-3 md:gap-6",children:e.map((o,l)=>{const c=i[l%i.length];return a.jsxs("div",{onClick:()=>t(`/profile/${o.uid}`),className:`relative h-44 md:h-80 rounded-2xl md:rounded-[35px] p-2 md:p-6 flex flex-col items-center justify-between shadow-md md:shadow-xl hover:shadow-2xl hover:scale-105 transition-all cursor-pointer overflow-hidden group bg-gradient-to-br ${c}`,children:[a.jsx("div",{className:"absolute top-[-10px] md:top-[-20px] right-[-10px] md:right-[-20px] w-12 md:w-24 h-12 md:h-24 bg-white/20 rounded-full blur-xl"}),a.jsx("div",{className:"absolute bottom-[-10px] md:bottom-[-20px] left-[-10px] md:left-[-20px] w-16 md:w-32 h-16 md:h-32 bg-white/20 rounded-full blur-xl"}),a.jsx("div",{className:"relative z-10 bg-white p-0.5 md:p-1 rounded-full shadow-lg mt-2 md:mt-4",children:a.jsx("img",{src:o.photoURL||"https://via.placeholder.com/150",className:"w-12 h-12 md:w-24 md:h-24 rounded-full object-cover border-2 md:border-4 border-white",alt:o.displayName})}),a.jsxs("div",{className:"relative z-10 text-center mb-1 md:mb-4 w-full",children:[a.jsx("h3",{className:"font-black text-dark text-[10px] md:text-xl mb-0.5 md:mb-1 drop-shadow-sm truncate w-full px-1",children:o.displayName}),a.jsxs("p",{className:"text-dark/60 font-bold text-[8px] md:text-sm uppercase tracking-wider truncate w-full px-1",children:["@",o.handle]}),a.jsx("div",{className:"mt-1 md:mt-3 bg-white/40 backdrop-blur-md rounded-lg md:rounded-xl px-2 md:px-4 py-0.5 md:py-2 text-[7px] md:text-xs font-bold text-dark/80 shadow-sm inline-block max-w-full truncate",children:o.profession||"Creator"})]}),a.jsx("button",{className:"hidden md:block w-full bg-white text-dark font-bold py-3 rounded-2xl shadow-lg opacity-0 group-hover:opacity-100 translate-y-4 group-hover:translate-y-0 transition-all duration-300",children:"View Profile"})]},o.uid)})}),e.length===0&&!s&&a.jsx("div",{className:"text-center py-20 text-gray-400",children:"No users found to explore."})]})},DA="https://via.placeholder.com/150/000000/FFFFFF?text=A",tq=({text:t,hasMedia:e})=>{const[n,s]=g.useState(!1),r=e?2:6,i=t.split(`
`),o=i.length>r||t.length>(e?100:300),l=n||!o?t:i.slice(0,r).join(`
`).slice(0,e?100:300)+"...";return a.jsxs("div",{className:"text-gray-800 mb-3 text-[15px] leading-relaxed whitespace-pre-wrap transition-all",children:[l,o&&a.jsx("button",{onClick:c=>{c.stopPropagation(),s(!n)},className:"text-primary font-bold ml-1 hover:underline focus:outline-none text-sm",children:n?"Show Less":"Read More"})]})},nq=({postId:t,user:e,setCommentText:n,setReplyingToId:s})=>{const r=tt(),[i,o]=g.useState([]),[l,c]=g.useState({});g.useEffect(()=>{if(!t)return;const b=qe(ae(L,"posts",t,"comments"),_t("timestamp","asc")),N=Fe(b,E=>{o(E.docs.map(w=>({id:w.id,...w.data()})))});return()=>N()},[t]);const u=i.filter(b=>!b.parentId),h=b=>i.filter(N=>N.parentId===b),f=b=>{var N;n(`@${b.userName} `),s(b.parentId||b.id),(N=document.getElementById("comment-input-main"))==null||N.focus()},m=b=>c(N=>({...N,[b]:!N[b]})),x=({c:b,isReply:N})=>{var E;return a.jsxs("div",{className:`flex gap-3 items-start text-sm mb-3 ${N?"ml-10 mt-2":""}`,children:[a.jsx("img",{src:b.userAvatar||DA,className:"w-8 h-8 rounded-full object-cover flex-shrink-0 cursor-pointer border border-gray-200",alt:b.userName,onClick:()=>r(`/profile/${b.uid}`)}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none inline-block border border-gray-100",children:[a.jsx("span",{className:"font-bold text-xs block text-dark cursor-pointer hover:underline mb-0.5",onClick:()=>r(`/profile/${b.uid}`),children:b.userName}),a.jsx("p",{className:"text-gray-700 leading-snug",children:b.text})]}),a.jsxs("div",{className:"flex items-center gap-3 mt-1 ml-1",children:[a.jsx("span",{className:"text-[10px] text-gray-400",children:(E=b.timestamp)!=null&&E.seconds?new Date(b.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"}),a.jsx("button",{onClick:()=>f(b),className:"text-[10px] font-bold text-gray-500 hover:text-primary transition-colors",children:"Reply"})]})]})]})};return a.jsx("div",{className:"mt-4 pt-2 border-t border-gray-50",children:a.jsxs("div",{className:"max-h-[500px] overflow-y-auto custom-scrollbar px-1",children:[i.length===0&&a.jsx("p",{className:"text-xs text-gray-400 text-center py-4",children:"No comments yet. Start the conversation!"}),u.map(b=>{const N=h(b.id);return a.jsxs("div",{children:[a.jsx(x,{c:b,isReply:!1}),N.length>0&&a.jsxs("div",{className:"ml-12 mb-2",children:[a.jsxs("button",{onClick:()=>m(b.id),className:"text-xs text-primary font-bold flex items-center gap-2 mb-2",children:[a.jsx("div",{className:"w-4 h-px bg-primary"})," ",l[b.id]?"Hide replies":`View ${N.length} replies`]}),l[b.id]&&N.map(E=>a.jsx(x,{c:E,isReply:!0},E.id))]})]},b.id)})]})})},sq=()=>{var V,j;const{id:t}=Nl(),e=tt(),n=Hs(),[s,r]=g.useState(null),[i,o]=g.useState(null),[l,c]=g.useState(!0),[u,h]=g.useState(""),[f,m]=g.useState(null),[x,b]=g.useState(null),[N,E]=g.useState(!1);(V=n.state)==null||V.commentId,g.useEffect(()=>{const y=Pt(Ve,S=>o(S)),k=Fe(H(L,"posts",t),S=>{S.exists()?r({id:S.id,...S.data()}):r(null),c(!1)});return()=>{y(),k()}},[t]);const w=async()=>{if(!i)return alert("Sign in required.");const y=H(L,"posts",t);s.likedBy&&s.likedBy.includes(i.uid)?await he(y,{likes:pt(-1),likedBy:kt(i.uid)}):(await he(y,{likes:pt(1),likedBy:ut(i.uid)}),s.uid!==i.uid&&await ze(ae(L,"notifications"),{recipientId:s.uid,senderId:i.uid,senderName:i.displayName,senderAvatar:i.photoURL,type:"like",targetId:t,timestamp:Ie(),isRead:!1}))},v=async()=>{if(!(!u.trim()||!i))try{await ze(ae(L,"posts",t,"comments"),{text:u,uid:i.uid,userName:i.displayName,userAvatar:i.photoURL,parentId:f,timestamp:Ie()}),await he(H(L,"posts",t),{comments:pt(1)}),s.uid!==i.uid&&await ze(ae(L,"notifications"),{recipientId:s.uid,senderId:i.uid,senderName:i.displayName,senderAvatar:i.photoURL,type:"comment",targetId:t,timestamp:Ie(),isRead:!1}),h(""),m(null)}catch(y){console.error("Comment failed",y)}},T=async()=>{window.confirm("Delete this post?")&&(await is(H(L,"posts",t)),e("/"))},I=()=>{const y=window.location.href;navigator.share?navigator.share({title:s.userName,text:s.text,url:y}):navigator.clipboard.writeText(y).then(()=>alert("Link copied!"))};if(l)return a.jsx("div",{className:"p-20 text-center text-gray-500",children:"Loading Post..."});if(!s)return a.jsx("div",{className:"p-20 text-center text-gray-500",children:"Post not found or deleted."});const R=i&&s.likedBy&&s.likedBy.includes(i.uid);return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1000px] mx-auto",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("button",{onClick:()=>e(-1),className:"mb-4 text-gray-500 font-bold flex items-center gap-2 hover:text-dark transition-colors",children:[a.jsx("i",{className:"fas fa-arrow-left"})," Back"]}),a.jsxs("div",{className:"glass-panel rounded-[30px] p-6 hover:shadow-xl transition-all duration-300 border border-white/60 relative",children:[a.jsxs("div",{className:"flex justify-between items-start mb-5",children:[a.jsxs("div",{className:"flex items-center gap-4 cursor-pointer",onClick:()=>e(`/profile/${s.uid}`),children:[a.jsx("img",{src:s.userAvatar||DA,className:"w-12 h-12 rounded-2xl object-cover",alt:"User"}),a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-dark text-lg leading-tight flex items-center gap-2",children:[s.userName,s.isPrivate&&a.jsx("i",{className:"fas fa-lock text-xs text-gray-400 ml-1"})]}),a.jsx("p",{className:"text-xs text-gray-500 font-medium",children:(j=s.timestamp)!=null&&j.seconds?new Date(s.timestamp.seconds*1e3).toLocaleString():"Just now"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>E(!N),className:"w-8 h-8 rounded-full hover:bg-gray-100 flex items-center justify-center text-gray-400",children:a.jsx("i",{className:"fas fa-ellipsis-h"})}),N&&a.jsx("div",{className:"absolute right-0 top-full mt-2 w-40 bg-white rounded-xl shadow-xl border border-gray-100 z-20 overflow-hidden py-1",children:(i==null?void 0:i.uid)===s.uid?a.jsx("button",{onClick:T,className:"w-full text-left px-4 py-2 text-sm text-red-500 hover:bg-red-50 font-bold",children:"Delete"}):a.jsx("button",{className:"w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:"Report"})})]})]}),a.jsx(tq,{text:s.text,hasMedia:!!s.mediaURL}),s.mediaURL&&a.jsx("div",{className:"rounded-[24px] overflow-hidden mb-5 shadow-md border border-white/50 cursor-pointer bg-black",onClick:()=>b({url:s.mediaURL,type:s.mediaType}),children:s.mediaType==="video"?a.jsx("video",{src:s.mediaURL,controls:!0,className:"w-full max-h-[600px] object-contain mx-auto"}):a.jsx("img",{src:s.mediaURL,className:"w-full max-h-[600px] object-contain mx-auto",alt:"Post Media"})}),a.jsxs("div",{className:"flex items-center gap-3 pt-2 border-t border-gray-100/50",children:[a.jsxs("button",{onClick:w,className:`h-10 px-5 rounded-xl border flex items-center gap-2 transition-all ${R?"bg-accent/10 border-accent/20 text-accent":"bg-white/50 border-white text-gray-600 hover:text-accent"}`,children:[a.jsx("i",{className:`${R?"fas":"far"} fa-heart text-lg`}),a.jsx("span",{className:"font-bold text-sm",children:s.likes||0})]}),a.jsxs("div",{className:"h-10 px-5 rounded-xl bg-white/50 border border-white flex items-center gap-2 text-primary",children:[a.jsx("i",{className:"fas fa-comment text-lg"}),a.jsx("span",{className:"font-bold text-sm",children:s.comments||0})]}),a.jsx("button",{onClick:I,className:"h-10 w-10 rounded-xl bg-white/50 border border-white flex items-center justify-center text-gray-600 hover:text-dark ml-auto",children:a.jsx("i",{className:"far fa-share-square text-lg"})})]}),a.jsxs("div",{className:"mt-4",children:[a.jsx(nq,{postId:t,user:i,setCommentText:h,setReplyingToId:m}),a.jsxs("div",{className:"flex gap-2 mt-4 sticky bottom-0 bg-white/95 p-2 rounded-xl border border-gray-100 shadow-sm z-10",children:[a.jsx("input",{id:"comment-input-main",type:"text",placeholder:f?"Write a reply...":"Write a comment...",className:"flex-1 bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-primary/20",value:u,onChange:y=>h(y.target.value),onKeyDown:y=>y.key==="Enter"&&v()}),a.jsx("button",{onClick:v,disabled:!u.trim(),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md hover:bg-primary-dark transition-colors disabled:opacity-50",children:a.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})]}),x&&a.jsxs("div",{className:"fixed inset-0 bg-black/95 z-[100] flex items-center justify-center p-4 cursor-pointer",onClick:()=>b(null),children:[a.jsx("button",{className:"absolute top-4 right-4 text-white text-3xl",children:""}),x.type==="video"?a.jsx("video",{src:x.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-full",onClick:y=>y.stopPropagation()}):a.jsx("img",{src:x.url,alt:"Fullscreen",className:"max-w-full max-h-full object-contain",onClick:y=>y.stopPropagation()})]})]})},rq=()=>{const[t]=_D(),e=tt(),[n,s]=g.useState("Processing...");g.useEffect(()=>{const i=t.get("paymentID"),o=t.get("status");if(o==="cancel"||o==="failure"){s("Payment Canceled or Failed."),setTimeout(()=>e("/"),2e3);return}i&&o==="success"&&r(i)},[]);const r=async i=>{try{(await HI(KI,"executeBkashPayment")({paymentID:i})).data.success?(s("Payment Successful! "),setTimeout(()=>e("/profile"),2e3)):s("Payment verification failed.")}catch(o){console.error(o),s("Error executing payment.")}};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-[#f0f4f8]",children:a.jsxs("div",{className:"bg-white p-8 rounded-[30px] shadow-xl text-center",children:[a.jsx("h2",{className:"text-2xl font-black text-dark mb-4",children:"bKash Payment"}),a.jsx("div",{className:"text-lg font-bold text-gray-600",children:n}),n==="Processing..."&&a.jsx("div",{className:"mt-4 w-10 h-10 border-4 border-pink-500 border-t-transparent rounded-full animate-spin mx-auto"})]})})},iq=()=>{const t=tt(),[e,n]=g.useState(!1),[s,r]=g.useState(!0),[i,o]=g.useState("overview"),[l,c]=g.useState({users:0,posts:0,reports:0,revenue:0,verifications:0}),[u,h]=g.useState([]),[f,m]=g.useState([]);g.useEffect(()=>{const N=Pt(Ve,async E=>{if(E){const w=await jt(H(L,"users",E.uid));w.exists()&&w.data().isAdmin?n(!0):(alert("Access Denied: Admins Only"),t("/"))}else t("/");r(!1)});return()=>N()},[]),g.useEffect(()=>{if(!e)return;const N=qe(ae(L,"verification_requests"),rt("status","==","pending"),_t("timestamp","desc")),E=Fe(N,I=>{const R=I.docs.map(V=>({id:V.id,...V.data()}));h(R),c(V=>({...V,verifications:R.length}))},I=>{console.error("Verification Query Error:",I),I.message.includes("index")&&alert(" MISSING INDEX: Open console (F12) and click the Firebase link to create it.")}),w=qe(ae(L,"reports"),_t("timestamp","desc")),v=Fe(w,I=>{const R=I.docs.map(V=>({id:V.id,...V.data()}));m(R),c(V=>({...V,reports:R.length}))});return(async()=>{const I=await Zt(ae(L,"users")),R=await Zt(ae(L,"posts")),V=await Zt(qe(ae(L,"orders"),rt("status","==","paid")));let j=0;V.forEach(y=>j+=y.data().amount||0),c(y=>({...y,users:I.size,posts:R.size,revenue:j}))})(),()=>{E(),v()}},[e]);const x=async(N,E)=>{if(confirm(`${E==="approve"?"Approve":"Reject"} this request?`))try{const w=xl(L),v=H(L,"verification_requests",N.id);if(E==="approve"){if(w.update(v,{status:"approved",processedAt:Ie()}),N.targetType==="business_page"){const I=H(L,"business_pages",N.targetId);w.update(I,{isVerified:!0})}else{const I=N.targetId||N.uid,R=H(L,"users",I);w.update(R,{isVerified:!0})}const T=H(ae(L,"notifications"));w.set(T,{recipientId:N.uid,type:"system",message:`Congratulations! Your ${N.targetType==="business_page"?"Business Page":"Profile"} verification request was approved.`,timestamp:Ie(),isRead:!1})}else w.update(v,{status:"rejected",processedAt:Ie()});await w.commit(),alert(`Request ${E}d successfully!`)}catch(w){console.error("Verification Action Failed:",w),alert("Action failed. Check console for details.")}},b=async(N,E)=>{try{if(E==="delete_content"){if(!confirm("Delete this content permanently?"))return;const w=N.type==="post"?"posts":N.type==="product"?"marketplace":"circles";await is(H(L,w,N.targetId||N.postId)),alert("Content deleted.")}await is(H(L,"reports",N.id))}catch(w){console.error(w),alert("Action failed.")}};return s?a.jsx("div",{className:"p-20 text-center",children:"Loading Dashboard..."}):e?a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),a.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[a.jsx("div",{className:"w-12 h-12 bg-dark rounded-2xl flex items-center justify-center text-white text-2xl shadow-lg",children:a.jsx("i",{className:"fas fa-shield-alt"})}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-black text-dark",children:"Admin Dashboard"}),a.jsx("p",{className:"text-gray-500 font-bold",children:"Manage your platform."})]})]}),a.jsx("div",{className:"flex gap-4 mb-8 border-b border-gray-200 overflow-x-auto no-scrollbar",children:["overview","verify","reports"].map(N=>a.jsx("button",{onClick:()=>o(N),className:`px-6 py-3 font-bold capitalize transition-all border-b-4 ${i===N?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:N==="verify"&&u.length>0?`Verify (${u.length})`:N==="reports"&&f.length>0?`Reports (${f.length})`:N},N))}),i==="overview"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6 animate-fade-in",children:[a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-2",children:"Total Revenue"}),a.jsxs("div",{className:"text-3xl font-black text-green-600",children:[" ",l.revenue.toLocaleString()]})]}),a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-2",children:"Total Users"}),a.jsx("div",{className:"text-3xl font-black text-dark",children:l.users.toLocaleString()})]}),a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-2",children:"Active Posts"}),a.jsx("div",{className:"text-3xl font-black text-dark",children:l.posts.toLocaleString()})]}),a.jsxs("div",{onClick:()=>o("verify"),className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100 cursor-pointer hover:shadow-md transition-all group",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-2 group-hover:text-primary",children:"Pending Verify"}),a.jsx("div",{className:"text-3xl font-black text-blue-500",children:u.length})]}),a.jsxs("div",{onClick:()=>o("reports"),className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100 cursor-pointer hover:shadow-md transition-all group",children:[a.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-2 group-hover:text-red-500",children:"Pending Reports"}),a.jsx("div",{className:"text-3xl font-black text-red-500",children:f.length})]})]}),i==="verify"&&a.jsx("div",{className:"space-y-4 animate-fade-in",children:u.length===0?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"No pending requests."}):u.map(N=>{var E,w,v,T;return a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100 flex flex-col md:flex-row gap-6",children:[a.jsxs("div",{className:"flex gap-4 overflow-x-auto",children:[a.jsxs("a",{href:N.frontURL,target:"_blank",rel:"noreferrer",className:"block w-40 h-24 rounded-xl overflow-hidden bg-gray-100 border border-gray-200 relative group",children:[a.jsx("img",{src:N.frontURL,className:"w-full h-full object-cover",alt:"ID Front"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"View Front"})]}),a.jsxs("a",{href:N.backURL,target:"_blank",rel:"noreferrer",className:"block w-40 h-24 rounded-xl overflow-hidden bg-gray-100 border border-gray-200 relative group",children:[a.jsx("img",{src:N.backURL,className:"w-full h-full object-cover",alt:"ID Back"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity text-white text-xs font-bold",children:"View Back"})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex justify-between items-start mb-2",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-xl font-bold text-dark flex items-center gap-2",children:[N.name,N.targetType==="business_page"&&a.jsx("span",{className:"bg-blue-100 text-blue-600 text-[10px] px-2 py-0.5 rounded-full uppercase",children:"Business"})]}),a.jsx("p",{className:"text-sm text-gray-500",children:N.targetType==="business_page"?a.jsxs(a.Fragment,{children:["Type: ",(E=N.details)==null?void 0:E.businessType,"  Reg: ",(w=N.details)==null?void 0:w.regNumber]}):a.jsxs(a.Fragment,{children:[N.docType,"  ",N.category]})})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("span",{className:"bg-green-100 text-green-700 text-xs font-bold px-3 py-1 rounded-full",children:["Paid ",(v=N.payment)==null?void 0:v.amount]}),a.jsxs("p",{className:"text-[10px] text-gray-400 mt-1",children:["TXN: ",(T=N.payment)==null?void 0:T.txnId]})]})]}),a.jsxs("div",{className:"flex gap-3 mt-4",children:[a.jsx("button",{onClick:()=>x(N,"approve"),className:"bg-blue-500 text-white px-6 py-2 rounded-xl font-bold text-sm hover:bg-blue-600 shadow-md",children:"Approve & Verify"}),a.jsx("button",{onClick:()=>x(N,"reject"),className:"bg-white border border-gray-200 text-gray-600 px-6 py-2 rounded-xl font-bold text-sm hover:bg-gray-50",children:"Reject"})]})]})]},N.id)})}),i==="reports"&&a.jsx("div",{className:"space-y-4 animate-fade-in",children:f.length===0?a.jsx("div",{className:"text-center py-20 text-gray-400",children:"Clean records! No reports."}):f.map(N=>a.jsxs("div",{className:"bg-white p-4 rounded-[24px] shadow-sm border border-red-100 flex items-center gap-4",children:[a.jsx("div",{className:"w-12 h-12 bg-red-50 rounded-full flex items-center justify-center text-red-500 text-xl shrink-0",children:a.jsx("i",{className:"fas fa-exclamation-triangle"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("h4",{className:"font-bold text-dark text-sm",children:["Reported ",N.type]}),a.jsx("p",{className:"text-xs text-red-500 font-bold uppercase tracking-wider mt-1",children:N.reason}),a.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["Target ID: ",N.targetId||N.postId]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{onClick:()=>t(N.type==="post"?`/post/${N.targetId||N.postId}`:`/product/${N.targetId}`),className:"px-4 py-2 bg-gray-100 text-dark rounded-lg text-xs font-bold hover:bg-gray-200",children:"View Content"}),a.jsx("button",{onClick:()=>b(N,"delete_content"),className:"px-4 py-2 bg-red-500 text-white rounded-lg text-xs font-bold hover:bg-red-600 shadow-sm",children:"Delete Content"}),a.jsx("button",{onClick:()=>b(N,"dismiss"),className:"px-4 py-2 border border-gray-200 text-gray-500 rounded-lg text-xs font-bold hover:bg-gray-50",children:"Dismiss"})]})]},N.id))})]}):null},aq=({location:t,radius:e})=>a.jsxs("div",{className:"relative w-full h-48 bg-blue-50 rounded-xl overflow-hidden border-2 border-blue-100 group",children:[a.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:"radial-gradient(#3b82f6 1px, transparent 1px)",backgroundSize:"20px 20px"}}),a.jsxs("div",{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 flex flex-col items-center",children:[a.jsx("div",{className:"w-32 h-32 rounded-full border-2 border-blue-500/30 bg-blue-500/10 flex items-center justify-center animate-pulse",children:a.jsx("div",{className:"w-16 h-16 rounded-full border-2 border-blue-500/50 bg-blue-500/20"})}),a.jsx("i",{className:"fas fa-map-marker-alt text-4xl text-red-500 -mt-24 drop-shadow-lg"}),a.jsxs("div",{className:"bg-white px-3 py-1 rounded-full shadow-md text-xs font-bold mt-2 whitespace-nowrap",children:[t," (+",e,"km)"]})]}),a.jsx("div",{className:"absolute bottom-2 right-2 bg-white/80 backdrop-blur-sm px-2 py-1 rounded text-[10px] font-bold text-gray-500",children:"Google Maps"})]}),oq=()=>{const t=tt(),e=Hs(),[n,s]=g.useState(null),[r,i]=g.useState(!0),[o,l]=g.useState([]),[c,u]=g.useState([]),[h,f]=g.useState("dashboard"),[m,x]=g.useState(1),[b,N]=g.useState("profile"),[E,w]=g.useState([]),[v,T]=g.useState(null),[I,R]=g.useState(null),[V,j]=g.useState("post"),[y,k]=g.useState({headline:"",text:"",media:null,preview:null,cta:"Learn More"}),[S,D]=g.useState({locations:["Dhaka"],gender:"All",age:[18,65],radius:10}),[P,C]=g.useState({daily:500,duration:7}),[q,ue]=g.useState("engagement"),[Se,fe]=g.useState(!1),K=["Dhaka","Chittagong","Sylhet","Rajshahi","Khulna","Barisal","Rangpur","Mymensingh","Comilla","Gazipur","Cox's Bazar"],[se,ne]=g.useState(""),[F,G]=g.useState([]),J=P.daily*P.duration,we=Math.floor(P.daily*15*(S.locations.length*.8));g.useEffect(()=>{const Q=Pt(Ve,async oe=>{var Me;if(oe){s(oe);const Ze=qe(ae(L,"boost_requests"),rt("requesterId","==",oe.uid),_t("timestamp","desc")),vt=await Zt(Ze);l(vt.docs.map(Nt=>({id:Nt.id,...Nt.data()})));const Pn=qe(ae(L,"posts"),rt("uid","==",oe.uid),_t("timestamp","desc"),Ur(12)),Yt=await Zt(Pn);w(Yt.docs.map(Nt=>({id:Nt.id,...Nt.data()})));const as=qe(ae(L,"business_pages"),rt("ownerId","==",oe.uid)),un=await Zt(as);u(un.docs.map(Nt=>({id:Nt.id,...Nt.data()}))),(Me=e.state)!=null&&Me.openBoost&&(f("wizard"),x(1),e.state.type==="business"?(N("business"),e.state.pageId&&R(e.state.pageId)):N("profile")),i(!1)}else t("/")});return()=>Q()},[e.state]),g.useEffect(()=>{se.length>1?G(K.filter(Q=>Q.toLowerCase().includes(se.toLowerCase()))):G([])},[se]);const je=Q=>{const oe=Q.target.files[0];oe&&k({...y,media:oe,preview:URL.createObjectURL(oe)})},U=async()=>{i(!0);try{let Q=(v==null?void 0:v.mediaURL)||null;if(V==="custom"&&y.media){const oe=sn(rn,`ads/${n.uid}/${Date.now()}_${y.media.name}`);await An(oe,y.media),Q=await nn(oe)}await ze(ae(L,"boost_requests"),{requesterId:n.uid,type:b,targetId:b==="business"?I:n.uid,source:V,creative:V==="custom"?{...y,media:Q}:{text:v.text,media:v.mediaURL},goal:q,targeting:S,budget:P,totalCost:J,status:"review",timestamp:Ie()}),alert("Campaign Launched Successfully! "),window.location.reload()}catch(Q){console.error(Q),alert("Failed to launch campaign.")}finally{i(!1),fe(!1)}};if(r)return a.jsx("div",{className:"p-20 text-center",children:"Loading Boost Hub..."});const xe=()=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h3",{className:"text-2xl font-black text-dark",children:"Select Boost Type"}),a.jsx("p",{className:"text-gray-500",children:"Who are you promoting?"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{onClick:()=>{N("profile"),x(2)},className:`p-6 rounded-[30px] border-2 cursor-pointer transition-all shadow-sm hover:shadow-xl text-center group ${b==="profile"?"border-pink-500 bg-pink-50":"border-gray-100 bg-white"}`,children:[a.jsx("div",{className:"w-20 h-20 bg-pink-100 text-pink-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:a.jsx("i",{className:"fas fa-user-astronaut text-4xl"})}),a.jsx("h4",{className:"font-black text-xl text-dark",children:"Personal Profile"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Gain followers & influence"})]}),a.jsxs("div",{onClick:()=>{N("business")},className:`p-6 rounded-[30px] border-2 cursor-pointer transition-all shadow-sm hover:shadow-xl text-center group ${b==="business"?"border-blue-500 bg-blue-50":"border-gray-100 bg-white"}`,children:[a.jsx("div",{className:"w-20 h-20 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center mx-auto mb-4 group-hover:scale-110 transition-transform",children:a.jsx("i",{className:"fas fa-store text-4xl"})}),a.jsx("h4",{className:"font-black text-xl text-dark",children:"Business Page"}),a.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Get sales & shop visits"})]})]}),b==="business"&&a.jsxs("div",{className:"animate-fade-in mt-6 border-t border-gray-200 pt-6",children:[a.jsx("h4",{className:"font-bold text-dark mb-4 text-center",children:"Select Your Business"}),c.length===0?a.jsx("p",{className:"text-center text-red-500 text-sm",children:"You have no business pages. Create one first."}):a.jsx("div",{className:"grid grid-cols-1 gap-3",children:c.map(Q=>a.jsxs("div",{onClick:()=>{R(Q.id),x(2)},className:`flex items-center gap-4 p-4 rounded-2xl border-2 cursor-pointer hover:bg-white transition-all ${I===Q.id?"border-blue-500 bg-white shadow-md":"border-gray-100 bg-gray-50"}`,children:[a.jsx("img",{src:Q.logo,className:"w-12 h-12 rounded-lg object-cover",alt:Q.name}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h5",{className:"font-bold text-dark",children:Q.name}),a.jsx("p",{className:"text-xs text-gray-500",children:Q.category})]}),a.jsx("i",{className:"fas fa-chevron-right text-gray-400"})]},Q.id))})]})]}),re=()=>a.jsxs("div",{className:"space-y-6 animate-fade-in",children:[a.jsxs("div",{className:"flex bg-gray-100 p-1 rounded-xl mb-6",children:[a.jsx("button",{onClick:()=>j("post"),className:`flex-1 py-3 rounded-lg text-sm font-bold transition-all ${V==="post"?"bg-white shadow text-dark":"text-gray-500"}`,children:"Select Existing Post"}),a.jsx("button",{onClick:()=>j("custom"),className:`flex-1 py-3 rounded-lg text-sm font-bold transition-all ${V==="custom"?"bg-white shadow text-dark":"text-gray-500"}`,children:"Upload Custom Ad"})]}),V==="post"?a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-dark mb-4",children:"Select a post to boost"}),a.jsx("div",{className:"grid grid-cols-2 gap-3 max-h-[400px] overflow-y-auto custom-scrollbar p-1",children:E.map(Q=>a.jsxs("div",{onClick:()=>T(Q),className:`relative rounded-xl overflow-hidden border-2 cursor-pointer transition-all ${(v==null?void 0:v.id)===Q.id?"border-primary ring-2 ring-primary/30":"border-transparent"}`,children:[Q.mediaURL?Q.mediaType==="video"?a.jsx("video",{src:Q.mediaURL,className:"w-full h-32 object-cover bg-black"}):a.jsx("img",{src:Q.mediaURL,className:"w-full h-32 object-cover"}):a.jsxs("div",{className:"w-full h-32 bg-gray-100 flex items-center justify-center text-xs text-gray-400 p-2 text-center break-words",children:[Q.text.substring(0,50),"..."]}),(v==null?void 0:v.id)===Q.id&&a.jsx("div",{className:"absolute inset-0 bg-primary/20 flex items-center justify-center",children:a.jsx("div",{className:"bg-primary text-white rounded-full w-8 h-8 flex items-center justify-center shadow-lg",children:a.jsx("i",{className:"fas fa-check"})})})]},Q.id))})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-2xl p-8 text-center hover:bg-gray-50 transition-colors relative cursor-pointer",children:[a.jsx("input",{type:"file",className:"absolute inset-0 opacity-0 cursor-pointer",onChange:je,accept:"image/*,video/*"}),y.preview?a.jsx("img",{src:y.preview,className:"h-40 mx-auto rounded-lg object-cover shadow-md"}):a.jsxs("div",{className:"text-gray-400",children:[a.jsx("i",{className:"fas fa-cloud-upload-alt text-4xl mb-2"}),a.jsx("p",{className:"font-bold text-sm",children:"Upload Ad Media"})]})]}),a.jsx("input",{value:y.headline,onChange:Q=>k({...y,headline:Q.target.value}),placeholder:"Ad Headline (e.g. Summer Sale!)",className:"w-full bg-gray-50 p-4 rounded-xl font-bold text-dark outline-none"}),a.jsx("textarea",{value:y.text,onChange:Q=>k({...y,text:Q.target.value}),placeholder:"Ad Text...",className:"w-full bg-gray-50 p-4 rounded-xl text-sm text-dark outline-none",rows:"3"}),a.jsx("select",{value:y.cta,onChange:Q=>k({...y,cta:Q.target.value}),className:"w-full bg-gray-50 p-4 rounded-xl font-bold text-dark outline-none",children:["Learn More","Shop Now","Sign Up","Message Us","Call Now"].map(Q=>a.jsx("option",{value:Q,children:Q},Q))})]})]}),Ee=()=>a.jsxs("div",{className:"space-y-6 animate-fade-in",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Goal"}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:(b==="business"?["Shop Visits","Messages","Sales","Website Clicks"]:["Followers","Profile Visits","Engagement","Messages"]).map(Q=>a.jsx("button",{onClick:()=>ue(Q),className:`py-3 rounded-xl text-xs font-bold border transition-all ${q===Q?"bg-dark text-white border-dark":"bg-white text-gray-500 border-gray-200"}`,children:Q},Q))})]}),a.jsxs("div",{children:[a.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase mb-2 block",children:"Location"}),a.jsxs("div",{className:"relative",children:[a.jsx("i",{className:"fas fa-search absolute left-4 top-3.5 text-gray-400"}),a.jsx("input",{value:se,onChange:Q=>ne(Q.target.value),placeholder:"Search District / City...",className:"w-full bg-white border border-gray-200 rounded-xl pl-10 pr-4 py-3 text-sm font-bold outline-none focus:border-primary"}),F.length>0&&a.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-white border border-gray-100 rounded-xl shadow-xl z-20 p-1 max-h-40 overflow-y-auto",children:F.map(Q=>a.jsx("button",{onClick:()=>{S.locations.includes(Q)||D(oe=>({...oe,locations:[...oe.locations,Q]})),ne("")},className:"w-full text-left px-4 py-2 text-sm font-bold hover:bg-gray-50 rounded-lg text-gray-600",children:Q},Q))})]}),a.jsx("div",{className:"mt-4",children:a.jsx(aq,{location:S.locations[0]||"Bangladesh",radius:S.radius})}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-3",children:S.locations.map(Q=>a.jsxs("span",{className:"bg-dark text-white px-3 py-1 rounded-full text-xs font-bold flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-map-marker-alt"})," ",Q,a.jsx("button",{onClick:()=>D(oe=>({...oe,locations:oe.locations.filter(Me=>Me!==Q)})),children:a.jsx("i",{className:"fas fa-times"})})]},Q))})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-xs font-bold text-gray-500 mb-2",children:[a.jsx("span",{children:"Radius"}),a.jsxs("span",{children:[S.radius," km"]})]}),a.jsx("input",{type:"range",min:"5",max:"100",value:S.radius,onChange:Q=>D({...S,radius:parseInt(Q.target.value)}),className:"w-full accent-primary"})]})]}),be=()=>a.jsxs("div",{className:"space-y-6 animate-fade-in",children:[a.jsxs("div",{className:"bg-gradient-to-r from-green-400 to-teal-500 p-6 rounded-[24px] text-white shadow-lg relative overflow-hidden",children:[a.jsxs("div",{className:"relative z-10",children:[a.jsx("p",{className:"text-sm font-medium opacity-90 mb-1",children:"Estimated Reach"}),a.jsx("h2",{className:"text-4xl font-black",children:we.toLocaleString()}),a.jsx("p",{className:"text-xs opacity-80 mt-2",children:"People will see your ad"})]}),a.jsx("i",{className:"fas fa-users absolute -bottom-4 -right-4 text-9xl opacity-10"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm font-bold text-dark mb-2",children:[a.jsx("span",{children:"Daily Budget"})," ",a.jsxs("span",{children:["",P.daily]})]}),a.jsx("input",{type:"range",min:"100",max:"5000",step:"100",value:P.daily,onChange:Q=>C({...P,daily:parseInt(Q.target.value)}),className:"w-full accent-green-500 h-2 bg-gray-200 rounded-lg cursor-pointer"})]}),a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between text-sm font-bold text-dark mb-2",children:[a.jsx("span",{children:"Duration"})," ",a.jsxs("span",{children:[P.duration," Days"]})]}),a.jsx("input",{type:"range",min:"1",max:"30",value:P.duration,onChange:Q=>C({...P,duration:parseInt(Q.target.value)}),className:"w-full accent-blue-500 h-2 bg-gray-200 rounded-lg cursor-pointer"})]})]}),a.jsxs("div",{className:"p-4 bg-gray-50 rounded-2xl border border-gray-200 flex justify-between items-center",children:[a.jsx("span",{className:"text-gray-500 font-bold text-sm",children:"Total Cost"}),a.jsxs("span",{className:"text-2xl font-black text-primary",children:["",J.toLocaleString()]})]})]});return a.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1200px] mx-auto pb-24",children:[a.jsx("div",{className:"hidden md:block",children:a.jsx(yn,{})}),h==="dashboard"?a.jsxs("div",{className:"space-y-8 animate-fade-in",children:[a.jsxs("div",{className:"flex justify-between items-end",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-4xl font-black text-dark mb-1",children:"Boost Hub"}),a.jsx("p",{className:"text-gray-500 font-bold",children:"Professional Ad Tools"})]}),a.jsxs("button",{onClick:()=>f("wizard"),className:"bg-gradient-to-r from-primary to-primary-dark text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:shadow-primary/30 transition-all flex items-center gap-2",children:[a.jsx("i",{className:"fas fa-plus"})," Create Ad"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"text-gray-400 text-xs font-bold uppercase mb-2",children:"Active Ads"}),a.jsx("p",{className:"text-3xl font-black text-primary",children:o.length})]}),a.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[a.jsx("h3",{className:"text-gray-400 text-xs font-bold uppercase mb-2",children:"Total Spent"}),a.jsx("p",{className:"text-3xl font-black text-dark",children:"0"})]})]}),a.jsx("h3",{className:"text-xl font-bold text-dark mt-8",children:"Recent Campaigns"}),a.jsx("div",{className:"space-y-4",children:o.length===0?a.jsx("div",{className:"text-center py-16 bg-white rounded-[30px] border-2 border-dashed border-gray-200 text-gray-400 font-bold",children:"No campaigns yet. Start one today!"}):o.map(Q=>a.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center text-white text-xl ${Q.type==="business"?"bg-blue-500":"bg-pink-500"}`,children:a.jsx("i",{className:`fas ${Q.type==="business"?"fa-store":"fa-user"}`})}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-dark capitalize",children:Q.goal.replace("_"," ")}),a.jsxs("p",{className:"text-xs text-gray-500",children:["Budget: ",(Q.budget.daily*Q.budget.duration).toLocaleString()]})]})]}),a.jsx("span",{className:"bg-green-500 text-white text-[10px] font-bold px-3 py-1 rounded-full uppercase",children:"Active"})]},Q.id))})]}):a.jsxs("div",{className:"bg-white w-full max-w-2xl mx-auto rounded-[30px] shadow-xl overflow-hidden flex flex-col min-h-[600px] animate-slide-up",children:[a.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-black text-dark",children:"Create Campaign"}),a.jsxs("p",{className:"text-xs text-gray-500 font-bold uppercase tracking-wider",children:["Step ",m," of 4"]})]}),a.jsx("button",{onClick:()=>{f("dashboard"),x(1)},className:"w-10 h-10 bg-white rounded-full shadow-sm flex items-center justify-center text-gray-400 hover:text-red-500 transition-all",children:a.jsx("i",{className:"fas fa-times"})})]}),a.jsxs("div",{className:"flex-1 p-6 md:p-8 overflow-y-auto custom-scrollbar",children:[m===1&&xe(),m===2&&re(),m===3&&Ee(),m===4&&be()]}),a.jsxs("div",{className:"p-6 border-t border-gray-100 bg-white flex gap-3 shadow-lg z-20",children:[m>1&&a.jsx("button",{onClick:()=>x(Q=>Q-1),className:"px-6 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Back"}),m<4?a.jsx("button",{onClick:()=>{if(m===1&&!b)return alert("Select type");if(m===2&&V==="post"&&!v)return alert("Select a post");x(Q=>Q+1)},className:"flex-1 bg-dark text-white py-3 rounded-xl font-bold hover:bg-primary transition-all shadow-lg",children:"Next Step"}):a.jsxs("button",{onClick:()=>fe(!0),className:"flex-1 bg-gradient-to-r from-primary to-primary-dark text-white py-3 rounded-xl font-bold hover:shadow-primary/30 transition-all shadow-lg",children:["Pay ",J.toLocaleString()," & Launch"]})]})]}),Se&&a.jsx(Y0,{amount:J,itemName:`${b} Boost (${P.duration} Days)`,onClose:()=>fe(!1),onSuccess:U})]})};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lq=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),VA=(...t)=>t.filter((e,n,s)=>!!e&&s.indexOf(e)===n).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var cq={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uq=g.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...l},c)=>g.createElement("svg",{ref:c,...cq,width:e,height:e,stroke:t,strokeWidth:s?Number(n)*24/Number(e):n,className:VA("lucide",r),...l},[...o.map(([u,h])=>g.createElement(u,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=(t,e)=>{const n=g.forwardRef(({className:s,...r},i)=>g.createElement(uq,{ref:i,iconNode:e,className:VA(`lucide-${lq(t)}`,s),...r}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dq=Yi("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hq=Yi("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fq=Yi("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mq=Yi("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $E=Yi("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pq=Yi("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gq=Yi("Volume1",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xq=Yi("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]),yq={iceServers:[{urls:["stun:stun1.l.google.com:19302","stun:stun2.l.google.com:19302"]}],iceCandidatePoolSize:10},vq=()=>{var D,P;const{activeCall:t,endActiveCall:e,isMinimized:n,setIsMinimized:s}=Q0(),[r,i]=g.useState(null),[o,l]=g.useState(null),[c,u]=g.useState(!1),[h,f]=g.useState(!0),[m,x]=g.useState(!0),[b,N]=g.useState("Connecting..."),[E,w]=g.useState(null),v=g.useRef(null),T=g.useRef(null),I=g.useRef(null),R=g.useRef([]);g.useEffect(()=>{if(!t)return;let C=null,q=null;const ue=async()=>{try{I.current=new RTCPeerConnection(yq),I.current.oniceconnectionstatechange=()=>{I.current.iceConnectionState==="connected"||I.current.iceConnectionState==="completed"?N("Connected"):I.current.iceConnectionState==="disconnected"?N("Reconnecting..."):I.current.iceConnectionState==="failed"&&(N("Connection Failed"),setTimeout(j,2e3))};const fe=await navigator.mediaDevices.getUserMedia({video:t.type==="video",audio:!0});i(fe),fe.getTracks().forEach(ne=>I.current.addTrack(ne,fe)),I.current.ontrack=ne=>{ne.streams&&ne.streams[0]&&(l(ne.streams[0]),N("Connected"))};const K=H(L,"calls",t.id),se=ae(K,"candidates");if(I.current.onicecandidate=ne=>{ne.candidate&&ze(se,{...ne.candidate.toJSON(),senderId:t.isCaller?"caller":"callee"})},t.isCaller){const ne=await I.current.createOffer();await I.current.setLocalDescription(ne),await he(K,{offer:{type:ne.type,sdp:ne.sdp},status:"calling"}),C=Fe(K,async F=>{const G=F.data();if(!(!I.current||!G)){if(!I.current.currentRemoteDescription&&G.answer){const J=new RTCSessionDescription(G.answer);await I.current.setRemoteDescription(J),Se()}(G.status==="ended"||G.status==="rejected")&&V()}})}else C=Fe(K,async ne=>{const F=ne.data();if(!(!I.current||!F)){if(F.status==="ended"){V();return}if(!I.current.currentRemoteDescription&&F.offer){const G=new RTCSessionDescription(F.offer);await I.current.setRemoteDescription(G),Se();const J=await I.current.createAnswer();await I.current.setLocalDescription(J),await he(K,{answer:{type:J.type,sdp:J.sdp}})}}});q=Fe(ae(K,"candidates"),ne=>{ne.docChanges().forEach(F=>{if(F.type==="added"){const G=F.doc.data(),J=t.isCaller?"callee":"caller";if(G.senderId===J){const we=new RTCIceCandidate(G);I.current.remoteDescription?I.current.addIceCandidate(we).catch(je=>console.warn("Candidate Error",je)):R.current.push(we)}}})})}catch(fe){console.error("WebRTC error:",fe),w("Connection failed."),setTimeout(()=>V(),3e3)}},Se=()=>{I.current&&(R.current.forEach(fe=>{I.current.addIceCandidate(fe).catch(K=>console.warn("Queue Error",K))}),R.current=[])};return ue(),()=>{C&&C(),q&&q(),V()}},[t]);const V=()=>{r&&r.getTracks().forEach(C=>C.stop()),I.current&&(I.current.close(),I.current=null),i(null),l(null),e()},j=async()=>{try{await he(H(L,"calls",t.id),{status:"ended"})}catch{}V()},y=()=>{if(r){const C=r.getAudioTracks();C.length>0?(C.forEach(q=>{q.enabled=!q.enabled}),u(!C[0].enabled)):console.warn("No audio tracks found to mute.")}},k=()=>{r&&(r.getVideoTracks().forEach(q=>q.enabled=!q.enabled),f(!h))},S=async()=>{const C=T.current;if(!C||typeof C.setSinkId!="function"){x(!m);return}try{const q=m?"":"default";await C.setSinkId(q),x(!m)}catch(q){console.error("Speaker toggle failed",q)}};return g.useEffect(()=>{v.current&&r&&(v.current.srcObject=r)},[r,n,h]),g.useEffect(()=>{T.current&&o&&(T.current.srcObject=o)},[o,n]),t?n?a.jsxs("div",{className:"fixed top-20 right-4 w-36 h-52 bg-gray-900 rounded-xl shadow-2xl z-[9999] overflow-hidden border border-white/20 cursor-move",children:[o?a.jsx("video",{ref:T,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}):a.jsx("div",{className:"w-full h-full flex items-center justify-center bg-gray-800 text-white text-xs",children:"Connecting..."}),a.jsx("button",{onClick:()=>s(!1),className:"absolute inset-0 z-10"})]}):a.jsxs("div",{className:"fixed inset-0 z-[9999] bg-[#1a1a1a] flex flex-col items-center justify-center",children:[E&&a.jsx("div",{className:"absolute top-4 bg-red-500 text-white px-6 py-2 rounded-full z-50",children:E}),a.jsx("div",{className:"absolute inset-0 w-full h-full",children:o?a.jsx("video",{ref:T,autoPlay:!0,playsInline:!0,className:"w-full h-full object-cover"}):a.jsxs("div",{className:"w-full h-full flex flex-col items-center justify-center bg-gray-900",children:[a.jsx("img",{src:((D=t.otherUser)==null?void 0:D.avatar)||"https://via.placeholder.com/150",className:"w-32 h-32 rounded-full border-4 border-white/10 animate-pulse object-cover mb-4"}),a.jsx("h2",{className:"text-white text-2xl font-bold",children:(P=t.otherUser)==null?void 0:P.name}),a.jsx("p",{className:"text-gray-400 mt-2",children:b})]})}),t.type==="video"&&r&&a.jsx("div",{className:"absolute top-6 right-6 w-32 h-48 bg-black rounded-xl overflow-hidden shadow-lg border border-white/20 z-20",children:h?a.jsx("video",{ref:v,autoPlay:!0,playsInline:!0,muted:!0,className:"w-full h-full object-cover transform scale-x-[-1]"}):a.jsx("div",{className:"w-full h-full bg-gray-800 flex items-center justify-center",children:a.jsx($E,{className:"text-gray-500"})})}),a.jsxs("div",{className:"absolute bottom-10 flex items-center gap-6 p-4 px-8 bg-black/60 backdrop-blur-xl rounded-full border border-white/10 z-30",children:[a.jsx("button",{onClick:S,className:`p-4 rounded-full ${m?"bg-white text-black":"bg-gray-700 text-white"}`,children:m?a.jsx(xq,{size:24}):a.jsx(gq,{size:24})}),a.jsx("button",{onClick:y,className:`p-4 rounded-full ${c?"bg-red-500 text-white":"bg-white text-black"}`,children:c?a.jsx(dq,{size:24}):a.jsx(hq,{size:24})}),t.type==="video"&&a.jsx("button",{onClick:k,className:`p-4 rounded-full ${h?"bg-gray-700 text-white":"bg-white text-black"}`,children:h?a.jsx(pq,{size:24}):a.jsx($E,{size:24})}),a.jsx("button",{onClick:j,className:"p-5 rounded-full bg-red-600 text-white shadow-lg",children:a.jsx(mq,{size:32})}),a.jsx("button",{onClick:()=>s(!0),className:"p-4 rounded-full bg-gray-700 text-white",children:a.jsx(fq,{size:24})})]})]}):null};function bq(){const[t,e]=g.useState(null),[n,s]=g.useState(!0);return g.useEffect(()=>{let r,i=()=>{};return r=Pt(Ve,async o=>{if(e(o),s(!1),i(),o&&o.emailVerified){const l=H(L,"users",o.uid),c=()=>{he(l,{isOnline:!1,lastSeen:Ie()}).catch(u=>console.error(u))};await he(l,{isOnline:!0,lastSeen:Ie()}),window.addEventListener("beforeunload",c),i=()=>window.removeEventListener("beforeunload",c)}}),()=>{r&&r(),i()}},[]),n?a.jsx("div",{className:"min-h-screen bg-[#f0f4f8] flex items-center justify-center",children:a.jsxs("div",{className:"flex flex-col items-center animate-pulse",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-tr from-[#008080] to-[#FFD166] rounded-2xl animate-spin shadow-2xl shadow-teal-900/20 mb-6 flex items-center justify-center",children:a.jsx("div",{className:"w-8 h-8 bg-white/30 rounded-md"})}),a.jsx("p",{className:"text-[#008080] font-black text-sm tracking-[0.3em] uppercase",children:"INITIALIZING TUKUMI..."})]})}):t?t.emailVerified?a.jsx(wD,{future:{v7_startTransition:!0,v7_relativeSplatPath:!0},children:a.jsxs(PB,{children:[a.jsx(DB,{}),a.jsx(vq,{}),a.jsxs("div",{className:"min-h-screen bg-[#f0f4f8] text-[#111827]",children:[a.jsx(AB,{}),a.jsx(RB,{}),a.jsx("div",{className:"w-full md:ml-[300px] md:w-[calc(100%-300px)] p-4 pb-28 transition-all duration-300",children:a.jsxs(xD,{children:[a.jsx(Lt,{path:"/",element:a.jsx(ZB,{})}),a.jsx(Lt,{path:"/explore",element:a.jsx(eq,{})}),a.jsx(Lt,{path:"/profile",element:a.jsx(TN,{})}),a.jsx(Lt,{path:"/profile/:id",element:a.jsx(TN,{})}),a.jsx(Lt,{path:"/profile/:id/connections",element:a.jsx(Z8,{})}),a.jsx(Lt,{path:"/messages",element:a.jsx(e6,{})}),a.jsx(Lt,{path:"/watch",element:a.jsx(d6,{})}),a.jsx(Lt,{path:"/dating",element:a.jsx(Y8,{})}),a.jsx(Lt,{path:"/notifications",element:a.jsx(J8,{})}),a.jsx(Lt,{path:"/marketplace",element:a.jsx(a6,{})}),a.jsx(Lt,{path:"/product/:id",element:a.jsx(o6,{})}),a.jsx(Lt,{path:"/business",element:a.jsx(l6,{})}),a.jsx(Lt,{path:"/business/:id",element:a.jsx(c6,{})}),a.jsx(Lt,{path:"/circles",element:a.jsx(n6,{})}),a.jsx(Lt,{path:"/circles/:circleId",element:a.jsx(i6,{})}),a.jsx(Lt,{path:"/saved-items",element:a.jsx(u6,{})}),a.jsx(Lt,{path:"/post/:id",element:a.jsx(sq,{})}),a.jsx(Lt,{path:"*",element:a.jsx(pD,{to:"/"})}),a.jsx(Lt,{path:"/bkash/callback",element:a.jsx(rq,{})}),a.jsx(Lt,{path:"/admin",element:a.jsx(iq,{})}),a.jsx(Lt,{path:"/boost",element:a.jsx(oq,{})})]})})]})]})}):a.jsx(MB,{user:t}):a.jsx(VB,{})}class wq extends Cf.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,n){console.error("React Error Boundary Caught:",e,n)}render(){var e;return this.state.hasError?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-red-50 text-red-900 p-10 text-center",children:a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-4",children:"Something went wrong."}),a.jsx("p",{className:"mb-4",children:(e=this.state.error)==null?void 0:e.message}),a.jsx("button",{onClick:()=>window.location.reload(),className:"bg-red-600 text-white px-6 py-2 rounded-lg font-bold transition duration-150 hover:bg-red-700",children:"Reload App"})]})}):this.props.children}}Lp.createRoot(document.getElementById("root")).render(a.jsx(Cf.StrictMode,{children:a.jsx(wq,{children:a.jsx(OB,{children:a.jsx(bq,{})})})}));
