import{j as e}from"./ui-BndUj6rU.js";import{e as Le,u as oe,r as i}from"./vendor-C_rG9DFw.js";import{T as Se,E as Fe}from"./TopBar-UEOhfdgU.js";import{B as Ue}from"./BoostModal-C1gW14Y4.js";import{V as Me}from"./VerificationModal-CmfMMQwG.js";import{a as p,d as n}from"./index-gjDmyrly.js";import{o as Ee,h as $,j as u,L as Ie,I as _,H as g,v as j,J as G,t as I,k as v,u as P,K as $e,q as ne,n as ce,w as Ve,D as Ae}from"./firebase-BaLQ-sp5.js";import"./PaymentModal-DBoEzFiD.js";const b="https://ui-avatars.com/api/?name=User&background=random",Be=({postId:f,currentUser:R,onReply:s})=>{const y=oe(),[d,V]=i.useState([]);if(i.useEffect(()=>{const o=ne(v(n,"posts",f,"comments"),ce("timestamp","asc")),h=$(o,w=>{const a=w.docs.map(S=>({id:S.id,...S.data()}));V(a)});return()=>h()},[f]),d.length===0)return null;const N=d.filter(o=>!o.parentId),A=o=>d.filter(h=>h.parentId===o),L=({c:o,isReply:h})=>e.jsxs("div",{className:`flex gap-3 items-start text-sm mb-3 ${h?"ml-10":""}`,children:[e.jsx("img",{src:o.userAvatar||b,className:"w-8 h-8 rounded-full object-cover flex-shrink-0 cursor-pointer border border-gray-100",alt:o.userName,onClick:()=>y(`/profile/${o.uid}`),onError:w=>{w.target.src=b}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"bg-gray-50 px-3 py-2 rounded-2xl rounded-tl-none inline-block border border-gray-100",children:[e.jsxs("span",{className:"font-bold text-xs block text-dark cursor-pointer hover:underline flex items-center gap-1",onClick:()=>y(`/profile/${o.uid}`),children:[o.userName,o.isVerified&&e.jsx("i",{className:"fas fa-check-circle text-blue-500 text-[10px]",title:"Verified Commenter"})]}),e.jsx("p",{className:"text-gray-700 leading-tight",children:o.text})]}),!h&&e.jsx("button",{onClick:()=>s(o.id,o.userName),className:"text-[10px] font-bold text-gray-500 ml-2 mt-1 hover:text-primary",children:"Reply"})]})]});return e.jsx("div",{className:"mt-3 px-2 max-h-60 overflow-y-auto custom-scrollbar",children:N.map(o=>e.jsxs("div",{children:[e.jsx(L,{c:o,isReply:!1}),A(o.id).map(h=>e.jsx(L,{c:h,isReply:!0},h.id))]},o.id))})},_e=()=>{var ie;const{id:f}=Le(),R=oe(),[s,y]=i.useState(null),[d,V]=i.useState(null),[N,A]=i.useState([]),[L,o]=i.useState(!1),[h,w]=i.useState(!1),[a,S]=i.useState(null),[F,B]=i.useState(!1),[T,Q]=i.useState(!1),[q,X]=i.useState(null),[U,M]=i.useState(""),[Y,D]=i.useState(null),[E,O]=i.useState(null),[Z,k]=i.useState(null),[de,ee]=i.useState(null),[z,te]=i.useState(""),[me,H]=i.useState(!1),[se,ae]=i.useState(null),[xe,J]=i.useState(!1),[ue,re]=i.useState(!1);i.useEffect(()=>{const t=Ee(p,l=>{if(l){S(l.uid);const m=$(u(n,"users",l.uid),c=>{c.exists()&&V(c.data())}),x=f||l.uid;return o(x===l.uid),K(x),x!==l.uid&&fe(x,l.uid),()=>m()}else f&&K(f)}),r=l=>{l.target.closest(".post-menu-container")||k(null)};return document.addEventListener("click",r),()=>{t(),document.removeEventListener("click",r)}},[f]);const K=t=>{const r=$(u(n,"users",t),c=>{var C;c.exists()?y(c.data()):t===((C=p.currentUser)==null?void 0:C.uid)?y({displayName:p.currentUser.displayName,handle:"user",photoURL:p.currentUser.photoURL,coverPhotoURL:null,bio:"New user",followers:0,following:0,followersList:[],followingList:[]}):y(null)}),l=v(n,"posts"),m=ne(l,Ve("uid","==",t),ce("timestamp","desc")),x=$(m,c=>{A(c.docs.map(C=>({id:C.id,...C.data()})))});return()=>{r(),x()}},fe=async(t,r)=>{const l=u(n,"users",t,"followers",r),m=await Ae(l);B(m.exists())},he=async()=>{if(!a||T)return;Q(!0);const t=f||a;try{const r=Ie(n),l=u(n,"users",t),m=u(n,"users",a),x=u(n,"users",t,"followers",a),c=u(n,"users",a,"following",t);F?(r.delete(x),r.delete(c),r.update(l,{followers:g(-1),followersList:_(a)}),r.update(m,{following:g(-1),followingList:_(t)}),B(!1)):(r.set(x,{timestamp:j()}),r.set(c,{timestamp:j()}),r.update(l,{followers:g(1),followersList:G(a)}),r.update(m,{following:g(1),followingList:G(t)}),B(!0),t!==a&&await I(v(n,"notifications"),{recipientId:t,senderId:a,senderName:p.currentUser.displayName,senderAvatar:p.currentUser.photoURL,type:"follow",targetId:a,timestamp:j(),isRead:!1})),await r.commit()}catch(r){console.error("Follow error:",r)}finally{Q(!1)}},W=((ie=s==null?void 0:s.followingList)==null?void 0:ie.includes(a))&&F,pe=(()=>{const t=s==null?void 0:s.gender;return t==="Male"?"Amigo":t==="Female"?"Amiga":"Amigos"})(),ge=()=>{if(!a)return console.error("Please sign in.");R("/messages",{state:{startChatWith:{...s,uid:f||a}}})},be=async t=>{await I(v(n,"boost_requests"),{...t,requesterId:a,timestamp:j()}),alert("Profile promotion requested!"),J(!1)},ye=async t=>{if(!a)return console.error("Sign in.");const r=u(n,"posts",t.id);t.likedBy&&t.likedBy.includes(a)?await P(r,{likes:g(-1),likedBy:_(a)}):await P(r,{likes:g(1),likedBy:G(a)})},we=t=>{if(!a)return console.error("Sign in to comment.");q===t?X(null):(X(t),M(""),D(null))},je=(t,r)=>{var l;D(t),M(`@${r} `),(l=document.querySelector(`#comment-input-${q}`))==null||l.focus()},le=async t=>{!U.trim()||!a||(await I(v(n,"posts",t,"comments"),{text:U,uid:a,userName:(d==null?void 0:d.displayName)||p.currentUser.displayName,userAvatar:(d==null?void 0:d.photoURL)||p.currentUser.photoURL||b,isVerified:(d==null?void 0:d.isVerified)||!1,parentId:Y,timestamp:j()}),await P(u(n,"posts",t),{comments:g(1)}),M(""),D(null))},ve=async t=>{const r=`${window.location.origin}/post/${t.id}`;navigator.clipboard&&navigator.clipboard.writeText(r).then(()=>alert("Link copied!"))},Ne=async t=>{window.confirm("Delete this post?")&&await $e(u(n,"posts",t))},ke=async t=>{await P(u(n,"posts",t.id),{isPrivate:!t.isPrivate}),k(null)},Ce=async t=>{!se||!a||(await I(v(n,"reports"),{targetId:se,type:"post",reporter:a,reason:t,timestamp:j()}),H(!1),ae(null))},Pe=t=>{ee(t.id),te(t.text),k(null)},Re=async t=>{z.trim()&&(await P(u(n,"posts",t),{text:z}),ee(null))};return s?e.jsxs("div",{className:"p-2 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(Se,{})}),e.jsxs("div",{className:"bg-white rounded-[30px] shadow-sm overflow-hidden mb-8 relative group transition-all hover:shadow-md",children:[e.jsx("div",{className:`h-48 md:h-80 w-full bg-gray-200 bg-cover bg-center relative ${s.isVerified?"ring-b-4 ring-blue-500":""}`,style:{backgroundImage:`url(${s.coverPhotoURL||"https://images.unsplash.com/photo-1579546929518-9e396f3cc809"})`},children:s.isVerified&&e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-blue-900/30 to-transparent"})}),e.jsxs("div",{className:"px-6 md:px-10 pb-8 relative",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end -mt-16 md:-mt-20 mb-6",children:[e.jsx("div",{className:"relative mx-auto md:mx-0",children:e.jsx("div",{className:`w-32 h-32 md:w-44 md:h-44 rounded-[2rem] p-1 bg-white shadow-2xl ${s.isVerified?"ring-4 ring-offset-4 ring-blue-500/50":""}`,children:e.jsx("img",{src:s.photoURL||b,className:"w-full h-full rounded-[1.8rem] object-cover",alt:`${s.displayName} avatar`,onError:t=>{t.target.src=b}})})}),e.jsxs("div",{className:"flex flex-col items-center w-full md:w-auto mt-4 md:mt-0 md:mb-4 gap-3",children:[e.jsxs("div",{className:"flex items-center gap-6 bg-white/90 backdrop-blur-md px-6 py-3 rounded-2xl shadow-sm border border-gray-100",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("span",{className:"block font-black text-lg text-dark",children:N.length}),e.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Posts"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-200"}),e.jsxs("div",{className:"text-center cursor-pointer hover:opacity-70 transition-opacity",onClick:()=>R(`/profile/${f||a}/connections`),children:[e.jsx("span",{className:"block font-black text-lg text-dark",children:s.followers||0}),e.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Followers"})]}),e.jsx("div",{className:"w-px h-8 bg-gray-200"}),e.jsxs("div",{className:"text-center cursor-pointer hover:opacity-70 transition-opacity",onClick:()=>R(`/profile/${f||a}/connections`),children:[e.jsx("span",{className:"block font-black text-lg text-dark",children:s.following||0}),e.jsx("span",{className:"text-xs text-gray-400 font-bold uppercase tracking-wider",children:"Following"})]})]}),e.jsx("div",{className:"flex gap-2",children:L?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>w(!0),className:"bg-gray-100 text-dark border border-gray-200 px-6 py-2 rounded-2xl font-bold hover:bg-gray-200 transition-all",children:"Edit Profile"}),e.jsx("button",{onClick:()=>J(!0),className:"w-10 h-10 rounded-2xl bg-gradient-to-br from-yellow-400 to-orange-500 text-white shadow-md hover:shadow-lg hover:scale-105 transition-all flex items-center justify-center",title:"Promote Profile",children:e.jsx("i",{className:"fas fa-rocket"})}),!s.isVerified&&e.jsx("button",{onClick:()=>re(!0),className:"w-10 h-10 rounded-2xl bg-blue-500 text-white shadow-md hover:bg-blue-600 hover:scale-105 transition-all flex items-center justify-center",title:"Get Verified",children:e.jsx("i",{className:"fas fa-check-circle"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:he,disabled:T,className:`px-6 py-2 rounded-2xl font-bold shadow-md transition-all flex items-center gap-2 
                           ${W?"bg-gradient-to-r from-purple-500 to-pink-500 text-white shadow-pink-500/30 border-none transform hover:scale-105":F?"bg-white text-dark border hover:bg-gray-100":"bg-primary text-white hover:bg-primary-dark"}`,children:T?e.jsx("i",{className:"fas fa-spinner fa-spin"}):W?e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-check"})," ",pe]}):F?"Following":"Follow"}),e.jsx("button",{onClick:ge,className:`bg-white text-primary border px-4 py-2 rounded-2xl font-bold shadow-md transition-all 
                           ${W?"animate-pulse ring-2 ring-primary/50 shadow-primary/30 border-primary":"hover:bg-primary-light/10"}`,title:"Send Message",children:e.jsx("i",{className:"fas fa-comment-alt text-xl"})})]})})]})]}),e.jsxs("div",{className:"text-center md:text-left",children:[e.jsxs("h1",{className:`text-3xl font-black mb-1 flex items-center justify-center md:justify-start gap-2 ${s.isVerified?"text-transparent bg-clip-text bg-gradient-to-r from-blue-700 to-blue-500":"text-dark"}`,children:[s.displayName,s.isVerified&&e.jsx("i",{className:"fas fa-check-circle text-blue-500 text-2xl",title:"Verified Account"})]}),e.jsxs("p",{className:"text-primary font-bold text-sm mb-4",children:["@",s.handle||"user"]}),e.jsx("p",{className:"text-gray-600 leading-relaxed text-lg",children:s.bio}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-4 justify-center md:justify-start",children:[s.profession&&e.jsxs("span",{className:"px-4 py-2 rounded-xl bg-[#F8FAFD] text-gray-600 text-sm font-bold flex items-center gap-2 border border-gray-100",children:[e.jsx("i",{className:"fas fa-briefcase text-primary"})," ",s.profession]}),s.location&&e.jsxs("span",{className:"px-4 py-2 rounded-xl bg-[#F8FAFD] text-gray-600 text-sm font-bold flex items-center gap-2 border border-gray-100",children:[e.jsx("i",{className:"fas fa-map-marker-alt text-primary"})," ",s.location]})]})]})]})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[N.length===0&&e.jsx("div",{className:"text-center py-10 border-2 border-dashed border-gray-200 rounded-3xl",children:e.jsx("p",{className:"text-gray-400 font-bold",children:"No posts yet."})}),N.map(t=>{var x;const r=t.likedBy&&t.likedBy.includes(a),l=a===t.uid;if(t.isPrivate&&!l)return null;const m=s.isVerified;return e.jsxs("div",{className:`bg-white rounded-[24px] p-6 shadow-sm border relative ${m?"border-blue-100":"border-gray-100"}`,children:[t.isPromoted&&e.jsx("div",{className:"absolute top-4 right-16 text-[10px] font-bold text-gray-400 uppercase tracking-wider bg-gray-100 px-2 py-1 rounded",children:"Promoted"}),e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"relative",children:e.jsx("img",{src:t.userAvatar||b,className:`w-12 h-12 rounded-2xl object-cover ${m?"ring-2 ring-blue-400":""}`,alt:`${t.userName} avatar`,onError:c=>{c.target.src=b}})}),e.jsxs("div",{children:[e.jsxs("h4",{className:"font-bold text-dark text-lg flex items-center gap-1",children:[t.userName,m&&e.jsx("i",{className:"fas fa-check-circle text-blue-500 text-sm"}),t.isPrivate&&e.jsx("i",{className:"fas fa-lock text-xs text-gray-400 ml-2",title:"Private Post"})]}),e.jsx("p",{className:"text-xs text-gray-400 font-bold",children:(x=t.timestamp)!=null&&x.seconds?new Date(t.timestamp.seconds*1e3).toLocaleDateString():"Just now"})]})]}),e.jsxs("div",{className:"relative post-menu-container",children:[e.jsx("button",{onClick:()=>k(Z===t.id?null:t.id),className:"text-gray-300 hover:text-dark p-2 transition-colors",children:e.jsx("i",{className:"fas fa-ellipsis-h"})}),Z===t.id&&e.jsx("div",{className:"absolute right-0 top-8 w-40 bg-white rounded-xl shadow-xl z-10 overflow-hidden border",children:l?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>ke(t),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50",children:t.isPrivate?"Make Public":"Make Private"}),e.jsx("button",{onClick:()=>Pe(t),className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50",children:"Edit"}),e.jsx("button",{onClick:()=>Ne(t.id),className:"w-full text-left px-4 py-2 text-sm hover:bg-red-50 text-red-500",children:"Delete"})]}):e.jsx("button",{onClick:()=>{ae(t.id),H(!0),k(null)},className:"w-full text-left px-4 py-2 text-sm hover:bg-gray-50 text-red-500",children:"Report"})})]})]}),de===t.id?e.jsxs("div",{className:"mb-4",children:[e.jsx("textarea",{value:z,onChange:c=>te(c.target.value),className:"w-full p-3 bg-gray-50 rounded-xl border focus:border-primary focus:outline-none transition-colors",rows:"4"}),e.jsx("button",{onClick:()=>Re(t.id),className:"mt-2 bg-primary text-white px-4 py-2 rounded-xl font-bold hover:bg-primary-dark transition-colors",children:"Save Edit"})]}):e.jsx("p",{className:"text-gray-800 mb-4 whitespace-pre-wrap",children:t.text}),t.mediaURL&&e.jsx("div",{className:"rounded-2xl overflow-hidden mb-4 shadow-sm cursor-pointer transition-all hover:opacity-90",onClick:()=>O({url:t.mediaURL,type:t.mediaType}),children:t.mediaType==="video"?e.jsx("video",{src:t.mediaURL,controls:!0,className:"w-full max-h-[500px] bg-black"}):e.jsx("img",{src:t.mediaURL,className:"w-full max-h-[500px] object-cover",alt:"Post Media"})}),e.jsxs("div",{className:"flex gap-6 text-gray-500 font-bold text-sm pt-2 border-t border-gray-100/50 items-center",children:[e.jsxs("button",{onClick:()=>ye(t),className:`flex items-center gap-2 transition-colors ${r?"text-red-500":"hover:text-red-500"}`,children:[e.jsx("i",{className:`${r?"fas":"far"} fa-heart text-lg`})," ",t.likes||0]}),e.jsxs("button",{onClick:()=>we(t.id),className:"flex items-center gap-2 hover:text-primary transition-colors",children:[e.jsx("i",{className:"far fa-comment text-lg"})," ",t.comments||0]}),e.jsx("button",{onClick:()=>ve(t),className:"ml-auto hover:text-dark transition-colors",children:e.jsx("i",{className:"far fa-share-square text-lg"})})]}),q===t.id&&e.jsxs("div",{className:"mt-4 animate-fade-in",children:[e.jsx(Be,{postId:t.id,currentUser:p.currentUser,onReply:je}),e.jsxs("div",{className:"flex gap-2 mt-3",children:[e.jsx("input",{id:`comment-input-${t.id}`,type:"text",placeholder:Y?"Replying to comment...":"Write a comment...",className:"flex-1 bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-sm focus:outline-none focus:border-primary transition-colors",value:U,onChange:c=>M(c.target.value),onKeyDown:c=>c.key==="Enter"&&le(t.id),autoFocus:!0}),e.jsx("button",{onClick:()=>le(t.id),className:"w-9 h-9 rounded-xl bg-primary text-white flex items-center justify-center shadow-md hover:bg-primary-dark transition-colors disabled:opacity-50",disabled:!U.trim(),children:e.jsx("i",{className:"fas fa-paper-plane text-xs"})})]})]})]},t.id)})]}),h&&s&&e.jsx(Fe,{user:s,onClose:()=>w(!1),onSave:()=>K(a)}),xe&&e.jsx(Ue,{target:{id:a,type:"profile",name:s.displayName},onClose:()=>J(!1),onBoost:be}),ue&&e.jsx(Me,{onClose:()=>re(!1)}),E&&e.jsxs("div",{className:"fixed inset-0 z-[100] bg-black/95 flex items-center justify-center p-4 transition-opacity duration-300",onClick:()=>O(null),children:[e.jsx("button",{onClick:()=>O(null),className:"absolute top-4 right-4 text-white text-3xl z-[101]",children:"Ã—"}),E.type==="video"?e.jsx("video",{src:E.url,controls:!0,autoPlay:!0,className:"max-w-full max-h-full object-contain",onClick:t=>t.stopPropagation()}):e.jsx("img",{src:E.url,alt:"Fullscreen Media",className:"max-w-full max-h-full object-contain",onClick:t=>t.stopPropagation()})]}),me&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-sm flex items-center justify-center animate-fade-in p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl p-6 w-full max-w-sm shadow-2xl",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Report Post"})}),e.jsx("div",{className:"space-y-2 mb-6",children:["Spam or Fraud","Harassment","Violence","False Information","Inappropriate Content"].map(t=>e.jsx("button",{onClick:()=>Ce(t),className:"w-full text-left p-3 rounded-xl bg-gray-50 hover:bg-red-50 hover:text-red-600 text-gray-700 font-medium transition-colors",children:t},t))}),e.jsx("button",{onClick:()=>H(!1),className:"w-full py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-100 transition-colors",children:"Cancel"})]})})]}):e.jsx("div",{className:"p-10 text-center text-gray-500",children:"Loading profile..."})};export{_e as default};
