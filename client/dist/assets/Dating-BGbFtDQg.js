import{j as e,A as le,u as ne,f as S,m as E}from"./ui-BndUj6rU.js";import{r as d,u as ie}from"./vendor-C_rG9DFw.js";import{d as u,a as oe}from"./index-D6biLhoi.js";import{o as de,j as p,D as W,u as H,B as M,t as Y,k as I,q as ce,w as xe,M as me,v as y}from"./firebase-BaLQ-sp5.js";import{T as G}from"./TopBar-CRp8H5ed.js";const he=({currentFilters:i,onClose:s,onApply:b,onDeactivate:o})=>{const[n,h]=d.useState(i),x=(a,f)=>{h(w=>({...w,[a]:f}))},j=()=>{b(n),s()};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-end md:items-center justify-center z-[9999] p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-md rounded-[30px] md:rounded-3xl shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#fff0f5]",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"font-black text-xl text-dark flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sliders-h text-pink-500"})," Dating Filters"]}),e.jsx("p",{className:"text-xs text-gray-500 font-bold",children:"Find your perfect match"})]}),e.jsx("button",{onClick:s,children:e.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark text-xl"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-8",children:[e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"I'm interested in"}),e.jsx("div",{className:"flex bg-gray-100 rounded-xl p-1",children:["Men","Women","Everyone"].map(a=>e.jsx("button",{onClick:()=>x("gender",a),className:`flex-1 py-3 rounded-lg text-sm font-bold transition-all ${n.gender===a?"bg-white text-pink-500 shadow-sm":"text-gray-500 hover:text-gray-700"}`,children:a},a))})]}),e.jsxs("section",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-3",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:"Age Range"}),e.jsxs("span",{className:"text-pink-500 font-bold text-sm",children:[n.ageRange[0]," - ",n.ageRange[1]]})]}),e.jsxs("div",{className:"px-2",children:[e.jsx("input",{type:"range",min:"18",max:"65",value:n.ageRange[1],onChange:a=>x("ageRange",[n.ageRange[0],parseInt(a.target.value)]),className:"w-full accent-pink-500 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mt-2 font-bold",children:[e.jsx("span",{children:"18"}),e.jsx("span",{children:"65+"})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Location"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-gray-100 rounded-xl px-4 py-3",children:[e.jsx("i",{className:"fas fa-map-marker-alt text-pink-400"}),e.jsx("input",{type:"text",placeholder:"e.g. Dhaka, Gulshan",className:"bg-transparent outline-none w-full text-sm font-bold text-dark placeholder-gray-300",value:n.location,onChange:a=>x("location",a.target.value)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 uppercase mb-2 block",children:"Profession"}),e.jsxs("div",{className:"flex items-center gap-3 bg-gray-50 border border-gray-100 rounded-xl px-4 py-3",children:[e.jsx("i",{className:"fas fa-briefcase text-pink-400"}),e.jsx("input",{type:"text",placeholder:"e.g. Doctor, Engineer",className:"bg-transparent outline-none w-full text-sm font-bold text-dark placeholder-gray-300",value:n.profession,onChange:a=>x("profession",a.target.value)})]})]})]}),e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Relationship Goals"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{id:"Long-term",icon:"fa-ring",label:"Long-term"},{id:"Casual",icon:"fa-glass-cheers",label:"Fun / Casual"},{id:"Friendship",icon:"fa-user-friends",label:"Friendship"},{id:"Not Sure",icon:"fa-question",label:"Figuring it out"}].map(a=>e.jsxs("button",{onClick:()=>x("goal",a.id),className:`p-3 rounded-xl border-2 text-left transition-all flex items-center gap-3 ${n.goal===a.id?"border-pink-500 bg-pink-50 text-pink-600":"border-gray-100 text-gray-500 hover:border-pink-200"}`,children:[e.jsx("i",{className:`fas ${a.icon}`}),e.jsx("span",{className:"text-sm font-bold",children:a.label})]},a.id))})]}),o&&e.jsxs("div",{className:"pt-4 border-t border-gray-100",children:[e.jsxs("button",{onClick:o,className:"w-full py-3 rounded-xl border border-red-100 text-red-500 font-bold text-sm bg-red-50 hover:bg-red-100 transition-colors flex items-center justify-center gap-2",children:[e.jsx("i",{className:"fas fa-eye-slash"})," Turn Off Dating Mode"]}),e.jsx("p",{className:"text-[10px] text-gray-400 text-center mt-2",children:"Your dating profile will be hidden. You can turn it back on anytime."})]})]}),e.jsx("div",{className:"p-4 border-t border-gray-100 bg-white",children:e.jsx("button",{onClick:j,className:"w-full bg-gradient-to-r from-pink-500 to-red-500 text-white font-bold py-4 rounded-2xl shadow-lg shadow-pink-500/30 hover:scale-[1.02] transition-transform",children:"Apply Filters"})})]})})},K=["Star Gazer","Night Owl","Coffee Lover","Dream Chaser","Music Soul","Ocean Child","Mountain Hiker","City Light","Book Worm","Artistic Spirit"],ue=({candidate:i,index:s,isBlindDate:b,onSwipe:o})=>{const n=ne(0),h=S(n,[-200,200],[-18,18]),x=S(n,[20,150],[0,1]),j=S(n,[-20,-150],[0,1]),a=S(n,[-200,0,200],[1.05,1,1.05]),f=(w,v)=>{v.offset.x>100?o("right",i):v.offset.x<-100&&o("left",i)};return e.jsxs(E.div,{style:{x:n,rotate:h,scale:a,zIndex:50-s,position:"absolute",top:0,bottom:0,left:0,right:0},initial:{scale:.95,opacity:0,y:20},animate:{scale:1-s*.04,y:s*15,opacity:1-s*.2,filter:s>0?"blur(2px)":"none"},exit:{x:n.get()<0?-500:500,opacity:0,transition:{duration:.2}},drag:s===0?"x":!1,dragConstraints:{left:0,right:0},onDragEnd:f,whileDrag:{cursor:"grabbing"},className:"w-full h-full rounded-[35px] shadow-2xl bg-white overflow-hidden cursor-grab origin-bottom touch-none border-4 border-white",children:[s===0&&e.jsxs(e.Fragment,{children:[e.jsx(E.div,{style:{opacity:x},className:"absolute top-8 left-8 z-50 border-4 border-green-500 text-green-500 font-black text-4xl px-4 py-2 rounded-xl transform -rotate-12 bg-black/20 backdrop-blur-sm",children:"LIKE"}),e.jsx(E.div,{style:{opacity:j},className:"absolute top-8 right-8 z-50 border-4 border-red-500 text-red-500 font-black text-4xl px-4 py-2 rounded-xl transform rotate-12 bg-black/20 backdrop-blur-sm",children:"NOPE"})]}),e.jsxs("div",{className:"absolute inset-0 bg-gray-900 pointer-events-none",children:[e.jsx("img",{src:i.photoURL||"https://images.unsplash.com/photo-1534528741775-53994a69daeb",className:`w-full h-full object-cover pointer-events-none ${b?"blur-xl scale-110 opacity-70":""}`,alt:"Candidate"}),b&&e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-black/20",children:e.jsx("div",{className:"w-24 h-24 bg-white/10 backdrop-blur-md rounded-full border border-white/30 flex items-center justify-center shadow-[0_0_40px_rgba(255,255,255,0.2)]",children:e.jsx("i",{className:"fas fa-user-secret text-5xl text-white"})})})]}),e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-t from-black via-black/30 to-transparent flex flex-col justify-end p-8 text-white pointer-events-none",children:[e.jsxs("div",{className:"flex items-end gap-3 mb-2",children:[e.jsx("h2",{className:"text-4xl font-black tracking-tighter drop-shadow-lg",children:b?i.mysteryName:i.displayName.split(" ")[0]}),e.jsx("span",{className:"text-xl font-bold opacity-90 mb-1 bg-white/20 px-2 rounded-lg backdrop-blur-md",children:i.age||24})]}),i.datingHeadline&&e.jsxs("p",{className:"text-pink-300 font-bold text-sm mb-4 italic shadow-black drop-shadow-md",children:['"',i.datingHeadline,'"']}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[i.profession&&e.jsx("span",{className:"bg-black/30 backdrop-blur px-3 py-1 rounded-full text-xs font-bold border border-white/20",children:i.profession}),i.location&&e.jsx("span",{className:"bg-black/30 backdrop-blur px-3 py-1 rounded-full text-xs font-bold border border-white/20",children:i.location})]})]})]})},je=()=>{const i=ie(),[s,b]=d.useState(null),[o,n]=d.useState(null),[h,x]=d.useState([]),[j,a]=d.useState(!0),[f,w]=d.useState(!1),[v,k]=d.useState(!1),[J,_]=d.useState(!1),[R,V]=d.useState(null),[Q,$]=d.useState(!1),[F,X]=d.useState(""),[C,z]=d.useState(null),[Z,U]=d.useState(!1),[D,T]=d.useState(""),[P,q]=d.useState({gender:"Everyone",ageRange:[18,50],location:"",profession:"",goal:"Long-term"});d.useEffect(()=>{const t=de(oe,async r=>{if(r){b(r);const l=p(u,"users",r.uid),N=await W(l);if(N.exists()){const m=N.data();if(n(m),T(m.datingHeadline||""),m.isDatingActive){const c=m.gender==="Male"?"Women":m.gender==="Female"?"Men":"Everyone";q(g=>({...g,gender:c})),B(r.uid,{...P,gender:c})}else a(!1)}}});return()=>t()},[]);const B=async(t,r)=>{a(!0);try{const l=ce(I(u,"users"),xe("isDatingActive","==",!0));let m=(await me(l)).docs.map(c=>({id:c.id,...c.data()}));m=m.filter(c=>{if(c.id===t)return!1;if(r.gender!=="Everyone"){const A=r.gender==="Men"?"Male":"Female";if(c.gender!==A)return!1}let g=c.age||24;return!(g<r.ageRange[0]||g>r.ageRange[1])}),m=m.map(c=>({...c,mysteryName:K[Math.floor(Math.random()*K.length)]})),x(m.sort(()=>.5-Math.random()))}catch(l){console.error("Error:",l)}finally{a(!1)}},ee=(t,r)=>{x(l=>l.slice(1)),t==="right"?(z(r),L(null,r)):O(r)},L=async(t=null,r=null)=>{const l=r||C;$(!1),r||x(g=>g.filter(A=>A.id!==l.id));const N=`${s.uid}_${l.id}`;if(await M(p(u,"dating_swipes",N),{from:s.uid,to:l.id,type:"like",timestamp:y(),message:t}),t){const g=[s.uid,l.id].sort().join("_");await M(p(u,"conversations",g),{participants:[s.uid,l.id],users:[{uid:s.uid,displayName:o.displayName,photoURL:o.photoURL},{uid:l.id,displayName:l.displayName,photoURL:l.photoURL}],lastMessage:t,isMatch:!1,updatedAt:y()},{merge:!0}),await Y(I(u,`conversations/${g}/messages`),{text:t,senderId:s.uid,timestamp:y()})}const m=p(u,"dating_swipes",`${l.id}_${s.uid}`),c=await W(m);c.exists()&&["like","superlike"].includes(c.data().type)&&se(l)},te=async()=>{if(h.length===0)return;const t=h[0];x(l=>l.slice(1));const r=`${s.uid}_${t.id}`;await M(p(u,"dating_swipes",r),{from:s.uid,to:t.id,type:"superlike",timestamp:y()}),await Y(I(u,"notifications"),{recipientId:t.id,senderId:s.uid,senderName:f?"Mystery Admirer":o.displayName,senderAvatar:f?null:o.photoURL,type:"dating_interest",message:"super liked you! ðŸŒŸ",timestamp:y(),isRead:!1})},O=async t=>{if(!t){if(h.length===0)return;t=h[0],x(r=>r.slice(1))}await M(p(u,"dating_swipes",`${s.uid}_${t.id}`),{from:s.uid,to:t.id,type:"pass",timestamp:y()})},se=async t=>{V(t),_(!0);const r=[s.uid,t.id].sort().join("_");await H(p(u,"conversations",r),{isMatch:!0})},ae=async()=>{s&&(await H(p(u,"users",s.uid),{datingHeadline:D}),n(t=>({...t,datingHeadline:D})),U(!1))},re=async()=>{await H(p(u,"users",s.uid),{isDatingActive:!0}),window.location.reload()};return j?e.jsx("div",{className:"flex h-screen items-center justify-center bg-gray-900",children:e.jsx("div",{className:"w-16 h-16 border-t-4 border-pink-500 rounded-full animate-spin"})}):o!=null&&o.isDatingActive?e.jsxs("div",{className:"p-4 md:p-6 w-full max-w-[1400px] mx-auto pb-28 relative min-h-screen bg-gradient-to-br from-gray-50 to-gray-200 overflow-hidden",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(G,{})}),e.jsxs("div",{className:"flex flex-col gap-4 mb-8 px-2 z-10 relative",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2 bg-white/80 backdrop-blur-md p-1.5 rounded-2xl shadow-sm border border-white/50",children:[e.jsx("button",{onClick:()=>w(!1),className:`px-5 py-2.5 rounded-xl text-sm font-bold transition-all ${f?"text-gray-400 hover:bg-gray-100":"bg-gradient-to-r from-pink-500 to-rose-500 text-white shadow-md"}`,children:"Classic"}),e.jsxs("button",{onClick:()=>w(!0),className:`px-5 py-2.5 rounded-xl text-sm font-bold transition-all flex items-center gap-2 ${f?"bg-black text-white shadow-md":"text-gray-400 hover:bg-gray-100"}`,children:[e.jsx("i",{className:"fas fa-user-secret"})," Blind"]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>U(!0),className:"w-11 h-11 bg-white rounded-xl shadow-sm border border-gray-100 flex items-center justify-center text-gray-500 hover:text-pink-600 hover:scale-105 transition-all",children:e.jsx("i",{className:"fas fa-pen"})}),e.jsx("button",{onClick:()=>k(!0),className:"w-11 h-11 bg-white rounded-xl shadow-sm border border-gray-100 flex items-center justify-center text-gray-500 hover:text-purple-600 hover:scale-105 transition-all",children:e.jsx("i",{className:"fas fa-sliders-h"})})]})]}),Z?e.jsxs("div",{className:"bg-white/80 backdrop-blur p-4 rounded-2xl shadow-sm flex gap-2 border border-pink-100",children:[e.jsx("input",{value:D,onChange:t=>T(t.target.value),placeholder:"Headline...",className:"flex-1 bg-transparent px-2 outline-none text-sm font-bold text-gray-800",maxLength:50,autoFocus:!0}),e.jsx("button",{onClick:ae,className:"bg-black text-white px-4 py-2 rounded-lg font-bold text-xs",children:"Save"})]}):o.datingHeadline&&e.jsxs("div",{className:"text-center text-gray-600 text-sm font-bold italic",children:['"',o.datingHeadline,'"']})]}),e.jsx("div",{className:"relative w-full max-w-sm md:max-w-md mx-auto h-[62vh] perspective-1000",children:e.jsx(le,{children:h.length>0?h.slice(0,3).map((t,r)=>e.jsx(ue,{candidate:t,index:r,isBlindDate:f,onSwipe:ee},t.id)):e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-white/80 backdrop-blur-xl rounded-[35px] border border-white shadow-xl",children:[e.jsx("div",{className:"w-20 h-20 bg-pink-100 rounded-full flex items-center justify-center text-pink-400 mb-4 animate-pulse",children:e.jsx("i",{className:"fas fa-search text-3xl"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-800",children:"Searching..."}),e.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Try adjusting your filters."}),e.jsx("button",{onClick:()=>k(!0),className:"mt-6 bg-black text-white px-6 py-3 rounded-xl font-bold text-sm",children:"Filters"})]})})}),h.length>0&&e.jsxs("div",{className:"flex justify-center items-center gap-6 mt-8 z-20 relative",children:[e.jsx("button",{onClick:()=>O(),className:"w-16 h-16 bg-white rounded-full shadow-lg border border-gray-100 text-gray-400 text-2xl flex items-center justify-center hover:bg-red-50 hover:text-red-500 hover:scale-110 active:scale-95 transition-all",children:e.jsx("i",{className:"fas fa-times"})}),e.jsx("button",{onClick:te,className:"w-12 h-12 bg-white rounded-full shadow-md border border-gray-100 text-blue-400 text-lg flex items-center justify-center hover:bg-blue-50 hover:text-blue-600 hover:scale-110 active:scale-95 transition-all transform -translate-y-3",children:e.jsx("i",{className:"fas fa-star"})}),e.jsx("button",{onClick:()=>{z(h[0]),$(!0)},className:"w-16 h-16 bg-gradient-to-tr from-pink-500 to-rose-600 rounded-full shadow-lg shadow-pink-500/30 text-white text-3xl flex items-center justify-center hover:scale-110 active:scale-95 transition-all",children:e.jsx("i",{className:"fas fa-heart"})})]}),Q&&C&&e.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/60 backdrop-blur-md flex items-center justify-center p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-sm rounded-[30px] p-6 shadow-2xl",children:[e.jsxs("h3",{className:"text-lg font-black text-center mb-4",children:["Message ",f?C.mysteryName:C.displayName]}),e.jsx("textarea",{value:F,onChange:t=>X(t.target.value),placeholder:"Say something nice...",className:"w-full bg-gray-50 rounded-2xl p-4 text-sm mb-4 outline-none resize-none font-medium",rows:"3"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>L(null),className:"flex-1 py-3 rounded-xl font-bold text-gray-500 hover:bg-gray-50",children:"Just Like"}),e.jsx("button",{onClick:()=>L(F),className:"flex-1 bg-pink-500 text-white py-3 rounded-xl font-bold hover:shadow-lg",children:"Send"})]})]})}),J&&R&&e.jsxs("div",{className:"fixed inset-0 z-[10000] bg-black/95 backdrop-blur-xl flex flex-col items-center justify-center p-6 animate-pop-in text-center",children:[e.jsx("h1",{className:"text-6xl font-black text-transparent bg-clip-text bg-gradient-to-r from-pink-400 to-purple-400 italic mb-8",children:"MATCH!"}),e.jsxs("div",{className:"flex items-center gap-4 mb-8",children:[e.jsx("img",{src:o.photoURL,className:"w-24 h-24 rounded-full border-4 border-white"}),e.jsx("img",{src:R.photoURL,className:"w-24 h-24 rounded-full border-4 border-white"})]}),e.jsx("button",{onClick:()=>i("/messages",{state:{startChatWith:R}}),className:"bg-white text-black px-8 py-4 rounded-full font-bold shadow-xl mb-4",children:"Chat Now"}),e.jsx("button",{onClick:()=>_(!1),className:"text-white/70 font-bold",children:"Keep Swiping"})]}),v&&e.jsx(he,{currentFilters:P,onClose:()=>k(!1),onApply:t=>{q(t),B(s.uid,t)}})]}):e.jsxs("div",{className:"p-6 min-h-screen flex flex-col items-center justify-center bg-gray-900",children:[e.jsx(G,{}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-4",children:"Dating Profile Inactive"}),e.jsx("button",{onClick:re,className:"bg-pink-500 text-white px-8 py-3 rounded-full font-bold",children:"Activate Now"})]})};export{je as default};
