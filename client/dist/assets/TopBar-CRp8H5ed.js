import{j as e}from"./ui-BndUj6rU.js";import{u as se,r}from"./vendor-C_rG9DFw.js";import{d as u,s as Y,b as ie,a as O}from"./index-D6biLhoi.js";import{q as V,k as B,M as T,w as q,n as te,m as W,E as K,N as J,G as Q,u as H,j as M,x as ne,l as ae,K as oe,O as ce,o as de,h as Z,L as X}from"./firebase-BaLQ-sp5.js";const xe=({onClose:t})=>{const p=se(),[l,i]=r.useState(""),[c,N]=r.useState("all"),[n,C]=r.useState({people:[],business:[],products:[],circles:[],videos:[]}),[m,g]=r.useState(!1);r.useEffect(()=>{const s=setTimeout(()=>{l.trim().length>1?k():C({people:[],business:[],products:[],circles:[],videos:[]})},500);return()=>clearTimeout(s)},[l]);const k=async()=>{g(!0);const s=l.toLowerCase(),E=s.startsWith("@"),h=E?s.substring(1):s,S=(f,v,b)=>V(f,q(v,">=",b),q(v,"<=",b+"ï£¿"),W(5));let y={people:[],business:[],products:[],circles:[],videos:[]};try{if(E){const f=S(B(u,"users"),"handle",h),v=await T(f);y.people=v.docs.map(b=>({id:b.id,...b.data()}))}else{const f=S(B(u,"users"),"displayName",l),v=await T(f);y.people=v.docs.map(b=>({id:b.id,...b.data()}))}if(!E){const f=S(B(u,"business_pages"),"name",l),v=await T(f);y.business=v.docs.map(d=>({id:d.id,...d.data()}));const b=S(B(u,"marketplace"),"title",l),P=await T(b);y.products=P.docs.map(d=>({id:d.id,...d.data()}));const A=S(B(u,"circles"),"name",l),D=await T(A);y.circles=D.docs.map(d=>({id:d.id,...d.data()}));const $=V(B(u,"posts"),q("mediaType","==","video"),te("timestamp","desc"),W(20)),o=await T($);y.videos=o.docs.map(d=>({id:d.id,...d.data()})).filter(d=>{var F;return(F=d.text)==null?void 0:F.toLowerCase().includes(s)})}C(y)}catch(f){console.error("Search error:",f)}finally{g(!1)}},j=s=>{p(s),t()};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-start justify-center z-[9999] p-4 pt-20 animate-fade-in cursor-pointer",onClick:t,children:e.jsxs("div",{className:"bg-white w-full max-w-3xl rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] cursor-default",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"p-4 border-b border-gray-100 bg-[#F8FAFD]",children:[e.jsxs("div",{className:"flex items-center gap-3 bg-white p-3 rounded-2xl border border-gray-200 shadow-sm focus-within:ring-2 ring-primary/20 transition-all",children:[e.jsx("i",{className:"fas fa-search text-gray-400 text-xl ml-2"}),e.jsx("input",{autoFocus:!0,type:"text",placeholder:"Search Products, Business, People...",className:"flex-1 bg-transparent outline-none text-lg font-medium text-dark placeholder-gray-400",value:l,onChange:s=>i(s.target.value)}),l&&e.jsx("button",{onClick:()=>i(""),className:"text-gray-400 hover:text-dark",children:e.jsx("i",{className:"fas fa-times-circle"})})]}),e.jsx("div",{className:"flex gap-6 mt-4 px-2 overflow-x-auto no-scrollbar",children:["all","products","business","people","circles","videos"].map(s=>e.jsx("button",{onClick:()=>N(s),className:`pb-2 font-bold text-sm capitalize border-b-2 transition-all whitespace-nowrap ${c===s?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:s},s))})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white min-h-[300px]",children:m?e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx("i",{className:"fas fa-circle-notch fa-spin text-2xl"}),e.jsx("p",{className:"mt-2 text-xs font-bold",children:"Searching..."})]}):l.length<2?e.jsxs("div",{className:"text-center py-20 text-gray-300",children:[e.jsx("i",{className:"fas fa-search text-4xl mb-4"}),e.jsx("p",{children:"Find products, businesses, or friends."})]}):e.jsxs("div",{className:"space-y-8",children:[(c==="all"||c==="products")&&n.products.length>0&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Products"}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-3",children:n.products.map(s=>e.jsxs("div",{onClick:()=>j(`/product/${s.id}`),className:"bg-white border border-gray-100 rounded-xl p-2 cursor-pointer hover:shadow-md transition-all flex flex-col",children:[e.jsx("img",{src:s.image,className:"w-full h-24 object-cover rounded-lg mb-2 bg-gray-100",alt:s.title}),e.jsx("h5",{className:"font-bold text-sm text-dark truncate",children:s.title}),e.jsxs("p",{className:"text-primary font-black text-xs",children:[s.currency==="BDT"?"à§³":s.currency,s.price]})]},s.id))})]}),(c==="all"||c==="business")&&n.business.length>0&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Businesses"}),e.jsx("div",{className:"space-y-2",children:n.business.map(s=>e.jsxs("div",{onClick:()=>j(`/business/${s.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors border border-transparent hover:border-gray-100",children:[e.jsx("img",{src:s.logo,className:"w-12 h-12 rounded-xl object-cover shadow-sm",alt:s.name}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h5",{className:"font-bold text-dark flex items-center gap-1",children:[s.name,s.isVerified&&e.jsx("i",{className:"fas fa-check-circle text-blue-500 text-xs"})]}),e.jsx("p",{className:"text-xs text-gray-500 font-bold",children:s.category})]}),e.jsx("button",{className:"text-xs bg-white border border-gray-200 px-3 py-1 rounded-full font-bold hover:bg-dark hover:text-white transition-colors",children:"Visit"})]},s.id))})]}),(c==="all"||c==="people")&&n.people.length>0&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"People"}),e.jsx("div",{className:"space-y-2",children:n.people.map(s=>e.jsxs("div",{onClick:()=>j(`/profile/${s.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors",children:[e.jsx("img",{src:s.photoURL||"https://via.placeholder.com/150",className:"w-10 h-10 rounded-full object-cover border border-gray-100",alt:s.displayName}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-dark text-sm",children:s.displayName}),e.jsxs("p",{className:"text-xs text-gray-500 font-bold",children:["@",s.handle||"user"]})]})]},s.id))})]}),(c==="all"||c==="circles")&&n.circles.length>0&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Circles"}),e.jsx("div",{className:"space-y-2",children:n.circles.map(s=>e.jsxs("div",{onClick:()=>j(`/circles/${s.id}`),className:"flex items-center gap-3 p-3 hover:bg-gray-50 rounded-2xl cursor-pointer transition-colors",children:[e.jsx("img",{src:s.image,className:"w-10 h-10 rounded-xl object-cover",alt:s.name}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-dark text-sm",children:s.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[s.memberCount||0," Members"]})]})]},s.id))})]}),(c==="all"||c==="videos")&&n.videos.length>0&&e.jsxs("section",{children:[e.jsx("h4",{className:"text-xs font-bold text-gray-400 uppercase mb-3 tracking-wider",children:"Videos"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:n.videos.map(s=>e.jsxs("div",{onClick:()=>j("/watch"),className:"relative rounded-xl overflow-hidden aspect-video cursor-pointer group bg-black",children:[e.jsx("video",{src:s.mediaURL,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"w-8 h-8 bg-white/20 backdrop-blur-md rounded-full flex items-center justify-center text-white",children:e.jsx("i",{className:"fas fa-play text-xs"})})}),e.jsx("p",{className:"absolute bottom-2 left-2 text-white text-[10px] font-bold truncate w-11/12 shadow-black drop-shadow-md",children:s.text})]},s.id))})]}),Object.values(n).every(s=>s.length===0)&&e.jsxs("div",{className:"text-center py-10 text-gray-400",children:[e.jsx("i",{className:"far fa-folder-open text-2xl mb-2"}),e.jsxs("p",{children:['No results found for "',l,'"']})]})]})}),e.jsx("div",{className:"p-4 bg-gray-50 border-t border-gray-100 text-center",children:e.jsx("button",{onClick:t,className:"text-gray-500 font-bold text-sm hover:text-dark",children:"Close Search"})})]})})},me=({user:t,onClose:p,onSave:l})=>{const[i,c]=r.useState({displayName:t.displayName||"",bio:t.bio||"",profession:t.profession||"",location:t.location||"",handle:t.handle||""}),[N,n]=r.useState(null),[C,m]=r.useState(null),[g,k]=r.useState(!1),j=async()=>{k(!0);try{let s=t.photoURL,E=t.coverPhotoURL;if(N){const h=K(Y,`users/${t.uid}/profile_${Date.now()}`);await J(h,N),s=await Q(h)}if(C){const h=K(Y,`users/${t.uid}/cover_${Date.now()}`);await J(h,C),E=await Q(h)}await H(M(u,"users",t.uid),{...i,photoURL:s,coverPhotoURL:E}),l(),p()}catch(s){console.error("Error updating profile:",s),alert("Failed to update profile.")}finally{k(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b border-gray-100 flex justify-between items-center bg-[#F8FAFD]",children:[e.jsx("h3",{className:"font-black text-xl text-dark",children:"Edit Profile"}),e.jsx("button",{onClick:p,children:e.jsx("i",{className:"fas fa-times text-gray-400 hover:text-dark"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"Profile Photo"}),e.jsx("input",{type:"file",onChange:s=>n(s.target.files[0]),className:"text-sm"})]}),e.jsxs("div",{className:"border-2 border-dashed border-gray-200 rounded-xl p-4 text-center",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 mb-2",children:"Cover Photo"}),e.jsx("input",{type:"file",onChange:s=>m(s.target.files[0]),className:"text-sm"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Display Name"}),e.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl font-bold",value:i.displayName,onChange:s=>c({...i,displayName:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Bio"}),e.jsx("textarea",{rows:"3",className:"w-full bg-gray-50 p-3 rounded-xl",value:i.bio,onChange:s=>c({...i,bio:s.target.value})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Profession"}),e.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl",value:i.profession,onChange:s=>c({...i,profession:s.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-bold text-gray-500 uppercase",children:"Location"}),e.jsx("input",{className:"w-full bg-gray-50 p-3 rounded-xl",value:i.location,onChange:s=>c({...i,location:s.target.value})})]})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-100 bg-white",children:e.jsx("button",{onClick:j,disabled:g,className:"w-full bg-dark text-white font-bold py-4 rounded-xl hover:bg-primary transition-all shadow-lg",children:g?"Saving...":"Save Changes"})})]})})},ee=({message:t,onConfirm:p,onCancel:l,title:i="Confirm Action"})=>e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[10001] p-4",children:e.jsxs("div",{className:"bg-white reading:bg-[#FFFCF0] p-6 rounded-2xl shadow-2xl w-full max-w-sm text-center",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:i}),e.jsx("p",{className:"text-gray-600 mb-6",children:t}),e.jsxs("div",{className:"flex justify-center gap-3",children:[e.jsx("button",{onClick:l,className:"bg-gray-100 text-gray-700 font-semibold px-4 py-2 rounded-xl hover:bg-gray-200 transition-colors flex-1",children:"Cancel"}),e.jsx("button",{onClick:p,className:"bg-red-500 text-white font-semibold px-4 py-2 rounded-xl hover:bg-red-600 transition-colors flex-1",children:"Confirm"})]})]})}),ge=({user:t,onClose:p})=>{var $;const[l,i]=r.useState("main"),[c,N]=r.useState(!1),[n,C]=r.useState(!1),[m,g]=r.useState(null),{theme:k,toggleTheme:j}=ie(),[s,E]=r.useState({privateAccount:t.isPrivate||!1,activeStatus:t.isOnline||!0,notifications:!0}),h=o=>{g({action:"message",message:o,title:"Notification"})},S=async o=>{const d=!s[o];E({...s,[o]:d});try{o==="privateAccount"&&await H(M(u,"users",t.uid),{isPrivate:d})}catch(F){console.error("Error updating setting:",F)}},y=async()=>{if(!t.email)return h("No email address found for your account.");C(!0);try{await ne(O,t.email),h(`Password reset email sent to ${t.email}`)}catch(o){h("Error sending reset email: "+o.message)}finally{C(!1)}},f=()=>{g({action:"signout",message:"Are you sure you want to sign out?",title:"Confirm Sign Out"})},v=async()=>{g(null);try{await ae(O),window.location.reload()}catch(o){console.error("Error signing out:",o)}},b=()=>{g({action:"delete",message:"âš ï¸ ARE YOU SURE? This will permanently delete your account and all associated data. This cannot be undone.",title:"Permanent Deletion"})},P=async()=>{g(null),C(!0);try{await oe(M(u,"users",t.uid)),await ce(O.currentUser),h("Account deleted successfully. Goodbye!"),setTimeout(()=>window.location.reload(),1500)}catch(o){console.error("Delete Error:",o),o.code==="auth/requires-recent-login"?h("Security check: Please sign out and sign in again before deleting your account."):h("Failed to delete account: "+o.message)}finally{C(!1)}},A=({id:o,icon:d,label:F,color:U="text-gray-600",bg:a="bg-gray-100"})=>e.jsxs("button",{onClick:()=>i(o),className:"w-full bg-white reading:bg-[#FFFCF0] border border-gray-100 reading:border-[#E8E0C5] p-4 rounded-2xl flex items-center justify-between hover:bg-gray-50 reading:hover:bg-[#EBE0C5] transition-all shadow-sm mb-3 group",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${a} ${U} group-hover:scale-110 transition-transform`,children:e.jsx("i",{className:`fas ${d}`})}),e.jsx("span",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:F})]}),e.jsx("i",{className:"fas fa-chevron-right text-gray-300"})]}),D=({title:o})=>e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-4 border-b border-gray-100 reading:border-[#E8E0C5]",children:[e.jsx("button",{onClick:()=>i("main"),className:"w-8 h-8 rounded-full bg-gray-100 reading:bg-[#F0EAD6] flex items-center justify-center hover:bg-gray-200 reading:hover:bg-[#EBE0C5] transition-colors",children:e.jsx("i",{className:"fas fa-arrow-left text-gray-600 reading:text-[#4A3B2A]"})}),e.jsx("h2",{className:"text-xl font-black text-gray-900 reading:text-[#2E2218]",children:o})]});return e.jsxs("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4 animate-fade-in",children:[e.jsxs("div",{className:"bg-white reading:bg-[#FFFCF0] w-full max-w-lg rounded-[30px] shadow-2xl overflow-hidden flex flex-col max-h-[85vh] relative transition-colors duration-300",children:[e.jsx("button",{onClick:p,className:"absolute top-5 right-5 z-10 text-gray-400 hover:text-gray-700 w-8 h-8 flex items-center justify-center rounded-full bg-gray-50 reading:bg-[#F0EAD6] hover:bg-gray-100 reading:hover:bg-[#EBE0C5] transition-all",children:e.jsx("i",{className:"fas fa-times text-lg"})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 md:p-8",children:[l==="main"&&e.jsxs("div",{className:"animate-slide-in",children:[e.jsx("h2",{className:"text-3xl font-black text-gray-900 reading:text-[#2E2218] mb-2",children:"Settings"}),e.jsx("p",{className:"text-gray-500 reading:text-[#8C7B65] font-bold mb-8",children:"Manage your account & preferences"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(A,{id:"account",icon:"fa-user-circle",label:"Account",color:"text-blue-500",bg:"bg-blue-50 reading:bg-[#F0EAD6]"}),e.jsx(A,{id:"privacy",icon:"fa-lock",label:"Privacy",color:"text-purple-500",bg:"bg-purple-50 reading:bg-[#F0EAD6]"}),e.jsx(A,{id:"security",icon:"fa-shield-alt",label:"Security",color:"text-green-500",bg:"bg-green-50 reading:bg-[#F0EAD6]"}),e.jsx(A,{id:"display",icon:"fa-book-open",label:"Display",color:"text-orange-500",bg:"bg-orange-50 reading:bg-[#F0EAD6]"}),e.jsx(A,{id:"help",icon:"fa-question-circle",label:"Help & Support",color:"text-cyan-500",bg:"bg-cyan-50 reading:bg-[#F0EAD6]"})]}),e.jsx("div",{className:"mt-8 pt-6 border-t border-gray-100 reading:border-[#E8E0C5]",children:e.jsxs("button",{onClick:f,className:"w-full bg-red-50 reading:bg-[#F8F5E6] text-red-500 p-4 rounded-2xl flex items-center justify-center gap-2 font-bold hover:bg-red-100 reading:hover:bg-[#EBE0C5] transition-all",children:[e.jsx("i",{className:"fas fa-sign-out-alt"})," Log Out"]})})]}),l==="account"&&e.jsxs("div",{className:"animate-slide-in",children:[e.jsx(D,{title:"Account"}),e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("img",{src:t.photoURL||"https://placehold.co/150x150/e0e0e0/333?text=PFP",className:"w-24 h-24 rounded-full object-cover border-4 border-gray-50 reading:border-[#E8E0C5] mb-3 mx-auto",alt:"User"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 reading:text-[#2E2218]",children:t.displayName}),e.jsxs("p",{className:"text-gray-500 reading:text-[#8C7B65]",children:["@",t.handle||"user"]}),e.jsx("button",{onClick:()=>N(!0),className:"mt-4 bg-gray-900 reading:bg-[#4A3B2A] text-white px-6 py-2 rounded-xl font-bold text-sm shadow-lg hover:opacity-90 transition-all",children:"Edit Profile"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 reading:bg-[#F0EAD6] p-4 rounded-2xl",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 reading:text-[#8C7B65] uppercase",children:"Email"}),e.jsx("p",{className:"font-bold text-gray-900 reading:text-[#4A3B2A]",children:t.email})]}),e.jsxs("div",{className:"bg-gray-50 reading:bg-[#F0EAD6] p-4 rounded-2xl",children:[e.jsx("label",{className:"text-xs font-bold text-gray-400 reading:text-[#8C7B65] uppercase",children:"Member Since"}),e.jsx("p",{className:"font-bold text-gray-900 reading:text-[#4A3B2A]",children:($=t.metadata)!=null&&$.creationTime?new Date(t.metadata.creationTime).toDateString():"N/A"})]})]}),e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100 reading:border-[#E8E0C5]",children:[e.jsx("h4",{className:"text-red-500 font-bold mb-2 text-sm uppercase tracking-wider",children:"Danger Zone"}),e.jsx("button",{onClick:b,disabled:n,className:"w-full border-2 border-red-100 reading:border-[#E8E0C5] text-red-500 p-3 rounded-xl font-bold text-sm hover:bg-red-50 reading:hover:bg-[#EBE0C5] transition-all flex items-center justify-center gap-2",children:n?"Deleting...":e.jsxs(e.Fragment,{children:[e.jsx("i",{className:"fas fa-trash-alt"})," Delete Account"]})})]})]}),l==="privacy"&&e.jsxs("div",{className:"animate-slide-in",children:[e.jsx(D,{title:"Privacy"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 reading:border-[#E8E0C5] rounded-2xl bg-white reading:bg-[#FFFCF0]",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:"Private Account"}),e.jsx("p",{className:"text-xs text-gray-500 reading:text-[#8C7B65] mt-1",children:"Only followers can see your posts."})]}),e.jsx("div",{onClick:()=>S("privateAccount"),className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${s.privateAccount?"bg-indigo-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${s.privateAccount?"left-7":"left-1"}`})})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 reading:border-[#E8E0C5] rounded-2xl bg-white reading:bg-[#FFFCF0]",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:"Active Status"}),e.jsx("p",{className:"text-xs text-gray-500 reading:text-[#8C7B65] mt-1",children:"Show when you're online."})]}),e.jsx("div",{onClick:()=>S("activeStatus"),className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${s.activeStatus?"bg-indigo-500":"bg-gray-300"}`,children:e.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${s.activeStatus?"left-7":"left-1"}`})})]})]})]}),l==="security"&&e.jsxs("div",{className:"animate-slide-in",children:[e.jsx(D,{title:"Security"}),e.jsxs("div",{className:"p-6 border border-orange-100 reading:border-[#E8E0C5] bg-orange-50 reading:bg-[#F0EAD6] rounded-3xl text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white reading:bg-[#FFFCF0] rounded-full flex items-center justify-center text-orange-500 text-2xl shadow-sm mx-auto mb-4",children:e.jsx("i",{className:"fas fa-key"})}),e.jsx("h4",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg mb-2",children:"Change Password"}),e.jsx("p",{className:"text-sm text-gray-600 reading:text-[#8C7B65] mb-6",children:"We'll send you an email to reset your password securely."}),e.jsx("button",{onClick:y,disabled:n,className:"w-full bg-orange-500 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-orange-600 transition-all disabled:opacity-50",children:n?"Sending...":"Send Reset Link"})]})]}),l==="display"&&e.jsxs("div",{className:"animate-slide-in",children:[e.jsx(D,{title:"Display"}),e.jsxs("div",{className:"bg-yellow-50 reading:bg-[#F0EAD6] p-6 rounded-3xl border border-yellow-100 reading:border-[#E8E0C5] text-center mb-6",children:[e.jsx("div",{className:"w-16 h-16 bg-white reading:bg-[#FFFCF0] rounded-full flex items-center justify-center text-yellow-600 text-3xl shadow-sm mx-auto mb-3",children:e.jsx("i",{className:"fas fa-book-reader"})}),e.jsx("h4",{className:"font-bold text-gray-900 reading:text-[#2E2218] text-lg",children:"Reading Mode"}),e.jsx("p",{className:"text-sm text-gray-600 reading:text-[#8C7B65] mb-0",children:"Warm, paper-like colors for relaxed viewing."})]}),e.jsxs("div",{className:"flex justify-between items-center p-4 border border-gray-100 reading:border-[#E8E0C5] rounded-2xl bg-white reading:bg-[#FFFCF0]",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-bold text-gray-900 reading:text-[#4A3B2A] text-lg",children:"Enable Reading Mode"}),e.jsx("p",{className:"text-xs text-gray-500 reading:text-[#8C7B65] mt-1",children:k==="reading"?"On":"Off"})]}),e.jsx("div",{onClick:j,className:`w-14 h-8 rounded-full cursor-pointer transition-colors relative ${k==="reading"?"bg-orange-400":"bg-gray-300"}`,children:e.jsx("div",{className:`w-6 h-6 bg-white rounded-full absolute top-1 transition-all shadow-sm ${k==="reading"?"left-7":"left-1"}`})})]})]}),l==="help"&&e.jsxs("div",{className:"animate-slide-in text-center pt-10",children:[e.jsx(D,{title:"Help"}),e.jsx("div",{className:"w-24 h-24 bg-cyan-50 reading:bg-[#F0EAD6] rounded-full flex items-center justify-center text-cyan-500 text-4xl mx-auto mb-6",children:e.jsx("i",{className:"fas fa-life-ring"})}),e.jsx("h3",{className:"text-2xl font-black text-gray-900 reading:text-[#2E2218] mb-2",children:"Need Support?"}),e.jsx("p",{className:"text-gray-500 reading:text-[#8C7B65] mb-8 max-w-xs mx-auto",children:"Our team is here to help you with any issues regarding your account."}),e.jsx("button",{className:"bg-gray-900 reading:bg-[#4A3B2A] text-white px-8 py-3 rounded-xl font-bold hover:bg-gray-800 transition-all shadow-lg",children:"Contact Support"})]})]})]}),c&&e.jsx("div",{className:"absolute inset-0 z-[10000]",children:e.jsx(me,{user:t,onClose:()=>N(!1),onSave:()=>window.location.reload()})}),m&&m.action!=="message"&&e.jsx(ee,{title:m.title,message:m.message,onConfirm:m.action==="signout"?v:P,onCancel:()=>g(null)}),m&&m.action==="message"&&e.jsx(ee,{title:m.title,message:m.message,onConfirm:()=>g(null),onCancel:()=>g(null),children:e.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-[10001] p-4",children:e.jsxs("div",{className:"bg-white reading:bg-[#FFFCF0] p-6 rounded-2xl shadow-2xl w-full max-w-sm text-center",children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900 mb-4",children:m.title}),e.jsx("p",{className:"text-gray-600 mb-6",children:m.message}),e.jsx("button",{onClick:()=>g(null),className:"bg-indigo-500 text-white font-semibold px-4 py-2 rounded-xl hover:bg-indigo-600 transition-colors w-full",children:"OK"})]})})})]})},fe=()=>{var U;const t=se(),[p,l]=r.useState(null),[i,c]=r.useState([]),[N,n]=r.useState(!1),[C,m]=r.useState(0),[g,k]=r.useState(!1),[j,s]=r.useState(!1),[E,h]=r.useState(!1),[S,y]=r.useState(!0),f=r.useRef(0),v=r.useRef(new Audio("https://assets.mixkit.co/sfx/preview/mixkit-software-interface-start-2574.mp3")),b=r.useRef(0),P=new Date().getHours(),A=P<12?"Good Morning":P<18?"Good Afternoon":"Good Evening";r.useEffect(()=>{de(O,x=>{if(x){l(x);const z=V(B(u,"notifications"),q("recipientId","==",x.uid),te("timestamp","desc")),_=Z(z,G=>{var I;const R=G.docs.map(L=>({id:L.id,...L.data()}));R.length>b.current&&!((I=R[0])!=null&&I.isRead)&&v.current.play().catch(()=>{}),c(R),b.current=R.length}),re=V(B(u,"conversations"),q("participants","array-contains",x.uid)),le=Z(re,G=>{let R=0;G.docs.forEach(I=>{const L=I.data();L.unreadCounts&&L.unreadCounts[x.uid]&&(R+=L.unreadCounts[x.uid])}),m(R)});return()=>{_(),le()}}else l(null)});const a=()=>{const x=window.scrollY;x<10?y(!0):x>f.current?y(!1):y(!0),f.current=x};window.addEventListener("scroll",a,{passive:!0});const w=x=>{x.target.closest(".notification-container")||n(!1),x.target.closest(".app-menu-container")||s(!1)};return document.addEventListener("click",w),()=>{document.removeEventListener("click",w),window.removeEventListener("scroll",a)}},[]);const D=async()=>{const a=!N;if(n(a),a){const w=i.filter(x=>!x.isRead);if(w.length>0)try{const x=X(u);w.forEach(z=>{const _=M(u,"notifications",z.id);x.update(_,{isRead:!0})}),await x.commit()}catch(x){console.error("Error marking notifications as read:",x)}}},$=async a=>{switch(a.isRead||H(M(u,"notifications",a.id),{isRead:!0}),n(!1),a.type){case"like":case"comment":case"mention":t(`/post/${a.targetId}`,{state:{commentId:a.commentId}});break;case"follow":case"circle_join":t(`/profile/${a.senderId}`);break;case"review":case"question":case"answer":const w=a.type==="review"?"reviews":"qa";t(`/product/${a.targetId}`,{state:{activeTab:w}});break;case"follow_business":t(`/business/${a.targetId}`);break;default:t("/")}},o=async()=>{const a=X(u);i.forEach(w=>a.delete(M(u,"notifications",w.id))),await a.commit()},d=async()=>{window.confirm("Sign out?")&&(await ae(O),window.location.reload())},F=i.filter(a=>!a.isRead).length;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`sticky top-0 md:relative z-[40] transition-transform duration-300 ease-in-out ${S?"translate-y-0":"-translate-y-[120%]"}`,children:e.jsxs("div",{className:"flex justify-between items-center bg-white/95 backdrop-blur-md md:bg-white rounded-b-[24px] md:rounded-[24px] p-4 md:p-5 shadow-sm mb-6 border-b border-gray-100 md:border-none",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-2xl md:text-3xl mr-3 md:mr-4 animate-gentle-float",children:P<18?"ðŸŒ¤ï¸":"ðŸŒ™"}),e.jsx("div",{children:e.jsxs("h2",{className:"text-lg md:text-xl font-bold text-[#2C3E50] leading-tight",children:[A,", ",e.jsxs("span",{className:"hidden md:inline",children:[((U=p==null?void 0:p.displayName)==null?void 0:U.split(" ")[0])||"Friend","!"]})]})})]}),e.jsxs("div",{className:"flex gap-2 md:gap-3",children:[e.jsx("div",{onClick:()=>k(!0),className:"w-10 h-10 rounded-full bg-[#F8FAFD] flex items-center justify-center cursor-pointer hover:shadow-md transition-all text-[#2C3E50]",children:e.jsx("i",{className:"fas fa-search text-lg"})}),e.jsxs("div",{className:"relative notification-container",children:[e.jsxs("div",{onClick:D,className:`w-10 h-10 rounded-full flex items-center justify-center cursor-pointer transition-all relative ${N?"bg-primary text-white shadow-lg":"bg-[#F8FAFD] text-[#2C3E50] hover:shadow-md"}`,children:[e.jsx("i",{className:"fas fa-bell text-lg"}),F>0&&e.jsx("span",{className:"absolute top-0 right-0 bg-accent text-white text-[10px] font-bold w-4 h-4 flex items-center justify-center rounded-full border-2 border-white animate-bounce-in",children:F>9?"9+":F})]}),N&&e.jsxs("div",{className:"absolute right-0 top-14 w-80 md:w-96 bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden animate-fade-in z-[101]",children:[e.jsxs("div",{className:"p-4 border-b border-gray-50 flex justify-between items-center bg-gray-50/50",children:[e.jsx("h3",{className:"font-bold text-dark",children:"Notifications"}),i.length>0&&e.jsx("button",{onClick:o,className:"text-xs text-gray-400 hover:text-red-500",children:"Clear All"})]}),e.jsx("div",{className:"max-h-80 overflow-y-auto custom-scrollbar",children:i.length>0?i.map(a=>{var w;return e.jsxs("div",{onClick:()=>$(a),className:`p-4 flex gap-3 cursor-pointer hover:bg-gray-50 transition-colors border-b border-gray-50 last:border-0 ${a.isRead?"":"bg-blue-50/30"}`,children:[e.jsx("img",{src:a.senderAvatar||"https://via.placeholder.com/150",className:"w-10 h-10 rounded-full object-cover border border-white shadow-sm"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-gray-800 leading-tight",children:[e.jsx("span",{className:"font-bold",children:a.senderName}),a.type==="like"&&" liked your post.",a.type==="comment"&&" commented on your post.",a.type==="follow"&&" started following you.",a.type==="mention"&&" mentioned you.",a.type==="review"&&" reviewed your product.",a.type==="team_invite"&&" invited you to a team.",!["like","comment","follow","mention","review","team_invite"].includes(a.type)&&` ${a.message}`]}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(w=a.timestamp)!=null&&w.seconds?new Date(a.timestamp.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):"Just now"})]}),!a.isRead&&e.jsx("div",{className:"w-2 h-2 bg-primary rounded-full mt-2 shrink-0"})]},a.id)}):e.jsxs("div",{className:"p-8 text-center text-gray-400",children:[e.jsx("i",{className:"far fa-bell-slash text-2xl mb-2"}),e.jsx("p",{className:"text-sm",children:"No notifications."})]})})]})]}),e.jsxs("div",{onClick:()=>s(!j),className:"relative app-menu-container w-10 h-10 rounded-full bg-gradient-to-tr from-primary to-gold text-white flex items-center justify-center cursor-pointer hover:shadow-md",children:[e.jsx("i",{className:"fas fa-bars text-lg"}),j&&e.jsxs("div",{className:"absolute right-0 top-14 w-64 bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden animate-fade-in z-[100] text-dark",children:[e.jsx("div",{className:"p-3 border-b border-gray-50 text-xs font-bold text-gray-400 uppercase bg-gray-50/50",children:"Menu"}),e.jsxs("div",{className:"flex flex-col p-2 space-y-1",children:[e.jsxs("button",{onClick:()=>{t("/explore"),s(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-sm font-bold",children:[e.jsx("i",{className:"fas fa-compass text-purple-500 w-6"})," Explore"]}),e.jsxs("button",{onClick:()=>{t("/business"),s(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-sm font-bold",children:[e.jsx("i",{className:"fas fa-briefcase text-blue-500 w-6"})," Business"]}),e.jsxs("button",{onClick:()=>{h(!0),s(!1)},className:"flex items-center gap-3 px-4 py-3 hover:bg-gray-50 rounded-xl text-sm font-bold",children:[e.jsx("i",{className:"fas fa-cog text-gray-500 w-6"})," Settings"]}),e.jsx("div",{className:"h-px bg-gray-100 my-1"}),e.jsxs("button",{onClick:d,className:"flex items-center gap-3 px-4 py-3 hover:bg-red-50 rounded-xl text-sm font-bold text-red-500",children:[e.jsx("i",{className:"fas fa-sign-out-alt w-6"})," Sign Out"]})]})]})]})]})]})}),g&&e.jsx(xe,{onClose:()=>k(!1)}),E&&p&&e.jsx(ge,{user:p,onClose:()=>h(!1)})]})};export{me as E,fe as T};
