import{j as e}from"./ui-BndUj6rU.js";import{e as os,u as is,r as l}from"./vendor-C_rG9DFw.js";import{a as ns,d as c,s as re}from"./index-gjDmyrly.js";import{o as ds,j as N,u as C,I as le,J as cs,t as oe,k as P,K as xs,q as O,m as ms,w as G,M as us,E as ie,N as ne,G as de,v as ce,h as H,n as ps}from"./firebase-BaLQ-sp5.js";import{T as hs}from"./TopBar-UEOhfdgU.js";import{V as gs}from"./VerificationModal-CmfMMQwG.js";import"./PaymentModal-DBoEzFiD.js";const I=({src:i,name:g,size:t="md",className:L=""})=>{const m=g?g.split(" ").map(J=>J[0]).join("").substring(0,2).toUpperCase():"??",$={sm:"w-8 h-8 text-xs",md:"w-10 h-10 text-sm",lg:"w-14 h-14 text-base",xl:"w-32 h-32 text-4xl"},W=i&&i.includes("via.placeholder.com");return i&&!W?e.jsx("img",{src:i,className:`${$[t]} rounded-full object-cover border border-gray-200 ${L}`,alt:g}):e.jsx("div",{className:`${$[t]} rounded-full bg-gradient-to-tr from-primary to-primary-light text-white flex items-center justify-center font-bold shadow-inner ${L}`,children:m})},ks=()=>{var Ce,Pe,Se,Ie;const{id:i}=os(),g=is(),[t,L]=l.useState(null),[m,$]=l.useState(null),[W,J]=l.useState(!0),[b,A]=l.useState("products"),[K,De]=l.useState(null),[Q,Re]=l.useState([]),[X,Te]=l.useState([]),[U,Ee]=l.useState([]),[M,Le]=l.useState(0),[D,$e]=l.useState("All"),[Ue,F]=l.useState(!1),[Y,xe]=l.useState(!1),[Me,Fe]=l.useState(null),[me,ue]=l.useState(!1),[o,u]=l.useState({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),[R,B]=l.useState([]),[V,Z]=l.useState([]),[Be,ee]=l.useState(!1),[p,v]=l.useState({}),[S,pe]=l.useState({logo:null,cover:null}),[he,ge]=l.useState(!1),[Ve,se]=l.useState(""),[be,z]=l.useState([]),[h,q]=l.useState(null),[fe,ze]=l.useState("Support"),[ye,T]=l.useState(null),[qe,je]=l.useState(!1),Ne=["Food & Beverage","Digital Products","Fashion & Apparel","Electronics & Gadgets","Home & Garden","Handmade & Crafts","Vehicles & Parts","Sports","Books","Baby & Kids","Beauty & Health","Real Estate","Services"],_e=["Shop Pickup","Free Shipping","Collection Point","Local Delivery"],Oe=["No Return","7 Days Return","15 Days Return","30 Days Return"],Ge=["New","Used","Like New","Refurbished","For Parts"];l.useEffect(()=>{const s=ds(ns,r=>{$(r),i&&He(i,r)}),a=r=>{r.target.closest(".menu-trigger")||r.target.closest(".search-results")||T(null)};return document.addEventListener("click",a),()=>{s(),document.removeEventListener("click",a)}},[i]);const He=(s,a)=>{const r=H(N(c,"business_pages",s),f=>{var y;if(f.exists()){const k=f.data();if(L({id:f.id,...k}),v(k),a){const _=(y=k.team)==null?void 0:y.find(j=>j.uid===a.uid);De(_?_.role:k.ownerId===a.uid?"Admin":null)}J(!1)}}),n=O(P(c,"marketplace"),G("sellerId","==",s)),x=H(n,f=>Re(f.docs.map(y=>({id:y.id,...y.data()})))),d=O(P(c,"conversations"),G("participants","array-contains",s)),as=H(d,f=>{const k=f.docs.map(j=>({id:j.id,...j.data()})).filter(j=>j.users.some(ae=>ae.uid!==s));Te(k);const _=k.reduce((j,ae)=>{var Ae;return j+(((Ae=ae.unreadCounts)==null?void 0:Ae[s])||0)},0);Le(_)}),rs=O(P(c,"notifications"),G("businessId","==",s),ps("timestamp","desc")),ls=H(rs,f=>{Ee(f.docs.map(y=>({id:y.id,...y.data()})))});return()=>{r(),x(),as(),ls()}},We=async s=>{if(se(s),q(null),s.length<2){z([]);return}const a=O(P(c,"users"),G("displayName",">=",""),ms(50)),r=await us(a),n=s.toLowerCase(),x=r.docs.map(d=>({uid:d.id,...d.data()})).filter(d=>d.displayName&&d.displayName.toLowerCase().includes(n)||d.handle&&d.handle.toLowerCase().includes(n)||d.email&&d.email.toLowerCase().includes(n)).slice(0,5);z(x)},Je=async()=>{var s;if(h){if((s=t.team)!=null&&s.some(a=>a.uid===h.uid)||t.ownerId===h.uid)return alert("User is already a member or owner.");await oe(P(c,"notifications"),{recipientId:h.uid,senderId:m.uid,senderName:t.name,senderAvatar:t.logo,type:"team_invite",pageId:i,pageName:t.name,role:fe,timestamp:ce(),isRead:!1}),alert(`Invite sent to ${h.displayName||h.email}!`),q(null),se(""),z([])}},ve=async s=>{await C(N(c,"notifications",s.id),{isRead:!0}),s.targetId&&g(`/product/${s.targetId}`)},Ke=async()=>{var r;if(!m)return alert("Please sign in.");const s=N(c,"business_pages",i);((r=t.followersList)==null?void 0:r.includes(m.uid))?await C(s,{followers:(t.followers||1)-1,followersList:le(m.uid)}):(await C(s,{followers:(t.followers||0)+1,followersList:cs(m.uid)}),t.ownerId!==m.uid&&await oe(P(c,"notifications"),{recipientId:t.ownerId,senderId:m.uid,senderName:m.displayName,senderAvatar:m.photoURL,type:"follow_business",targetId:i,message:`started following your business ${t.name}`,timestamp:ce(),isRead:!1}))},Qe=async s=>{try{await C(N(c,"marketplace",s.id),{sold:!s.sold}),T(null)}catch(a){console.error(a)}},Xe=()=>{xe(!1),u({title:"",price:"",currency:"BDT",condition:"New",description:"",category:"Digital Products",location:"Dhaka",address:"",stock:1,shippingType:"Shop Pickup",returnPolicy:"No Return"}),B([]),Z([]),F(!0)},Ye=s=>{xe(!0),Fe(s.id),u({...s});const a=Array.isArray(s.media)?s.media:s.image?[{url:s.image,type:"image"}]:[];Z(a),B([]),F(!0),T(null)},Ze=async s=>{confirm("Are you sure you want to delete this product?")&&(await xs(N(c,"marketplace",s.id)),T(null))},es=async()=>{var s;if(R.length===0&&V.length===0)return alert("Image required.");ue(!0);try{const a=await Promise.all(R.map(async x=>{const d=ie(re,`business/${i}/products/${Date.now()}_${x.name}`);return await ne(d,x),{url:await de(d),type:x.type.startsWith("video")?"video":"image"}})),r=[...V.map(x=>typeof x=="string"?{url:x,type:"image"}:x),...a],n={...o,price:Number(o.price),stock:Number(o.stock),media:r,image:(s=r[0])==null?void 0:s.url,sellerId:i,sellerName:t.name,sellerAvatar:t.logo,sellerVerified:t.isVerified||!1,isBusiness:!0,timestamp:ce()};Y?await C(N(c,"marketplace",Me),n):await oe(P(c,"marketplace"),{...n,boost:null,reviews:[],questions:[],sold:!1}),F(!1)}catch(a){console.error("Product Save Failed:",a),alert("Failed to save product. Check console for details.")}finally{ue(!1)}},ss=async()=>{ge(!0);try{let s=t.logo,a=t.coverImage;if(S.logo){const r=ie(re,`business/${i}/logo_${Date.now()}`);await ne(r,S.logo),s=await de(r)}if(S.cover){const r=ie(re,`business/${i}/cover_${Date.now()}`);await ne(r,S.cover),a=await de(r)}await C(N(c,"business_pages",i),{...p,logo:s,coverImage:a}),alert("Updated!"),ee(!1)}catch(s){console.error(s),alert("Error updating page.")}finally{ge(!1)}},ts=async s=>{confirm(`Remove ${s.name}?`)&&await C(N(c,"business_pages",i),{team:le(s),teamIds:le(s.uid)})};if(W)return e.jsx("div",{className:"p-20 text-center",children:"Loading..."});const we=["Admin","Editor"].includes(K),w=K==="Admin",E=!!K,ke=m&&((Ce=t.followersList)==null?void 0:Ce.includes(m.uid)),te=Q.filter(s=>D==="All"||s.category===D);return e.jsxs("div",{className:"p-0 md:p-6 w-full max-w-[1400px] mx-auto pb-24",children:[e.jsx("div",{className:"hidden md:block",children:e.jsx(hs,{})}),e.jsxs("div",{className:`bg-white md:rounded-[30px] shadow-sm mb-6 relative group overflow-hidden ${t.isVerified?"border-2 border-gold shadow-gold/20":""}`,children:[e.jsxs("div",{className:"h-48 md:h-72 bg-gray-200 relative group",children:[e.jsx("img",{src:t.coverImage,className:"w-full h-full object-cover",alt:"Business cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 via-transparent to-transparent"}),w&&e.jsxs("button",{onClick:()=>ee(!0),className:"absolute top-4 right-4 bg-white/20 backdrop-blur-md text-white px-4 py-2 rounded-full text-sm font-bold flex items-center gap-2 transition hover:bg-white/40",children:[e.jsx("i",{className:"fas fa-pen"})," Edit Page"]})]}),e.jsxs("div",{className:"px-6 md:px-10 pb-6 -mt-16 relative z-10 flex flex-col md:flex-row items-end gap-6",children:[e.jsx("div",{className:"w-32 h-32 bg-white rounded-2xl p-1 shadow-xl flex-shrink-0",children:e.jsx("img",{src:t.logo,className:"w-full h-full rounded-xl object-cover",alt:"Business logo"})}),e.jsxs("div",{className:"flex-1 text-center md:text-left mb-2",children:[e.jsxs("h1",{className:"text-3xl font-black text-dark flex items-center justify-center md:justify-start",children:[t.name,t.isVerified&&e.jsx("i",{className:"fas fa-check-circle text-gold text-2xl ml-2",title:"Verified Business"})]}),e.jsxs("p",{className:"text-gray-500 font-bold text-sm",children:[t.category," ",e.jsxs("span",{className:"text-primary mx-2",children:[t.followers||0," Followers"]})]})]}),e.jsx("div",{className:"flex gap-3 mb-2 justify-center w-full md:w-auto",children:E?e.jsxs(e.Fragment,{children:[w&&!t.isVerified&&e.jsxs("button",{onClick:()=>je(!0),className:"bg-blue-500 text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-blue-600 transition flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-check-circle"})," Verify Page"]}),w&&e.jsxs("button",{onClick:()=>g("/boost",{state:{targetId:i,targetType:"page",targetName:t.name}}),className:"bg-gold text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-yellow-600 transition",children:[e.jsx("i",{className:"fas fa-rocket mr-2"})," Boost"]}),e.jsxs("button",{onClick:()=>g("/messages",{state:{asBusiness:!0,businessId:i}}),className:"bg-dark text-white px-5 py-3 rounded-xl font-bold shadow-lg hover:bg-gray-700 transition",children:[e.jsx("i",{className:"fas fa-inbox mr-2"})," Inbox"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Ke,className:`px-6 py-3 rounded-xl font-bold shadow-lg transition-all ${ke?"bg-white text-dark border hover:bg-gray-50":"bg-primary text-white hover:bg-primary-dark"}`,children:ke?"Following":"Follow Shop"}),e.jsx("button",{onClick:()=>g("/messages",{state:{startChatWith:{uid:t.id,displayName:t.name,photoURL:t.logo,isBusiness:!0}}}),className:"bg-gray-100 text-dark px-4 py-3 rounded-xl font-bold hover:bg-gray-200 transition",children:e.jsx("i",{className:"fas fa-comment-alt"})})]})})]}),e.jsxs("div",{className:"flex border-t border-gray-100 px-6 gap-8 overflow-x-auto no-scrollbar mt-4",children:[e.jsx("button",{onClick:()=>A("products"),className:`py-4 font-bold capitalize border-b-4 transition-all ${b==="products"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:"Products"}),E&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>A("inbox"),className:`py-4 font-bold capitalize border-b-4 transition-all flex items-center gap-2 ${b==="inbox"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Inbox ",M>0&&e.jsx("span",{className:"bg-red-500 text-white text-[10px] px-2 py-0.5 rounded-full",children:M})]}),e.jsxs("button",{onClick:()=>A("notifications"),className:`py-4 font-bold capitalize border-b-4 flex items-center gap-2 ${b==="notifications"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:["Notifications ",U.length>0&&e.jsx("span",{className:"bg-orange-500 text-white text-[10px] px-2 py-0.5 rounded-full",children:U.length})]}),e.jsx("button",{onClick:()=>A("team"),className:`py-4 font-bold capitalize border-b-4 ${b==="team"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:"Team"}),w&&e.jsxs("button",{onClick:()=>A("growth"),className:`py-4 font-bold capitalize border-b-4 flex items-center gap-2 ${b==="growth"?"border-primary text-primary":"border-transparent text-gray-400 hover:text-dark"}`,children:[e.jsx("i",{className:"fas fa-chart-line"})," Growth"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[b==="products"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-50",children:[e.jsx("h3",{className:"font-bold text-xl mb-2 text-dark",children:"About"}),e.jsx("p",{className:"text-gray-600 text-sm whitespace-pre-wrap",children:t.description})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-bold text-xl text-dark",children:["Inventory (",te.length,")"]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("select",{value:D,onChange:s=>$e(s.target.value),className:"bg-gray-100 p-3 rounded-xl font-bold text-sm border border-gray-200",children:[e.jsx("option",{value:"All",children:"All"}),Ne.map(s=>e.jsx("option",{value:s,children:s},s))]}),we&&e.jsxs("button",{onClick:Xe,className:"bg-dark text-white px-4 py-3 rounded-xl font-bold text-sm flex items-center gap-1 hover:bg-primary transition",children:[e.jsx("i",{className:"fas fa-plus"})," Add"]})]})]}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4",children:te.map(s=>{var a,r;return e.jsxs("div",{className:"bg-white p-3 rounded-2xl shadow-sm border border-gray-100 relative group",children:[e.jsxs("div",{onClick:()=>g(`/product/${s.id}`),className:"cursor-pointer",children:[e.jsxs("div",{className:"relative rounded-xl overflow-hidden mb-3 aspect-square",children:[((r=(a=s.media)==null?void 0:a[0])==null?void 0:r.type)==="video"?e.jsx("video",{src:s.media[0].url,className:"w-full h-full object-cover",controls:!0}):e.jsx("img",{src:s.image,className:"w-full h-full object-cover",alt:s.title}),s.sold&&e.jsx("div",{className:"absolute inset-0 bg-black/70 flex items-center justify-center text-white font-black text-lg",children:"SOLD OUT"})]}),e.jsx("h4",{className:"font-bold text-sm text-dark truncate",children:s.title}),e.jsxs("p",{className:"text-primary font-black text-sm",children:[s.currency==="BDT"?"à§³":s.currency," ",s.price]})]}),we&&e.jsxs("div",{className:"absolute top-3 right-3",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),T(ye===s.id?null:s.id)},className:"menu-trigger w-8 h-8 bg-white/90 rounded-full flex items-center justify-center shadow-sm text-dark hover:bg-white transition",children:e.jsx("i",{className:"fas fa-ellipsis-v"})}),ye===s.id&&e.jsxs("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-xl shadow-xl z-50 overflow-hidden p-1 border border-gray-100",children:[e.jsx("button",{onClick:()=>Ye(s),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-gray-50 rounded-lg",children:"Edit"}),e.jsxs("button",{onClick:()=>Qe(s),className:`w-full text-left px-3 py-2 text-xs font-bold hover:bg-gray-50 rounded-lg flex items-center gap-2 ${s.sold?"text-green-600":"text-red-600"}`,children:[e.jsx("i",{className:`fas ${s.sold?"fa-check":"fa-times"}`})," ",s.sold?"Mark Available":"Mark Sold"]}),e.jsx("button",{onClick:()=>Ze(s),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-red-50 text-red-500 rounded-lg",children:"Delete"}),e.jsxs("button",{onClick:()=>g("/boost",{state:{targetId:s.id,targetType:"product",targetName:s.title}}),className:"w-full text-left px-3 py-2 text-xs font-bold hover:bg-yellow-50 text-gold rounded-lg flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-rocket"})," Boost Product"]})]})]})]},s.id)})}),te.length===0&&e.jsx("div",{className:"p-10 text-center text-gray-400 bg-gray-50 rounded-2xl border border-dashed border-gray-200",children:e.jsxs("p",{className:"font-bold",children:["No products found in ",D==="All"?"inventory":D,"."]})})]}),b==="inbox"&&E&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsxs("h3",{className:"text-lg font-bold mb-4 border-b pb-2 flex justify-between",children:["Business Inbox ",M>0&&e.jsxs("span",{className:"text-red-500 text-xs flex items-center gap-1",children:[e.jsx("i",{className:"fas fa-envelope"})," ",M," new"]})]}),X.length===0?e.jsx("p",{className:"text-gray-400",children:"No messages yet."}):e.jsx("div",{className:"space-y-3",children:X.map(s=>{var n,x;const a=s.users.find(d=>d.uid!==t.id)||{displayName:"Customer",photoURL:null},r=((n=s.unreadCounts)==null?void 0:n[t.id])>0;return e.jsxs("div",{onClick:()=>g("/messages",{state:{activeConversationId:s.id,asBusiness:!0,businessId:i,businessName:t.name}}),className:`flex justify-between items-center p-4 rounded-2xl cursor-pointer border transition-all ${r?"bg-gradient-to-r from-[#E0F2F1] to-white border-primary/30 shadow-sm scale-[1.01]":"bg-white hover:bg-gray-50 border-gray-100"}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{src:a.photoURL,name:a.displayName,size:"md"}),e.jsxs("div",{children:[e.jsx("h4",{className:`text-sm ${r?"font-black":"font-bold"}`,children:a.displayName}),e.jsx("p",{className:`text-xs truncate w-48 ${r?"font-bold text-dark":"text-gray-500"}`,children:s.lastMessage})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-[10px] text-gray-400 block",children:(x=s.updatedAt)!=null&&x.seconds?new Date(s.updatedAt.seconds*1e3).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}):""}),r&&e.jsx("span",{className:"inline-block bg-primary text-white text-[10px] font-bold px-2.5 py-0.5 rounded-full mt-1",children:"New"})]})]},s.id)})})]}),b==="notifications"&&E&&e.jsxs("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"text-lg font-bold mb-4 text-dark",children:"Page Activity (Reviews & Questions)"}),U.length===0?e.jsx("div",{className:"text-center py-10 text-gray-400",children:"No new activity."}):e.jsx("div",{className:"space-y-3",children:U.map(s=>{var r;const a=Q.find(n=>n.id===s.targetId);return e.jsxs("div",{onClick:()=>ve(s),className:"flex items-start gap-3 p-4 bg-gray-50 rounded-xl cursor-pointer hover:bg-gray-100 transition-colors border border-gray-100",children:[e.jsx(I,{src:s.senderAvatar,name:s.senderName}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm text-gray-800 leading-tight",children:[e.jsx("span",{className:"font-bold",children:s.senderName}),s.type==="review"&&" wrote a review on ",s.type==="question"&&" asked a question about ",e.jsx("span",{className:"text-primary font-bold",children:(a==null?void 0:a.title)||"a product"}),":"]}),e.jsxs("p",{className:"text-gray-600 italic text-sm mt-1",children:['"',s.message,'"']}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:(r=s.timestamp)!=null&&r.seconds?new Date(s.timestamp.seconds*1e3).toLocaleString():"Just now"})]}),e.jsxs("button",{className:"bg-primary text-white px-3 py-1 rounded-lg text-xs font-bold hover:bg-primary-dark transition-all flex-shrink-0",onClick:n=>{n.stopPropagation(),ve(s)},children:[e.jsx("i",{className:"fas fa-reply mr-1"})," View/Reply"]})]},s.id)})})]}),b==="team"&&E&&e.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-100",children:[e.jsx("h3",{className:"font-bold text-xl text-dark mb-6",children:"Team"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-50 rounded-2xl border border-yellow-100",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{src:t.logo,name:t.name,size:"md"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-bold",children:[t.name," (Owner)"]}),e.jsx("p",{className:"text-xs text-gray-500",children:t.email||"N/A"})]})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("span",{className:"text-primary font-bold text-sm ml-2",children:"Admin/Owner"})})]},t.ownerId),(Pe=t.team)==null?void 0:Pe.filter(s=>s.uid!==t.ownerId).map(s=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-2xl border border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(I,{src:s.avatar,name:s.name,size:"md"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-bold",children:s.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.email})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`text-xs font-bold px-3 py-1 rounded-full ${s.role==="Admin"?"bg-red-100 text-red-700":s.role==="Editor"?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"}`,children:s.role}),w&&e.jsx("button",{onClick:()=>ts(s),className:"text-red-500 hover:bg-red-50 p-2 rounded-full transition",children:e.jsx("i",{className:"fas fa-trash"})})]})]},s.uid)),((Se=t.team)==null?void 0:Se.filter(s=>s.uid!==t.ownerId).length)===0&&t.ownerId&&e.jsx("p",{className:"text-gray-400 text-center py-4",children:"No team members yet (only owner listed)."})]}),w&&e.jsxs("div",{className:"mt-8 pt-6 border-t border-gray-100",children:[e.jsx("h4",{className:"font-bold text-dark mb-4",children:"Invite New Member"}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx("input",{placeholder:"Search (Name, @handle, Email)...",value:Ve,onChange:s=>We(s.target.value),className:"w-full bg-gray-50 p-3 rounded-xl font-bold text-sm border border-gray-200 focus:border-primary focus:ring-primary"}),be.length>0&&!h&&e.jsx("div",{className:"search-results absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-xl shadow-lg z-30 max-h-40 overflow-y-auto p-2",children:be.map(s=>e.jsxs("div",{onClick:()=>{q(s),se(s.displayName||s.email),z([])},className:"p-2 hover:bg-gray-50 rounded-lg cursor-pointer flex items-center gap-3",children:[e.jsx(I,{src:s.photoURL,name:s.displayName,size:"sm"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-bold text-sm",children:s.displayName}),e.jsx("p",{className:"text-xs text-gray-400",children:s.email})]})]},s.uid))})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("select",{value:fe,onChange:s=>ze(s.target.value),className:"bg-gray-50 p-3 rounded-xl font-bold text-sm border border-gray-200 flex-1",children:[e.jsx("option",{value:"Support",children:"Support"}),e.jsx("option",{value:"Editor",children:"Editor"}),e.jsx("option",{value:"Viewer",children:"Viewer"})]}),e.jsx("button",{onClick:Je,disabled:!h,className:"bg-dark text-white px-6 py-3 rounded-xl font-bold hover:bg-primary transition disabled:opacity-50",children:"Send Invite"})]}),h&&e.jsxs("div",{className:"flex items-center justify-between bg-green-50 p-3 rounded-xl border border-green-100 mt-3 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(I,{src:h.photoURL,name:h.displayName,size:"sm"}),e.jsxs("span",{className:"font-bold text-green-800",children:["Selected: ",h.displayName||h.email]})]}),e.jsxs("button",{onClick:()=>q(null),className:"text-red-500 hover:text-red-700",children:[e.jsx("i",{className:"fas fa-times"})," Clear"]})]})]})]}),b==="growth"&&w&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[e.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Followers"}),e.jsx("div",{className:"text-2xl font-black text-dark",children:t.followers||0})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[e.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Leads"}),e.jsx("div",{className:"text-2xl font-black text-dark",children:X.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[e.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Inventory"}),e.jsx("div",{className:"text-2xl font-black text-dark",children:Q.length})]}),e.jsxs("div",{className:"bg-white p-4 rounded-2xl shadow-sm border border-gray-50",children:[e.jsx("div",{className:"text-gray-400 text-xs font-bold uppercase mb-1",children:"Rating"}),e.jsx("div",{className:"text-2xl font-black text-dark",children:((Ie=t.rating)==null?void 0:Ie.toFixed(1))||"N/A"})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-dark to-gray-900 p-6 rounded-[24px] text-white shadow-lg",children:[e.jsx("h3",{className:"font-bold text-lg mb-2",children:"Boost Sales"}),e.jsx("p",{className:"text-sm mb-4 text-gray-300",children:"Promote your business page to reach thousands of potential customers in your area."}),e.jsxs("button",{onClick:()=>g("/boost",{state:{targetId:i,targetType:"page",targetName:t.name}}),className:"w-full bg-white text-dark font-bold py-3 rounded-xl hover:bg-gold transition-colors",children:[e.jsx("i",{className:"fas fa-rocket mr-2"})," Promote Page"]})]})]})]}),e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{className:"bg-white p-6 rounded-[24px] shadow-sm border border-gray-50",children:[e.jsx("h3",{className:"font-bold text-dark mb-4 border-b border-gray-100 pb-2",children:"Contact & Info"}),e.jsxs("div",{className:"space-y-4 text-sm",children:[t.address&&e.jsxs("p",{children:[e.jsx("i",{className:"fas fa-map-pin mr-2 text-gray-400"})," ",t.address]}),t.email&&e.jsxs("p",{children:[e.jsx("i",{className:"fas fa-envelope mr-2 text-gray-400"})," ",t.email]}),t.phone&&e.jsxs("p",{children:[e.jsx("i",{className:"fas fa-phone mr-2 text-gray-400"})," ",t.phone]}),t.website&&e.jsxs("p",{children:[e.jsx("i",{className:"fas fa-globe mr-2 text-gray-400"})," ",e.jsx("a",{href:t.website,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline",children:t.website})]})]})]})})]}),Be&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-2xl rounded-[30px] flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"p-6 border-b flex justify-between",children:[e.jsx("h3",{className:"font-bold text-xl",children:"Edit Page Info"}),e.jsx("button",{onClick:()=>ee(!1),className:"text-gray-500 hover:text-red-500 text-2xl",children:e.jsx("i",{className:"fas fa-times"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("label",{className:"block",children:["Logo ",e.jsx("input",{type:"file",onChange:s=>pe({...S,logo:s.target.files[0]}),className:"block w-full text-sm text-gray-500"})]}),e.jsxs("label",{className:"block",children:["Cover ",e.jsx("input",{type:"file",onChange:s=>pe({...S,cover:s.target.files[0]}),className:"block w-full text-sm text-gray-500"})]})]}),e.jsx("input",{value:p.name||"",onChange:s=>v({...p,name:s.target.value}),placeholder:"Name",className:"w-full border p-3 rounded-xl"}),e.jsx("textarea",{value:p.description||"",onChange:s=>v({...p,description:s.target.value}),placeholder:"Description",className:"w-full border p-3 rounded-xl h-24"}),e.jsx("input",{value:p.address||"",onChange:s=>v({...p,address:s.target.value}),placeholder:"Address",className:"w-full border p-3 rounded-xl"}),e.jsx("input",{value:p.website||"",onChange:s=>v({...p,website:s.target.value}),placeholder:"Website",className:"w-full border p-3 rounded-xl"}),e.jsx("input",{value:p.email||"",onChange:s=>v({...p,email:s.target.value}),placeholder:"Email",className:"w-full border p-3 rounded-xl"}),e.jsx("input",{value:p.phone||"",onChange:s=>v({...p,phone:s.target.value}),placeholder:"Phone",className:"w-full border p-3 rounded-xl"})]}),e.jsx("div",{className:"p-6 border-t",children:e.jsx("button",{onClick:ss,disabled:he,className:"w-full bg-primary text-white p-3 rounded-xl font-bold hover:bg-primary-dark transition disabled:opacity-50",children:he?e.jsx("i",{className:"fas fa-spinner fa-spin"}):"Save Changes"})})]})}),Ue&&e.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm flex items-center justify-center z-[9999] p-4",children:e.jsxs("div",{className:"bg-white w-full max-w-lg rounded-[30px] p-6 max-h-[90vh] overflow-y-auto",children:[e.jsx("h3",{className:"font-bold text-xl mb-4",children:Y?"Edit Product":"Add Product"}),e.jsx("input",{value:o.title,onChange:s=>u({...o,title:s.target.value}),placeholder:"Title",className:"w-full border p-3 rounded-xl mb-2"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-2",children:[e.jsx("input",{value:o.price,onChange:s=>u({...o,price:s.target.value}),placeholder:"Price",type:"number",className:"w-full border p-3 rounded-xl"}),e.jsx("input",{value:o.stock,onChange:s=>u({...o,stock:s.target.value}),placeholder:"Stock",type:"number",className:"w-full border p-3 rounded-xl"}),e.jsxs("select",{value:o.currency,onChange:s=>u({...o,currency:s.target.value}),className:"w-full border p-3 rounded-xl",children:[e.jsx("option",{value:"BDT",children:"BDT"}),e.jsx("option",{value:"USD",children:"USD"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsx("select",{value:o.category,onChange:s=>u({...o,category:s.target.value}),className:"w-full border p-3 rounded-xl",children:Ne.map(s=>e.jsx("option",{value:s,children:s},s))}),e.jsx("select",{value:o.condition,onChange:s=>u({...o,condition:s.target.value}),className:"w-full border p-3 rounded-xl",children:Ge.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsx("input",{value:o.location,onChange:s=>u({...o,location:s.target.value}),placeholder:"City/Location",className:"w-full border p-3 rounded-xl mb-2"}),e.jsx("input",{value:o.address,onChange:s=>u({...o,address:s.target.value}),placeholder:"Full Address / Pickup Point",className:"w-full border p-3 rounded-xl mb-2"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-2",children:[e.jsx("select",{value:o.shippingType,onChange:s=>u({...o,shippingType:s.target.value}),className:"w-full border p-3 rounded-xl",children:_e.map(s=>e.jsx("option",{children:s},s))}),e.jsx("select",{value:o.returnPolicy,onChange:s=>u({...o,returnPolicy:s.target.value}),className:"w-full border p-3 rounded-xl",children:Oe.map(s=>e.jsx("option",{children:s},s))})]}),e.jsx("textarea",{value:o.description,onChange:s=>u({...o,description:s.target.value}),placeholder:"Description",className:"w-full border p-3 rounded-xl h-24 mb-2"}),e.jsxs("label",{className:"block mb-4",children:["Media (Images/Videos) ",e.jsx("input",{type:"file",multiple:!0,onChange:s=>B([...R,...Array.from(s.target.files)]),className:"block w-full text-sm text-gray-500"})]}),e.jsx("div",{className:"mb-4 flex flex-wrap gap-2",children:[...V,...R.map(s=>({url:URL.createObjectURL(s),file:s,isNew:!0}))].map((s,a)=>e.jsxs("div",{className:"relative w-16 h-16 rounded-lg overflow-hidden border border-gray-300",children:[s.type==="video"?e.jsx("video",{src:s.url,className:"w-full h-full object-cover"}):e.jsx("img",{src:s.url,className:"w-full h-full object-cover",alt:"product media"}),e.jsx("button",{onClick:()=>{s.isNew?B(R.filter(r=>r!==s.file)):Z(V.filter((r,n)=>n!==a))},className:"absolute top-0 right-0 bg-red-500 text-white rounded-full w-4 h-4 text-[8px] flex items-center justify-center",children:e.jsx("i",{className:"fas fa-times"})})]},a))}),e.jsx("button",{onClick:es,disabled:me,className:"w-full bg-primary text-white p-3 rounded-xl font-bold hover:bg-primary-dark transition disabled:opacity-50",children:me?e.jsx("i",{className:"fas fa-spinner fa-spin"}):Y?"Update Product":"Publish Product"}),e.jsx("button",{onClick:()=>F(!1),className:"w-full mt-2 text-gray-500 p-2 rounded-xl border border-gray-200 hover:bg-gray-50 transition",children:"Cancel"})]})}),qe&&e.jsx(gs,{onClose:()=>je(!1),target:{id:t.id,type:"business",name:t.name}})]})};export{ks as default};
